!function(){var e,t={1954:function(e){e.exports='<svg viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>713FE66A-8793-4FD4-AE48-3CFEB9EA14A4</title><g fill="none" fill-rule="evenodd"><path d="M25.45 18.897c.509.757.8 1.658.8 2.61 0 2.623-2.172 4.743-4.83 4.743H7.882c-3.375 0-6.131-2.69-6.131-6.015 0-3.326 2.756-6.016 6.131-6.016l.099.001c1.43-2.71 4.318-4.47 7.481-4.47.328 0 .653.019.972.055.316-.077.645-.123.982-.133 1.105-1.922 3.205-3.157 5.499-3.157 3.257 0 5.955 2.435 6.278 5.56a3.71 3.71 0 0 1 1.705 3.106c0 2.057-1.7 3.716-3.777 3.716h-1.67z" fill="#FFF" fill-rule="nonzero"></path><path d="M7.881 25C5.19 25 3 22.863 3 20.235c0-2.628 2.19-4.766 4.881-4.766.278 0 .563.03.863.088C9.779 12.848 12.465 11 15.461 11c3.953 0 7.17 3.14 7.17 7 0 .073-.002.146-.004.217 1.401.49 2.373 1.803 2.373 3.29C25 23.431 23.395 25 21.42 25H7.882z" fill="#8CB1D2"></path><path d="M18.494 10.303c.88-1.536 2.566-2.538 4.42-2.538 2.79 0 5.06 2.216 5.06 4.94 0 .053 0 .104-.002.154.99.346 1.675 1.273 1.675 2.322 0 1.36-1.133 2.466-2.527 2.466h-2.893a4.827 4.827 0 0 0-.367-.234c-.234-3.252-2.397-5.983-5.366-7.11z" fill="#BDDBF5"></path></g></svg>'},1695:function(e){e.exports='<svg viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>E27C4D95-57B5-47A8-BD76-95E0D90CC1A7</title><g fill="none" fill-rule="evenodd"><path d="M25.45 18.897c.509.757.8 1.658.8 2.61 0 2.623-2.172 4.743-4.83 4.743H7.882c-3.375 0-6.131-2.69-6.131-6.015 0-3.326 2.756-6.016 6.131-6.016l.099.001c1.43-2.71 4.318-4.47 7.481-4.47.328 0 .653.019.972.055.316-.077.645-.123.982-.133 1.105-1.922 3.205-3.157 5.499-3.157 3.257 0 5.955 2.435 6.278 5.56a3.71 3.71 0 0 1 1.705 3.106c0 2.057-1.7 3.716-3.777 3.716h-1.67z" fill="#FFF" fill-rule="nonzero"></path><path d="M18.494 10.303c.88-1.536 2.566-2.538 4.42-2.538 2.79 0 5.06 2.216 5.06 4.94 0 .053 0 .104-.002.154.99.346 1.675 1.273 1.675 2.322 0 1.36-1.133 2.466-2.527 2.466h-2.893a4.827 4.827 0 0 0-.367-.234c-.234-3.252-2.397-5.983-5.366-7.11zM7.88 25C5.19 25 3 22.863 3 20.235c0-2.628 2.19-4.766 4.881-4.766.278 0 .563.03.863.088C9.779 12.848 12.465 11 15.461 11c3.953 0 7.17 3.14 7.17 7 0 .073-.002.146-.004.217 1.401.49 2.373 1.803 2.373 3.29C25 23.431 23.395 25 21.42 25H7.882z" fill="#8CB1D2"></path></g></svg>'},1951:function(e){e.exports='<svg viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>713FBFF8-8C77-40D6-AB19-AA638C997654</title><g fill="none" fill-rule="evenodd"><path d="M17 28.25c-5.66 0-10.25-4.59-10.25-10.25S11.34 7.75 17 7.75 27.25 12.34 27.25 18 22.66 28.25 17 28.25zm0-20.5a2.25 2.25 0 0 1-2.25-2.25c0-1.367.79-3.25 2.25-3.25s2.25 1.883 2.25 3.25A2.25 2.25 0 0 1 17 7.75zm0 26c-1.46 0-2.25-1.883-2.25-3.25a2.25 2.25 0 1 1 4.5 0c0 1.367-.79 3.25-2.25 3.25zm12.5-13.5a2.25 2.25 0 1 1 0-4.5c1.367 0 3.25.79 3.25 2.25s-1.883 2.25-3.25 2.25zm-25 0c-1.367 0-3.25-.79-3.25-2.25s1.883-2.25 3.25-2.25a2.25 2.25 0 1 1 0 4.5zm19.748-9.498a2.25 2.25 0 0 1 0-3.182c.966-.966 2.857-1.739 3.889-.707 1.032 1.032.26 2.923-.707 3.89a2.25 2.25 0 0 1-3.182 0zM5.863 29.137c-1.032-1.032-.26-2.923.707-3.89a2.25 2.25 0 0 1 3.182 3.183c-.966.966-2.857 1.739-3.889.707zm18.385-.707a2.25 2.25 0 0 1 3.182-3.182c.966.966 1.739 2.857.707 3.889-1.032 1.032-2.923.26-3.89-.707zM6.57 10.752c-.966-.966-1.739-2.857-.707-3.889 1.032-1.032 2.923-.26 3.89.707a2.25 2.25 0 0 1-3.183 3.182z" fill="#FFF" fill-rule="nonzero"></path><path d="M17 27a9 9 0 1 1 0-18 9 9 0 0 1 0 18zm0-20.5a1 1 0 0 1-1-1c0-.552.448-2 1-2s1 1.448 1 2a1 1 0 0 1-1 1zm0 26c-.552 0-1-1.448-1-2a1 1 0 0 1 2 0c0 .552-.448 2-1 2zM29.5 19a1 1 0 0 1 0-2c.552 0 2 .448 2 1s-1.448 1-2 1zm-25 0c-.552 0-2-.448-2-1s1.448-1 2-1a1 1 0 0 1 0 2zm20.632-9.132a1 1 0 0 1 0-1.414c.39-.39 1.73-1.098 2.121-.707.39.39-.317 1.73-.707 2.121a1 1 0 0 1-1.414 0zM6.747 28.253c-.39-.39.317-1.73.707-2.121a1 1 0 0 1 1.414 1.414c-.39.39-1.73 1.098-2.121.707zm18.385-.707a1 1 0 1 1 1.414-1.414c.39.39 1.098 1.73.707 2.121-.39.39-1.73-.317-2.121-.707zM7.454 9.868c-.39-.39-1.098-1.73-.707-2.121.39-.39 1.73.317 2.121.707a1 1 0 0 1-1.414 1.414z" fill="#FFC704"></path></g></svg>'},6285:function(e){e.exports='<svg viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>2C77511B-A6C2-4FF5-9173-DEAFE123A9FF</title><g fill="none" fill-rule="evenodd"><path d="M25.688 19.29c.36.668.562 1.425.562 2.216 0 2.624-2.172 4.744-4.83 4.744H7.882c-3.375 0-6.131-2.69-6.131-6.015 0-3.326 2.756-6.016 6.131-6.016l.099.001c1.34-2.538 3.96-4.244 6.887-4.45a7.605 7.605 0 0 1 14.618 2.936 7.6 7.6 0 0 1-3.797 6.584z" fill="#FFF" fill-rule="nonzero"></path><path d="M7.881 25C5.19 25 3 22.863 3 20.235c0-2.628 2.19-4.766 4.881-4.766.278 0 .563.03.863.088C9.779 12.848 12.465 11 15.461 11c3.953 0 7.17 3.14 7.17 7 0 .073-.002.146-.004.217 1.401.49 2.373 1.803 2.373 3.29C25 23.431 23.395 25 21.42 25H7.882z" fill="#BDDBF5"></path><path d="M16.24 9.785a6.353 6.353 0 1 1 8.71 8.486 4.822 4.822 0 0 0-1.09-.858c-.29-4.03-3.542-7.26-7.62-7.628z" fill="#FFC704"></path><path d="M15.76 11.006c3.815.153 6.87 3.232 6.87 6.994 0 .073 0 .146-.003.217.388.136.744.335 1.055.583a6.353 6.353 0 0 1-7.922-7.794z" fill="#D9CE98"></path></g></svg>'},3816:function(e){e.exports='<svg viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>F18C0D2A-CC73-41D5-B1BF-68BB83CD1865</title><g fill-rule="nonzero" fill="none"><path d="M14.343 27.901a10.207 10.207 0 0 1-4.655-2.711l-2.147-2.187 3.064.06c4.602.092 7.14-1.438 7.997-4.632.899-3.355.076-6.127-2.533-8.51l-2.348-2.144 3.18-.028c.92-.008 1.843.108 2.748.35 5.468 1.466 8.713 7.086 7.248 12.554-1.465 5.468-7.086 8.713-12.554 7.248z" fill="#FFF"></path><path d="M14.667 26.694a9 9 0 1 0 2.245-17.695c2.952 2.696 3.917 5.948 2.897 9.755-1.02 3.808-4.096 5.66-9.229 5.56a8.958 8.958 0 0 0 4.087 2.38z" fill="#FFC704"></path></g></svg>'},3876:function(e){e.exports='<svg viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>80ED3C3E-F502-4A60-92F0-A412101E78FE</title><g fill="none" fill-rule="evenodd"><path d="M19.45 10.736c.014-1.394-.444-2.57-1.368-3.58l-1.892-2.07 2.804-.024a7.603 7.603 0 0 1 5.576 12.85 4.717 4.717 0 0 1 1.68 3.594c0 2.624-2.172 4.744-4.83 4.744H7.882c-3.375 0-6.131-2.69-6.131-6.015 0-3.326 2.756-6.016 6.131-6.016l.099.001c1.43-2.71 4.318-4.47 7.481-4.47 1.441 0 2.8.357 3.989.986z" fill="#FFF" fill-rule="nonzero"></path><path d="M7.881 25C5.19 25 3 22.863 3 20.235c0-2.628 2.19-4.766 4.881-4.766.278 0 .563.03.863.088C9.779 12.848 12.465 11 15.461 11c3.953 0 7.17 3.14 7.17 7 0 .073-.002.146-.004.217 1.401.49 2.373 1.803 2.373 3.29C25 23.431 23.395 25 21.42 25H7.882z" fill="#BDDBF5"></path><path d="M20.392 12.923c1.36 1.26 2.217 3.035 2.238 5a6.338 6.338 0 0 1-5.21.88 6.324 6.324 0 0 1-2.885-1.68c3.168-.05 5.113-1.42 5.833-4.108l.024-.092z" fill="#D9CE98"></path><path d="M20.654 11.51c.215-2.028-.335-3.76-1.65-5.198a6.353 6.353 0 0 1 4.801 10.584c-.298-2.18-1.468-4.09-3.151-5.387z" fill="#FFC704"></path></g></svg>'},545:function(e){e.exports='<svg viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>3359B0F4-A128-4549-88A2-213FDE2FA2FB</title><g fill="none" fill-rule="evenodd"><path d="M10.52 29.68c-.564.971-1.562 1.57-2.576 1.57-1.228 0-2.194-.89-2.194-2.198 0-1.442 1.225-2.712 3.545-4.12l1.641-.997.248 1.904c.189 1.452-.025 2.746-.663 3.842zm7 0c-.564.971-1.562 1.57-2.576 1.57-1.228 0-2.194-.89-2.194-2.198 0-1.442 1.225-2.712 3.545-4.12l1.641-.997.248 1.904c.189 1.452-.025 2.746-.663 3.842z" fill="#FFF"></path><path d="M9.44 29.052c-.736 1.264-2.44 1.264-2.44 0 0-.843.981-1.86 2.944-3.052.155 1.192-.013 2.21-.503 3.052zm7 0c-.736 1.264-2.44 1.264-2.44 0 0-.843.981-1.86 2.944-3.052.155 1.192-.013 2.21-.503 3.052z" fill="#8EB8DD"></path></g></svg>'},4587:function(e){e.exports='<svg viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>613BEAEE-9128-4049-9659-BB80DD998461</title><g fill="none" fill-rule="evenodd"><path d="M10.52 28.68c-.564.971-1.562 1.57-2.576 1.57-1.228 0-2.194-.89-2.194-2.198 0-1.442 1.225-2.712 3.545-4.12l1.641-.997.248 1.904c.189 1.452-.025 2.746-.663 3.842zm7.796.794c-.688 1.108-1.876 1.776-3.057 1.776-1.4 0-2.509-.96-2.509-2.435 0-1.68 1.56-3.195 4.557-4.901L18.91 23l.254 1.827c.245 1.766-.031 3.33-.848 4.646z" fill="#FFF" fill-rule="nonzero"></path><path d="M9.44 28.052c-.736 1.264-2.44 1.264-2.44 0 0-.843.981-1.86 2.944-3.052.155 1.192-.013 2.21-.503 3.052zm7.814.763c-.981 1.58-3.254 1.58-3.254 0 0-1.054 1.309-2.325 3.926-3.815.206 1.49-.018 2.761-.672 3.815z" fill="#4899DE"></path></g></svg>'},7885:function(e){e.exports='<svg viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>D2A5B7F2-9111-4D4B-ABE3-7B78FFB0D14B</title><g fill-rule="nonzero" fill="none"><path d="M19.316 28.474c-.688 1.108-1.876 1.776-3.057 1.776-1.4 0-2.509-.96-2.509-2.435 0-1.68 1.56-3.195 4.557-4.901L19.91 22l.254 1.827c.245 1.766-.031 3.33-.848 4.646zm-6.795 2.207c-.565.97-1.563 1.569-2.577 1.569-1.228 0-2.194-.89-2.194-2.198 0-1.442 1.225-2.712 3.545-4.12l1.641-.997.248 1.904c.189 1.452-.025 2.746-.663 3.842zm-4-4c-.565.97-1.563 1.569-2.577 1.569-1.228 0-2.194-.89-2.194-2.198 0-1.442 1.225-2.712 3.545-4.12l1.641-.997.248 1.904c.189 1.452-.025 2.746-.663 3.842z" fill="#FFF"></path><path d="M18.254 27.815c.654-1.054.878-2.325.672-3.815C16.309 25.49 15 26.761 15 27.815c0 1.58 2.273 1.58 3.254 0zm-6.813 2.237c.49-.843.658-1.86.503-3.052C9.981 28.192 9 29.21 9 30.052c0 1.264 1.704 1.264 2.44 0zm-4-4c.49-.843.658-1.86.503-3.052C5.981 24.192 5 25.21 5 26.052c0 1.264 1.704 1.264 2.44 0z" fill="#4899DE"></path></g></svg>'},7937:function(e){e.exports='<svg viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>997A852F-F63E-48A1-8889-CE66B125273D</title><g fill="none" fill-rule="evenodd"><path d="M12.682 28.765l-1.453 1.413-.607 2.202-2.122-.553-2.122.553-.607-2.202-1.453-1.413 1.453-1.413.607-2.202 2.122.552 2.122-.552.607 2.202 1.453 1.413zm5.839 1.916c-.565.97-1.563 1.569-2.577 1.569-1.228 0-2.194-.89-2.194-2.198 0-1.442 1.225-2.712 3.545-4.12l1.641-.997.248 1.904c.189 1.452-.025 2.746-.663 3.842z" fill="#FFF" fill-rule="nonzero"></path><path d="M9.362 28.281h1.029l.498.484-.498.484H9.36l.565.95-.182.66-.68-.176-.564-.95-.564.95-.68.177-.182-.661.564-.95H6.61l-.498-.484.498-.484h1.03l-.565-.95.182-.661.68.177.564.95.564-.95.68-.177.182.66-.564.951zm8.079 1.77c-.737 1.265-2.441 1.265-2.441 0 0-.842.981-1.86 2.944-3.051.155 1.192-.013 2.21-.503 3.052z" fill="#4899DE"></path></g></svg>'},2881:function(e){e.exports='<svg viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>805FDEE7-AE75-479C-9901-F66E82E9A0E8</title><g fill="none" fill-rule="evenodd"><path d="M11.072 27.638l1.445-1.405.665-2.413 2.318.603 2.318-.603.665 2.413 1.575 1.532-1.575 1.531-.665 2.414-2.318-.604-2.318.604-.665-2.414-1.496-1.454a6.042 6.042 0 0 1-.705 1.632c-.688 1.108-1.876 1.776-3.057 1.776-1.4 0-2.509-.96-2.509-2.435 0-1.68 1.56-3.195 4.557-4.901L10.91 23l.254 1.827c.14 1.005.11 1.944-.092 2.81z" fill="#FFF"></path><path d="M9.254 28.815c-.981 1.58-3.254 1.58-3.254 0C6 27.76 7.309 26.49 9.926 25c.206 1.49-.018 2.761-.672 3.815zm7.244-1.61h1.19l.577.56-.576.56h-1.191l.653 1.1-.211.765-.787-.205-.653-1.1-.653 1.1-.787.205-.21-.765.652-1.1h-1.19l-.577-.56.576-.56h1.191l-.653-1.1.211-.765.787.205.653 1.1.653-1.1.787-.205.21.765-.652 1.1z" fill="#4899DE"></path></g></svg>'},9787:function(e){e.exports='<svg viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>761B13B3-A6B1-4263-A2A2-A42324506CBF</title><g fill="none" fill-rule="evenodd"><path d="M14.066 29.063l-.606.606.033.056-.703 2.626-2.564-.687-2.564.687-.704-2.626.033-.056-1.75-1.75c-.405.214-.849.331-1.297.331-1.228 0-2.194-.89-2.194-2.198 0-1.442 1.225-2.712 3.545-4.12l1.641-.997.248 1.904c.18 1.392-.008 2.64-.587 3.706l.394-.394-.033-.056.704-2.626 2.564.687 2.564-.687.703 2.626-.033.056.533.533c.546-1.252 2.002-2.454 4.314-3.77L19.91 22l.254 1.827c.245 1.766-.031 3.33-.848 4.646-.688 1.108-1.876 1.776-3.057 1.776-.95 0-1.766-.442-2.193-1.187z" fill="#FFF"></path><path d="M11.39 27.238h1.39l.671.672-.672.672h-1.39l.763 1.32-.246.918-.918-.246-.762-1.32-.762 1.32-.918.246-.246-.918.762-1.32h-1.39L7 27.91l.672-.672h1.39l-.762-1.32.246-.918.918.246.762 1.32.762-1.32.918-.246.246.918-.762 1.32zm-5.95-1.186c-.736 1.264-2.44 1.264-2.44 0 0-.843.981-1.86 2.944-3.052.155 1.192-.013 2.21-.503 3.052zm12.814 1.763c-.981 1.58-3.254 1.58-3.254 0 0-1.054 1.309-2.325 3.926-3.815.206 1.49-.018 2.761-.672 3.815z" fill="#4899DE"></path></g></svg>'},2778:function(e){e.exports='<svg viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>EBA3AE65-3F6D-4359-ACED-1C62415F17C4</title><g fill="none" fill-rule="evenodd"><path fill="#FFF" d="M12 29.428l-.771.75-.607 2.202-2.122-.553-2.122.553-.607-2.202-1.453-1.413 1.453-1.413.607-2.202 2.122.552 2.122-.552.607 2.202.771.75.771-.75.607-2.202 2.122.552 2.122-.552.607 2.202 1.453 1.413-1.453 1.413-.607 2.202-2.122-.553-2.122.553-.607-2.202-.771-.75z"></path><path d="M9.362 28.281h1.029l.498.484-.498.484H9.36l.565.95-.182.66-.68-.176-.564-.95-.564.95-.68.177-.182-.661.564-.95H6.61l-.498-.484.498-.484h1.03l-.565-.95.182-.661.68.177.564.95.564-.95.68-.177.182.66-.564.951zm7 0h1.029l.498.484-.498.484h-1.03l.565.95-.182.66-.68-.176-.564-.95-.564.95-.68.177-.182-.661.564-.95H13.61l-.498-.484.498-.484h1.03l-.565-.95.182-.661.68.177.564.95.564-.95.68-.177.182.66-.564.951z" fill="#8EB8DD"></path></g></svg>'},7771:function(e){e.exports='<svg viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>D795E98C-9378-4FD8-9245-C6BC911F3076</title><g fill="none" fill-rule="evenodd"><path d="M13.058 25.765l-1.575 1.531-.665 2.414-2.318-.604-2.318.604-.665-2.414-1.575-1.531 1.575-1.532.665-2.413 2.318.603 2.318-.603.665 2.413 1.575 1.532zm8.935 1.46l-1.758 1.76.032.056-.703 2.625L17 30.98l-2.564.687-.703-2.625.032-.057-1.758-1.758 1.758-1.76-.032-.056.703-2.625 2.564.687 2.564-.687.703 2.625-.032.057 1.758 1.759z" fill="#FFF" fill-rule="nonzero"></path><path d="M9.498 25.205h1.19l.577.56-.576.56H9.498l.653 1.1-.211.765-.787-.205-.653-1.1-.653 1.1-.787.205-.21-.765.652-1.1h-1.19l-.577-.56.576-.56h1.191l-.653-1.1.211-.765.787.205.653 1.1.653-1.1.787-.205.21.765-.652 1.1zm8.666 1.349h1.39l.672.672-.672.672h-1.39l.762 1.32-.246.917-.918-.246L17 28.57l-.762 1.32-.918.246-.246-.918.762-1.32h-1.39l-.672-.671.672-.672h1.39l-.762-1.32.246-.918.918.246.762 1.32.762-1.32.918-.246.246.918-.762 1.32z" fill="#4899DE"></path></g></svg>'},3714:function(e){e.exports='<svg viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>5F458AD6-AC27-44BA-ABDE-58A62B42520E</title><g fill="none" fill-rule="evenodd"><path fill="#FFF" fill-rule="nonzero" d="M16.038 29.18l-.803.804.032.057-.703 2.625L12 31.98l-2.564.687-.703-2.625.032-.057-1.389-1.389-1.876-.489-2.318.604-.665-2.414-1.575-1.531 1.575-1.532.665-2.413 2.318.603 2.318-.603.665 2.413.873.85.08-.298 2.564.687 2.564-.687.398 1.485.803-.803-.032-.057.703-2.625 2.564.687 2.564-.687.703 2.625-.032.057 1.758 1.759-1.758 1.758.032.057-.703 2.625L19 29.98l-2.564.687-.398-1.485z"></path><path d="M13.164 27.554h1.39l.672.672-.672.672h-1.39l.762 1.32-.246.917-.918-.246L12 29.57l-.762 1.32-.918.246-.246-.918.762-1.32h-1.39l-.672-.671.672-.672h1.39l-.762-1.32.246-.918.918.246.762 1.32.762-1.32.918-.246.246.918-.762 1.32zm-6.666-3.35h1.19l.577.56-.576.56H6.498l.653 1.1-.211.766-.787-.205-.653-1.1-.653 1.1-.787.205-.21-.765.652-1.1h-1.19l-.577-.56.576-.56h1.191l-.653-1.1.211-.765.787.205.653 1.1.653-1.1.787-.205.21.765-.652 1.1zm13.666 1.35h1.39l.672.672-.672.672h-1.39l.762 1.32-.246.917-.918-.246L19 27.57l-.762 1.32-.918.246-.246-.918.762-1.32h-1.39l-.672-.671.672-.672h1.39l-.762-1.32.246-.918.918.246.762 1.32.762-1.32.918-.246.246.918-.762 1.32z" fill="#4899DE"></path></g></svg>'},7073:function(e){e.exports='<svg viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>0F024FCF-A601-4A32-85EA-9AB49EAB9573</title><defs><linearGradient x1="92.825%" y1="0%" x2="15.617%" y2="100%" id="b"><stop stop-color="#FFC90A" stop-opacity=".9" offset="0%"></stop><stop stop-color="#FF9904" stop-opacity=".9" offset="100%"></stop></linearGradient><path id="a" d="M30.072 14.513l-8.105 8.75.034.25h3.03l-2.297 6.595.239.217 8.425-8.92-.02-.21H28.3l2.122-6.682z"></path></defs><g fill-rule="nonzero" fill="none"><path fill="#FFF" d="M32.513 19.945l.184 1.905-9.659 10.226-1.756-1.6 1.99-5.714h-2.36l-.264-1.914 8.878-9.585h2.604l-2.122 6.682z"></path><g fill-rule="evenodd"><use fill="#FFF" xlink:href="#a"></use><use fill="url(#b)" xlink:href="#a"></use></g></g></svg>'},5675:function(e,t,i){"use strict";i(6833);var a=i(7339),n=i(2789),r=(i(6719),i(7866),i(3205),i(7463),i(620),i(5815)),o=(i(2699),i(5273));function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}r(i(7339)),o(),n.module("mosapp",["pascalprecht.translate"]).constant("mosconfig",{altParams:{ru:"Официальный сайт Мэра Москвы",en:"Moscow Mayor official website"},domain:"www.mos.ru",vendor:"/news/assets/vendor/",imagesPath:"/news/assets/static/images/",i18nPath:"/news/assets/news/",jsPath:"/news/assets/vendor/",assetsPath:"/news/assets/",searchPath:{search:"/search?category=%category%&page=1&q=",suggest:"/aisearch/suggest/ais/api/suggests/serp/%query%/"},"2GisApi":{url:"//maps.api.2gis.ru/2.0/loader.js?pkg=full&lazy=true",search_url:"//catalog.api.2gis.ru/geo/search"},mapsLoaderPath:"/front/markup/maps/js/loader.min.js",linksPath:{windowCams:"http://video.dit.mos.ru/window/"},pagePath:{page404:"/404/",mainpage:"/index/",feedback:"/feedback/",reception:"/reception/",authority:"/authority/",news:"/news/",afisha:"/afisha/",pulse:"/news/",press:"/mayor/themes/",department:"/authority/structure/",departmentScheme:"/scheme/",programs:"/city/progress/programs/",mayor:"/mayor/biography/",mayorMain:"/mayor/",mayorNews:"/mayor/themes/",mayorInfographic:"/mayor/infographic/",interviews:"/mayor/interviews/",progress:"/city/progress/result/",projects:"/city/projects/",city:"/city/progress/","mos.seasons":"/city/seasons/",festivals:"/city/festivals/",departmentSchemePrint:"/schemePrint/",search:"/search/",errorMessage:"/api/widgets/v1/json/bugreport",ritual:"/ritual/",documents:"/authority/documents/",documentslegacy:"/docs/",maslenica:"/maslenica/",conferences:"/conferences/",services:"/services/",servicesPgu:"/pgu",mediaMain:"/media/",myRegion:"/moi-raion/",venues:"/afisha/venues/"},banners:{},restAPI:{newsfeed:{pressStory:"/api/newsfeed/v4/frontend/json/[lang]/press/news/%id%",articlesList:"/api/newsfeed/v4/frontend/json/[lang]/articles",newsArticle:"/api/newsfeed/v4/frontend/json/[lang]/articles/%id%",afishaV4Event:"/api/newsfeed/v4/frontend/json/[lang]/afisha/%id%",mediaGallery:"/api/newsfeed/v4/frontend/json/[lang]/press/media/info/%id%",pressVideo:"/api/newsfeed/v4/frontend/json/[lang]/press/media/video",pressPresentation:"/api/newsfeed/v4/frontend/json/[lang]/press/presentation/%id%",pressInfographic:"/api/newsfeed/v4/frontend/json/[lang]/infographic/%id%",media_photo:"/api/newsfeed/v4/frontend/json/[lang]/press/media/photo",afishaV4List:"/api/newsfeed/v4/frontend/json/[lang]/afisha",spheres:"/api/newsfeed/v4/frontend/json/[lang]/spheres",daytimes:"/api/newsfeed/v4/frontend/json/[lang]/afisha/daytimes",auditories:"/api/newsfeed/v4/frontend/json/ru/afisha/auditories",place_types:"/api/newsfeed/v4/frontend/json/ru/afisha/place_types",spots:"/api/newsfeed/v4/frontend/json/ru/spot",mainMediaPhoto:"/api/newsfeed/v4/frontend/json/[lang]/press/main_media/info/%id%",mainMediaVideo:"/api/newsfeed/v4/frontend/json/[lang]/press/main_media/video",proxy:"/api/newsfeed/v4/frontend/json/[lang]/proxy/%id%",materials:"/api/newsfeed/v4/frontend/json/[lang]/materials",mainDistrics:"/api/newsfeed/v4/frontend/json/[lang]/articles",occurrences:"/api/newsfeed/v4/frontend/json/[lang]/afisha/%id%/occurrences",abcdRandomLastMaterials:'/api/newsfeed/v4/frontend/json/ru/materials?filter={"entity_suffix":["050","073"],"status":"public","has_image":1}&fields=id,entity_id,lang,date,entity_suffix,status&perPage=20&page=1&sort=-date'},projects:{projectSpecDetail:"/api/projects/v1/frontend/json/[lang]/projects/%id%",festivalDetail:"/api/projects/v1/frontend/json/[lang]/festivals/%id%"},moldings:{moldings:"/api/moldings/v1/frontend/json/[lang]/moldings/%id%"},structure:{institutions:"/api/structure/v1/frontend/json/[lang]/institutions",institution:"/api/structure/v1/frontend/json/[lang]/institutions/%id%",person:"/api/structure/v1/frontend/json/[lang]/persons/%id%"},department:{all:"/api/structure/v1/frontend/json/ru/institutions",personsDetail:"/api/government/v1/json/persons/detail.php?personId=%id%",departmentDetail:"/api/government/v1/json/department/detail.php"},suggest:{newsfeed:"/aisearch/suggest/ais/api/suggests/serp/%query%/",afisha:'/aisearch/ais_searchapi/ru/search/afisha/?q=%query%*&simple_query_string=1&skip_stat=9&filter_not={"f_published":[false]}'},directories:{districts:"/api/directories/v2/frontend/json/territory/districts",areas:"/api/directories/v2/frontend/json/territory/areas",area:"/api/directories/v2/frontend/json/territory/areas/%id%"},"moi-raion":{districts:"/api/moi-raion/v1/districts"},services:{segments:"/services/segments/v1/%mosId%"},search:{weather:"/aisearch/wizards/widgets/section_news/?q=погода&no_cache=1"},foundations:{list:"/api/newsfeed/v4/frontend/json/ru/foundations"},newsRecommender:{recommend:"/api/news-recommender/v1/frontend/json/ru/recommend"}}}).name,n.module("mosapp").service("UrlSrvc",["mosconfig","LangSrvc","$location",function(e,t,i){this.getMainDomain=function(){var t="";return e.domain&&(t=(t=(0===e.domain.indexOf("http")?"":location.protocol+"//")+e.domain).replace(new RegExp("/$"),"")),t},this.getLangLink=function(e){var i=t.getCurrentLang();return"ru"==i?e:"/"+i+e},this.getLangLinkPrefix=function(){var e=t.getCurrentLang();return"ru"==e?"":"/"+e},this.tmplPath=function(e){return e},this.apiPath=function(t){return e.restAPI[t]},this.jsPath=function(t){return((e.jsPath||"")+t).replace(new RegExp("//","g"),"/")},this.cssPath=function(t){return((e.cssPath||"")+t).replace(new RegExp("//","g"),"/")},this.pagePath=function(t,i){return((e.pagePath[t]||"")+i).replace(new RegExp("//","g"),"/")},this.assetsPath=function(t){return((e.assetsPath||"")+t).replace(new RegExp("//","g"),"/")},this.linksPath=function(t){return e.linksPath[t]},this.specialType=function(t){return e.specialType[t]||""},this.currentEmergency=function(t){if(t||e.emergency)return e.emergency[t]||""},this.currentEmergencyPath=function(t){if(t||e.emergency||e.emergency.path)return e.emergency.path[t]||""},this.getBanners=function(t){return{items:e.banners[t]}},this.isExternalUrl=function(e){return!/(^((http(s)?:\/\/)?(www.)?|\/\/)?mos.ru)|^\/{1}([^/]+|$)/gi.test(e)},this.addParamsToUrl=function(e,t){if(!t)return e;var i=e.split("#"),a=i[1]?"#"+i[1]:"",r=[];return i=i[0].split("?"),n.forEach(t,(function(e,t){r.push(t+"="+e)})),1===i.length?e=i[0]+"?"+r.join("&"):2===i.length&&(e=i[0]+"?"+i[1]+"&"+r.join("&")),e+a},this.setCanonical=function(t){var a=document.querySelector('link[rel="canonical"]');if(a||((a=document.createElement("link")).rel="canonical",document.getElementsByTagName("head")[0].appendChild(a)),!t){t=i.absUrl();var n=/([a-z][a-z0-9+\-.]*:(\/\/[^/?#]+)?)?([a-z0-9\-._~%!$&'()*+,;=:@/]*)/.exec(t)[3];t=e.domain?(0===e.domain.indexOf("http")?"":"https://")+e.domain:"https://mos.ru",t+=n}a.setAttribute("href",t)}}]),n.module("mosapp").filter("imagesPath",["mosconfig",function(e){return function(t){return((e.imagesPath||"")+t).replace(new RegExp("//","g"),"/")}}]),n.module("mosapp").provider("LangSrvc",(function(){var e=!1;this.setCurrentLang=function(){return e||(e=(e=document.documentElement.lang)||"ru"),e},this.$get=function(){return{getCurrentLang:function(){return e}}}})).service("linksInterceptor",[function(){var e=0,t=new Object(null);t[++e]={regExp:[/\/pgu./],attr:"href",callback:function(e,t){if("object"===("undefined"==typeof _paq?"undefined":s(_paq))&&"function"==typeof _paq.push){e.preventDefault();var i=a(t).attr("href");_paq.push(["trackLink",i,"link"]);var n=window.open(i,"_blank");n&&n.focus()}},id:e},t[++e]={regExp:[/\/pgu\//],attr:"href",callback:function(e,t){if("object"===s(window._paq)&&"function"==typeof window._paq.push){var i=a(t).attr("href");_paq.push(["trackLink",i,"link"])}},id:e};var i={openInNewTab:function(e,t){e.preventDefault();var i=a(t).attr("href"),n=window.open(i,"_blank");n&&n.focus()}};function n(e){return"function"==typeof e.exec}return a(document).on("click","a",(function(e){var i=a(this);Object.keys(t).forEach((function(a){var n=t[a],r=i.attr(n.attr);if(r&&""!==r)for(var o=0;o<n.regExp.length;o++)if(null!==n.regExp[o].exec(r)){n.callback(e,i,n.cbParams);break}}))})),{add:function(a,r,o,l){var c=new Object(null);if(Array.isArray(a)){var d=[];a.forEach((function(e){n(e)&&d.push(e)})),c.regExp=d}else n(a)&&(c.regExp=[a]);if(c.attr="string"==typeof o?o:"href","function"==typeof r)c.callback=r;else if("string"==typeof r){if("function"!=typeof i[r])return!1;c.callback=i[r]}return"object"==s(l)?c.cbParams=l:c.cbParams=new Object(null),c.id=++e,t[e]=c,c},remove:function(e){return!!t[e]&&(delete t[e],!0)},check:function(e){return!!t[e]}}}]),n.module("mosapp").service("toolsSrvc",["mosconfig","$timeout","LangSrvc","UrlSrvc","$filter",function(e,t,i,r,o){var s,l=this;this.ruStrToDate=function(e){var t=!1;if(n.isString(e)){var i=e.split(".");i.length>2&&(t=new Date(i[2],i[1]-1,i[0]))}return t||e},this.getSiteLogo=function(){return e.siteLogo||null},this.fillOutPages=function(e,t){for(var i=[],a=1;a<t+1;a++)i.push({num:a});return i},this.scrollTop=function(){a("html, body").animate({scrollTop:0},750)},this.scrollTo=function(e){var t=e.top,i=e.speed,n=e.substractHeaderHeight,r=0;(void 0===n||n)&&(r=a("#mos-header").outerHeight(!0)||0),a("html, body").animate({scrollTop:t-r},i||750)},this.colorScheme=function(){return"true"===localStorage.getItem("contrast")?"contrast":"default"},this.htmlToPlaintext=function(e){return(e=e?String(e).replace(/&\w{4,5};/gm," "):"")?String(e).replace(/<[^>]+>/gm,""):""},this.setMeta=function(t,i,n){var o;o=r.getMainDomain();var s=t.image&&""!==t.image&&t.image.indexOf("data:image",0)<0?t.image:(e.imagesPath||"")+"favicon/icon200x200.png";if(s=0===s.indexOf("http")?s:o+"/"+s.replace(new RegExp("^/"),""),a('meta[property="og:url"]').attr("content",o+"/"+location.pathname.replace(new RegExp("^/"),"")),n&&i[n]){var c=this.htmlToPlaintext(i[n].description);a('meta[property="og:title"]').attr("content",this.htmlToPlaintext(i[n].title)),a('meta[property="og:description"]').attr("content",c),l.setDescription(c)}a('meta[property="og:image"]').attr("content",s),a('meta[property="og:image:url"]').attr("content",s)},this.getMetaForImage=function(t){var a=i.getCurrentLang();return{alt:t+". "+e.altParams[a],title:t}},this.setTitle=function(){for(var t=i.getCurrentLang(),n=e.titleParams||{},r=n.separator||" / ",o=n.siteName&&n.siteName[t]||"Сайт Москвы",s=[],l=0;l<arguments.length;l++)s.push(this.htmlToPlaintext(arguments[l]));var c=Array.prototype.slice.call(s,0);c.push(o),a("title").text(c.join(r))},this.setDescription=function(t){var a=i.getCurrentLang();if(t&&""!=t){var n=(e.altParams||{})[a]||"Официальный сайт Мэра Москвы",r=" ";"."!==t[t.length-1]&&(r=". "),l._setMeta("description",t+r+n)}},this.setKeywords=function(e){e&&""!=e&&l._setMeta("keywords",e)},this._setMeta=function(e,t){if(e&&0!=e.length){var i=a("meta[name="+e+"]");if(i.length>0)i.attr("content",t);else{var n=document.createElement("meta");n.name=e,n.content=t,document.getElementsByTagName("head")[0].appendChild(n)}}},this.togglerBlackAndWhite=function(e,t,i){i instanceof a||"string"!=typeof i?i instanceof a&&void 0!==i||(i=a(document.body)):i=a(i),"contrast"===t?(i.find(e).addClass("grayscale"),i.find(".grayscale-img").addClass("grayscale"),i.find(".grayscale").gray()):(i.find(".grayscale").toggleClass("grayscale-off"),i.find(e).removeClass("grayscale"),i.find(".grayscale-img").removeClass("grayscale"))},this.prepareTags=function(e){var t=[];return n.isString(e)?e:n.isArray(e)?(e.forEach((function(e){t.push(e.title)})),t.join(", ")):void 0},this.setErrorInfo=function(e){s=e},this.getErrorInfo=function(){return s},this.localeNum=function(e,t){if("number"!=typeof(e*=1))return"";if((!t||t.length<1)&&(t=new Array("")),(e=e.toString()).indexOf(".")>0||e.indexOf(",")>0)return t[1];var i,a,n=e.length;return i=new Number(n<2?0:e.substr(n-2,1)),a=new Number(e.substr(n-1,1)),1==i?t[2]:a>1&&a<5?t[1]:a>4&&a<=9||0==a?t[2]:1==a?t[0]:void 0},this.hideContentArea=function(e){e.css("opacity",0)},this.showContentArea=function(e){e&&e.length&&e.animate({opacity:1},500,(function(){e.css("opacity","")}))},this.convertDateToMos=function(e){var t=(new Date).getTimezoneOffset()/60;return-3!==t&&(e=new Date(e.getTime()+3600*t*1e3+108e5)),e},this.compileDate=function(e,t){return t?o("date")(e,"yyyy-MM-dd")+" 00:00:00":o("date")(e,"yyyy-MM-dd")+" 23:59:59"},this.testDateString=function(e){var t={date:e,status:0};if(""!==e){var i=/([0-3]\d).([01]\d).([12][09]\d{2})/.exec(e);if(i&&i.length&&i[0]){var a=new Date(1*i[3],1*i[2]-1,i[1]);if(a){var n=a.getDate();n=n<10?"0"+n:""+n;var r=a.getMonth()+1;r=r<10?"0"+r:""+r;var o=a.getFullYear(),s=n+"."+r+"."+o;i[0]===s&&o>1989&&o<2091&&(t={date:i[0],status:i[0]===e?1:2})}}}return t},this.isIE=function(){return!!document.documentMode},this.getScreenWidth=function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},this.disableScroll=function(){var e=document.getElementsByTagName("html")[0],t=e.scrollTop;e.style.overflowY="scroll",e.style.width="100%",e.style.top="-".concat(t,"px"),e.style.position="fixed"},this.enableScroll=function(){var e=document.getElementsByTagName("html")[0],t=parseInt(e.style.top.split("px")[0],10);e.style.overflowY="",e.style.width="",e.style.top="",e.style.position="",e.scrollTop=-t},this.getVisibilityApiKeys=function(){var e,t;return void 0!==document.hidden?(e="hidden",t="visibilitychange"):void 0!==document.msHidden?(e="msHidden",t="msvisibilitychange"):void 0!==document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),{hidden:e,visibilityChange:t}},this.debounce=function(e,i){var a=!1;return function(){if(!a)return e.apply(this,arguments),a=!0,t((function(){return a=!1}),i)}},this.isInViewport=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=e.getBoundingClientRect(),a=i.height;return i.top+a*t>=0&&i.left>=0&&i.bottom-a*t<=(window.innerHeight||document.documentElement.clientHeight)&&i.right<=(window.innerWidth||document.documentElement.clientWidth)}}]).name,n.module("mosapp").service("loaderIndicator",[function(){var e=function(){var e=56;return Modernizr&&Modernizr.mq("(max-width: 1365px)")&&(e=48),e},t='<div class="dots-loader-backdrop"></div><div class="dots-loader"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>';function i(i,a){i.css({position:"relative",height:e()+"px",overflow:"hidden"}),"plainDots"===a.loaderType?(a.animate&&i.css({height:e()+"px",overflow:"hidden"}),i.prepend(t)):i.prepend(t)}function a(e){e.css({position:"",height:"",overflow:""}),e.find(".dots-loader-backdrop,.dots-loader").remove()}function r(t,i){"plainDots"===i.loaderType&&i.animate?function(t){t.css({height:""}),t.animate({height:e()+"px"},.7,(function(){a(t)}))}(t):a(t)}function o(e){return e instanceof n.element||("object"===("undefined"==typeof HTMLElement?"undefined":l(HTMLElement))||"function"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"===l(e)&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName)}this.switchOn=function(e){var t;e&&(o(e)?(t=n.element(e)).length&&i(t,e):e.hasOwnProperty("elems")&&(e.elems.hasOwnProperty("length")?e.elems.length&&n.forEach(e.elems,(function(t,a){i(n.element(t),e),e.elems.length===a&&"function"==typeof e.onSwitchOn&&e.onSwitchOn()})):(i(t=n.element(e.elems),e),"function"==typeof e.onSwitchOn&&e.onSwitchOn())))},this.switchOff=function(e){var t;e&&(o(e)?(t=n.element(e)).length&&r(t,e):e.hasOwnProperty("elems")&&(e.elems.hasOwnProperty("length")?e.elems.length&&n.forEach(e.elems,(function(t,i){r(n.element(t),e),e.elems.length===i&&"function"==typeof e.onSwitchOn&&e.onSwitchOn()})):(r(t=n.element(e.elems),e),"function"==typeof e.onSwitchOff&&e.onSwitchOff()),"function"==typeof e.onSwitchOff&&e.onSwitchOff()))}}]),n.module("mosapp").value("apiQueue",[]).value("lastReq",!1).run(["$http",function(e){e.defaults.headers.common["x-caller-id"]="mosru.news-app-frontend"}]).service("apiSrvc",["UrlSrvc","$http","$q","transformRequestAsFormPost","apiQueue","$timeout","loaderIndicator","lastReq","LangSrvc","$log",function(e,t,i,a,r,o,s,l,c,d){var m=this;function u(){l&&(l=!1,o((function(){"function"==typeof window.callPhantom&&window.callPhantom({queue:"isempty"})}),100))}function p(e,t,i,a){return d.error("Object '"+e+"' not found! Check config, please."),s.switchOff(a),"function"==typeof i?i({error:"Object '"+e+"' not found! Check config, please."}):t({error:"Object '"+e+"' not found! Check config, please."}),!1}function f(e,t){var i=[];n.forEach(t,(function(t,a){e.indexOf("%"+a+"%")>-1&&(e=e.replace("%"+a+"%",t),i.indexOf(a)<0&&i.push(a))}));for(var a=0;a<i.length;a++)delete t[i[a]];return e.indexOf("[lang]")>-1&&(e=e.replace("[lang]",c.getCurrentLang())),e}this.sendRequestFromQueue=function e(){var i=Math.floor(50*Math.random()+25);if(r.length>0){var c={};n.forEach(r[0],(function(e,t){c[t]=r[0][t]})),"POST"===c.method?function(e){var i=e.header,n=e.notTransform,r={url:e.url,method:"POST",data:e.params,headers:i,withCredentials:!0};n||(r.transformRequest=a),t(r).then((function(t){if(e.showError&&t.error){var i={title:"Ошибка получения данных из API.",content:t.description,placement:"top",type:"warning",show:!0};t.errorMessage=i}s.switchOff(e.loaderEl),u(),e.resolve(t)}),(function(t,i){s.switchOff(e.loaderEl),u();var a={content:t,code:i};e.reject(a)}))}(c):function(e){t({url:e.url,method:"GET",params:e.params}).then((function(t,i){if(e.showError&&t.error){var a={title:"Ошибка получения данных из API.",content:t.description,placement:"top",type:"warning",show:!0};t.errorMessage=a}e.loaderEl&&!e.loaderEl.dontSwitchOff&&s.switchOff(e.loaderEl),u(),e.resolve(t,i)}),(function(t,i){s.switchOff(e.loaderEl),u();var a={content:t,code:i};e.reject(a)}))}(c),r.shift(),0===r.length&&(l=!0)}o(e,i)},this.sendRequestFromQueue(),this.getData=function(t,a,o,l,c){return i((function(i,d){s.switchOn(c);var m=n.copy(o),u=e.apiPath(t);if(!n.isObject(u))return p(t,i,d,c);if(!(u=u[a]))return p(t+"."+a,i,d,c);n.isObject(m),u=f(u,m);var g={method:"GET",url:encodeURI(u),resolve:i,reject:d,params:m,showError:l,loaderEl:c};r.push(g)}))},this.getDataByUrl=function(e,t,a,o){return i((function(i,l){s.switchOn(o);var c=n.copy(t);if(!e)return p(e,i,l,o);n.isObject(c);var d={method:"GET",url:e=f(e,c),resolve:i,reject:l,params:c,showError:a,loaderEl:o};r.push(d)}))},this.getDataCancelable=function(t,a,o,l,c){var d,m=i((function(i,m){s.switchOn(c);var u=n.copy(o),g=e.apiPath(t);return n.isObject(g)?(g=g[a])?(n.isObject(u),g=f(g,u),d={method:"GET",url:g,resolve:i,reject:m,params:u,showError:l,loaderEl:c},void r.push(d)):p(t+"."+a,i,m,c):p(t,i,m,c)}));return m.cancel=function(){d.resolve({state:"cancelled"})},m},this.getAllPages=function(e,t,a){var n=i.defer(),r=[];return function i(o){o&&(a.page=o),m.getData(e,t,a).then((function(e){r=r.concat(e.data.items),e.data._meta&&e.data._meta.currentPage<e.data._meta.pageCount?i(e.data._meta.currentPage+1):(a&&delete a.page,n.resolve(r))}),(function(){n.reject()}))}(),n.promise},this.postDataByUrl=function(e,t,a,o,l,c){return i((function(i,d){s.switchOn(o);var m=n.copy(t);if(!e)return p(e,i,d,o);var u={method:"POST",url:e=f(e,m),resolve:i,reject:d,params:m,showError:a,loaderEl:o,header:l,notTransform:c};r.push(u)}))},this.postData=function(t,a,o,l,c,d,m){return i((function(i,u){s.switchOn(c);var g=n.copy(o),h=e.apiPath(t);if(!n.isObject(h))return p(t,i,u,c);if(!(h=h[a]))return p(t+"."+a,i,u,c);var v={method:"POST",url:h=f(h,g),resolve:i,reject:u,params:g,showError:l,loaderEl:c,header:d,notTransform:m};r.push(v)}))}}]).factory("transformRequestAsFormPost",(function(){return function(e,t){return t()["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8",function(e){if(!n.isObject(e))return null===e?"":e.toString();var t=[];for(var i in e)if(e.hasOwnProperty(i)){var a=e[i];t.push(encodeURIComponent(i)+"="+encodeURIComponent(null===a?"":a))}return t.join("&").replace(/%20/g,"+")}(e)}})).service("apiCache",["$q","apiSrvc",function(e,t){var i={};this.getData=function(a,n,r,o,s){var l=a+n+JSON.stringify(r);return i[l]?e.when(i[l]):t.getData(a,n,r,o,s).then((function(e){return i[l]=e,e}))}}]);var c=n.module("mosapp").config(["mosconfig","$translateProvider","LangSrvcProvider",function(e,t,i){t.usePostCompiling(!0),t.useSanitizeValueStrategy("escape"),t.useLoader("$translatePartialLoader",{urlTemplate:e.i18nPath+"{part}/{lang}.json?mosRuVersionControlFlag"}),t.preferredLanguage(i.setCurrentLang())}]).name,d=Modernizr,m=n.module("mosapp.horizontalCardsScroll",[]).directive("horizontalCardsScroll",["$timeout",function(e){return{restrict:"A",scope:{horizontalCardsScroll:"@"},link:function(t,i){i.on("$destroy",(function(){a(window).off("resize."+n),t.$destroy()}));var n="inst"+(new Date).getTime();t.createScroll=function(){i.hasClass("mCustomScrollbar")?i.mCustomScrollbar("update"):(i.mCustomScrollbar({axis:"x",scrollInertia:600,autoHideScrollbar:!0,scrollButtons:{enable:!1},advanced:{updateOnContentResize:!0,autoUpdateTimeout:100,autoExpandHorizontalScroll:!0},documentTouchScroll:!0,keyboard:{enable:!1}}),i.addClass("horizontalCardsScroll"))},t.killScroll=function(){i.hasClass("mCustomScrollbar")&&(i.mCustomScrollbar("destroy"),i.removeClass("horizontalCardsScroll"))},t.test1023=function(){return t.widthLT1024=d&&d.mq("(max-width: 1023px)"),t.widthLT1024},t.chooseScreen=function(){e.cancel(t.bounceTimer),t.bounceTimer=e((function(){t.test1023(),t.widthLT1024?t.createScroll():t.killScroll()}),100)},t.watchDocWidth=function(){t.chooseScreen(),a(window).off("resize."+n).on("resize."+n,t.chooseScreen)},t.filloutVariables=function(){t.listItems=i.find(t.horizontalCardsScroll)},t.init=function(){t.filloutVariables(),t.watchDocWidth()},t.init()}}}]).name,u=(i.p,i.p,n.module("mosapp.scrollToElement",[]).directive("scrollToElement",[function(){return{restrict:"A",scope:{href:"@",scrollTo:"@"},link:function(e,t){t.on("$destroy",(function(){e.$destroy()})),t.on("click",(function(t){var i=n.isString(e.href)&&0===e.href.indexOf("#")?a(e.href):a(e.scrollTo);if(i.length){t.preventDefault();var r=a("#mos-header").outerHeight(!0)||0;a("html,body").animate({scrollTop:i.offset().top-r-15},"slow")}}))}}}]).name),p=n.module("mosapp.lazyLoad",[]),f=p.name;p.directive("lazyLoad",[function(){return{restrict:"E",transclude:!0,scope:{},template:'<ng-transclude ng-if="isVisible === true"></ng-transclude>',compile:function(e){var t=!!window.IntersectionObserver;return t||e[0].children[0].removeAttribute("ng-if"),{post:function(e,i){if(t){e.$watch((function(){return i[0].childNodes.length}),(function(e,t){e!==t&&n()}));var a=new IntersectionObserver((function(t){t.forEach((function(t){t.isIntersecting&&(a.unobserve(t.target),e.isVisible=!0)}))}),{root:null,rootMargin:"0px",threshold:0});a.observe(i[0])}else n();function n(){var e=i[0].querySelectorAll("[data-src], [data-srcset]"),t=i[0].querySelectorAll("[data-mos-teaser]");Array.prototype.forEach.call(e,(function(e){var t=e.getAttribute("data-src"),i=e.getAttribute("data-srcset");["img","source"].indexOf(e.tagName.toLowerCase())>-1&&(t&&(e.src=t),i&&(e.srcset=i))})),Array.prototype.forEach.call(t,(function(e){var t=window.mosTizer&&window.mosTizer.getBanner&&window.mosTizer.getBanner(e);!window.mosTizer||t&&t.isInitalized||window.mosTizer.renderBanner(e)}))}}}}}}]),i.p;var g=i(1954),h=i(1695),v=i(1951),y=i(6285),w=i(3816),b=i(3876),_=i(545),k=i(4587),x=i(7885),C=i(7937),A=i(2881),S=i(9787),$=i(2778),M=i(7771),D=i(3714),O=i(7073);function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function T(e){return e<=0?"".concat(e,"&deg;"):e>0?"+".concat(e,"&deg;"):void 0}var E=n.module("weather",[]).directive("weather",[function(){return{restrict:"EA",scope:{},controller:"WeatherController",controllerAs:"ctrl",template:'<div class="weather" ng-if="!isError" role="region" tabindex="0" aria-labelledby="weather-title weather-temperature weather-comfort-temperature weather-description"><div class="weather__title" id="weather-title">{{ \'weather.title\' | translate }}</div><div class="weather__row"><div class="weather__temperature" id="weather-temperature"><span class="sr-only">{{ \'weather.currentTemp\' | translate }}</span><span ng-bind-html="data.temperature | unsafe"></span></div><div class="weather__comfort-temperature" id="weather-comfort-temperature"><span class="weather__comfort-temperature-text">{{ \'weather.comfort_text\' | translate }}</span><span class="weather__comfort-temperature-temperature" ng-bind-html="data.comfort_temperature | unsafe"></span></div><div class="weather__icon" aria-hidden="true"><div class="weather__icon-layour" ng-bind-html="svgLayor1"></div><div class="weather__icon-layour" ng-bind-html="svgLayor2"></div><div class="weather__icon-layour" ng-bind-html="svgLayor3"></div></div></div><div class="weather__row weather__description" id="weather-description">{{ data.description }}</div></div>',link:function(){}}}]).filter("unsafe",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]).controller("WeatherController",["$scope","$element","LangSrvc","apiSrvc","$sce",function(e,t,i,a,n){var r=i.getCurrentLang();e.data={},e.svgLayor1=e.svgLayor2=e.svgLayor3="";var o,s,l="";e.isError=!0,a.getData("search","weather").then((function(t){if(t&&t.data&&t.data.results&&t.data.results[0]&&t.data.results[0].now&&(e.data=t.data.results[0].now,e.data.comfort_temperature=T(e.data.comfort_temperature),e.data.temperature=T(e.data.temperature),e.data&&e.data.temperature&&e.data.comfort_text&&e.data.comfort_temperature&&e.data.description&&0!==e.data.icon.split("_").length)){var i=(E=e.data.icon.split("_"),F=4,function(e){if(Array.isArray(e))return e}(E)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var a,n,r=[],o=!0,s=!1;try{for(i=i.call(e);!(o=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);o=!0);}catch(e){s=!0,n=e}finally{try{o||null==i.return||i.return()}finally{if(s)throw n}}return r}}(E,F)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?P(e,t):void 0}}(E,F)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],c=i[1],d=void 0===c?"c0":c,m=i[2],u=void 0===m?"r0":m,p=i[3],f=void 0===p?"":p;"c0"===d&&"d"===a&&(o=v),"c0"===d&&"n"===a&&(o=w),"c2"===d&&(o=g),"c3"===d&&(o=h),"c1"===d&&"d"===a&&(o=y),"c1"===d&&"n"===a&&(o=b),e.svgLayor1=n.trustAsHtml(o),"r1"===u&&(s=_),"r2"===u&&(s=k),"r3"===u&&(s=x),"s1"===u&&(s=$),"s2"===u&&(s=M),"s3"===u&&(s=D),"rs1"===u&&(s=C),"rs2"===u&&(s=A),"rs3"===u&&(s=S),e.svgLayor2=n.trustAsHtml(s),"st"===f&&(l=O),e.svgLayor3=n.trustAsHtml(l),e.data.description="ru"===r?e.data.description:function(e){var t=e.split(",");String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},t=t.map((function(e){return e.trim().capitalize()}));var i={ru:{mainlyCloudy:"Пасмурно",shower:"Ливень",showers:"Ливневый дождь",smallRain:"Небольшой дождь",ice:"Гололед",snow:"Снег",clear:"Ясно",littleDrizzle:"Небольшая морось",partlyCloudy:"Малооблачно",heavyRain:"Сильный дождь",precipitation:"Осадки",cloudy:"Облачно",haze:"Дымка",heavyRainfall:"Ливневые осадки",storm:"Гроза",freezingRain:"Ледяной дождь",rain:"Дождь",snowGroats:"Снежная крупа",lightSnow:"Небольшой снег",heavySnow:"Сильный снег",iceNeedles:"Ледяные иглы",lightRainfall:"Небольшие осадки",heavySnow1:"Ливневый снег",lightPrecipitation:"Небольшой осадки",snowCrystals:"Снежные кристаллы",heavyRain1:"Сильный ливень",driftwood:"Поземок",blizzard:"Метель",snowGrains:"Снежные зёрна",snowfall:"Снегопад",freezingRain1:"Замерзающий дождь",drizzle:"Морось",littleFreezingRain:"Небольшой замерзающий дождь",dustStorm:"Пыльная буря",fog:"Туман",snowGrains1:"Снежные зерна",heavyPrecipitation:"Сильный осадки"},en:{mainlyCloudy:"Cloudy",shower:"Showers",showers:"Showers",smallRain:"Few showers",ice:"Glaze”",snow:"Snow",clear:"Sunny",littleDrizzle:"Light drizzle",partlyCloudy:"Mostly sunny",heavyRain:"Heavy rain",precipitation:"Precipitation",cloudy:"Cloudy",haze:"Mist",heavyRainfall:"Showers",storm:"Thunderstorm",freezingRain:"Ice pellets",rain:"Rain",snowGroats:"Snow pellets",lightSnow:"Light snow",heavySnow:"Heavy snow",iceNeedles:"Ice needles",lightRainfall:"Light precipitation",heavySnow1:"Heavy snow",lightPrecipitation:"Light precipitation",snowCrystals:"Snow crystals",heavyRain1:"Showers",driftwood:"Drift snow",blizzard:"Blizzard",snowGrains:"Snow pellets",snowfall:"Snowfall",freezingRain1:"Sleet",drizzle:"Drizzle",littleFreezingRain:"Light sleet",dustStorm:"Dust storm",fog:"Fog",snowGrains1:"Snow pellets",heavyPrecipitation:"Heavy precipitation"}};return t.map((function(e){return i.en[(t=i.ru,a=e,Object.keys(t).find((function(e){return t[e]===a})))];var t,a})).join(", ").toLowerCase().capitalize()}(e.data.description),e.isError=!1}var E,F})).catch((function(){}))}]).name,F=n.module("digest",[E]).directive("newsPrimeDigest",[function(){return{restrict:"EA",scope:{},controller:"NewsPrimeDigest",controllerAs:"ctrl",link:function(){}}}]).controller("NewsPrimeDigest",["$scope","$element",function(e,t){setTimeout((function(){t.mCustomScrollbar({axis:"x"})}),100)}]).name,I=(i.p,i.p,i.p,i.p,i(6228),1024),L=n.module("newsMain.mediaSlider",["angular-click-outside"]).directive("mediaSlider",["$timeout",function(e){return{restrict:"A",scope:{slideItemClass:"=?",api:"=?",prevButtonClick:"&",nextButtonClick:"&",lang:"=?",labelText:"=?"},link:function(t,i){i.on("$destroy",(function(){t.$destroy()})),t.api=t.api||{},t.api.reinit=function(){window.innerWidth>=I&&(i.hasClass("slick-initialized")&&t.mainSlider.slick("unslick"),e((function(){n()})))},t.mainSlider=i,t.mainSlider.hide();var a=function(e){return{prevArrowText:"ru"===e?"Предыдущий":"Previous",nextArrowText:"ru"===e?"Следующий":"Next"}};function n(){t.mainSlider.slick({slidesToShow:3,slidesToScroll:1,infinite:!1,speed:700,cssEase:"ease",arrows:!0,slide:".".concat(t.slideItemClass),waitForAnimate:!0,rows:-1,regionLabel:"".concat("ru"===t.lang?"Карусель":"Carousel"," ").concat(t.labelText),prevArrow:'<button type="button" class="slick-prev">'.concat(a(t.lang).prevArrowText,"</button>"),nextArrow:'<button type="button" class="slick-next">'.concat(a(t.lang).nextArrowText,"</button>")})}function r(e,t){e.$prevArrow&&e.$nextArrow&&(e.$prevArrow.removeAttr("disabled"),e.$nextArrow.removeAttr("disabled"),0===t?e.$prevArrow.attr("disabled","disabled"):(t>=e.slideCount-e.options.slidesToShow&&!1===e.options.centerMode||t>=e.slideCount-1&&!0===e.options.centerMode)&&e.$nextArrow.attr("disabled","disabled"))}e((function(){t.mainSlider.on("init",(function(e,i){t.mainSlider.css("visibility",""),r(i,i.currentSlide),i.$prevArrow&&i.$nextArrow&&(i.$slides.map((function(e,i){return i.setAttribute("aria-label","".concat("ru"==t.lang?"Слайд":"Slide"," ").concat(e+1))})),i.$prevArrow.on("click",(function(){return t.prevButtonClick()})),i.$nextArrow.on("click",(function(){return t.nextButtonClick()})))})),t.mainSlider.on("beforeChange",(function(e,t,i,a){r(t,a)})),t.mainSlider.show(0,(function(){window.innerWidth>=I?n():t.mainSlider.css("visibility","")})),t.$watch((function(){return window.innerWidth}),(function(i,a){i!==a&&(e.cancel(t.t),t.t=e((function(){i>=I?n():t.mainSlider&&t.mainSlider.slick("unslick")}),100))}))}),0)}}}]).name,j=(i.p,i.p,angular.module("newsMain.news.list",[]).directive("newsList",[function(){return{restrict:"EA",scope:{pages:"="},template:'<div class="news-list"><div class="news-row news-list__page page-{{$index + 1}}" data-ng-repeat="page in pages"><div class="news-list__material news-col-sm-2 news-col-xl-3 item-{{$index + 1}}" data-ng-repeat="material in page.items"><common-card data-item="material"></common-card></div></div></div>',link:function(){}}}]).name),z=(i.p,i.p,i(3803)),B=angular.module("mosapp.fields.period.position",[]).factory("mosPosition",["$document","$window",function(e,t){var i,a,n={normal:/(auto|scroll)/,hidden:/(auto|scroll|hidden)/},r={auto:/\s?auto?\s?/i,primary:/^(top|bottom|left|right)$/,secondary:/^(top|bottom|left|right|center)$/,vertical:/^(top|bottom)$/},o=/(HTML|BODY)/;return{getRawNode:function(e){return e.nodeName?e:e[0]||e},parseStyle:function(e){return e=parseFloat(e),isFinite(e)?e:0},offsetParent:function(i){for(var a,n=(i=this.getRawNode(i)).offsetParent||e[0].documentElement;n&&n!==e[0].documentElement&&(a=n,"static"===(t.getComputedStyle(a).position||"static"));)n=n.offsetParent;return n||e[0].documentElement},scrollbarWidth:function(n){if(n){if(angular.isUndefined(a)){var r=e.find("body");r.addClass("mos-position-body-scrollbar-measure"),a=t.innerWidth-r[0].clientWidth,a=isFinite(a)?a:0,r.removeClass("mos-position-body-scrollbar-measure")}return a}if(angular.isUndefined(i)){var o=angular.element('<div class="mos-position-scrollbar-measure"></div>');e.find("body").append(o),i=o[0].offsetWidth-o[0].clientWidth,i=isFinite(i)?i:0,o.remove()}return i},scrollbarPadding:function(e){e=this.getRawNode(e);var i=t.getComputedStyle(e),a=this.parseStyle(i.paddingRight),n=this.parseStyle(i.paddingBottom),r=this.scrollParent(e,!1,!0),s=this.scrollbarWidth(o.test(r.tagName));return{scrollbarWidth:s,widthOverflow:r.scrollWidth>r.clientWidth,right:a+s,originalRight:a,heightOverflow:r.scrollHeight>r.clientHeight,bottom:n+s,originalBottom:n}},isScrollable:function(e,i){e=this.getRawNode(e);var a=i?n.hidden:n.normal,r=t.getComputedStyle(e);return a.test(r.overflow+r.overflowY+r.overflowX)},scrollParent:function(i,a,r){i=this.getRawNode(i);var o=a?n.hidden:n.normal,s=e[0].documentElement,l=t.getComputedStyle(i);if(r&&o.test(l.overflow+l.overflowY+l.overflowX))return i;var c="absolute"===l.position,d=i.parentElement||s;if(d===s||"fixed"===l.position)return s;for(;d.parentElement&&d!==s;){var m=t.getComputedStyle(d);if(c&&"static"!==m.position&&(c=!1),!c&&o.test(m.overflow+m.overflowY+m.overflowX))break;d=d.parentElement}return d},position:function(i,a){i=this.getRawNode(i);var n=this.offset(i);if(a){var r=t.getComputedStyle(i);n.top-=this.parseStyle(r.marginTop),n.left-=this.parseStyle(r.marginLeft)}var o=this.offsetParent(i),s={top:0,left:0};return o!==e[0].documentElement&&((s=this.offset(o)).top+=o.clientTop-o.scrollTop,s.left+=o.clientLeft-o.scrollLeft),{width:Math.round(angular.isNumber(n.width)?n.width:i.offsetWidth),height:Math.round(angular.isNumber(n.height)?n.height:i.offsetHeight),top:Math.round(n.top-s.top),left:Math.round(n.left-s.left)}},offset:function(i){var a=(i=this.getRawNode(i)).getBoundingClientRect();return{width:Math.round(angular.isNumber(a.width)?a.width:i.offsetWidth),height:Math.round(angular.isNumber(a.height)?a.height:i.offsetHeight),top:Math.round(a.top+(t.pageYOffset||e[0].documentElement.scrollTop)),left:Math.round(a.left+(t.pageXOffset||e[0].documentElement.scrollLeft))}},viewportOffset:function(i,a,n){n=!1!==n;var r=(i=this.getRawNode(i)).getBoundingClientRect(),o={top:0,left:0,bottom:0,right:0},s=e[0].documentElement,l=s.getBoundingClientRect();if(o.top=l.top+s.clientTop,o.left=l.left+s.clientLeft,s===e[0].documentElement&&(o.top+=t.pageYOffset,o.left+=t.pageXOffset),o.bottom=o.top+s.clientHeight,o.right=o.left+s.clientWidth,n){var c=t.getComputedStyle(s);o.top+=this.parseStyle(c.paddingTop),o.bottom-=this.parseStyle(c.paddingBottom),o.left+=this.parseStyle(c.paddingLeft),o.right-=this.parseStyle(c.paddingRight)}return{top:Math.round(r.top-o.top),bottom:Math.round(o.bottom-r.bottom),left:Math.round(r.left-o.left),right:Math.round(o.right-r.right)}},parsePlacement:function(e){var t=r.auto.test(e);return t&&(e=e.replace(r.auto,"")),(e=e.split("-"))[0]=e[0]||"top",r.primary.test(e[0])||(e[0]="top"),e[1]=e[1]||"center",r.secondary.test(e[1])||(e[1]="center"),e[2]=!!t,e},positionElements:function(e,i,a,n){e=this.getRawNode(e),i=this.getRawNode(i);var o=angular.isDefined(i.offsetWidth)?i.offsetWidth:i.prop("offsetWidth"),s=angular.isDefined(i.offsetHeight)?i.offsetHeight:i.prop("offsetHeight");a=this.parsePlacement(a);var l=n?this.offset(e):this.position(e),c={top:0,left:0,placement:"",hostElem:l};if(a[2]){var d=this.viewportOffset(e,n),m=t.getComputedStyle(i),u={width:o+Math.round(Math.abs(this.parseStyle(m.marginLeft)+this.parseStyle(m.marginRight))),height:s+Math.round(Math.abs(this.parseStyle(m.marginTop)+this.parseStyle(m.marginBottom)))};if(a[0]="top"===a[0]&&u.height>d.top&&u.height<=d.bottom?"bottom":"bottom"===a[0]&&u.height>d.bottom&&u.height<=d.top?"top":"left"===a[0]&&u.width>d.left&&u.width<=d.right?"right":"right"===a[0]&&u.width>d.right&&u.width<=d.left?"left":a[0],a[1]="top"===a[1]&&u.height-l.height>d.bottom&&u.height-l.height<=d.top?"bottom":"bottom"===a[1]&&u.height-l.height>d.top&&u.height-l.height<=d.bottom?"top":"left"===a[1]&&u.width-l.width>d.right&&u.width-l.width<=d.left?"right":"right"===a[1]&&u.width-l.width>d.left&&u.width-l.width<=d.right?"left":a[1],"center"===a[1])if(r.vertical.test(a[0])){var p=l.width/2-o/2;d.left+p<0&&u.width-l.width<=d.right?a[1]="left":d.right+p<0&&u.width-l.width<=d.left&&(a[1]="right")}else{var f=l.height/2-u.height/2;d.top+f<0&&u.height-l.height<=d.bottom?a[1]="top":d.bottom+f<0&&u.height-l.height<=d.top&&(a[1]="bottom")}}switch(a[0]){case"top":c.top=l.top-s;break;case"bottom":c.top=l.top+l.height;break;case"left":c.left=l.left-o;break;case"right":c.left=l.left+l.width}switch(a[1]){case"top":c.top=l.top;break;case"bottom":c.top=l.top+l.height-s;break;case"left":c.left=l.left;break;case"right":c.left=l.left+l.width-o;break;case"center":if(r.vertical.test(a[0]))c.left=l.left+l.width/2-o/2;else{if(!n&&this.offsetParent(e).getBoundingClientRect().height<u.height){c.top=0;break}c.top=l.top+l.height/2-s/2}}return c.top=Math.round(c.top),c.left=Math.round(c.left),c.placement="center"===a[1]?a[0]:a[0]+"-"+a[1],c},adjustTop:function(e,t,i,a){if(-1!==e.indexOf("top")&&i!==a)return{top:t.top-a+"px"}},positionArrow:function(e,i){var a=(e=this.getRawNode(e)).querySelector(".tooltip-inner, .popover-inner");if(a){var n=angular.element(a).hasClass("tooltip-inner"),o=n?e.querySelector(".tooltip-arrow"):e.querySelector(".arrow");if(o){var s={top:"",bottom:"",left:"",right:""};if("center"!==(i=this.parsePlacement(i))[1]){var l="border-"+i[0]+"-width",c=t.getComputedStyle(o)[l],d="border-";r.vertical.test(i[0])?d+=i[0]+"-"+i[1]:d+=i[1]+"-"+i[0],d+="-radius";var m=t.getComputedStyle(n?a:e)[d];switch(i[0]){case"top":s.bottom=n?"0":"-"+c;break;case"bottom":s.top=n?"0":"-"+c;break;case"left":s.right=n?"0":"-"+c;break;case"right":s.left=n?"0":"-"+c}s[i[1]]=m,angular.element(o).css(s)}else angular.element(o).css(s)}}}}}]).name,R=angular.module("mosapp.fields.period.datepickerPopup",[z,B]).value("$datepickerPopupLiteralWarning",!0).constant("mosDatepickerPopupConfig",{altInputFormats:[],appendToBody:!0,clearText:"Clear",closeOnDateSelection:!0,closeText:"Done",currentText:"Today",datepickerPopup:"yyyy-MM-d",datepickerPopupTemplateUrl:"common/template/datepickerPopup.html",datepickerTemplateUrl:"common/template/datepicker.html",html5Types:{date:"yyyy-MM-d","datetime-local":"yyyy-MM-ddTHH:mm:ss.sss",month:"yyyy-MM"},onOpenFocus:!0,showButtonBar:!0,placement:"auto bottom-left"}).run(["$templateCache",function(e){e.put("common/template/datepickerPopup.html",'<ul class="mos-datepicker-popup dropdown-menu mos-position-measure" mos-datepicker-classes="mos-datepicker-classes" role="presentation" dropdown-nested="dropdown-nested" ng-if="isOpen" ng-keydown="keydown($event)" ng-click="$event.stopPropagation()" tabindex="-1"><div class="arrow"></div><div class="mos-datepicker-popup__close" ng-click="close($event)" ng-class="{\'mos-datepicker-popup__close_top\': !presets || presets.length === 0}"></div><div class="mos-datepicker-popup__label" ng-class="{\'mos-datepicker-popup__label--no-presets\': !presets}"><button ng-if="presets &amp;&amp; presets.length &gt; 0" ng-repeat="preset in presets" ng-click="setPresetDate(preset.code)" tabindex="-1">{{ preset.title }}</button></div><li ng-transclude="ng-transclude"></li></ul>'),e.put("common/template/datepicker.html",'<div ng-switch="datepickerMode"><div class="uib-daypicker" uib-daypicker="uib-daypicker" ng-switch-when="day" tabindex="-1" template-url="common/template/daypicker.html"></div><div class="uib-monthpicker" uib-monthpicker="uib-monthpicker" ng-switch-when="month" tabindex="-1"></div><div class="uib-yearpicker" uib-yearpicker="uib-yearpicker" ng-switch-when="year" tabindex="-1"></div></div>'),e.put("common/template/daypicker.html",'<table class="daypicker-head" role="grid" aria-labelledby="{{::uniqueId}}-title" aria-activedescendant="{{activeDateId}}"><thead><tr><th><button class="btn btn-default btn-sm pull-left uib-left" type="button" ng-click="move(-1)" tabindex="-1"><svg class="DayPickerNavigation_svg__horizontal DayPickerNavigation_svg__horizontal_1" focusable="false" viewBox="0 0 1000 1000"><path d="M336 275L126 485h806c13 0 23 10 23 23s-10 23-23 23H126l210 210c11 11 11 21 0 32-5 5-10 7-16 7s-11-2-16-7L55 524c-11-11-11-21 0-32l249-249c21-22 53 10 32 32z"></path></svg></button></th><th colspan="{{::5 + showWeeks}}"><button class="btn btn-default btn-sm uib-title" id="{{::uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" ng-disabled="datepickerMode === maxMode" tabindex="-1"><strong>{{title}}</strong></button></th><th><button class="btn btn-default btn-sm pull-right uib-right" type="button" ng-click="move(1)" tabindex="-1"><svg class="DayPickerNavigation_svg__horizontal DayPickerNavigation_svg__horizontal_1" focusable="false" viewBox="0 0 1000 1000"><path d="M694 242l249 250c12 11 12 21 1 32L694 773c-5 5-10 7-16 7s-11-2-16-7c-11-11-11-21 0-32l210-210H68c-13 0-23-10-23-23s10-23 23-23h806L662 275c-21-22 11-54 32-33z"></path></svg></button></th></tr></thead></table><table class="daypicker-body" role="grid" aria-labelledby="{{::uniqueId}}-title" aria-activedescendant="{{activeDateId}}"><thead><tr><th class="text-center" ng-if="showWeeks"></th><th class="text-center" ng-repeat="label in ::labels track by $index"><small aria-label="{{::label.full}}">{{::label.abbr}}</small></th></tr></thead><tbody><tr class="uib-weeks" ng-repeat="row in rows track by $index" role="row"><td class="text-center h6" ng-if="showWeeks"><em>{{ weekNumbers[$index] }}</em></td><td class="uib-day text-center" ng-repeat="dt in row" role="gridcell" id="{{::dt.uid}}" ng-class="::dt.customClass" uib-is-class="\'active\' for selectedDt on dt"><button class="btn btn-default btn-sm" type="button" ng-click="select(dt.date)" ng-mouseover="hover(dt.date, $event)" ng-mouseleave="leave(dt.date, $event)" ng-disabled="::dt.disabled" tabindex="-1" ng-attr-data-timestamp="{{::dt.date.setHours(0, 0, 0, 0)}}"><span ng-class="::{\'text-muted\': dt.secondary}">{{::dt.label}}</span></button></td></tr></tbody></table>')}]).controller("MosDatepickerPopupController",["$scope","$element","$attrs","$compile","$log","$parse","$window","$document","$rootScope","mosPosition","dateFilter","uibDateParser","mosDatepickerPopupConfig","$timeout","uibDatepickerConfig","$datepickerPopupLiteralWarning",function(e,t,i,a,n,r,o,s,l,c,d,m,u,p,f,g){var h,v,y,w,b,_,k,x,C,A,S,$,M,D=!1,O=[];function P(t){var i=m.parse(t,h,e.date);if(isNaN(i))for(var a=0;a<M.length;a++)if(i=m.parse(t,M[a],e.date),!isNaN(i))return i;return i}function T(e){if(angular.isNumber(e)&&(e=new Date(e)),!e)return null;if(angular.isDate(e)&&!isNaN(e))return e;if(angular.isString(e)){var t=P(e);if(!isNaN(t))return m.toTimezone(t,S.getOption("timezone"))}return S.getOption("allowInvalid")?e:void 0}function E(e,t){var a=e||t;return!i.ngRequired&&!a||(angular.isNumber(a)&&(a=new Date(a)),!a||!(!angular.isDate(a)||isNaN(a))||!!angular.isString(a)&&!isNaN(P(a)))}function F(i){if(e.isOpen||!e.disabled){var a=$[0],n=t[0].contains(i.target),r=void 0!==a.contains&&a.contains(i.target);!e.isOpen||n||r||e.$apply((function(){e.isOpen=!1}))}}function I(i){27===i.which&&e.isOpen?(i.preventDefault(),i.stopPropagation(),e.$apply((function(){e.isOpen=!1})),t[0].focus()):40!==i.which||e.isOpen||(i.preventDefault(),i.stopPropagation(),e.$apply((function(){e.isOpen=!0})))}function L(){if(e.isOpen){var a=angular.element($[0].querySelector(".mos-datepicker-popup")),n=angular.element($[0].querySelector(".arrow")),r=i.popupPlacement?i.popupPlacement:u.placement,o=c.parsePlacement(r);a.addClass(o[0]);var s=c.positionElements(t,a,r,y),l=Math.round(s.hostElem.top+(s.hostElem.height-1)/2);a.css({top:s.top+"px",left:s.left+"px"}),n.css({top:l}),a.hasClass("mos-position-measure")&&a.removeClass("mos-position-measure")}}this.init=function(n){if(S=function(e){var t;return angular.version.minor<6?(t=angular.isObject(e.$options)?e.$options:{timezone:null}).getOption=function(e){return t[e]}:t=e.$options,t}(A=n),v=angular.isDefined(i.closeOnDateSelection)?e.$parent.$eval(i.closeOnDateSelection):u.closeOnDateSelection,y=angular.isDefined(i.datepickerAppendToBody)?e.$parent.$eval(i.datepickerAppendToBody):u.appendToBody,w=angular.isDefined(i.onOpenFocus)?e.$parent.$eval(i.onOpenFocus):u.onOpenFocus,b=angular.isDefined(i.datepickerPopupTemplateUrl)?i.datepickerPopupTemplateUrl:u.datepickerPopupTemplateUrl,_=angular.isDefined(i.datepickerTemplateUrl)?i.datepickerTemplateUrl:u.datepickerTemplateUrl,M=angular.isDefined(i.altInputFormats)?e.$parent.$eval(i.altInputFormats):u.altInputFormats,e.showButtonBar=angular.isDefined(i.showButtonBar)?e.$parent.$eval(i.showButtonBar):u.showButtonBar,u.html5Types[i.type]?(h=u.html5Types[i.type],D=!0):(h=i.mosDatepickerPopup||u.datepickerPopup,i.$observe("mosDatepickerPopup",(function(e){var t=e||u.datepickerPopup;if(t!==h&&(h=t,A.$modelValue=null,!h))throw new Error("mosDatepickerPopup must have a date format specified.")}))),!h)throw new Error("mosDatepickerPopup must have a date format specified.");if(D&&i.mosDatepickerPopup)throw new Error("HTML5 date input types do not support custom formats.");(k=angular.element("<div mos-datepicker-popup-wrap><div uib-datepicker></div></div>")).attr({"ng-model":"date","ng-change":"dateSelection(date)","template-url":b,"ng-mousedown":"handleMousedown($event)"}),(x=angular.element(k.children()[0])).attr("template-url",_),e.datepickerOptions||(e.datepickerOptions={}),D&&"month"===i.type&&(e.datepickerOptions.datepickerMode="month",e.datepickerOptions.minMode="month"),x.attr("datepicker-options","datepickerOptions"),D?A.$formatters.push((function(t){return e.date=m.fromTimezone(t,S.getOption("timezone")),t})):(A.$$parserName="date",A.$validators.date=E,A.$parsers.unshift(T),A.$formatters.push((function(t){return A.$isEmpty(t)?(e.date=t,t):(angular.isNumber(t)&&(t=new Date(t)),e.date=m.fromTimezone(t,S.getOption("timezone")),m.filter(e.date,h))}))),A.$viewChangeListeners.push((function(){e.date=P(A.$viewValue)})),t.on("keydown",I),$=a(k)(e),k.remove(),y?s.find("body").append($):t.after($),e.$on("$destroy",(function(){for(!0===e.isOpen&&(l.$$phase||e.$apply((function(){e.isOpen=!1}))),$.remove(),t.off("keydown",I),s.off("click",F),C&&C.off("scroll",L),angular.element(o).off("resize",L);O.length;)O.shift()()}))},e.$on("moveMonth",(function(t,i){e.$$childHead&&e.$$childHead.$$childHead.$$childHead.move(i.direction)})),e.getText=function(t){return e[t+"Text"]||u[t+"Text"]},e.isDisabled=function(t){"today"===t&&(t=m.fromTimezone(new Date,S.getOption("timezone")));var i={};return angular.forEach(["minDate","maxDate"],(function(t){e.datepickerOptions[t]?angular.isDate(e.datepickerOptions[t])?i[t]=new Date(e.datepickerOptions[t]):(g&&n.warn("Literal date support has been deprecated, please switch to date object usage"),i[t]=new Date(d(e.datepickerOptions[t],"medium"))):i[t]=null})),e.datepickerOptions&&i.minDate&&e.compare(t,i.minDate)<0||i.maxDate&&e.compare(t,i.maxDate)>0},e.compare=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate())-new Date(t.getFullYear(),t.getMonth(),t.getDate())},e.dateSelection=function(i){e.$emit("date-picker-select-date",i),e.date=i;var a=e.date?m.filter(e.date,h):null;t.val(a),A.$setViewValue(a),v&&(e.isOpen=!1)},e.keydown=function(i){27===i.which&&(i.stopPropagation(),e.isOpen=!1,t[0].focus())},e.select=function(t,i){if(i.stopPropagation(),"today"===t){var a=new Date;angular.isDate(e.date)?(t=new Date(e.date)).setFullYear(a.getFullYear(),a.getMonth(),a.getDate()):(t=m.fromTimezone(a,S.getOption("timezone"))).setHours(0,0,0,0)}e.dateSelection(t)},e.setPresetDate=function(t){e.$emit("set-preset-date",{code:t})},e.close=function(i){i.stopPropagation(),e.isOpen=!1,t[0].focus()},e.disabled=angular.isDefined(i.disabled)||!1,i.ngDisabled&&O.push(e.$parent.$watch(r(i.ngDisabled),(function(t){e.disabled=t}))),e.handleMousedown=function(e){e.preventDefault()},e.$watch("isOpen",(function(a){a?e.disabled?e.isOpen=!1:p((function(){L(),w&&e.$broadcast("uib:datepicker.focus"),s.on("click",F);var a=i.popupPlacement?i.popupPlacement:u.placement;y||c.parsePlacement(a)[2]?(C=C||angular.element(c.scrollParent(t)))&&C.on("scroll",L):C=null,angular.element(o).on("resize",L),e.$$childHead&&!e.$$childHead.$$childHead.$$childHead.hover&&(e.$$childHead.$$childHead.$$childHead.hover=function(t,i){e.$emit("date-picker-hover-date",{date:t,e:i})}),e.$$childHead&&!e.$$childHead.$$childHead.$$childHead.leave&&(e.$$childHead.$$childHead.$$childHead.leave=function(t,i){e.$emit("date-picker-leave-date",{date:t,e:i})})}),0,!1):(s.off("click",F),C&&C.off("scroll",L),angular.element(o).off("resize",L)),e.$emit("toggled-datepicker-popup",{opened:e.isOpen})})),e.$on("uib:datepicker.mode",(function(){p(L,0,!1)}))}]).directive("mosDatepickerPopup",(function(){return{require:["ngModel","mosDatepickerPopup"],controller:"MosDatepickerPopupController",scope:{datepickerOptions:"=?",isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",label:"@",presets:"=",getPresetCode:"&"},link:function(e,t,i,a){var n=a[0];a[1].init(n)}}})).directive("mosDatepickerPopupWrap",(function(){return{restrict:"A",transclude:!0,templateUrl:function(e,t){return t.templateUrl||"common/template/datepickerPopup.html"}}})).name,N=i(5636),H=angular.module("mosapp.fields.field",[]).directive("mosField",[function(){return{restrict:"A",require:"^?mosFieldWrap",link:function(e,t,i,a){a&&"input"===t[0].tagName.toLowerCase()&&(t.on("focus",(function(){a.setFocused(!0)})),t.on("blur",(function(){a.setFocused(!1)})))}}}]).name,q=angular.module("mosapp.fields.fieldWrap",[]).directive("mosFieldWrap",[function(){return{restrict:"EA",controller:["$scope","$element",function(e,t){this.setFocused=function(e){t.toggleClass("field-focused",e)},this.setHasValue=function(e){t.toggleClass("field-has-value",e)}}]}}]).name,V=i(75),W=i(7339),U=angular.module("mosapp.fields.period",[R,N,H,q]).config(["$provide",function(e){e.decorator("uibDatepickerDirective",["$delegate",function(e){var t=e[0],i=t.link;return t.compile=function(){return function(e,t,a,n){i.apply(this,arguments);var r=n[0],o=n[1];r.customClass=function(t){var i=o.$viewValue?new Date(o.$viewValue):null;return e.customClass({date:t,mode:e.datepickerMode},r.activeDate,i)}}},e}])}]).directive("mosPeriod",[function(){return{restrict:"EA",require:["mosPeriod","^ngModel"],scope:{label:"@",presets:"=",placement:"=",ngModel:"=ngModel",rangeMode:"=?",onePickerMode:"=?",placementTo:"=?",minDate:"=",maxDate:"=",filterType:"=",filterLang:"=?",disabledDates:"=",enabledDates:"=",appendToBody:"=?"},controller:"MosPeriodController",controllerAs:"ctrl",template:'<div class="mos-period" ng-click="ctrl.clicked($event)"><div class="mos-period__trigger" ng-class="{\'field-has-value\': ctrl.period}" ng-click="ctrl.$tooltip.toggle()"><label>{{ label }}</label><div class="mos-period__value" title="{{ctrl.period}}">{{ ctrl.period }}</div></div><div class="mos-period__fields"><div class="mos-period__input-wrap" mos-field-wrap="" ng-click="$event.stopPropagation()" ng-class="{\'field-has-value\': ctrl.model.from, \'mos-period__input-wrap_error\': ctrl.invalidInputs.from, \'mos-period__input-wrap_focused\': ctrl.opened.from}"><input type="text" name="from" spellcheck="false" autocomplete="off" ng-readonly="ctrl.isMobile" ng-model="ctrl.model.from" ng-change="ctrl.updateModel(\'from\')" ng-focus="ctrl.focused($event, \'from\')" ng-blur="ctrl.blured($event, \'from\')" ng-click="ctrl.inputClicked($event, \'from\')" placeholder="{{ \'fieldPeriod.dateFrom\' | translate }}" mos-field="" mos-datepicker-popup="{{ctrl.format}}" datepicker-options="ctrl.fromDpOpts" datepicker-append-to-body="ctrl.appendToBody" range-mode="ctrl.rangeMode" close-on-date-selection="!ctrl.rangeMode" popup-placement="{{ placement }}" on-open-focus="false" is-open="ctrl.opened.from" ui-options="ctrl.maskOptions" ui-mask="{{ctrl.dateMask}}" ui-mask-placeholder="{{ctrl.maskOptions.uiMaskPlaceholder}}" model-view-value="true" presets="ctrl.presets" get-preset-code="ctrl.setPresetDate(code)" aria-label="{{ \'fieldPeriod.labelFrom\' | translate }}"/></div><div class="mos-period__dash-block"><div class="dash"></div></div><div class="mos-period__input-wrap" mos-field-wrap="" ng-click="$event.stopPropagation()" ng-class="{\'field-has-value\': ctrl.model.to, \'mos-period__input-wrap_error\': ctrl.invalidInputs.to, \'mos-period__input-wrap_focused\': ctrl.opened.to}"><input type="text" name="to" spellcheck="false" autocomplete="off" ng-readonly="ctrl.isMobile" ng-model="ctrl.model.to" ng-change="ctrl.updateModel(\'to\')" ng-focus="ctrl.focused($event, \'to\')" ng-blur="ctrl.blured($event, \'to\')" ng-click="ctrl.inputClicked($event, \'to\')" placeholder="{{ \'fieldPeriod.dateTo\' | translate }}" mos-field="" mos-datepicker-popup="{{ctrl.format}}" datepicker-options="ctrl.toDpOpts" datepicker-append-to-body="ctrl.appendToBody" close-on-date-selection="true" popup-placement="{{ placementTo }}" on-open-focus="false" is-open="ctrl.opened.to" ui-options="ctrl.maskOptions" ui-mask="{{ctrl.dateMask}}" ui-mask-placeholder="{{ctrl.maskOptions.uiMaskPlaceholder}}" model-view-value="true" presets="ctrl.presets" get-preset-code="ctrl.setPresetDate(code)" aria-label="{{ \'fieldPeriod.labelTo\' | translate }}"/></div></div></div>',link:function(e,t,i,a){var n=a[0],r=a[1];n.init(r)}}}]).controller("MosPeriodController",["$scope","$filter","$tooltip","$element","$timeout","$translate","toolsSrvc",function(e,t,i,a,n,r,o){var s,l=this,c={en:{format:"MM.dd.yyyy",dateMask:"MM.DD.20Yy",uiMaskPlaceholder:"MM.DD.YYYY",maskDefinition:{D:/\d/,M:/\d/,Y:/[2-9]/,y:/\d/,2:/2/,0:/0/}},ru:{format:"dd.MM.yyyy",dateMask:"ДД.ММ.20Гг",uiMaskPlaceholder:"ДД.ММ.ГГГГ",maskDefinition:{"Д":/\d/,"М":/\d/,"Г":/[2-9]/,"г":/\d/,2:/2/,0:/0/}}};e.filterLang=angular.isUndefined(e.filterLang)?"ru":e.filterLang,l.format=c[e.filterLang].format,l.dateMask=c[e.filterLang].dateMask,l.maskDefinition=c[e.filterLang].maskDefinition;var d=["keyup","click","focus"];function m(e){var t=W(e.parentNode);l.$popup.animate({scrollTop:l.$popup[0].scrollTop+t.position().top},"fast")}function u(){angular.merge(l.fromDpOpts,{maxDate:l.model.to||e.maxDate}),angular.merge(l.toDpOpts,{minDate:l.model.from||e.minDate})}function p(){var t=a.find('input[name="from"]').val(),i=a.find('input[name="to"]').val();l.invalidInputs.from=!l.focus.from&&!l.focus.to&&(!!t&&t!==l.maskOptions.uiMaskPlaceholder&&!l.model.from&&!l.opened.from||l.model.from&&l.model.from<e.minDate||l.model.from&&l.model.to&&l.model.from>l.model.to),l.invalidInputs.to=!l.focus.to&&!l.focus.from&&(!!i&&i!==l.maskOptions.uiMaskPlaceholder&&!l.model.to&&!l.opened.to||l.model.to&&l.model.to<e.minDate||e.maxDate&&l.model.to&&l.model.to>e.maxDate||l.model.from&&l.model.to&&l.model.from>l.model.to)}o.isIE()||d.push("input"),l.maskOptions={maskDefinitions:l.maskDefinition,addDefaultPlaceholder:!1,clearOnBlurPlaceholder:!0,uiMaskPlaceholder:c[e.filterLang].uiMaskPlaceholder,eventsToHandle:d},l.model={mode:"all",from:null,to:null},l.isMobile=V.Z.mobile(),l.focus={},l.invalidInputs={from:!1,to:!1},l.rangeMode=e.rangeMode,l.onePickerMode=e.onePickerMode,l.appendToBody=e.appendToBody,l.rangeMode&&(l.dateRange={from:null,to:null,latest:null}),e.disabledDates&&(l.disabledDateTimes=e.disabledDates.map((function(e){var t=new Date(e);return t.setHours(0,0,0,0),t.getTime()}))),e.enabledDates&&(l.enabledDateTimes=e.enabledDates.map((function(e){var t=new Date(e);return t.setHours(0,0,0,0),t.getTime()}))),l.datepickerOptions={customClass:function(e,t,i){var a=new Date(e.date).setHours(0,0,0,0),n=l.model.from?l.model.from.setHours(0,0,0,0):null,r=l.model.to?l.model.to.setHours(0,0,0,0):null,o=new Date;if(o.setHours(0,0,0,0),"month"===e.mode&&i&&e.date.getMonth()===i.getMonth()&&e.date.getFullYear()===i.getFullYear())return"active";if("year"===e.mode&&i&&e.date.getFullYear()===i.getFullYear())return"active";if("day"===e.mode&&a===o.getTime()&&(o.getMonth(),t.getMonth()),"month"===e.mode&&e.date.getMonth()===o.getMonth()&&e.date.getFullYear()===o.getFullYear())return"today";if("year"===e.mode&&e.date.getFullYear()===o.getFullYear())return"today";if("day"===e.mode&&t&&e.date.getMonth()!==t.getMonth())return"inactive";if("day"===e.mode&&(l.rangeMode||i)){if(l.model.from&&a===n)return"period_start";if(l.model.to&&a===r)return"period_end";if(l.model.from&&l.model.to&&a>n&&a<r)return"period_range"}},dateDisabled:function(e){var t=new Date(e.date);return t.setHours(0,0,0,0),l.disabledDateTimes?l.disabledDateTimes.includes(t.getTime()):l.enabledDateTimes?!l.enabledDateTimes.includes(t.getTime()):void 0},formatDayTitle:"LLLL, yyyy",formatMonth:"LLLL",formatDay:"d",showWeeks:!1},e.minDate&&(e.minDate.setHours(0,0,0,0),l.datepickerOptions.minDate=e.minDate),e.maxDate&&(e.maxDate.setHours(0,0,0,0),l.datepickerOptions.maxDate=e.maxDate),e.placementTo||(e.placementTo=e.placement),l.fromDpOpts=angular.merge({},l.datepickerOptions),l.toDpOpts=angular.merge({},l.datepickerOptions),l.opened={from:!1,to:!1},e.$on("$destroy",(function(){W(window).off("resize.period")})),e.$on("toggle-datepicker",(function(e,t){l.toggle(t.mod,t.isOpen)})),e.$on("reset-datepicker",(function(){l.model={mode:"all",from:null,to:null},l.rangeMode&&(l.dateRange.from=null,l.dateRange.to=null,l.dateRange.latest=null),u()})),e.$on("set-preset-date",(function(e,t){l.setPresetDate(t.code)})),e.$on("date-picker-select-date",(function(e,t){l.rangeMode&&l.model.from&&l.model.from.getTime()===t.getTime()&&s.$setViewValue({mode:l.model.mode,from:l.model.from,to:t})})),e.$on("date-picker-hover-date",(function(e,t){if(l.rangeMode&&l.model.from&&!l.model.to){var i=l.model.from.setHours(0,0,0,0),a=t.date.setHours(0,0,0,0),n="TD"===t.e.currentTarget.tagName?W(t.e.currentTarget):W(t.e.currentTarget).closest("TD");n&&n.length&&n.closest("tbody").find("td").each((function(e,t){var n=W(t).find("button");if(!n.is(":disabled")){W(t).removeClass("period_range");var r=n.data("timestamp");+r>i&&+r<=a&&W(t).addClass("period_range")}}))}})),e.$on("date-picker-leave-date",(function(e,t){if(l.rangeMode&&l.model.from&&!l.model.to){var i="TD"===t.e.currentTarget.tagName?W(t.e.currentTarget):W(t.e.currentTarget).closest("TD"),a=("TD"===t.e.relatedTarget.tagName?W(t.e.relatedTarget):W(t.e.relatedTarget).closest("TD")).find("button"),n=i.closest("tbody");a.length&&!a.is(":disabled")||n.find(".period_range").removeClass("period_range")}})),l.init=function(i){var o;s=i,l.presets=e.presets,l.periods={selectDates:(o="selectDates",r("fieldPeriod."+o).then((function(e){return l.periods[o]=e})))},l.presets&&l.presets.length&&l.presets.forEach((function(e){l.periods[e.code]=e.title})),e.$watch((function(){return l.opened}),(function(){p()}),!0),e.$watch((function(){return s.$modelValue}),(function(t){if(t&&(l.mode=t.mode,"period"===t.mode&&(l.model.from=t.from,l.model.to=t.to),l.rangeMode)){if(l.onePickerMode){var i=t.to||t.from;if(!i)return;l.dateRange.latest=i,l.dateRange.from?l.dateRange.from&&!l.dateRange.to?(l.dateRange.to=l.dateRange.latest,l.model.from=l.dateRange.from,l.model.to=l.dateRange.latest):l.dateRange.from&&l.dateRange.to&&(l.dateRange.from=t.from,l.model.from=t.from,l.dateRange.to=null,l.model.to=null,u()):(l.dateRange.from=i,l.model.from=i)}else l.model.from&&!l.model.to&&(l.toggle("from",!1),a.find('input[name="to"]').focus(),n((function(){if(l.rangeMode&&l.opened.to&&l.model.from&&!l.model.to&&e.$$childHead){var t=new Date,i=new Date(l.model.from);i.setDate(l.model.from.getDate()+1),t.getFullYear()===i.getFullYear()&&n((function(){e.$broadcast("moveMonth",{direction:i.getMonth()-t.getMonth()})}))}}),100));p(),e.$emit("date-range-selected",l.model)}})),s.$formatters.push((function(e){return e||(e={mode:"all",from:null,to:null}),!s.$isEmpty(e)&&e.from&&e.to?t("date")(e.from,"d MMMM yyyy")+" – "+t("date")(e.to,"d MMMM yyyy"):e&&e.mode&&l.periods[e.mode]||e}));var c=s.$render;s.$render=function(){c(),l.period=angular.isString(s.$viewValue)?s.$viewValue:""}},l.updateModel=function(){if(u(),!l.widthLT768){var e=angular.copy(l.model);s.$setViewValue(e),s.$processModelValue()}},l.clicked=function(e){var t=W(e.target);t.length&&t.parents(".mos-period__popup").length&&e.stopPropagation()},l.inputClicked=function(e,t){l.focus[t]&&l.widthLT768&&(l.isKeyboard=!0,n((function(){m(e.target)}),300))},l.focused=function(e,t){l.focus[t]=!0,l.invalidInputs[t]=!1,l.toggle("from"===t?"to":"from",!1),l.widthLT768?(l.isKeyboard=!0,n((function(){m(e.target)}),300)):l.toggle(t,!0)},l.blured=function(e,t){l.focus[t]=!1,l.isKeyboard=!1,p(),l.toggle(t,!1)},l.toggle=function(e,t){l.opened[e]=t},l.select=function(e){l.mode=e,l.model.mode=e,l.toggle(e,!1),"period"!==e&&!l.widthLT768&&l.apply()},l.apply=function(){l.updateModel()},l.setPresetDate=function(e){var t,i=new Date;"today"===e?(t=i,l.model.from=t,l.model.to=t):"tomorrow"===e?(t=new Date(i.setDate(i.getDate()+1)),l.model.from=t,l.model.to=t):"week"===e&&(l.model.from=new Date,t=new Date(i.setDate(i.getDate()+6)),l.model.to=t,l.rangeMode&&(l.dateRange.from=l.model.from,l.dateRange.to=l.model.to,l.dateRange.latest=l.model.to)),l.updateModel(),l.toggle("from",!1),l.toggle("to",!1)}}]).name,Y=angular.module("mosapp.fields.select",[]).directive("mosSelect",[function(){return{restrict:"EA",require:["mosSelect","?ngModel"],scope:{label:"@",defaultOption:"=",options:"=",displayField:"@",sortingField:"@",onChange:"&",disabledField:"=",multiple:"@"},controller:"MosSelectController",controllerAs:"ctrl",template:'<div class="mos-select" ng-disabled="disabledField" ng-class="{\'mos-select_has-value\': ctrl.selected, \'mos-select_open\': ctrl.show}"><button class="mos-select__select" bs-dropdown="" bs-on-show="ctrl.shown" bs-on-hide="ctrl.hide" auto-close="false" aria-haspopup="menu" aria-expanded="{{ctrl.show}}"><label class="mos-select__label" data-ng-if="label">{{ label }}</label><div class="mos-select__selected" title="{{ctrl.selected}}" ng-if="ctrl.selected">{{ ctrl.selected }}</div></button><div class="mos-select__options dropdown-menu customScrollbar" role="menu"><ul><li ng-if="ctrl.selectedValue" data-ng-attr-aria-hidden="{{ctrl.isMultiple || undefined}}"><div class="mos-select__option" ng-click="ctrl.select($event, {id: null})">{{ defaultOption || label }}</div></li><li ng-repeat="option in options | orderBy: sortingField track by option.id" ng-if="ctrl.isMultiple || option.id !== ctrl.selectedValue" ng-class="{\'mos-select__option_selected\': option.id === ctrl.selectedValue}"><label class="mos-select__option" ng-if="ctrl.isMultiple"><span><input type="checkbox" ng-click="ctrl.select($event, option)"/><span class="mos-select__option-mark" ng-class="{\'mos-select__option-mark_checked\': ctrl.isSelected(option) }"></span></span><span>{{ option[displayField] }}</span></label><div class="mos-select__option" ng-if="!ctrl.isMultiple" ng-click="ctrl.select($event, option)"><span>{{ option[displayField] }}</span></div></li></ul></div></div>',link:function(e,t,i,a){var n=a[0],r=a[1];n.init(r)}}}]).controller("MosSelectController",["$scope","$element",function(e){var t,i=this;e.displayField=e.displayField||"title",i.show=!1,i.selected=null,i.init=function a(n){if(e.options&&e.options.length){(t=n).$formatters.push((function(t){for(var a=[],n=0;n<e.options.length;n++)if(Array.isArray(t)&&t.length){if(t.indexOf(e.options[n].id)>-1&&(a.push(e.options[n][e.displayField]),!i.isMultiple))break}else if(e.options[n].id===t)return e.options[n][e.displayField];return a.join(", ")})),t.$parsers.push((function(t){for(var a=[],n=0;n<e.options.length&&(!(t.indexOf(e.options[n].id)>-1)||(a.push(e.options[n].id),i.isMultiple));n++);return i.isMultiple?a:a.length?a[0]:null}));var r=t.$render;t.$render=function(){r(),i.isMultiple?(i.selected=t.$viewValue,i.selectedValue=Array.isArray(t.$modelValue)?t.$modelValue:[t.$modelValue]):(i.selected=t.$viewValue,i.selectedValue=t.$modelValue)},t.$processModelValue()}else var o=e.$watch("options",(function(e){e&&e.length&&(a(n),o())}))},i.shown=function(e){i.$dropdown=e;var t=e.$element;t.mCustomScrollbar({callbacks:{onScrollStart:function(){this.classList.add("mos-select_scroll-start")},onTotalScrollBack:function(){this.classList.remove("mos-select_scroll-start")}}}),t.find(".mCustomScrollBox").attr("tabindex",-1),t.find(".mCSB_container").attr("tabindex",-1),i.show=!0,t.attr("tabindex",0),t.on("focus.mos-select",(function(){t.attr("tabindex",-1),t.off("focus.mos-select")}))},i.hide=function(){i.$dropdown.$element.off("focus.mos-select"),i.show=!1},i.select=function(a,n){if(i.isMultiple){n.checked=!n.checked,i.selectedValue||(i.selectedValue=[]);var r=i.selectedValue.indexOf(n.id);r>-1?i.selectedValue.splice(r,1):i.selectedValue.push(n.id)}else i.selectedValue=[n.id],i.$dropdown.hide();t.$setViewValue(i.selectedValue),t.$processModelValue(),e.onChange({value:i.selectedValue,option:n})},i.isSelected=function(e){return Array.isArray(i.selectedValue)&&i.selectedValue.indexOf(e.id)>-1},i.isMultiple=e.multiple}]).name,Q=angular.module("newsMain.news.filter.service",[]).service("newsFilterSrvc",["$stateParams","$filter","toolsSrvc","$state",function(e,t,i,a){var n=this,r=[],o={},s="news",l="dd.MM.yyyy";function c(e){e.from&&(e.from=t("date")(e.from,l)),e.to&&(e.to=t("date")(e.to,l))}function d(){var e=n.normalizeParams(o,r);e.page=null,a.go(n.generateState(e,r,s),e)}this.getParams=function(){return o},this.init=function(t,i,a){r=i,s=t,o={},c(o=a?angular.extend({},e,a):e),o.page||(o.page=1),n.normalizeParams(o,r)},this.setState=function(e){c(o=angular.extend({},o,e))},this.getDateForCalendar=function(){return{from:t("date")(o.from,"yyyy-MM-dd"),to:t("date")(o.to,"yyyy-MM-dd")}},this.getParam=function(e){return o[e]},this.setAndGetParams=function(e){var t=angular.extend({},o);for(var a in o.page=t.page=e?++o.page:1,t)if("from"!==a&&"to"!==a)"type"!==a||"all"===t.type?(t[a]=""!==t[a]?t[a]:"all","all"!==t[a]&&""!==t[a]||delete t[a]):t.type=typesArray[t.type]?typesArray[t.type].toString():null;else{var n="from"===a;t[a]=""!==o[a]?i.compileDate(i.ruStrToDate(t[a]),n):t[a]}return t},this.setFilterCalendar=function(e){delete o.day,delete o.week,delete o.from,delete o.to,"day"===e.mode||"week"===e.mode?o[e.mode]=!0:(o.from=t("date")(e.from,l)||null,o.to=t("date")(e.to,l)||null),d()},this.setNewInstitution=function(e){o.institution=e||"all",d()},this.setNewSphere=function(e){o.sphere=e||"all",d()},this.generateState=function(e,t,i){for(var a="",n=t.length;n--;){var r=t[n];if(e[r]&&["day","week","period"].indexOf(r)<0&&(a+="."+r),"period"===r&&e.from&&e.to){a+="."+r;break}["day","week"].indexOf(r)>-1&&e[r]&&(a+="."+r)}return i+a},this.normalizeParams=function(e,t){var i={},a=0;if(e.from&&(i.from=e.from,a++),e.to&&(i.to=e.to,a++),t)for(var n=0;n<t.length;n++){var r=t[n];["day","week","period"].indexOf(r)>-1&&e[r]&&(i[r]=e[r],"period"!==r&&a++),["sphere","institution"].indexOf(r)>-1&&(e[r]&&"all"!==e[r]?(i[r]=e[r],a++):i[r]="all")}if(0===a&&t)for(var o=0;o<t.length;o++){var s=t[o];"period"!==s&&delete i[s]}return i}}]).name,K=angular.module("newsMain.news.filter",[U,Y,Q]).directive("newsFilter",["apiSrvc","$q",function(e,t){return{restrict:"EA",scope:{filter:"=",onChange:"&",onInit:"&"},controller:"NewsFilterController",controllerAs:"ctrl",template:'<div class="news-filter news-row"><div class="news-filter__sphere"><mos-select data-label="\'spheres\'" data-ng-model="model.sphere" data-options="spheres" data-on-change="sphereChanged(option)"></mos-select></div><div class="news-filter__institution"><mos-select display-field="name" data-label="\'Департамент\'" data-ng-model="model.institution" data-options="institutions" data-on-change="institutionChanged(option)"></mos-select></div><div class="news-filter__period"><mos-period data-ng-if="ctrl.periodPresets" data-label="\'Период\'" data-ng-model="model.period" data-presets="ctrl.periodPresets" data-placement="\'auto left\'" data-ng-change="periodChanged()"></mos-period></div></div>',link:function(i){i.model=i.filter||{sphere:null,institution:null,period:null},i.$watch("filter",(function(e){i.model=e}));var a,n={spheres:{apiMod:"newsfeed",apiKey:"spheres",params:{fields:"id,title",filter:{in_article:1},"per-page":50},transform:function(e){return e.map((function(e){return e.id=""+e.id,e}))}},institutions:{apiMod:"structure",apiKey:"institutions",params:{fields:"id,name,lead_institution_id",filter:{"frame.level":0,"frame.type":"institution"},"per-page":50,sort:"name"},transform:function(e){return e.sort((function(e,t){return null===e.lead_institution_id?-1:null===t.lead_institution_id?1:0})).map((function(e){return e.id=""+e.id,e})),e}}};i.institutionChanged=function(){i.onChange({filter:i.model,key:"institution"})},i.sphereChanged=function(){i.onChange({filter:i.model,key:"sphere"})},i.periodChanged=function(){i.onChange({filter:i.model,key:"period"})},(a=[],Object.keys(n).forEach((function(t){var r=n[t];a.push(e.getAllPages(r.apiMod,r.apiKey,r.params).then((function(e){i[t]=r.transform?r.transform(e):e})))})),t.all(a)).then((function(){i.onInit()}))}}}]).controller("NewsFilterController",["$scope","$q","$translate",function(e,t,i){var a=this;function n(e){return i("newsFilter."+e).then((function(t){return a.periods[e]=t}))}a.periods={},t.all([n("all"),n("week"),n("day")]).then((function(){a.periodPresets=[{code:"all",title:a.periods.all},{code:"week",title:a.periods.week},{code:"day",title:a.periods.day}]}))}]).name,G=angular.module("mosapp.fields.button",[]).directive("mosButton",[function(){return{restrict:"AE",require:["mosButton"],scope:{label:"@",href:"@",onClick:"&"},controller:"MosButtonController",controllerAs:"ctrl",template:'<a class="mos-button" ng-href="{{ href }}" ng-click="ctrl.clicked($event)"><span>{{ label }}</span></a>',link:function(){}}}]).controller("MosButtonController",["$scope",function(e){this.clicked=function(t){e.onClick({$event:t})}}]).name,J=(i.p,angular.module("mosapp.filters.dateFormat",[]).filter("newsfeedDateFormat",["$filter",function(e){return function(t,i,a){var n=new Date,r=n.getTime(),o=new Date(t),s=n.getTimezoneOffset()/60;-3!==s&&(n=new Date(r+3600*s*1e3+108e5));var l=Math.abs(r-t);return Math.floor(l/864e5)<1&&n.getDate()===o.getDate()?e("date")(t,"HH:mm","+0300"):n.getFullYear()===o.getFullYear()?a?e("date")(t,"d MMM").replace(/\./g,""):e("date")(t,"d MMMM"):a?e("date")(t,"d MMM yyyy").replace(/\./g,""):e("date")(t,"d MMMM yyyy")}}]).filter("eventDateFormat",["$filter",function(e){return function(t,i,a,n){var r=function(t,i){var a=e("date")(t,i),n=a.indexOf(".")>-1,r=a.split(" ")[0],o=a.split(" ")[1],s=a.split(" ")[2]||"";return o=n?o.slice(0,3)+".":o,o=n&&"ноя."===o?"нояб.":o,"".concat(r," ").concat(o).concat(s?" ".concat(s):"")},o=a||new Date,s=o.getTime(),l=o.getTimezoneOffset()/60;-3!==l&&(o=new Date(s+3600*l*1e3+108e5));var c=new Date(t),d=new Date(i),m=o.getFullYear(),u=c.getDate(),p=c.getMonth(),f=c.getFullYear(),g=d.getDate(),h=d.getMonth(),v=d.getFullYear(),y=n?"MMM":"MMMM",w=v!==m?"d ".concat(y," yyyy"):"d ".concat(y);if(c<o&&o<=d)return"до ".concat(r(d,w));if(u===g&&p===h&&f===v)return r(c,w);if(u!==g&&p===h&&f===v)return u+" – "+r(d,w);if(p!==h&&f===v&&(o<c||o>d)){var b="d ".concat(y),_=b+(f!==m?" yyyy":"");return r(c,b)+" — "+r(d,_)}return(r(c,"d MMM yyyy")+" — "+r(d,"d MMM yyyy")).replace(/\./g,"")}}]).name),X=n.module("mosapp.services.materialsUtils",[]).service("MaterialsUtilsSrvc",[function(){this.buildPageObjectList=function(e,t){var i=e.items;if(void 0===e.needFix){e.needFix=!1;for(var a=0;a<t;a++)if(!i[a].image){e.needFix=!0;break}}if(!1!==e.needFix){if(e.items.sort((function(e,t){return t.timestamp-e.timestamp})),1===t)return i;var n=[],r=[],o=[];if(e.imagesCount<t)for(var s=0;s<i.length;s++)i[s].image&&delete i[s].image;else{for(var l=0;l<i.length;l++){var c=i[l];if(!(n.length<t)){o=i.slice(l);break}c.img?(c.image=c.img,n.push(c)):r.push(c)}i=n.concat(r,o)}return e.items=i,i}},this.transformAndCountImages=function(e,t,i){i=i||{};var a,n=0;if(a=e.map((function(a,r){return n<(i.maxImages||e.length)&&a.image&&(n+=1),i.hasImages&&r<3?a.hasImage=!0:a.hasImage=!1,t(a,n)})),i.minImages&&n<i.minImages){for(var r=0;r<e.length;r++){var o=a[r];o&&o.image&&delete o.image}n=0}return{items:a,imagesCount:n}}}]).name,Z=i(7339),ee=angular.module("newsMain.news",[J,j,K,X,G]).directive("mainNews",[function(){return{restrict:"EA",scope:{},controller:"MainNewsController",controllerAs:"ctrl",template:'<div class="main-news" id="main-news"><news-filter data-on-change="ctrl.filterChanged(filter, key)" data-on-init="ctrl.filterInited()" filter="ctrl.modelFilter"></news-filter><div class="main-news__list"><news-list data-ng-if="ctrl.materialsStore" data-pages="ctrl.materialsStore"></news-list></div><div class="main-news__notfound" data-ng-if="ctrl.notFound" data-translate="mainNews.notFound"></div><mos-button class="main-news__more" data-ng-if="ctrl.pagination.currentPage &lt; ctrl.pagination.pageCount &amp;&amp; !ctrl.notFound" data-on-click="ctrl.moreClicked($event)" data-href="{{ ctrl.urlMore }}" data-label="{{ \'mainNews.seeMore\' | translate }}"></mos-button></div>',link:function(){}}}]).controller("MainNewsController",["$scope","$element","apiSrvc","UrlSrvc","toolsSrvc","newsFilterSrvc","$filter","$httpParamSerializer","$location","$sce","$timeout","$state","$stateParams","$transitions","MaterialsUtilsSrvc",function(e,t,i,a,n,r,o,s,l,c,d,m,u,p,f){var g=this;g._materials=[],e.exludedIds=window.config&&window.config.articlesIds||[];var h="scroll.main-news mousedown.main-news wheel.main-news DOMMouseScroll.main-news mousewheel.main-news keyup.main-news touchmove.main-news",v=["day","week","period","institution","sphere"],y=t.find(".main-news__list"),w=t.find(".main-news");function b(){r.init("news",v,{});var e=r.setAndGetParams();!function(e){if(e.period&&e.from&&e.to){var t=new Date(e.from.replace(" ","T")),i=new Date(e.to.replace(" ","T"));t>i&&(e.from=i,e.to=t,r.setFilterCalendar(e))}}(e),function(e){(e.sphere&&"all"!==e.sphere||e.institution&&"all"!==e.institution||e.period&&(e.from||e.to)||e.week||e.day)&&(g.isNeedScrollToFilter=!0,Z("html,body").on(h,(function(){g.isNeedScrollToFilter=!1,Z("html,body").off(h)})),Z(window).on("load",(function(){g.isNeedScrollToFilter&&M()})))}(e),g.modelFilter=function(){var e={institution:r.getParam("institution"),period:r.getDateForCalendar(),sphere:r.getParam("sphere")},t=n.ruStrToDate(e.period.from),i=n.ruStrToDate(e.period.to);return e.period.from=t&&!isNaN(t.getTime())?t:null,e.period.to=i&&!isNaN(i.getTime())?i:null,e.period.from&&e.period.to?e.period.mode="period":r.getParam("day")?e.period.mode="day":r.getParam("week")?e.period.mode="week":e.period.mode="all",e}();var t=null,i=null,a=g.modelFilter.period.mode;if("week"===a||"day"===a){var s="week"===a?7:1;i=new Date,(t=new Date).setDate(i.getDate()-s)}else t=g.modelFilter.period&&g.modelFilter.period.from,(i=g.modelFilter.period&&g.modelFilter.period.to)&&(i.setHours(23),i.setMinutes(59),i.setSeconds(59));t&&(t=n.convertDateToMos(t),t=o("date")(t,"dd.MM.yyyy HH:mm:ss")),i&&(i=n.convertDateToMos(i),i=o("date")(i,"dd.MM.yyyy HH:mm:ss")),g.filter={department_id:e.institution,sphere_id:e.sphere,from:t,to:i}}function _(t,a){g._materials=[],g.notFound=!1,g.getDataProcess=!0;var n=angular.merge({"per-page":12,sort:"-date",fields:"id,title,image,published_at_timestamp,published_at",expand:"spheres"},g.filter,t);if(e.exludedIds&&e.exludedIds.length&&(n=angular.merge(n,{filter:{"!=id":e.exludedIds}})),n.sphere_id)try{delete(n=angular.merge(n,{filter:{"spheres.id":JSON.parse("["+n.sphere_id+"]")}})).sphere_id}catch(e){}return w.height(w.height()),i.getData("newsfeed","articlesList",n,!1,a).then((function(e){if(e.data.items&&e.data.items.length){var t=x(e.data.items);g.pagination=e.data._meta,g.urlMore=g.buildUrl();var i="page"+g.pagination.currentPage;g.materialsStore[i]||(g.materialsStore[i]={imagesCount:t,items:[]}),g.widthLT768?C(g._materials.splice(0,4)):(C(g._materials.splice(0)),A(g.materialsStore[i],g.numOfCols))}else e.data._meta&&1===e.data._meta.currentPage&&(g.notFound=!0)})).finally((function(){g.silence=!1,g.getDataProcess=!1,w.height("")}))}function k(e){var t=1e3*e.published_at_timestamp,i=/(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})/;if(isNaN(t)&&e.published_at&&e.published_at.match(i)){var n=i.exec(e.published_at);t=new Date(1*n[1],1*n[2]-1,n[3],n[4],n[5],n[6]).getTime()||NaN}var r={title:c.trustAsHtml(e.title),href:a.getLangLink(a.pagePath("news","/item/"+e.id+"/")),extra:[],timestamp:t};return isNaN(t)||r.extra.push({title:o("newsfeedDateFormat")(t,"d MMMM")}),angular.isArray(e.spheres)&&angular.isObject(e.spheres[0])&&r.extra.push({title:e.spheres[0].title}),g.imagesCount<4&&e.image&&(r.image=e.image,r.img=e.image,g.imagesCount+=1),r}function x(e){g.imagesCount=0;var t=f.transformAndCountImages(e,k,{minImages:3,maxImages:4});return g._materials=t.items,t.imagesCount}function C(e){var t="page"+g.pagination.currentPage;g.materialsStore[t].items=g.materialsStore[t].items.concat(e)}function A(e,t){return f.buildPageObjectList(e,t)}function S(){g.widthLT768=Modernizr&&Modernizr.mq("(max-width: 767px)"),g.widthLT768,g.widthLT1366=Modernizr&&Modernizr.mq("(max-width: 1366px)"),g.widthLT1366}function $(){if(S(),g.numOfCols=g.widthLT768?1:g.widthLT1366?3:4,g.oldNumOfCols!==g.numOfCols){var e=1===g.numOfCols||g.oldNumOfCols>g.numOfCols||void 0;for(var t in 1===g.oldNumOfCols&&g._materials.length&&C(g._materials.splice(0)),g.oldNumOfCols=g.numOfCols,g.materialsStore)g.materialsStore[t].needFix=e,A(g.materialsStore[t],g.numOfCols)}}function M(e){var t=Z("#mos-header").eq(0),i=Z("news-filter"),a=t.length?t.outerHeight(!0):0,n=t.find(".mos-header_red-top-bar").eq(0),r=t.find(".mos-layouts__hero-block").eq(0),o=n.length?n.outerHeight(!0):0,s=r.length?r.outerHeight(!0):0;a=Math.max(a,o+s);var l=Z("html,body");l.on(h,(function(){l.stop(),g.isNeedScrollToFilter=!1})),l.animate({scrollTop:i.offset().top-a-15},"slow",(function(){l.off(h),e&&e()}))}g.rootState="news",g.pagination={},g.filterChanged=function(e,t){"sphere"===t?r.setNewSphere(e.sphere):"institution"===t?r.setNewInstitution(e.institution):"period"===t&&e.period&&r.setFilterCalendar(e.period),M()},g.moreClicked=function(e){e.preventDefault(),g.getDataProcess||(g.widthLT768&&g._materials.length?C(g._materials.splice(0,4)):(g.silence=!0,g.isPageParam&&(u.page=g.pagination.currentPage+1,m.transitionTo(m.current.name,u,{location:!0,inherit:!0,notify:!1,reload:!1,relative:null})),_({page:g.pagination.currentPage+1},t.find(".main-news__more"))))},g.addToRender=C,g.handleMaterials=x,g.handleMaterialsImages=A,g.materialsStore={},r.init("news",v,{}),t.on("$destroy",(function(){Z(window).off("resize.main-news"),e.$destroy()})),g.filterInited=function(){p.onSuccess({},(function(e){if(g.silence)g.silence=!1;else{for(var t=e.to(),i=!1,a=0;a<v.length;a++)if(t.name.indexOf(v[a])>-1){i=!0;break}(t.name===g.rootState||i)&&(b(),function(){g.pagination={},g.materialsStore={};var e=l.search().page;/^\d+$/.test(e)&&(e=+e),_({page:e},y)}())}})),b(),function(){$(),Z(window).off("resize.main-news").on("resize.main-news",$);var e={},t=l.search().page;/^\d+$/.test(t)&&(e.page=+t),_(e,y)}()},g.buildUrl=function(){g.isPageParam=!1,angular.isDefined(u.page)&&(g.isPageParam=!0);var e=l.absUrl(),t=angular.copy(l.search()),i=s(t);return i.length&&(e=e.replace("?"+i,"")),t.page=g.pagination.currentPage+1,(i=s(t)).length&&(e+="?"+i),e},S(),g.oldNumOfCols=1}]).name;function te(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.p;var ie={type:"newsfeed",section:null,src:window.location.href},ae=new function(e){var t=ie,i=!1;this.initialize=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!i&&e){t=Object.assign({},ie,a);var n=document.createElement("script"),r=document.getElementsByTagName("script")[0];n.src="/shared/counters/spatz.js",r.parentNode.insertBefore(n,r),i=!0}},this.sendStat=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;a||(i=Object.assign({},t,i));var n=e;i.section&&(n=te({},i.section,n)),i.type&&(n=te({},i.type,n)),window.Spatz&&window.Spatz.send({type:i.type,src:i.src,data:n})}}("true"==="True".toLowerCase()),ne=ae,re="Мэр Москвы",oe="Мой район",se="Медиа",le="Выбор района",ce="Клик по ссылке",de="Доскролл",me="Взаимодействие с фильтром",ue="Фильтр",pe="Клик по кнопке Подобрать",fe="Клик по скролу",ge=i(7339);function he(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var ve=angular.module("newsMain.raionButton",[]).directive("moyRayonHeader",["$modal","$rootScope","apiSrvc","$timeout","$filter",function(e,t,i,a,n){return{restrict:"EA",template:'<div class="main-district__head"><div class="main-district__info"><h2 class="main-district__title">{{ title }}</h2><button class="main-district__link main-district__link--find-district" type="button" data-ng-click="openRaionPopup($event)" data-ng-class="{\'main-district__link--selected\': !!raionID}"><span class="main-district__link-icon" role="presentation"></span><span>{{ textButton }}</span></button><button class="main-district__remove-icon" type="button" data-ng-show="!!raionID" data-ng-click="unsetRaion()"><span class="sr-only">{{ removeButtonText }}</span></button></div><a class="main-district__all link-animated__all" href="{{ linkAll }}" data-ng-click="onClickDistrictsAll()"><span>{{ textAll }}</span><span class="main-district__all-icon" role="presentation"><span class="link-animated__all-icon"></span></span></a></div>',scope:{title:"@",textButton:"@",placeholder:"@",placeholderMob:"@",notFound:"@",textAll:"@",linkAll:"@",removeButtonText:"@",modalCloseButtonText:"@",districtItemSelectText:"@",searchClearButtonText:"@",clickOpenPopup:"&"},link:function(r,o){var s=!1;r.searchClear=!1,r.showPlaceholder=!0,r.placeholderText=r.placeholder,r.data=[],r.searchList=[];var l=[];r.filterQuery="";var c=angular.element(document),d=document.cookie.match(new RegExp("(?:^|; )user_area_id=([^;]*)"));function m(e){r.raionID=e.id,t.raionID=r.raionID,r.linkAll="/moi-raion/"+e.local_id+"/",t.raionCode=e.local_id,r.textButton=e.title,document.cookie="user_area_id="+e.id+"; path=/; domain=.mos.ru; max-age=604800",r.popup&&r.popup.hide(),r.enableScroll()}(d=d&&+d[1])&&window.config.data.userArea&&d!==+window.config.data.userArea.id||d&&!window.config.data.userArea?i.getData("directories","area",{id:d}).then((function(e){m(e.data)})):window.config.data.userArea&&window.config.data.userArea.title&&(r.title=window.config.data.userArea.title,r.textButton=r.title,r.raionID=window.config.data.userArea.id),o.on("$destroy",(function(){r.$destroy()})),r.unsetRaion=function(){r.raionID=null,r.textButton=n("translate")("mainDistrict.find"),t.raionID=null,t.raionCode=null,config.data.userArea=null,r.linkAll="/moi-raion/",document.cookie="user_area_id=; Path=/; Domain=.mos.ru; expires=Thu, 01 Jan 1970 00:00:01 GMT;",ne.sendStat(he({},oe,"Клик по сбросу района"))},r.openRaionPopup=function(t){r.openPopupButton=ge(t.delegateTarget),r.popup=e({scope:r,template:'<div class="raion-popup-modal" role="dialog" aria-modal="true" aria-labelledby="districtPopupTitle" data-ng-click="hidePop($event)" data-ng-class="{ \'contrast\': colorScheme === \'contrast\' }"><div class="raion-popup-modal__cont-wrapper"><div class="district_popup raion-popup-modal__cont" style="{{heightPopup}}"><div class="district_popup_header"><button class="district_popup_close" type="button" data-ng-click="hidePop()"><span class="sr-only">{{modalCloseButtonText}}</span></button><div class="district_popup_title" id="districtPopupTitle"><h2>{{ title }}</h2></div><div class="district_popup_search_wrap"><div class="district_popup_search_container"><label class="sr-only" for="inputSearchDistrict">{{placeholderText}}</label><input class="district_popup_search" id="inputSearchDistrict" type="text" ng-change="districtsSearch(filterQuery)" name="query" ng-focus="onFocus()" ng-blur="onBlur()" autocomplete="off" ng-model="filterQuery"/><span class="district_popup_search_placeholder" ng-if="showPlaceholder">{{placeholderText}}</span><button class="district_popup_search_clear" type="button" ng-click="searchClearFn()" ng-show="searchClear"><span class="sr-only">{{searchClearButtonText}}</span></button></div></div></div><div class="district_popup_list"><div class="district_popup_list-scrollbar"><ul ng-repeat="item in data" ng-if="!searchClear || filterQuery.length &lt; 3"><li class="letter-item" ng-if="item.key">{{item.key}}</li><li class="raion-item" ng-repeat="district in item.districts"><button class="radio-item_link" type="button" ng-click="selectRaion(district)"><span aria-hidden="true">{{district.title}}</span><span class="sr-only">{{districtItemSelectText}} {{district.title}}</span></button></li></ul><ul class="district_popup_search_results" ng-if="searchClear &amp;&amp; filterQuery.length &gt;= 3 &amp;&amp; searchList.length &gt; 0"><li class="raion-item" ng-repeat="item in searchList"><button class="radio-item_link" ng-click="selectRaion(item)"><span aria-hidden="true">{{item.title}}</span><span class="sr-only">{{districtItemSelectText}} {{district.title}}</span></button></li></ul><p class="notfound" ng-if="searchList.length === 0 &amp;&amp; searchClear &amp;&amp; filterQuery.length &gt;= 3">{{notFound}}</p></div></div></div></div></div>',show:!1,prefixClass:"raionPopup",prefixEvent:"raionPopup",backdropAnimation:"am-fade",placement:"center",backdrop:!0}),r.popup.$promise.then((function(){var e;0===r.data.length&&(e={"per-page":50},i.getAllPages("directories","areas",e).then((function(e){var t;e.map((function(e){e.id&&l.push(e)})),l.length>0&&(r.data=(t=l.sort((function(e,t){return e.title>t.title?1:-1})).reduce((function(e,t){var i=t.title.charAt(0);return e[i]=e[i]||[],e[i].push(t),e}),{}),Object.keys(t).map((function(e){return{key:e,districts:t[e]}}))))}))),r.popup.show(),r.disableScroll()})),ne.sendStat(he({},oe,he({},le,"Клик Найти свой район")))},r.onClickDistrictsAll=function(){ne.sendStat(he({},oe,he({},"Переход на страницу района",he({},r.textAll,r.linkAll))))},r.$on("raionPopup.show",(function(e,t){var i=t.$element.find(".district_popup_list"),n=t.$element.find(".district_popup_search");a((function(){i.mCustomScrollbar({axis:"y",live:!0,scrollbarPosition:"outside",theme:"minimal-dark",advanced:{autoExpandHorizontalScroll:!0,updateOnContentResize:!0},callbacks:{onScrollStart:function(){t.$element.find(".district_popup_header").addClass("whileScroll")},onTotalScrollBack:function(){t.$element.find(".district_popup_header").removeClass("whileScroll")},onUpdate:function(){t.$element.find(".district_popup_header").removeClass("whileScroll")}}}),n.focus()}),10),r.searchClearFn=function(){n.val(""),r.filterQuery="",r.searchList=[],r.searchClear=!1,r.showPlaceholder=!0,r.heightPopup=""}})),r.disableScroll=function(){var e=document.getElementsByTagName("html")[0],t=e.scrollTop;e.style.overflowY="scroll",e.style.width="100%",e.style.top="-".concat(t,"px"),e.style.position="fixed"},r.enableScroll=function(){var e=document.getElementsByTagName("html")[0],t=parseInt(e.style.top.split("px")[0],10);e.style.overflowY="",e.style.width="",e.style.top="",e.style.position="",e.scrollTop=-t},r.selectRaion=function(e){m(e),e.title&&ne.sendStat(he({},oe,he({},le,he({},"Клик по названию района",e.title))))},r.$on("raionPopup.hide",(function(){r.searchClearFn(),c.off("keyup.raionPopup")})),r.hidePop=function(e){var t=document.querySelector(".raion-popup-modal__cont");e&&t&&t.contains(e.target)||r.popup&&(r.popup.hide(),r.popup=null,r.openPopupButton&&r.openPopupButton.focus(),r.enableScroll())},r.onFocus=function(){r.showPlaceholder=!1,ne.sendStat(he({},oe,he({},le,["Активация окна поиска района"])))},r.onBlur=function(){r.filterQuery.length>0?r.showPlaceholder=!1:r.showPlaceholder=!0},r.districtsSearch=function(e){var t=l;r.filterQuery=e,e.length?r.searchClear=!0:r.searchClear=!1,t=t.filter((function(t){return~t.title.toLowerCase().search(function(e){return e=(e=e.trim().toLowerCase()).replace(/(е|ё)/g,"(е|ё)"),e="".concat(e,"|").concat(e.replace(/\s/g,"")),new RegExp(e)}(e))})),r.searchList=t,e.length<3?r.heightPopup="":(window.innerWidth>700&&(r.heightPopup="height: auto;"),s||(ne.sendStat(he({},oe,he({},le,["Поиск"]))),s=!0))},r.$watch((function(){return window.innerWidth}),(function(e){a.cancel(r.t),r.t=a((function(){r.placeholderText=e>767?r.placeholder:r.placeholderMob}),100)}))}}}]).name;function ye(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var we=angular.module("newsMain.news",[J,X,ve]).directive("mainDistrictList",[function(){return{restrict:"EA",scope:{textAll:"@",excludedIds:"="},controller:"MainDistrictController",controllerAs:"ctrl",transclude:!0,template:'<main-districts-transclude ng-if="(!materials || materials.length === 0) &amp;&amp; !$scope.isLoading"></main-districts-transclude><div data-horizontal-cards-scroll=".main-district__item"><div class="news-row" ng-if="(materials &amp;&amp; materials.length &gt; 0) &amp;&amp; !$scope.isLoading" data-media-slider="" ng-attr-slide-item-class="materials.length &gt; 4 ? \'main-district__item\' : \'\'" data-api="ctrl.mediaSliderApi" data-prev-button-click="ctrl.onPrevButtonClick()" data-next-button-click="ctrl.onNextButtonClick()"><div class="main-district__item news-col-md-3" ng-repeat="item in materials"><a class="main-district__item-content-wrap" href="{{ item.href }}" target="_top" data-ng-click="ctrl.onMaterialClick($event, item.title, $index + 1)"><div class="main-district__item-content"><div class="main-district__item-header"><span class="main-district__item-date">{{ item.date }}</span><span class="main-district__item-sphere">{{ item.sphere }}</span></div><div class="main-district__item-title main-district__link">{{ item.title }}</div><div class="main-district__item-image"><img ng-src="{{ item.image }}" alt="{{ item.title }}" title="{{ item.title }}"/></div></div></a></div></div></div><a class="main-district__all main-district__all--320 link-animated__all" href="{{ raionCode }}"><span>{{ textAll }}</span><span class="main-district__all-icon"><span class="link-animated__all-icon"></span></span></a>',link:function(){}}}]).directive("mainDistrictsTransclude",[function(){return{restrict:"EA",link:function(e,t,i,a,n){n((function(i,a){a.ctrl=e.ctrl,t.append(i)}))}}}]).controller("MainDistrictController",["$scope","$element","$timeout","apiSrvc","$rootScope","UrlSrvc","$filter","deduplicationSrvc",function(e,t,i,a,n,r,o,s){var l=this,c=!0,d=e.excludedIds||[];function m(e){var t=e.image;return t&&(t=e.image["2x1_m"]?e.image["2x1_m"].src:e.image.small.src),{id:e.id,title:e.title,date:o("newsfeedDateFormat")(1e3*e.date_timestamp,"d MMM"),href:r.getLangLink(r.pagePath("news","/item/"+e.id+"/")),sphere:e.sphere.title,image:t}}e.raionCode="/moi-raion/",e.isLoading=!1,t.on("$destroy",(function(){e.$destroy()})),l.mediaSliderApi={},l.getNewsDistricts=function(){var t={filter:{territory_area_id:e.raionID},"per-page":6},i=s.getIdsExcept(d);i&&i.length&&(t=angular.merge(t,{filter:{"!=id":i}})),a.getData("newsfeed","mainDistrics",t).then((function(t){c&&(c=!1),e.materials=[];var i=t.data.items;s.remove(d),d.splice(0);for(var a=0;a<i.length;a++){var n=m(i[a]);e.materials.push(n),d.push(n.id)}s.add(d),e.isLoading=!1,!c&&l.mediaSliderApi&&l.mediaSliderApi.reinit&&l.mediaSliderApi.reinit()}),(function(){}))},l._materials=[],e.materials=[],e.justStarted=!0,e.$watch("$root.raionID",(function(){if(n.raionID||!e.justStarted){if(!n.raionID)return e.materials=[],void(e.raionCode="/moi-raion/");e.raionCode="/moi-raion/"+n.raionCode+"/",e.raionID=n.raionID,l.getNewsDistricts()}else e.justStarted=!1})),l.onPrevButtonClick=function(){ne.sendStat(ye({},oe,ye({},fe,"Влево")))},l.onNextButtonClick=function(){ne.sendStat(ye({},oe,ye({},fe,"Вправо")))},l.onMaterialClick=function(e,t,i){ne.sendStat(ye({},oe,ye({},"Элемент "+i,ye({},t,e.currentTarget.href))))}}]).name,be=n.module("mosapp.filters.imageSrc",[]).value("imageSet",{defaultImage:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",ratioMask:"x1_",size:{s:"small",m:"middle",b:"big"}}).service("imgSrvc",["mosconfig",function(e){this.isMarkupImage=function(t){return t.indexOf("%markup_images_dir%")>-1?t.replace("%markup_images_dir%",e.imagesPath):t},this.testSrc=function(e){return""!==e&&e},this.testObj=function(e,t){return!!(n.isObject(e)&&n.isObject(e[t])&&n.isDefined(e[t].src)&&this.testSrc(e[t].src))&&e[t].src}}]).filter("imgThumb",["imgSrvc","imageSet",function(e,t){return function(i){var a,r=t.defaultImage;return n.isObject(i)?n.isDefined(i.src)&&e.testSrc(i.src)?e.isMarkupImage(i.src):(a=e.testObj(i,"thumb")||e.testObj(i,"small")||e.testObj(i,"middle")||e.testObj(i,"big"))?e.isMarkupImage(a):r:r}}]).filter("imgShow",["imgSrvc","imageSet",function(e,t){return function(i){var a,r=t.defaultImage;return n.isObject(i)?n.isDefined(i.src)&&e.testSrc(i.src)?e.isMarkupImage(i.src):(a=e.testObj(i,"show")||e.testObj(i,"big")||e.testObj(i,"original"))?e.isMarkupImage(a):r:r}}]).filter("imgDownload",["imgSrvc","imageSet",function(e,t){return function(i){var a,r=t.defaultImage;if(n.isObject(i)){if(n.isDefined(i.src)&&e.testSrc(i.src))return e.isMarkupImage(i.src);if(a=e.testObj(i,"download")||e.testObj(i,"show")||e.testObj(i,"big")||e.testObj(i,"original")){var o=e.isMarkupImage(a);0===(o=o.split("/").pop()).indexOf("undefined(",0)&&(a=e.testObj(i,"show")||e.testObj(i,"big")||e.testObj(i,"original"))}return a?e.isMarkupImage(a):r}return r}}]).filter("imageSrc",["imgSrvc","imageSet",function(e,t){return function(i){var a,r=t.defaultImage;return n.isObject(i)?n.isDefined(i.src)&&e.testSrc(i.src)?e.isMarkupImage(i.src):(a=e.testObj(i,"small")||e.testObj(i,"middle")||e.testObj(i,"big"))?e.isMarkupImage(a):r:r}}]).filter("imageSrcBig",["imgSrvc","imageSet",function(e,t){return function(i){var a,r=t.defaultImage;return n.isObject(i)?n.isDefined(i.src)&&e.testSrc(i.src)?e.isMarkupImage(i.src):(a=device.mobile()?e.testObj(i,"small")||e.testObj(i,"middle")||e.testObj(i,"big"):device.tablet()?e.testObj(i,"middle")||e.testObj(i,"big")||e.testObj(i,"small"):e.testObj(i,"big")||e.testObj(i,"middle")||e.testObj(i,"small"))?e.isMarkupImage(a):r:r}}]).filter("imageSrcMiddle",["imgSrvc","imageSet",function(e,t){return function(i){var a,r=t.defaultImage;return n.isObject(i)?n.isDefined(i.src)&&e.testSrc(i.src)?e.isMarkupImage(i.src):(a=e.testObj(i,"middle")||e.testObj(i,"big")||e.testObj(i,"small"))?e.isMarkupImage(a):r:r}}]).filter("imageSetSrc",["imgSrvc","imageSet",function(e,t){return function(i,a,r,o,s,l){var c,d=t.defaultImage,m=document.documentElement.clientWidth,u=o;m&&(u=a,m>480&&(u=r),m>768&&(u=o),m>1024&&(u=s),m>1280&&(u=l));var p=(u=u.split("|"))[1]||"3",f=u[2]||"m";return n.isObject(i)?n.isDefined(i.src)&&e.testSrc(i.src)?e.isMarkupImage(i.src):(c=e.testObj(i,p+t.ratioMask+f)||e.testObj(i,t.size[f]))?e.isMarkupImage(c):d:d}}]).filter("imageSrcOriginal",["imgSrvc","imageSet",function(e,t){return function(i){var a,r=t.defaultImage;return n.isObject(i)?n.isDefined(i.src)&&e.testSrc(i.src)?e.isMarkupImage(i.src):(a=e.testObj(i,"original")||e.testObj(i,"big")||e.testObj(i,"middle")||e.testObj(i,"small"))?e.isMarkupImage(a):r:r}}]).filter("imgFileName",["imgSrvc",function(e){return function(t){var i;return n.isObject(t)&&(i=n.isDefined(t.src)&&e.testSrc(t.src)?e.isMarkupImage(t.src):e.isMarkupImage(e.testObj(t,"original")))?i.split("/").pop():"Moscow.jpg"}}]).directive("fixHeadImage",[function(){return{restrict:"A",scope:{},link:function(e,t){t.on("$destroy",(function(){e.$destroy()})),e.EL=a(t),e.HDR=a(".b-header.attached"),e.WND=a(window),e.WND.on("scroll",(function(){var t=e.EL.offset().top,i=e.HDR.length?e.HDR.height():0,a=e.WND.scrollTop();a=a>t-i?a+i-t:0,e.EL.css({"background-position":"center "+a+"px"})}))}}}]).directive("imageSetElement",["imgSrvc","imageSet","$timeout","toolsSrvc","loaderIndicator",function(e,t,i,a,r){return{restrict:"A",link:function(o,s){s.on("$destroy",(function(){o.$destroy()})),o.removeLoader=function(){var e=s;o.loaderType&&(e={loaderType:o.loaderType,elems:s}),r.switchOff(e)},o.firstStart=!0,o.getSrc=function(){var i,a,l,c=t.defaultImage;if(a=s.width(),l=s.height(),o.firstStart){var d=s;o.loaderType&&(d={loaderType:o.loaderType,elems:s}),r.switchOn(d)}var m=Math.round(a/l);m=(m=m>4?4:m)<1?1:m;var u="s";return a>480&&(u="m"),a>800&&(u="b"),n.isObject(o.imageSetElement)?n.isDefined(o.imageSetElement.src)&&e.testSrc(o.imageSetElement.src)?e.isMarkupImage(o.imageSetElement.src):(i=e.testObj(o.imageSetElement,m+t.ratioMask+u)||e.testObj(o.imageSetElement,t.size[u]))?e.isMarkupImage(i):c:c},o.setBackground=function(){o.firstStart&&(o.firstStart=!1,a.hideContentArea(n.element(s))),o.removeLoader(),s.css("background-image",'url("'+o.img.src+'")'),a.showContentArea(n.element(s))},o.loadBackground=function(){o.img=new Image,o.img.src=o.getSrc(),n.element(o.img).on("load",o.setBackground).on("error",o.removeLoader)},i((function(){o.childImgEl=s.children("img"),o.childImgEl.length&&o.childImgEl[0]?o.$watch((function(){return o.childImgEl[0].src}),(function(){i.cancel(o.loadBGTimer),o.loadBGTimer=i((function(){o.loadBackground()}),1e3)})):(o.loadBackground(),o.enableWatch&&(o.parentNode=n.element(s[0].parentNode),o.$watch((function(){return{width:s.width(),height:s.height()}}),(function(e,t){e.width===t.width&&e.height===t.height||o.loadBackground()}),!0)))}))},scope:{imageSetElement:"=",loadHeight:"@",enableWatch:"@",loaderType:"@"}}}]).directive("imgSpacer",[function(){return{restrict:"A",link:function(e,t,i){var n="imgSpacer"+(new Date).getTime()+(9998*Math.random()+1);t.on("$destroy",(function(){a(window).off("resize."+n),e.$destroy()})),e.attrParams=i.imgSpacer,e.attrParams=e.attrParams.split(":"),e.params={};for(var r=e.attrParams.length;r--;){var o=e.attrParams[r].split("|");e.params[o[0]]=o[1]}e.images={"1x1":"data:image/gif;base64,R0lGODlhDwAPAIAAAP///wAAACH5BAEAAAAALAAAAAAPAA8AAAINhI+py+0Po5y02otnAQA7","2x1":"data:image/gif;base64,R0lGODlhHgAPAIAAAP///wAAACH5BAEAAAAALAAAAAAeAA8AAAIThI+py+0Po5y02ouz3rz7D4ZTAQA7","3x1":"data:image/gif;base64,R0lGODlhLQAPAIAAAP///wAAACH5BAEAAAAALAAAAAAtAA8AAAIYhI+py+0Po5y02ouz3rz7D4biSJbmiTYFADs=","4x1":"data:image/gif;base64,R0lGODlhPAAPAIAAAP///wAAACH5BAEAAAAALAAAAAA8AA8AAAIchI+py+0Po5y02ouz3rz7D4biSJbmiabqyrZrAQA7"},e.rewriteSet=function(){e.w=document.documentElement.clientWidth,e.set="a",e.w&&(e.set="a",e.w>463&&(e.set="b"),e.w>750&&(e.set="c"),e.w>970&&(e.set="d"),e.w>1170&&(e.set="e")),t[0].src=e.images[e.params[e.set]+"x1"],t[0].style.width="100%",t[0].style.height="auto"},e.rewriteSet(),a(window).on("resize."+n,(function(){e.t&&clearTimeout(e.t),e.t=setTimeout((function(){e.rewriteSet()}),Math.floor(400*Math.random())+100)}))},scope:{imgSpacer:"@"}}}]).directive("imgRatio",["mosconfig","$timeout","imgSrvc","imageSet","toolsSrvc","loaderIndicator",function(e,t,i,r,o,s){return{restrict:"A",link:function(e,l,c){var d="imgRatio"+(new Date).getTime()+(9998*Math.random()+1);l.on("$destroy",(function(){a(window).off("resize."+d),e.$destroy()})),e.images={"1x1":"data:image/gif;base64,R0lGODlhDwAPAIAAAP///wAAACH5BAEAAAAALAAAAAAPAA8AAAINhI+py+0Po5y02otnAQA7","2x1":"data:image/gif;base64,R0lGODlhHgAPAIAAAP///wAAACH5BAEAAAAALAAAAAAeAA8AAAIThI+py+0Po5y02ouz3rz7D4ZTAQA7","3x1":"data:image/gif;base64,R0lGODlhLQAPAIAAAP///wAAACH5BAEAAAAALAAAAAAtAA8AAAIYhI+py+0Po5y02ouz3rz7D4biSJbmiTYFADs=","4x1":"data:image/gif;base64,R0lGODlhPAAPAIAAAP///wAAACH5BAEAAAAALAAAAAA8AA8AAAIchI+py+0Po5y02ouz3rz7D4biSJbmiabqyrZrAQA7"},e.noAnimation="true"===c.noAnimation,e.attrParams=c.imgRatio,e.attrParams=e.attrParams.split(":"),e.params={};for(var m=e.attrParams.length;m--;){var u=e.attrParams[m].split("|");e.params[u[0]]=u[1]}e.parentNode=n.element(l[0].parentNode),e.removeLoader=function(){s.switchOff(e.parentNode[0])},e.firstStart=!0,e.getSrc=function(t){var a,o,l=e.images[t+"x1"];o=e.parentNode.width(),!e.noAnimation&&e.firstStart&&s.switchOn(e.parentNode[0]);var c="s";if(o>480&&(c="m"),o>800&&(c="b"),e.parentNode.height(o/t),n.isObject(e.imgSource)){if(n.isDefined(e.imgSource.src)&&i.testSrc(e.imgSource.src)){var d=i.isMarkupImage(e.imgSource.src);return/^(\/)|(http(s):\/\/)/.test(d)||(d="/"+d),d}return(a=i.testObj(e.imgSource,t+r.ratioMask+c)||i.testObj(e.imgSource,r.size[c]))?i.isMarkupImage(a):l}return l},e.restoreStyle=function(i){e.needForRestore=!1,t.cancel(e.needForRestoreTimer),e.noAnimation||e.removeLoader(),!e.noAnimation&&e.firstStart&&(e.firstStart=!1,o.hideContentArea(e.parentNode)),l[0].src=i,l[0].style.height="auto",e.noAnimation||o.showContentArea(e.parentNode)},e.brokenImageSrc=function(t){c.setBrokenImageSrc&&e.setBrokenImageSrc(t)},e.rewriteSet=function(){e.needForRestore=!0,l[0].style.width="100%";var i=new Image,a=e.params[e.ratio];i.src=e.getSrc(a),e.noAnimation&&(l[0].src=i.src),n.element(i).on("load",(function(){e.needForRestore&&(e.brokenImageSrc(!1),e.restoreStyle(i.src,a))})),n.element(i).on("error",(function(){i.src=e.images[a+"x1"],e.needForRestore&&(e.brokenImageSrc(!0),e.restoreStyle(i.src,a))})),e.needForRestoreTimer=t((function(){e.needForRestore&&(e.brokenImageSrc(!1),e.restoreStyle(i.src,a))}),1e4)},e.getRatio=function(){var e=document.documentElement.clientWidth,t="a";return e&&(t="a",e>463&&(t="b"),e>750&&(t="c"),e>970&&(t="d"),e>1170&&(t="e")),t},e.ratio=e.getRatio(),e.rewriteSet(),e.$watch((function(){return e.parentNode.width()}),(function(t,i){t!==i&&(e.ratio=e.getRatio(),e.parentNode.css({height:t/e.params[e.ratio],overflow:"hidden"}),l[0].style.height="100%",e.t&&clearTimeout(e.t),e.t=setTimeout((function(){e.rewriteSet()}),Math.floor(100*Math.random())+50))}))},scope:{imgRatio:"@",imgSource:"=",noAnimation:"@",setBrokenImageSrc:"=?"}}}]).name,_e=n.module("mosapp.extralistPopup",["mgcrea.ngStrap","mosapp","ngAnimate"]).directive("mosExtraListPopup",["$popover","$sce",function(e,t){return{restrict:"A",priority:0,link:function(i,a){var r,o=a.find(i.selector);i.extrasLength=o.length;var s=o.slice(0,i.max-1);(o=o.slice(i.max-1)).detach();var l=n.element('<span class="extraList__item extraList__item-more"><span class="extraList__link link-gray">'+i.moreTitle+"</span></span>"),c=e(l,{scope:i,content:t.trustAsHtml(o.toArray().map((function(e){return e.outerHTML})).join("")),html:!0,placement:"bottom",trigger:"manual",prefixEvent:"extraListPopup"});s.last().after(l),a.removeClass("extraList_hide-items"),l.on("mouseenter mouseover",(function(){c.show(),l.addClass("extraList_open"),clearTimeout(r)})),l.on("mouseleave",(function(){r=setTimeout((function(){c.hide(),l.removeClass("extraList_open")}),200)})),i.$on("extraListPopup.show",(function(e,t){t.$element.on("mouseenter mouseover",(function(){clearTimeout(r)})),t.$element.on("mouseleave",(function(){r=setTimeout((function(){c.hide(),l.removeClass("extraList_open")}),200)}))}))},scope:{max:"=",moreTitle:"@",selector:"@"}}}]).name,ke=n.module("newsCards.commonCard",[be,_e]).directive("commonCard",["imgSrvc",function(e){return{restrict:"EA",scope:{item:"="},link:function(t,i){function a(){if(n.isObject(t.item)){t.showCard=(t.item.title||t.item.image)&&t.item.href;var i=t.item.type;if(n.isObject(i)&&i.title&&(!i.place||t.typeEnum.indexOf(i.place)<0)&&(i.place=t.typeEnum[0]),(!t.item.modifier||t.modifierEnum.indexOf(t.item.modifier)<0)&&(t.item.modifier=t.modifierEnum[0]),n.isDefined(t.item.image)){t.imageRatio=t.item.imageRatio&&t.imageRatioEnum.indexOf(t.item.imageRatio)>-1?t.item.imageRatio:t.imageRatio;var a=n.isArray(t.item.image)&&n.isObject(t.item.image[0])?t.item.image[0]:t.item.image;if(Array.isArray(t.imageRatio))for(var r=0;r<t.imageRatio.length;r++){var o=e.testObj(a,t.imageRatio[r]);if(o){a=o;break}}else a=e.testObj(a,t.imageRatio);t.image=a||t.item.image}t.item.target=t.item.target||"_top"}}i.on("$destroy",(function(){t.$destroy()})),t.imageRatio=["2x1_m","small"],t.imageRatioEnum=["1x1_m","1x1_s","2x1_b","2x1_m","2x1_s","3x1_b","3x1_m","3x1_s","4x1_b","4x1_m","4x1_s","big","download","middle","original","show","small","thumb"],t.typeEnum=["lead","head"],t.modifierEnum=["default","highlight","strong","molding"],a(),t.$watch("item",(function(){a()}))},template:'<div class="commonCard" data-ng-if="showCard" data-ng-class="[\n    item.type.media,\n    {\n      \'commonCard-highlight\': item.modifier==\'highlight\',\n      \'commonCard-strong\': item.modifier==\'strong\',\n      \'commonCard-molding\': item.modifier === \'molding\',\n    },\n  ]"><a class="commonCard__link link-black" data-ng-href="{{item.href}}" target="{{item.target}}"><span class="commonCard__type" data-ng-if="item.type &amp;&amp; item.type.title &amp;&amp; item.type.place===\'head\'">{{item.type.title}}</span><span class="commonCard__image" data-ng-if="image &amp;&amp; item.image"><img data-ng-src="{{image}}" role="presentation" alt="{{item.title}}" title="{{item.title}}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}"/><span class="commonCard__label" data-ng-if="item.label &amp;&amp; item.modifier !== \'molding\'">{{item.label}}</span><span class="commonCard__typeicon" data-ng-if="item.typeicon &amp;&amp; item.type.media !== \'infographic\'" aria-hidden="true"><svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{{item.typeicon}}"></use></svg><span class="commonCard__info" data-ng-if="item.info">{{item.info}}</span></span></span><span class="commonCard__moldingLabel" data-ng-if="item.label &amp;&amp; item.modifier === \'molding\'"><span class="moldingLabel__text">{{item.label}}</span><div class="moldingLabel__star" ng-if="item.hasStar"></div></span><div class="commonCard__text"><span class="commonCard__extra extraList" ng-if="(item.type &amp;&amp; item.type.title &amp;&amp; item.type.place===\'lead\') || item.icon || (item.extra &amp;&amp; item.extra.length)"><span class="commonCard__type" data-ng-if="item.type &amp;&amp; item.type.title &amp;&amp; item.type.place===\'lead\'">{{item.type.title}}</span><em class="extraList__icon" ng-if="item.icon" ng-bind-html="item.icon"></em><span class="extraList__item" ng-class="{\'extraList__item-icon\':item.icon}" ng-repeat="extraitem in item.extra">{{extraitem.title}}</span></span><br/><span class="commonCard__title" data-ng-if="item.title" data-ng-class="{\n        \'commonCard__title_extra-padding\': !item.extra || !item.extra.length\n      }">{{item.title}}</span></div></a></div>'}}]).name,xe=n.module("newsCards.raionCard",[be]).directive("raionCard",["imgSrvc",function(e){return{restrict:"EA",scope:{item:"="},link:function(t,i){if(i.on("$destroy",(function(){t.$destroy()})),n.isObject(t.item)){t.imageRatio=["2x1_m","small"],t.imageRatioEnum=["1x1_m","1x1_s","2x1_b","2x1_m","2x1_s","3x1_b","3x1_m","3x1_s","4x1_b","4x1_m","4x1_s","big","download","middle","original","show","small","thumb"],t.typeEnum=["lead","head"],t.modifierEnum=["default","highlight","strong","molding"],t.showCard=(t.item.title||t.item.image)&&t.item.href;var a=t.item.type;if(n.isObject(a)&&a.title&&(!a.place||t.typeEnum.indexOf(a.place)<0)&&(a.place=t.typeEnum[0]),(!t.item.modifier||t.modifierEnum.indexOf(t.item.modifier)<0)&&(t.item.modifier=t.modifierEnum[0]),n.isDefined(t.item.image)){t.imageRatio=t.item.imageRatio&&t.imageRatioEnum.indexOf(t.item.imageRatio)>-1?t.item.imageRatio:t.imageRatio;var r=n.isArray(t.item.image)&&n.isObject(t.item.image[0])?t.item.image[0]:t.item.image;if(Array.isArray(t.imageRatio))for(var o=0;o<t.imageRatio.length;o++){var s=e.testObj(r,t.imageRatio[o]);if(s){r=s;break}}else r=e.testObj(r,t.imageRatio);t.image=r||t.item.image}t.item.target=t.item.target||"_top"}},template:'<div class="raionCard" data-ng-if="showCard"><a class="raionCard__link link-black" data-ng-href="{{item.href}}" target="{{item.target}}"><span class="raionCard__image" data-ng-if="image &amp;&amp; item.image"><picture><source srcset="{{image.double}}" media="{{image.media}}"/><source srcset="{{image.single}}"/><img data-ng-src="{{image.single}}" alt="{{item.title}}" title="{{item.title}}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}"/></picture></span><div class="raionCard__text"><span class="raionCard__extra extraList" ng-if="(item.type &amp;&amp; item.type.title &amp;&amp; item.type.place===\'lead\') || item.icon || (item.extra &amp;&amp; item.extra.length) || (item.label &amp;&amp; item.modifier === \'molding\')"><span class="raionCard__type" data-ng-if="item.type &amp;&amp; item.type.title &amp;&amp; item.type.place===\'lead\'">{{item.type.title}}</span><em class="extraList__icon" ng-if="item.icon" ng-bind-html="item.icon"></em><span class="extraList__item" ng-class="{\'extraList__item-icon\':item.icon}" ng-repeat="extraitem in item.extra">{{extraitem.title}}</span></span><br/><span class="raionCard__title" data-ng-if="item.title">{{item.title}}</span></div></a></div>'}}]).name,Ce=/([.$?*|{}()[\]\\/+^])/g;function Ae(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(Ce,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}var Se=n.module("mosapp.blackAndWhite",[]),$e=Se.name;Se.directive("blackAndWhite",[function(){return{restrict:"A",link:function(e){function t(){if(i()){var e,t,a,n=localStorage.getItem("contrast");n&&"true"===n||"Y"===Ae("EVP_blindVersion")?(e="false",t="N"):(e="true",t="Y"),localStorage.setItem("contrast",e),document.cookie="EVP_blindVersion="+t+"; path=.mos.ru; domain=.mos.ru; expires=0",(window.opera||window.webkit)&&onStorage(),function(){if(i()){var e=localStorage.getItem("contrast"),t=Ae("EVP_blindVersion");e&&"true"===e||"Y"===t?(a=document.getElementsByTagName("html")[0],n="contrast","true"===localStorage.getItem("contrast")?a.classList?a.classList.add(n):a.className+=" contrast":a.classList.remove(n)):function(){var e=document.getElementsByTagName("html")[0],t="contrast";e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}()}var a,n}(),window.CustomEvent?a=new CustomEvent("contrastTrigger",{detail:{contrast:e}}):(a=document.createEvent("CustomEvent")).initCustomEvent("contrastTrigger",!0,!0,{contrast:e}),window.dispatchEvent(a)}}function i(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}e.$on("$destroy",(function(){a("body").off("click","#contrastlink",t)})),a("body").on("click","#contrastlink",t)}}}]),i.p;var Me=n.module("mosapp.horizontalLinkList",["angular-click-outside"]).directive("horizontalLinkList",["$timeout",function(e){return{restrict:"A",priority:0,link:function(t,i){function n(){t.closeMoreNav(),e.cancel(t.bounceTimer),t.bounceTimer=e((function(){t.widthLT768=d&&d.mq("(max-width: 767px)"),t.widthLT768,t.widthLT768?(t.isWideScreen=!1,t.maxIndex=t.list.length-1,t.showMore=!1,t.$themesMenu.hasClass("mCustomScrollbar")?t.$themesMenu.mCustomScrollbar("update"):t.$themesMenu.mCustomScrollbar({axis:"x",scrollInertia:600,autoHideScrollbar:!0,scrollButtons:{enable:!1},advanced:{updateOnContentResize:!0,autoUpdateTimeout:100,autoExpandHorizontalScroll:!0},documentTouchScroll:!0,keyboard:{enable:!1}})):function(){t.isWideScreen=!0,t.$themesMenu.hasClass("mCustomScrollbar")&&t.$themesMenu.mCustomScrollbar("destroy");var i=t.$themesMenuList.width();t.$themesMenuList.css("width",i),t.maxIndex=t.list.length-1,t.$moreButton.css("opacity",0),t.showMore=!0,e((function(){var i=t.$themesWrapper.innerWidth()-t.$moreButton.innerWidth(),a=r(t.$themesMenuList.find(".hor-link-list-menu__item"),t.list,i);void 0!==a&&(t.maxIndex=a),e((function(){t.$themesMenuList.css("width",""),t.showMore=t.maxIndex<t.list.length-1,t.$moreButton.css("opacity","")}))}))}()}),100)}function r(e,t,i){for(var n,r=0,o=0;o<t.length;o++)if((r+=a(e[o]).innerWidth())>i&&o<t.length-1){n=o-1;break}return n}t.getMaxIndex=r,i.on("$destroy",(function(){a(window).off("resize.themes"),t.$destroy()})),i[0].classList.add("hor-link-list"),t.list=[],t.showMore=!1,t.moreButtonClick=function(){t.isMoreNavOpen=!t.isMoreNavOpen},t.closeMoreNav=function(){t.isMoreNavOpen=!1},t.items&&(t.list=t.items.slice(),t.maxIndex=t.list.length-1,t.$themesMenu=i.find(".hor-link-list-menu"),t.$themesMenuList=i.find(".hor-link-list-menu__items"),t.$themesWrapper=i.find(".hor-link-list__wrapper"),t.$moreButton=i.find(".hor-link-list__item_more"),n(),a(window).off("resize.themes").on("resize.themes",n))},scope:{title:"@",items:"="},template:'<div class="hor-link-list__wrapper"><div class="hor-link-list__flex"><div class="hor-link-list-menu" data-ng-class="{\'hor-link-list-menu__open\': isMoreNavOpen}"><ul class="hor-link-list-menu__items" data-ng-class="{\'hor-link-list-menu__items-wide\':isWideScreen,\'hor-link-list-menu__items-narrow\':!isWideScreen}"><li class="hor-link-list-menu__item" data-ng-repeat="link in list track by $index" data-ng-if="$index &lt;= maxIndex"><a class="hor-link-list-menu__link" data-ng-href="{{link.href}}" target="_top">{{ link.title }}</a></li></ul><div class="dropdown hor-link-list__dropdown hor-link-list-menu__item" data-ng-hide="!isWideScreen"><span class="hor-link-list__item_more hor-link-list-menu__link visible-xs-inline" id="hor-link-list-more" data-ng-show="showMore" data-ng-click="moreButtonClick($event)">{{title}}</span><div class="dropdown-menu-custom" click-outside="closeMoreNav()" outside-if-not="hor-link-list-more" data-ng-click="$event.stopPropagation()" data-ng-class="{\'dropdown-menu-custom__open\': isMoreNavOpen}"><ul class="hor-link-list__dropdown-menu"><li class="hor-link-list__dropdown-menu__item" data-ng-repeat="item in list track by $index" data-ng-if="$index &gt; maxIndex"><a class="hor-link-list__dropdown-menu__item-link" target="_top" data-ng-href="{{item.href}}">{{ item.title }}</a></li></ul></div></div></div></div></div>'}}]).name,De=(i.p,angular.module("mosapp.filters.typeaheadHighlight",[]).filter("typeaheadHighlight",["$sce","$injector","$log",function(e,t,i){var a;return a=t.has("$sanitize"),function(t,n){return!a&&function(e){return/<.*>/g.test(e)}(t)&&i.warn("Unsafe use of typeahead please use ngSanitize"),t=n?(""+t).replace(new RegExp(n.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"gi"),"<strong>$&</strong>"):t,a||(t=e.trustAsHtml(t)),t}}]).name),Oe=n.module("mosapp.search",["mgcrea.ngStrap",De,"mosapp"]).run(["$templateCache",function(e){e.put("search/template/typeahead.html",'<ul class="typeahead dropdown-menu" tabindex="-1" ng-show="$isVisible()" role="select" aria-hidden="true"><li role="presentation" ng-repeat="match in $matches" ng-class="{active: $index == $activeIndex &amp;&amp; !match.totalCount, totalCount: match.totalCount}"><div role="menuitem" tabindex="-1" ng-if="!match.totalCount" ng-click="$select($index, $event)"><span class="typeahead-item__label" ng-bind-html="match.label | typeaheadHighlight:oldSearchQuery"></span><span class="typeahead-item__extra" ng-if="match.extra">&nbsp;{{match.extra}}</span></div><div role="menuitem" tabindex="-1" ng-if="match.totalCount">{{ "mainSearch.andMore" | translate }} {{match.totalCount}} {{ match.resultsKey | translate }}. <a class="link-blue" data-ng-click="formSubmit()" href="">&nbsp;{{ "mainSearch.showMore" | translate }}</a></div></li></ul>')}]).directive("mosSearch",["$timeout","mosconfig","LangSrvc","UrlSrvc","$typeahead","apiSrvc","$$rAF","$window","toolsSrvc",function(e,t,i,r,o,s,l,c,d){return{restrict:"A",priority:0,link:function(l,m){var u=t.searchPath.search,p=a(m).find(".newsapp-search__input");l.isBlur=!0,l.inputPlaceholder=l.placeholder,l.lang=i.getCurrentLang(),l.oldSearchQuery="",l.cacheQuery=[],l.matches=[],m[0].classList.add("newsapp-search"),l.buildSearchUrl=g,l.setQueryVal=function(){var e=p.val().trim();l.query=encodeURIComponent(e)},l.setQueryVal(),l.onFocus=function(){l.isBlur=!1,l.focusPlaceholder&&(l.inputPlaceholder=l.focusPlaceholder)},l.onBlur=function(){l.inputPlaceholder=l.placeholder,l.isBlur||(l.isBlur=!0,e((function(){p.trigger("blur")}),100))},"on"===l.searchAutoComplete?l.autocomplete=!0:l.autocomplete=!1;var f=o(p,p.controller("ngModel"),{scope:l,templateUrl:"search/template/typeahead.html",onSelect:function(e,t){l.searchQuery=e;var i=l.matches&&l.matches[t]&&l.matches[t].url;l.query=encodeURIComponent(l.searchQuery),l.formSubmit(i,l.query)}});function g(){var e=c.location.href,t=u.replace("%category%",l.type||"common");return r.getLangLink(r.pagePath(l.searchUrl,t+l.query+"&referer="+encodeURIComponent(e)+"/"))}f.select=function(e){if(-1!==e){var t=f.$scope.$matches[e].value;l.$emit(f.$options.prefixEvent+".select",t,e,f),n.isDefined(f.$options.onSelect)&&n.isFunction(f.$options.onSelect)&&f.$options.onSelect(t,e,f)}},f.$onKeyDown=function(e){if(/(38|40)/.test(e.keyCode)){var t=f.$scope;38===e.keyCode?t.$activeIndex>0?(t.$activeIndex--,i()):0===t.$activeIndex?(t.$activeIndex--,l.searchQuery=l.oldSearchQuery):t.$activeIndex<0&&(t.$activeIndex=t.$matches.length-1,i()):40===e.keyCode?t.$activeIndex<t.$matches.length-1?(t.$activeIndex++,i()):t.$activeIndex===t.$matches.length-1&&(t.$activeIndex=-1,l.searchQuery=l.oldSearchQuery):n.isUndefined(t.$activeIndex)&&(t.$activeIndex=0),f.$$updateScrollTop(f.$element[0],t),l.$digest()}function i(){var e=t.$matches[t.$activeIndex];e&&(l.searchQuery=e.label)}},l.filloutNewsSugest=function(e){var t=e&&e.data&&e.data.data;t&&t.length&&f.update(t.map((function(e){return{label:e.answer,value:e.answer}})))},l.filloutAfishaSugest=function(e){var t=e&&e.data&&e.data.results;if(t&&t.length){var i=t.map((function(e){var t=e.sphere_title,i=e.place_title,a=t+(t&&i?", ":"")+i;return a=a?"("+a+")":"",{label:e.title,value:e.title,extra:a,url:e.url}}));if(e.data._meta&&e.data._meta.totalCount){var a=d.localeNum(e.data._meta.totalCount,["resultOne","resultFew","resultMany"]),n={totalCount:e.data._meta.totalCount,resultsKey:"mainSearch."+a};i.push(n)}l.matches=i,f.update(i)}},l.onChange=function(){l.setQueryVal(),l.searchQuery||f.update([]),l.oldSearchQuery=l.searchQuery;var e={query:l.searchQuery};"afisha"===l.type&&(e.filter_range={date_to_timestamp:{gte:parseInt(Date.now()/1e3,10)}}),l.searchQuery.length>=3&&s.getData("suggest",l.type,e).then((function(e){"afisha"===l.type?l.filloutAfishaSugest(e):l.filloutNewsSugest(e)}))},l.formSubmit=function(e,t){if(t||l.setQueryVal(),""===l.query&&!e)return!1;var i=e;if(!i){if(i=g(),-1!==l.cacheQuery.indexOf(l.query))return;l.cacheQuery.push(l.query)}c.location.href=i},l.clear=function(){l.searchQuery=""}},scope:{button:"@",placeholder:"@",focusPlaceholder:"@",type:"@"},template:'<div class="newsapp-search__container"><i class="newsapp-search__search-icon" ng-click="formSubmit()"></i><form class="newsapp-search__wrapper" data-ng-submit="formSubmit()" name="searchForm" data-ng-class="{\'newsapp-search__wrapper_filled\': query.length &gt; 0}"><input class="newsapp-search__input s-autocompl-input" type="text" name="query" value="" autocomplete="off" placeholder="{{inputPlaceholder}}" data-ng-model="searchQuery" data-ng-change="onChange()" data-ng-focus="onFocus()" data-ng-blur="onBlur()" id="mos-main-page-search" ng-class="{\'newsapp-search__input_focused\': !isBlur}"/><i class="newsapp-search__clear-icon" ng-click="clear()"></i><button class="newsapp-search__button" data-ng-click="formSubmit()" type="submit">{{button}}</button></form></div>'}}]).name,Pe=n.module("mainHead",[Me,Oe]).controller("MainHeadController",["$scope",function(e){e.links=window.config.themes}]).name,Te=(i.p,i.p,angular.module("mosapp.fields.checkbox",[]).directive("mosCheckbox",[function(){return{restrict:"AE",require:["mosCheckbox","?ngModel"],scope:{label:"@",onChange:"&"},controller:"MosCheckboxController",controllerAs:"ctrl",template:'<div class="mos-checkbox" ng-class="{\'mos-checkbox_checked\': ctrl.value}"><label class="mos-checkbox__label" ng-click="ctrl.clicked($event)"><div class="mos-checkbox__mark"></div><span>{{ label }}</span></label></div>',link:function(e,t,i,a){var n=a[0],r=a[1];n.init(r)}}}]).controller("MosCheckboxController",["$scope",function(e){var t,i=this;e.displayField=e.displayField||"title",i.selected=null,i.init=function(e){var a=(t=e).$render;t.$render=function(){a(),i.value=t.$modelValue},t.$processModelValue()},i.clicked=function(){i.value=!i.value,t.$setViewValue(i.value),t.$processModelValue(),e.onChange({value:i.value})}}]).name),Ee=angular.module("afishaMain.events.filter.service",[]).service("eventsFilterSrvc",["$stateParams","$filter","toolsSrvc","$state",function(e,t,i,a){var n=this,r=[],o={},s="afisha",l="dd.MM.yyyy";function c(e){e.from&&(e.from=t("date")(e.from,l)),e.to&&(e.to=t("date")(e.to,l))}function d(e){var t=n.normalizeParams(o,r,e);t.page=null,a.go(n.generateState(t,r,s),t)}this.getParams=function(){return o},this.init=function(t,i,a){r=i,s=t,o={},c(o=a?angular.extend({},n.parseParams(e),a):e),o.page||(o.page=1)},this.setState=function(e){c(o=angular.extend({},o,e))},this.getDateForCalendar=function(){return{from:t("date")(o.from,"yyyy-MM-dd"),to:t("date")(o.to,"yyyy-MM-dd")}},this.getParam=function(e){return o[e]},this.getParams=function(){var e=angular.extend({},o);for(var t in e)if("from"!==t&&"to"!==t)e[t]=""!==e[t]?e[t]:"all","all"!==e[t]&&""!==e[t]||delete e[t];else{var a="from"===t;e[t]=""!==o[t]?i.compileDate(i.ruStrToDate(e[t]),a):e[t]}return e},this.setParams=function(e){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var a in e=angular.copy(e))angular.isArray(e[a])&&!e[a].length&&(e[a]="all");if(o=angular.extend({},e),e.period){var n=e.period;delete o.today,delete o.tomorrow,delete o.week,delete o.from,delete o.to,delete o.anytime,["today","tomorrow","week","anytime"].indexOf(n.mode)>-1?o[n.mode]=!0:(o.from=t("date")(n.from,l)||null,o.to=t("date")(n.to,l)||null)}d(i)},this.generateState=function(e,t,i){for(var a="",n=t.length;n--;){var r=t[n];e[r]&&["today","tomorrow","week","period","anytime"].indexOf(r)<0&&(a+="."+r),"period"===r&&e.from&&e.to&&(a+="."+r),["today","tomorrow","week","anytime"].indexOf(r)>-1&&e[r]&&(a+="."+r)}return i+a},this.normalizeParams=function(e,t,i){for(var a=0,n=0;n<t.length;n++){var r=t[n];if(e[r]&&"all"!==e[r])break;a=n}a<n&&(t=t.slice(n));var o={};e.from&&(o.from=e.from),e.to&&(o.to=e.to);for(var s=0;s<t.length;s++){var l=t[s];if(["today","tomorrow","week","period","anytime"].indexOf(l)>-1)e[l]&&(o[l]=e[l]);else if(e[l]&&"all"!==e[l])if("free"===l&&e[l])o[l]="free";else{var c=e[l];Array.isArray(c)?c.length&&(o[l]=c.join("|")):o[l]=c}else o[l]="all"}return i&&(Object.keys(o.period).length||o.district||o.area)&&!o.period.from&&!o.period.to&&(o.anytime=!0),o},this.parseParams=function(e){var t=angular.extend({},e);for(var i in e){var a=e[i];"string"==typeof a&&a.indexOf("|")>-1&&(t[i]=a.split("|"))}return t}}]).name,Fe=i(7339);function Ie(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var Le={period:"Период",daytime:"Время",auditory:"Тип мероприятия",sphere:"Сфера",department:"Департамент",district:"Округ",area:"Район",place:"Площадка",free:"Бесплатные"},je="dd.MM.yyyy",ze=angular.module("events.filter",[Te,Y,U,Ee]).directive("eventsFilter",[function(){return{restrict:"AE",scope:{model:"=",onInit:"&",onChange:"&",onApply:"&",filterType:"=",filterLang:"=",isButtonApplyDisabled:"=",metricKey:"="},controller:"EventsFilterController",controllerAs:"ctrl",template:'<div class="events-filter"><div class="events-filter__wrap"><div class="events-filter__item events-filter__item--item1"><mos-period label="\'Период\'" ng-model="ctrl.filter.period" ng-change="ctrl.changed(\'period\')" data-presets="ctrl.periodPresets" placement="\'bottom-left\'" placement-to="\'bottom-right\'" min-date="ctrl.minDate" max-date="ctrl.maxDate" filter-type="filterType" filter-lang="filterLang" range-mode="true" data-testid="filter-period"></mos-period></div><div class="events-filter__item events-filter__item--item2" ng-if="filterType === \'afisha\'"><mos-select ng-model="ctrl.filter.daytime" ng-change="ctrl.changed(\'daytime\')" data-options="daytimes" data-label="В любое время" data-testid="filter-daytime"></mos-select></div><div class="events-filter__item events-filter__item--item3" ng-if="filterType === \'afisha\'"><mos-select class="mos-select__multi" ng-model="ctrl.filter.auditory" ng-change="ctrl.changed(\'auditory\')" data-multiple="true" data-options="auditories" data-label="Тип мероприятия" data-default-option="\'Все типы мероприятий\'" data-testid="filter-auditory"></mos-select></div><div class="events-filter__item"><mos-select class="mos-select__multi" ng-model="ctrl.filter.sphere" ng-change="ctrl.changed(\'sphere\')" data-multiple="true" data-options="spheres" data-label="{{ \'eventsFilter.sphere\' | translate }}" data-default-option="\'Все сферы\'" data-testid="filter-sphere"></mos-select></div><div class="events-filter__item" ng-if="filterType === \'news\' &amp;&amp; filterLang ===\'ru\'"><mos-select class="mos-select__multi" ng-model="ctrl.filter.department" ng-change="ctrl.changed(\'department\')" data-multiple="true" data-options="departments" data-label="Департамент" data-default-option="\'Все департаменты\'" data-testid="filter-department"></mos-select></div><div class="events-filter__item"><mos-select class="mos-select__multi" ng-model="ctrl.filter.district" data-multiple="true" ng-change="ctrl.districtChanged(ctrl.filter.district)" data-options="districts" data-display-field="{{displayField}}" data-label="{{ \'eventsFilter.district\' | translate }}" data-default-option="\'Все округа\'" data-testid="filter-district"></mos-select></div><div class="events-filter__item"><mos-select class="mos-select__multi" data-disabled-field="ctrl.disabledArea" data-sorting-field="\'title\'" ng-model="ctrl.filter.area" ng-change="ctrl.changed(\'area\')" data-multiple="true" data-options="areas" data-display-field="{{displayField}}" data-label="{{ \'eventsFilter.area\' | translate }}" data-default-option="\'Все районы\'" data-testid="filter-area"></mos-select></div><div class="events-filter__item events-filter__item--last" ng-if="filterType === \'afisha\'"><mos-select class="mos-select__multi" ng-model="ctrl.filter.place" ng-change="ctrl.changed(\'place\')" data-multiple="true" data-options="places" data-label="Площадка" data-default-option="\'Все площадки\'" data-testid="filter-place"></mos-select></div></div><div class="events-filter__wrap-buttons"><div class="events-filter__item events-filter__item--checkbox" ng-if="filterType === \'afisha\'"><mos-checkbox label="{{ \'eventsFilter.seeFree\' | translate }}" ng-model="ctrl.filter.free" ng-change="ctrl.changed(\'free\')"></mos-checkbox></div><div class="events-filter__button"><button class="events-filter__btn-select" ng-click="ctrl.applyClicked()" data-translate="{{!ctrl.filterUsed ? \'eventsFilter.select\' : \'eventsFilter.selectAgain\'}}" ng-disabled="isButtonApplyDisabled" data-testid="{{filterType}}-filter-button"></button></div><div class="events-filter__button events-filter__button--clear" ng-if="ctrl.filterUsed"><button class="events-filter__btn-clear" ng-click="ctrl.clear()" data-translate="eventsFilter.clearFilter"></button></div></div></div>',link:function(e,t,i,a){e.$on("clear-filter",a.clear)}}}]).controller("EventsFilterController",["$scope","$q","apiSrvc","$element","$timeout","$filter",function(e,t,i,a,n,r){var o=this;e.displayField="ru"===e.filterLang?"title":"title_en";var s={daytimes:{apiMod:"newsfeed",apiKey:"daytimes",params:{},transform:function(e){return e.filter((function(e){return!!e.id}))}},spheres:{apiMod:"newsfeed",apiKey:"spheres",params:{fields:"id,title",filter:{},"per-page":50},transform:function(e){return e.map((function(e){return e.id=""+e.id,e}))}},departments:{apiMod:"department",apiKey:"all",params:{fields:"id,name,lead_institution_id",filter:{"frame.level":0,"frame.type":"institution"},"per-page":50,sort:"name"},transform:function(e){return e.map((function(e){return e.id=""+e.id,e.title=e.name,e}))}},districts:{apiMod:"directories",apiKey:"districts",params:{fields:"id,title,title_en"},transform:function(e){return e.map((function(e){return e.id=""+e.id,e}))}},areas:{apiMod:"directories",apiKey:"areas",params:{fields:"id,title,title_en"},transform:function(e){return e.map((function(e){return e.id=""+e.id,e}))}},auditories:{apiMod:"newsfeed",apiKey:"auditories",params:{},transform:function(e){return e.map((function(e){return e.id=""+e.id,e}))}},places:{apiMod:"newsfeed",apiKey:"place_types",transform:function(e){return e.map((function(e){return e.id=""+e.id,e}))}}};function l(){o.widthLT768=Modernizr&&Modernizr.mq("(max-width: 767px)"),o.widthLT768}function c(){var a=t.defer(),n=[],r=0;return Object.keys(s).forEach((function(t){var o=s[t];n.push(i.getAllPages(o.apiMod,o.apiKey,angular.copy(o.params)).then((function(i){e[t]=o.transform?o.transform(i):i,"departments"===t&&(e[t]=e[t].sort((function(e){return e.lead_institution_id?1:-1})))})).finally((function(){(r+=1)===n.length&&a.resolve()})))})),a.promise}function d(){if(!(window.innerWidth<1366)){var t=a.closest(".events-block__container").get(0).getBoundingClientRect(),i=t.top,n=t.height,r=t.bottom,o=a.find(".events-filter"),s="afisha"===e.filterType?750:600;n<800||(i<100?(o.addClass("fixed"),r<s?o.css("top",20-(s-r)+"px"):o.css("top","")):(o.removeClass("fixed"),o.css("top","")))}}function m(){var e=a.find(".events-filter");e.removeClass("fixed"),e.css("top","")}function u(e,t){if(!e.length||!t||0===t.length)return"";var i=e.filter((function(e){return Array.isArray(t)?t.includes(e.id):e.id===t})).map((function(e){return e.title}));return i.length?1===i.length?i[0]:i:""}"afisha"===e.filterType?s.spheres.params.filter.in_event=1:s.spheres.params.filter.in_article=1,o.filter=e.model||{auditory:null,daytime:null,district:[],free:null,place:null,sphere:null,department:null,period:null,area:null},o.periodPresets="afisha"===e.filterType?[{code:"today",title:"Сегодня"},{code:"tomorrow",title:"Завтра"},{code:"week",title:"Неделя"}]:[],o.minDate="afisha"===e.filterType?new Date:null,o.maxDate="news"===e.filterType?new Date:null,o.disabledArea=!1,o.scrollHandlerAttached=!1,e.$watch("model",(function(e){var t,i;t=o.filter,i=e,Object.keys(i).reduce((function(e,a){if(e)return!0;if("period"===a){var n=t[a].from||"all",r=i[a].from||"all",o=t[a].to||"all",s=i[a].to||"all";return n!==r||o!==s||e}return(t[a]||"all")!==(i[a]||"all")||void 0}),!1)?(o.filter=e,o.filterUsed=!0):o.filter=e})),e.$on("date-range-selected",(function(t,i){i.from&&i.to&&e.$broadcast("toggle-datepicker",{mod:"from",isOpen:!1})})),e.$on("events-fetched",(function(){n((function(){o.scrollHandlerAttached||(window.addEventListener("scroll",d),o.scrollHandlerAttached=!0)}),200)})),a.on("$destroy",(function(){Fe(window).off("resize.main-news"),window.removeEventListener("scroll",d),e.$destroy()})),o.applyClicked=function(){var t,i=angular.copy(o.filter.period);if(i.to&&!i.from)if("news"===e.filterType){var a=i.to.getMonth(),n=i.to.getYear(),r=i.to.getDate();if(r<14){var s=13-r;r=1==(a-=1)?n%4==0?29-s:28-s:[0,2,4,6,7,9,11].includes(a)?31-s:30-s}else r-=14;var l=new Date(i.to.setMonth(a)).setDate(r);o.filter.period.from=new Date(l)}else o.filter.period.from=new Date;if(i.from&&!i.to){var c=i.from.getMonth()+1;12===c&&(c=0,i.from.setFullYear(i.from.getFullYear()+1)),o.filter.period.to="afisha"===e.filterType?new Date(i.from.setMonth(c)):new Date}o.filterUsed=!0,m(),window.removeEventListener("scroll",d),o.scrollHandlerAttached=!1,t={daytime:u(e.daytimes,o.filter.daytime),auditory:u(e.auditories,o.filter.auditory),sphere:u(e.spheres,o.filter.sphere),department:u(e.departments,o.filter.department),district:u(e.districts,o.filter.district),area:u(e.areas,o.filter.area),place:u(e.places,o.filter.place)},e.onApply({filter:o.filter,key:undefined,filterTitles:t})},o.clear=function(){o.filterUsed=!1,o.filter={cleared:!0},delete s.areas.params.filter,e.onApply({filter:o.filter,key:"all"}),e.$broadcast("reset-datepicker"),m(),c(),window.removeEventListener("scroll",d),o.scrollHandlerAttached=!1},o.districtChanged=function(a){var n,r,l,c;o.changed("district"),o.filter.district.length?(o.filter.area=null,s.areas.params.filter={district_id:a}):(o.filter.area=null,delete s.areas.params.filter),delete s.areas.params.page,delete s.departments.params.page,s.areas.promise&&s.areas.promise.cancel(),s.areas.promise=(l=s.areas,(c=t((function(t,a){n=t,i.getAllPages(l.apiMod,l.apiKey,angular.copy(l.params)).then((function(i){r||(e.areas=l.transform?l.transform(i):i,o.disabledArea=!i.length,t())})).catch((function(){a()}))}))).cancel=function(){r=!0,n()},c)},o.changed=function(t){if(e.onChange(),e.metricKey){var i;if("period"===t){var a=o.filter[t].from?"c ".concat(r("date")(o.filter[t].from,je)," "):"",n=o.filter[t].to?"по ".concat(r("date")(o.filter[t].to,je)):"";i="".concat(a).concat(n).trim()}else i=o.filter[t];var s=Le[t];"boolean"==typeof i?i=i?"Да":"Нет":Array.isArray(i)&&(i=i.join(",")),ne.sendStat(function(t,i){return Ie({},e.metricKey,Ie({},me,Ie({},ue,Ie({},t,i))))}(s,i))}},c().then((function(){e.onInit()})),l(),Fe(window).off("resize.afisha-filter").on("resize.afisha-filter",l)}]).name,Be=angular.module("events.list",[]).directive("eventsList",[function(){return{restrict:"EA",scope:{pages:"=",filterType:"=",itemClick:"&"},template:'<div class="events-list"><div class="events-list__page page-{{$index + 1}}" data-ng-repeat="page in pages"><div class="events-list__material news-col-md-4 item-{{itemIndex + 1}}" data-ng-repeat="(itemIndex, item) in page.items"><afisha-card data-item="item" data-item-index="itemIndex + 1" data-page-index="$parent.$parent.$index + 1" ng-if="filterType === \'afisha\'" data-click="itemClick({ $event, item, index: $index })"></afisha-card><article-card data-item="item" data-item-index="itemIndex + 1" data-page-index="$parent.$parent.$index + 1" ng-if="filterType === \'news\'" data-click="itemClick({ $event, item, index: $index })"></article-card></div></div></div>',link:function(){}}}]).name,Re=i(7339);function Ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function He(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function qe(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?He(Object(i),!0).forEach((function(t){Ve(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):He(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Ve(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var We=qe(qe({},Le),{},{dateFrom:"Период с",dateTo:"Период по"}),Ue=angular.module("events",[ze,Be,J,X,G]).directive("eventsBlock",[function(){return{restrict:"AE",scope:{filterType:"@",filterLang:"@?",metricKey:"@?"},controller:"EventsBlockController",controllerAs:"ctrl",template:'<div class="events-block"><div class="events-block__title"><h2 class="events-block__title-text" data-translate="{{ filterType + \'Main.eventsBlock.title\' }}" tabindex="-1"></h2><div class="events-block__title-toggle-filter" ng-click="ctrl.toggleFilter($event)"><span>{{ filterType + \'Main.eventsBlock.select\' | translate }}</span><span>{{ filterType + \'Main.eventsBlock.select\' | translate }} {{ filterType + \'Main.eventsBlock.materials \' | translate }}</span></div></div><div class="events-block__container"><events-filter class="events-block__filter news-col-xl-3" model="ctrl.modelFilter" data-filter-type="filterType" data-filter-lang="filterLang" is-button-apply-disabled="ctrl.isButtonApplyDisabled" metric-key="metricKey" on-init="ctrl.filterInited()" on-change="ctrl.filterChanged()" on-apply="ctrl.filterApplied(filter, key, filterTitles)"></events-filter><div class="events-block__content news-col-xl-9" data-ng-class="{loading: ctrl.getDataProcess}"><h3 class="sr-only" tabindex="-1" id="events-block-results">{{ \'eventsBlock.results\' | translate }}</h3><div class="events-block__list"><events-list data-ng-if="ctrl.materialsStore" data-pages="ctrl.materialsStore" data-filter-type="filterType" data-item-click="ctrl.itemClicked($event, item)"></events-list></div><div class="events-block__notfound" data-ng-if="ctrl.notFound"><div class="events-block__notfound-icon"></div><div class="events-block__notfound-text" data-translate="{{ filterType + \'Main.eventsBlock.notFound\' }}"></div><div class="events-block__notfound-link" data-translate="eventsFilter.clearFilter" ng-click="ctrl.resetFilters()"></div></div><div class="events-block__error" data-ng-if="ctrl.searchError"><div class="events-block__error-icon"></div><div class="events-block__error-text" data-translate="{{ filterType + \'Main.eventsBlock.searchError\' }}"></div><div class="events-block__error-link" data-translate="{{ filterType + \'Main.eventsBlock.repeatRequest\' }}" ng-click="ctrl.filterChanged(ctrl.modelFilter)"></div></div><div class="events-block__button" data-ng-if="ctrl.pagination.currentPage &lt; ctrl.pagination.pageCount &amp;&amp; !ctrl.notFound"><hr aria-hidden="true"/><mos-button class="events-block__more" data-on-click="ctrl.moreClicked($event)" data-href="{{ ctrl.urlMore }}" data-label="{{ filterType + \'Main.eventsBlock.seeMore\' | translate }}"></mos-button><hr aria-hidden="true"/></div></div></div></div>',link:function(){}}}]).controller("EventsBlockController",["$scope","$state","$stateParams","$transitions","$location","$httpParamSerializer","eventsFilterSrvc","$element","$filter","toolsSrvc","apiSrvc","$sce","UrlSrvc","MaterialsUtilsSrvc","loaderIndicator","deduplicationSrvc","$timeout",function(e,t,i,a,n,r,o,s,l,c,d,m,u,p,f,g,h){var v=this,y=[],w=e.filterType;e.filterLang=angular.isUndefined(e.filterLang)?"ru":e.filterLang;var b=["area","free","auditory","place","daytime","district","sphere","today","tomorrow","week","period"];"news"===w&&(b=["area","district","period","anytime","week","tomorrow","today","department","sphere"]),v.pagination={},v._materials=[],v.materialsStore={};var _=s.find(".events-filter__btn-select"),k=s.find(".events-block");v.filterApplied=function(t,i,a){if(t.period=function(t){var i=t.period||{};if(!(t.cleared||i.mode&&"period"!==i.mode||i.from&&i.to)){var a=new Date;"afisha"===e.filterType?(i.from=a,i.to=new Date,i.to.setMonth(a.getMonth()+1)):"news"===e.filterType&&(i={})}return i}(t),o.setParams(t,"news"===e.filterType),v.isButtonApplyDisabled=!t.cleared,e.metricKey&&a){var n=[["dateFrom",l("date")(t.period.from,je)],["dateTo",l("date")(t.period.from,je)],["daytime",a.daytime],["auditory",a.auditory],["sphere",a.sphere],["district",a.district],["area",a.area],["place",a.place],["department",a.department]];"afisha"===e.filterType&&n.push(["free",t.free?"Да":"Нет"]),ne.sendStat(Ve({},e.metricKey,Ve({},pe,n.map((function(e){var t,i,a=(i=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var a,n,r=[],o=!0,s=!1;try{for(i=i.call(e);!(o=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);o=!0);}catch(e){s=!0,n=e}finally{try{o||null==i.return||i.return()}finally{if(s)throw n}}return r}}(t,i)||function(e,t){if(e){if("string"==typeof e)return Ne(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Ne(e,t):void 0}}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=a[0],r=a[1];if(r){var o=We[n],s=r;if(Array.isArray(r)&&(s=r.join(",")),s)return"".concat(o,": ").concat(s)}return""})).filter((function(e){return!!e})).join(";"))))}t.cleared&&s.find(".events-block__title-text").focus()},v.filterChanged=function(){v.isButtonApplyDisabled=!1},v.filterInited=function(){a.onSuccess({},(function(e){if(v.silence)v.silence=!1;else{for(var t=e.to(),i=!1,a=0;a<b.length;a++)if(t.name.indexOf(b[a])>-1){i=!0;break}(t.name===w||i)&&(D(),function(){v.pagination={};var e=n.search().page;return/^\d+$/.test(e)&&(e=+e),A({page:e},_,!0)}().then((function(){s.find("#events-block-results").focus()})))}})),D(),function(){P(),T(),Re(window).off("resize.main-afisha").on("resize.main-afisha",T);var e={},t=n.search().page;/^\d+$/.test(t)&&(e.page=+t);var i=Object.keys(v.modelFilter).some((function(e){return"period"===e?v.modelFilter.period&&(v.modelFilter.period.from||v.modelFilter.period.to):!!v.modelFilter[e]&&"all"!==v.modelFilter[e]}));v.isButtonApplyDisabled=i,A(e,_)}()},v.moreClicked=function(a){if(a.preventDefault(),!v.getDataProcess){v.silence=!0;var n=v.pagination.currentPage+1;v.isPageParam&&(i.page=n,t.transitionTo(t.current.name,i,{location:!0,inherit:!0,notify:!1,reload:!1,relative:null})),A({page:n},s.find(".events-block__more")).then((function(){h((function(){var e=s.find(".events-list__page.page-".concat(n," .events-list__material:first-child a[href]"));e&&e.focus()}))})),e.metricKey&&ne.sendStat(Ve({},e.metricKey,"Показать ещё"))}},v.resetFilters=function(){e.$broadcast("clear-filter")},v.toggleFilter=function(e){s.find(".events-block__filter").slideToggle(),Re(e.currentTarget).toggleClass("events-block__title-toggle-filter--opened")},v.itemClicked=function(t,i){e.metricKey&&ne.sendStat(Ve({},e.metricKey,Ve({},ce,Ve({},i.title,t.currentTarget.href))))},o.init(w,b,{});var x=O();if(v.modelFilter=x,x.period&&x.period.from&&x.period.to&&x.period.from>x.period.to){var C=x.period.from;x.period.from=x.period.to,x.period.to=C,o.setFilterCalendar(x.period.from,x.period.to)}function A(t,a,o){v.fetchPromise?v.fetchPromise.cancel():k.height(k.height()),v._materials=[],v.notFound=!1,v.searchError=!1,v.getDataProcess=!0;var s="afishaV4List",l={"per-page":9,sort:"occurrences.date_to,-occurrences.date_from",fields:"id,title,label,image,date_from,date_to,kind,free",expand:"spheres"};return"news"===e.filterType&&(s="articlesList",l.sort="-date",l.fields="id,title,label,image,date,date_timestamp,kind,place,free,department_id",v.filter.department_id&&(v.department=v.filter.department_id,delete v.filter.department_id)),l.filter=angular.merge({},v.filter),l=angular.merge(l,t),0===Object.keys(l.filter).length&&delete l.filter,v.excludedIds=g.getIdsExcept(y),v.excludedIds&&v.excludedIds.length&&(l=angular.merge(l,{filter:{"!=id":v.excludedIds}})),f.switchOn(a),"news"===e.filterType&&(v.from&&(l.from=v.from),v.to&&(l.to=v.to),v.department&&(l["department_id[]"]=v.department)),v.fetchPromise=d.getDataCancelable("newsfeed",s,l,!1),v.fetchPromise.then((function(s){if(s.state&&"cancelled"===s.state)return s;if(f.switchOff(a),s.data.items&&s.data.items.length){t.page||(g.remove(y),y.splice(0));var l=s.data.items.map((function(e){return e.id}));y=y.concat(l),g.add(l);for(var c=!0,d=s.data.items.length>=3?3:s.data.items.length,m=0,u=0;u<=d-1;u++)s.data.items[u].image&&(m+=1);m!==d&&(c=!1);var h=p.transformAndCountImages(s.data.items,$,{hasImages:c});v._materials=v._materials.concat(h.items),v.pagination=s.data._meta,v.urlMore=function(){v.isPageParam=!1,angular.isDefined(i.page)&&(v.isPageParam=!0);var e=n.absUrl(),t=angular.copy(n.search()),a=r(t);return a.length&&(e=e.replace("?"+a,"")),t.page=v.pagination.currentPage+1,(a=r(t)).length&&(e+="?"+a),e}();var w="page"+v.pagination.currentPage;o&&(v.materialsStore={}),v.materialsStore[w]||(v.materialsStore[w]={imagesCount:h.imagesCount,items:[]}),M(v._materials.splice(0))}else s.data._meta&&1===s.data._meta.currentPage&&(v.materialsStore={},v.notFound=!0);S(),e.$broadcast("events-fetched")}),(function(e){e.content&&-1===e.content.status&&(v.materialsStore={},v.searchError=!0),f.switchOff(a),S()})),v.fetchPromise}function S(){v.silence=!1,v.getDataProcess=!1,k.height(""),v.fetchPromise=null}function $(t){var i=t.kind&&"article"===t.kind.id,a=t.kind&&"afisha"===t.kind.id,n=E(t,"date"),r=E(t,"date_from"),o=E(t,"date_to"),s="news"===e.filterType?"/item/":"/event/",c={id:t.id,title:m.trustAsHtml(t.title),href:u.getLangLink(u.pagePath(e.filterType,s+t.id+"/")),free:t.free,label:t.free?l("translate")("cardLabel.free"):null,kind:t.kind,extra:[],timestamp:i?n:r,hasImage:t.hasImage};return isNaN(n)||(c.date=i?isNaN(n)?null:l("newsfeedDateFormat")(n):l("eventDateFormat")(r,o,null)),a&&(c.date=l("eventDateFormat")(r,o,null)),c.extra.push({title:t.spheres&&t.spheres.length&&t.spheres[0].title}),t.image&&(c.image=t.image),c}function M(e){var t="page"+v.pagination.currentPage;v.materialsStore[t].items=v.materialsStore[t].items.concat(e)}function D(){o.init(w,b,{});var t=o.getParams();v.modelFilter=O();var i,a=null,n=null,r=v.modelFilter.period.mode;if("today"===r)n=new Date,a=new Date;else if("tomorrow"===r)n=new Date,a=new Date,n.setDate(n.getDate()+1),a.setDate(a.getDate()+1);else if("week"===r){var s=(i=new Date).getDate()-i.getDay()+1,d=s+6;a=new Date(i.setDate(s)),n=new Date(i.setDate(d))}else a=v.modelFilter.period&&v.modelFilter.period.from,n=v.modelFilter.period&&v.modelFilter.period.to,a&&n||"news"===e.filterType||(a=i=new Date,(n=new Date).setMonth(i.getMonth()+1));a&&n&&("afisha"===e.filterType&&(a=c.convertDateToMos(a),n=c.convertDateToMos(n)),a=l("date")(a,"yyyy-MM-dd 00:00:00"),n=l("date")(n,"yyyy-MM-dd 23:59:59"));var m={"spheres.id":t.sphere,"auditories.id":t.auditory,daytime:t.daytime,"districts.id":t.district,"spots.place_type_id":t.place,"districts.area_ids":t.area,department_id:t.department};v.from=null,v.to=null,v.department=null,a&&n&&("news"===e.filterType?(v.from=a,v.to=n):(m["<=occurrences.date_from"]=n,m[">=occurrences.date_from"]=a)),"free"===t.free&&(m.free=1),v.modelFilter.free=m.free,v.filter=m}function O(){var e={auditory:o.getParam("auditory"),daytime:o.getParam("daytime"),district:o.getParam("district"),free:o.getParam("free"),period:o.getDateForCalendar(),place:o.getParam("place"),sphere:o.getParam("sphere"),department:o.getParam("department"),area:o.getParam("area")},t=c.ruStrToDate(e.period.from),i=c.ruStrToDate(e.period.to);return e.period.from=t&&!isNaN(t.getTime())?t:null,e.period.to=i&&!isNaN(i.getTime())?i:null,e.period.from&&e.period.to?e.period.mode="period":o.getParam("today")?e.period.mode="today":o.getParam("tomorrow")?e.period.mode="tomorrow":o.getParam("week")?e.period.mode="week":o.getParam("anytime")?e.period.mode="anytime":e.period.mode="period",e}function P(){v.widthLT768=Modernizr&&Modernizr.mq("(max-width: 767px)"),v.widthLT768,v.widthLT1024=Modernizr&&Modernizr.mq("(max-width: 1024px)"),v.widthLT1024}function T(){P(),v.numOfCols=v.widthLT768?1:v.widthLT1024?3:4,v.oldNumOfCols!==v.numOfCols&&(1===v.oldNumOfCols&&v._materials.length&&M(v._materials.splice(0)),v.oldNumOfCols=v.numOfCols)}function E(e,t){var i=1e3*e[t+"_timestamp"];return!i&&e[t]&&e[t].match(/\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}/)&&(e[t]=e[t].replace(/(\d{4}-\d{2}-\d{2})(\s)(\d{2}:\d{2}:\d{2})/,"$1T$3"),i=new Date(e[t]).getTime()||NaN),i}v.oldNumOfCols=1}]).name,Ye=n.module("newsCards.themeCard",[be]).directive("themeCard",["imgSrvc",function(e){return{restrict:"EA",scope:{item:"="},link:function(t,i){if(i.on("$destroy",(function(){t.$destroy()})),n.isObject(t.item)){t.imageRatio=["2x1_m","small"],t.imageRatioEnum=["1x1_m","1x1_s","2x1_b","2x1_m","2x1_s","3x1_b","3x1_m","3x1_s","4x1_b","4x1_m","4x1_s","big","download","middle","original","show","small","thumb"],t.typeEnum=["lead","head"],t.modifierEnum=["default"],t.showCard=(t.item.title||t.item.image)&&t.item.href;var a=t.item.type;if(n.isObject(a)&&a.title&&(!a.place||t.typeEnum.indexOf(a.place)<0)&&(a.place=t.typeEnum[0]),(!t.item.modifier||t.modifierEnum.indexOf(t.item.modifier)<0)&&(t.item.modifier=t.modifierEnum[0]),n.isDefined(t.item.image)){t.imageRatio=t.item.imageRatio&&t.imageRatioEnum.indexOf(t.item.imageRatio)>-1?t.item.imageRatio:t.imageRatio;var r=n.isArray(t.item.image)&&n.isObject(t.item.image[0])?t.item.image[0]:t.item.image;if(Array.isArray(t.imageRatio))for(var o=0;o<t.imageRatio.length;o++){var s=e.testObj(r,t.imageRatio[o]);if(s){r=s;break}}else r=e.testObj(r,t.imageRatio);t.image=r||t.item.image}t.item.target=t.item.target||"_top"}},template:'<div class="themeCard" data-ng-if="showCard"><a class="themeCard__link link-black" data-ng-href="{{item.href}}" target="{{item.target}}"><span class="themeCard__image" data-ng-class="{\'themeCard__image-noimage\':!item.image}"><img data-ng-src="{{image}}" data-ng-if="image &amp;&amp; item.image" alt="{{item.title}}" title="{{item.title}}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}"/></span><span class="themeCard__extra extraList"><span class="extraList__item" ng-class="{\'extraList__item-icon\':item.icon}" ng-repeat="extraitem in item.extra">{{extraitem.title}}</span></span><span class="themeCard__title" data-ng-if="item.title">{{item.text}}</span><span class="themeCard__text" data-ng-if="item.text">{{item.text}}</span></a></div>'}}]).name,Qe=n.module("newsCards.afishaCard",[be]).directive("afishaCard",["imgSrvc",function(e){return{restrict:"EA",scope:{item:"=",itemIndex:"=",pageIndex:"=",click:"&"},link:function(t,i){if(i.on("$destroy",(function(){t.$destroy()})),n.isObject(t.item)){t.imageRatio="2x1_m",t.imageRatioEnum=["1x1_m","1x1_s","2x1_b","2x1_m","2x1_s","3x1_b","3x1_m","3x1_s","4x1_b","4x1_m","4x1_s","big","download","middle","original","show","small","thumb"],t.typeEnum=["lead","head"],t.modifierEnum=["default","highlight","strong","molding"],t.showCard=(t.item.title||t.item.image)&&t.item.href;var a=t.item.type;if(n.isObject(a)&&a.title&&(!a.place||t.typeEnum.indexOf(a.place)<0)&&(a.place=t.typeEnum[0]),(!t.item.modifier||t.modifierEnum.indexOf(t.item.modifier)<0)&&(t.item.modifier=t.modifierEnum[0]),n.isDefined(t.item.image)){t.imageRatio=t.item.imageRatio&&t.imageRatioEnum.indexOf(t.item.imageRatio)>-1?t.item.imageRatio:t.imageRatio;var r=n.isArray(t.item.image)&&n.isObject(t.item.image[0])?t.item.image[0]:t.item.image;r=e.testObj(r,t.imageRatio),t.image=r||t.item.image}t.item.target=t.item.target||"_top"}},template:'<div class="afishaCard" ng-class="{\'top-border\': (itemIndex &gt; 3 || pageIndex &gt; 1)}"><div class="afishaCard__content"><a class="afishaCard__link link-black" href="{{item.href}}" target="{{item.target}}" data-ng-click="click({ $event })"><div class="afishaCard__image" data-ng-if="item.hasImage"><figure class="afishaCard__figure" data-ng-if="image &amp;&amp; item.image"><img data-ng-src="{{image}}" alt="{{item.title}}" title="{{item.title}}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}"/></figure></div><div class="afishaCard__text" data-ng-if="item.title"><div class="afishaCard__extra" data-ng-if="item.date"> {{item.date}}</div><div class="card__label card__label-transparent" data-ng-if="item.label">{{item.label}}</div><div class="afishaCard__title" data-ng-if="item.title">{{item.title}}</div></div></a></div></div>'}}]).name,Ke=n.module("newsCards.articleCard",[be]).directive("articleCard",["imgSrvc",function(e){return{restrict:"EA",scope:{item:"=",itemIndex:"=",pageIndex:"=",click:"&"},link:function(t,i){if(t.baseId="article-card-"+(t.item.id||Date.now()),i.on("$destroy",(function(){t.$destroy()})),n.isObject(t.item)){t.imageRatio="2x1_m",t.imageRatioEnum=["1x1_m","1x1_s","2x1_b","2x1_m","2x1_s","3x1_b","3x1_m","3x1_s","4x1_b","4x1_m","4x1_s","big","download","middle","original","show","small","thumb"],t.typeEnum=["lead","head"],t.modifierEnum=["default","highlight","strong","molding"],t.showCard=(t.item.title||t.item.image)&&t.item.href;var a=t.item.type;if(n.isObject(a)&&a.title&&(!a.place||t.typeEnum.indexOf(a.place)<0)&&(a.place=t.typeEnum[0]),(!t.item.modifier||t.modifierEnum.indexOf(t.item.modifier)<0)&&(t.item.modifier=t.modifierEnum[0]),n.isDefined(t.item.image)){t.imageRatio=t.item.imageRatio&&t.imageRatioEnum.indexOf(t.item.imageRatio)>-1?t.item.imageRatio:t.imageRatio;var r=n.isArray(t.item.image)&&n.isObject(t.item.image[0])?t.item.image[0]:t.item.image;r=e.testObj(r,t.imageRatio),t.image=r||t.item.image}t.item.target=t.item.target||"_top"}},template:'<div class="articleCard" ng-class="{\'top-border\': (itemIndex &gt; 3 || pageIndex &gt; 1)}"><div class="articleCard__content"><a class="articleCard__link link-black" href="{{item.href}}" target="{{item.target}}" data-ng-click="click({ $event })" aria-labelledby="{{baseId}}-date {{baseId}}-sphere {{baseId}}-title"><div class="articleCard__image" data-ng-if="item.hasImage"><figure class="articleCard__figure" data-ng-if="image &amp;&amp; item.image"><img data-ng-src="{{image}}" alt="{{item.title}}" title="{{item.title}}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}"/></figure></div><div class="articleCard__text" data-ng-if="item.title"><div class="articleCard__wrapper"><div class="articleCard__extra" data-ng-if="item.date" id="{{baseId}}-date"> {{item.date}}</div><div class="card__label card__label-transparent" id="{{baseId}}-sphere" data-ng-if="item.label || (item.extra &amp;&amp; item.extra.length &gt; 0)">{{item.label || item.extra[0].title}}</div></div><div class="articleCard__title" data-ng-if="item.title" id="{{baseId}}-title">{{item.title}}</div></div></a></div></div>'}}]).name,Ge=n.module("newsCards.eventCard",[be]).directive("eventCard",["imgSrvc",function(e){return{restrict:"EA",scope:{item:"=",itemIndex:"=",pageIndex:"=",click:"&"},link:function(t,i){if(i.on("$destroy",(function(){t.$destroy()})),n.isObject(t.item)){t.imageRatio="2x1_m",t.imageRatioEnum=["1x1_m","1x1_s","2x1_b","2x1_m","2x1_s","3x1_b","3x1_m","3x1_s","4x1_b","4x1_m","4x1_s","big","download","middle","original","show","small","thumb"],t.typeEnum=["lead","head"],t.modifierEnum=["default","highlight","strong","molding"],t.showCard=(t.item.title||t.item.image)&&t.item.href;var a=t.item.type;if(n.isObject(a)&&a.title&&(!a.place||t.typeEnum.indexOf(a.place)<0)&&(a.place=t.typeEnum[0]),(!t.item.modifier||t.modifierEnum.indexOf(t.item.modifier)<0)&&(t.item.modifier=t.modifierEnum[0]),t.item.image){t.imageRatio=t.item.imageRatio&&t.imageRatioEnum.indexOf(t.item.imageRatio)>-1?t.item.imageRatio:t.imageRatio;var r=n.isArray(t.item.image)&&n.isObject(t.item.image[0])?t.item.image[0]:t.item.image;r=e.testObj(r,t.imageRatio),t.image=r||t.item.image}else t.image="/news/assets/static/images/placeholder-event.png";t.item.target=t.item.target||"_top"}},template:'<div class="eventCard" ng-class="{\'top-border\': (itemIndex &gt; 1 || pageIndex &gt; 1)}"><div class="eventCard__content"><a class="eventCard__link link-black" href="{{item.href}}" target="{{item.target}}" data-ng-click="click({$event, item})"><div class="eventCard__image"><figure class="eventCard__figure"><img data-ng-src="{{image}}" alt="{{item.title}}" title="{{item.title}}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}"/></figure></div><div class="eventCard__text" data-ng-if="item.title"><div class="eventCard__wrapper-extra" data-ng-class="{\'eventCard__wrapper-extra--flexWrap\':item.label}"> <div class="eventCard__free-label" data-ng-if="item.label"> {{item.label}}</div><div class="eventCard__extra" data-ng-if="item.date"> {{item.date}}</div><div class="card__label card__label-transparent">{{item.spheres}}</div></div><div class="eventCard__title" data-ng-if="item.title">{{item.title}}</div></div></a></div></div>'}}]).name,Je=n.module("newsCards.textOverImageCard",[be]).directive("textOverImageCard",["imgSrvc",function(e){return{restrict:"EA",scope:{item:"="},link:function(t,i){if(i.on("$destroy",(function(){t.$destroy()})),n.isObject(t.item)){if(t.imageRatio="2x1_m",t.imageRatioEnum=["1x1_m","1x1_s","2x1_b","2x1_m","2x1_s","3x1_b","3x1_m","3x1_s","4x1_b","4x1_m","4x1_s","big","download","middle","original","show","small","thumb"],t.showCard=(t.item.title||t.item.image)&&t.item.href,n.isDefined(t.item.image)){t.imageRatio=t.item.imageRatio&&t.imageRatioEnum.indexOf(t.item.imageRatio)>-1?t.item.imageRatio:t.imageRatio;var a=n.isArray(t.item.image)&&n.isObject(t.item.image[0])?t.item.image[0]:t.item.image;a=e.testObj(a,t.imageRatio),t.image=a||t.item.image}t.item.target=t.item.target||"_top"}},template:'<div class="textOverImageCard" data-ng-if="showCard"><a class="textOverImageCard__link" data-ng-href="{{item.href}}" target="{{item.target}}"><div class="textOverImageCard__image" data-ng-if="image" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" data-ng-style="{\'background-image\': \'url(&quot;{{image}}&quot;)\'}"><div class="textOverImageCard__label" data-ng-if="item.label">{{item.label}}</div><div class="textOverImageCard__title" data-ng-if="item.title">{{item.title}}</div></div></a></div>'}}]).name,Xe=n.module("newsCards.embedSocial",[]).directive("embedSocialRender",[function(){return{restrict:"EA",scope:{code:"@"},link:function(e,t){t.on("$destroy",(function(){e.$destroy()}));var i,n=[{name:"facebook-video",regexp:/facebook\.com\/plugins\/video\.php/},{name:"facebook-post",regexp:/facebook\.com\/plugins\/post\.php/},{name:"instagram",regexp:/instagram\.com/},{name:"vk",regexp:/vk\.com/}],r=decodeURIComponent(escape(window.atob(e.code)));a(t).find(".embed-social").html(r);for(var o=0;o<n.length;o++)n[o].regexp.test(r)&&(i=n[o].name);switch(i){case"facebook-video":e.displayBlock=!0,e.responsiveFrame=!0;break;case"facebook-post":case"vk":e.displayBlock=!0;break;case"instagram":e.displayBlock=!0,window.instgrm&&window.instgrm.Embeds&&window.instgrm.Embeds.process()}},template:'<div class="embed-social-wrapper"><div class="embed-social" data-ng-class="{\'embed-social_displayb\': displayBlock, \'embed-social_resp-frame\': responsiveFrame}"></div></div>'}}]).name,Ze=n.module("newsCards.personBlockquote",[]).directive("personBlockquote",[function(){return{restrict:"A",scope:{quote:"@",quoteText:"=?",personImage:"@",personName:"@",personPosition:"@"},link:function(e,t){e.quoteText=e.quote.replace(/%quot%/g,'"'),t.on("$destroy",(function(){e.$destroy()}))},template:'<blockquote class="person-blockquote"><svg class="person-blockquote__icon" role="presentation"><use xlink:href="/news/assets/icons/sprite.svg#quote"></use></svg><div class="person-blockquote__content"><div class="person-blockquote__text" data-ng-show="quote">{{quoteText}}</div><div class="person-blockquote-author person-blockquote__author"><img class="person-blockquote-author__image" alt="{{personName+\', \'+personPosition}}" role="presentation" title="{{personName+\', \'+personPosition}}" data-ng-src="{{personImage}}"/><div class="person-blockquote-author__info"><div class="person-blockquote-author__info-name">{{personName}}</div><div class="person-blockquote-author__info-position">{{personPosition}}</div></div></div></div></blockquote>'}}]).name,et=n.module("newsCards.personCard",[]).directive("personCard",[function(){return{restrict:"EA",scope:{item:"="},link:function(e,t){t.on("$destroy",(function(){e.$destroy()})),n.isObject(e.item)&&(e.modifierEnum=["default","highlight","strong","molding"],e.showCard=e.item.surname||e.item.fullname,(!e.item.modifier||e.modifierEnum.indexOf(e.item.modifier)<0)&&(e.item.modifier=e.modifierEnum[0]),e.item.target=e.item.target||"_top")},template:'<div class="personCard" data-ng-if="showCard" data-ng-class="{\n    \'personCard-highlight\': item.modifier === \'highlight\',\n    \'personCard-strong\': item.modifier === \'strong\',\n    \'personCard-molding\': item.modifier === \'molding\',\n  }"><a class="personCard__link" data-ng-href="{{item.href}}" target="{{item.target}}"><div class="personCard__wrapper"><div class="personCard__image" data-ng-if="item.image" data-ng-style="{\'background-image\': \'url(&quot;{{item.image}}&quot;)\'}"></div><div class="personCard__fio" data-ng-if="item.surname"><div class="personCard__surname">{{item.surname}}</div><div class="personCard__name" data-ng-if="item.name">{{item.name}}</div><div class="personCard__patronymic" data-ng-if="item.patronymic">{{item.patronymic}}</div></div><div class="personCard__fio" data-ng-if="!item.surname &amp;&amp; item.fullname">{{item.fullname}}</div></div><div class="personCard__post" data-ng-if="item.post">{{item.post}}</div></a></div>'}}]).name,tt=n.module("newsCards.oivCard",[]).directive("oivCard",[function(){return{restrict:"EA",scope:{item:"="},link:function(e,t){t.on("$destroy",(function(){e.$destroy()})),n.isObject(e.item)&&(e.modifierEnum=["default","highlight","strong","molding"],(!e.item.modifier||e.modifierEnum.indexOf(e.item.modifier)<0)&&(e.item.modifier=e.modifierEnum[0]),e.item.target=e.item.target||"_top",e.showCard=!!e.item.title)},template:'<div class="oivCard" data-ng-if="showCard" data-ng-class="{\n    \'oivCard-highlight\': item.modifier == \'highlight\', \n    \'oivCard-strong\': item.modifier == \'strong\', \n    \'oivCard-molding\': item.modifier == \'molding\',\n  }"><a class="oivCard__link" data-ng-href="{{item.href}}" target="{{item.target}}"><div class="oivCard__image" data-ng-if="item.image"><img data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" data-ng-src="{{item.image}}"/></div><div class="oivCard__title" data-ng-if="item.title">{{item.title}}</div></a><div class="oivCard__contacts"></div></div>'}}]).name,it=n.module("newsCards.tellyCard",[be]).directive("tellyCard",[function(){return{restrict:"EA",scope:{item:"=",itemIndex:"=",pageIndex:"="},link:function(e,t){t.on("$destroy",(function(){e.$destroy()})),n.isObject(e.item)&&(e.wide=e.item.wide,e.showPowerIcon=e.item.is_powered,e.cropSmall="2x1_m",e.cropBig="2x1_b",e.item.target=e.item.target||"_top")},template:'<a class="tellyCard" href="{{item.href}}" target="{{item.target}}" ng-class="{\'telleyCard_wide\': wide}"><div class="tellyCard__time-and-icon"><time class="tellyCard__time" ng-if="item.date">{{item.date}}</time><span class="tellyCard__alert-icon" ng-if="showPowerIcon"></span></div><span class="tellyCard__alert-icon-square" ng-if="wide &amp;&amp; showPowerIcon"></span><aside class="tellyCard__sphere" ng-if="sphereTitle">{{item.sphereTitle}}</aside><picture><source srcset="{{item.image &amp;&amp; item.image[cropSmall] &amp;&amp; item.image[cropSmall].src ? item.image[cropSmall].src : \'\'}}" media="(max-width: 1023px)"/><source srcset="{{item.image &amp;&amp; item.image[cropBig] &amp;&amp; item.image[cropBig].src ? item.image[cropBig].src : \'\'}}" media="(min-width: 1024px)"/><img src="{{item.image &amp;&amp; item.image[cropBig] &amp;&amp; item.image[cropBig].src ? item.image[cropBig].src : \'\'}}" alt="{{item.title}}" title="{{item.title}}"/></picture><div class="tellyCard__title">{{item.title}}</div></a>'}}]).name,at=n.module("newsCards",[ke,Ye,xe,Je,Xe,Qe,Ke,Ge,Ze,tt,et,it]).name,nt=i(1110);function rt(e){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rt(e)}var ot=n.module("newsMain.routing",[nt.default,ee]).config(["$locationProvider","$stateProvider",function(e,t){e.html5Mode(!0),e.hashPrefix("!"),t.state("news",{url:"/?{page:[0-9]}"}).state("news.sphere",{url:"{sphere:[^/]*}/",params:{sphere:"all"}}).state("news.sphere.department",{url:"{department:[^/]*}/",params:{department:"all"}}),[{name:"period",url:"from/{from:[^/]*}/to/{to:[^/]*}/"},"today","tomorrow","week","anytime"].forEach((function(e){var i,a,n={};"object"===rt(e)?(i=e.name,a=e.url):(i=e,a=e+"/"),n[i]=!0,t.state("news.sphere.department."+i,{url:a,params:n}).state("news.sphere.department."+i+".district",{url:"{district:[^/]*}/",params:{district:"all"}}).state("news.sphere.department."+i+".district.area",{url:"{area:[^/]*}/",params:{area:"all"}})}))}]).name,st=n.module("mosapp").provider("deduplicationSrvc",(function(){var e=[];this.init=function(t){Array.isArray(t)&&(e=t)},this.$get=[function(){return new lt(e)}]})).name;function lt(e){var t=new Set;Array.isArray(e)&&e.forEach((function(e){t.add(e)})),this.add=function(e){e.forEach((function(e){t.add(e)}))},this.remove=function(e){e.forEach((function(e){t.delete(e)}))},this.getIds=function(){var e=[];return t.forEach((function(t){e.push(t)})),e},this.getIdsExcept=function(e){return this.getIds().filter((function(t){return e.indexOf(t)<0}))}}function ct(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}ne.initialize({type:"news"});var mt=[["main-themes","Главные темы"],["my-region","Мой район"],["news-media","Медиа"],["all-news","Все новости"]];n.module("newsMain",[ke,xe,$e,c,u,f,m,Pe,"pascalprecht.translate","mgcrea.ngStrap",F,ee,we,L,ot,at,Ue,L,st]).config(["$compileProvider","$translateProvider","LangSrvcProvider","deduplicationSrvcProvider",function(e,t,i,a){e.debugInfoEnabled(!1),t.useSanitizeValueStrategy("escaped").translations(i.setCurrentLang(),config.translations).preferredLanguage(i.setCurrentLang());var n=window.config&&window.config.data&&Object.values(window.config.data.articleIds)||[];a.init(n)}]).run(["UrlSrvc","$transitions",function(e,t){t.onSuccess({},(function(){e.setCanonical()}))}]).controller("NewsMainController",["toolsSrvc","LangSrvc","$scope","$element",function(e,t,i,a){this.newsListMetricKey="Все новости",i.$watch((function(){return e.colorScheme()}),(function(e){i.colorScheme=e,"contrast"==i.colorScheme?a.addClass("contrast"):a.removeClass("contrast")})),i.language=t.getCurrentLang(),i.colorScheme=e.colorScheme(),"contrast"==i.colorScheme&&a.addClass("contrast");var n=e.debounce((function(){mt.forEach((function(t,i){var a,n,r=(n=2,function(e){if(Array.isArray(e))return e}(a=t)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var a,n,r=[],o=!0,s=!1;try{for(i=i.call(e);!(o=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);o=!0);}catch(e){s=!0,n=e}finally{try{o||null==i.return||i.return()}finally{if(s)throw n}}return r}}(a,n)||function(e,t){if(e){if("string"==typeof e)return dt(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?dt(e,t):void 0}}(a,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],s=r[1],l=document.getElementById(o);l&&e.isInViewport(l,.5)&&(mt.splice(i,1),ne.sendStat(ct({},de,s)))}))}),30);function r(e){return function(t,i,a){i&&a&&ne.sendStat(ct({},e,ct({},"Элемент "+a,ct({},ce,ct({},i,t.currentTarget.href)))))}}window.addEventListener("scroll",n),this.onClickLink=r("Телевизор"),this.onClickMayorLink=r(re),this.onClickMayorAll=function(){ne.sendStat(ct({},re,ct({},ce,"Все новости мэра")))},this.onClickDigestLink=r("Актуальное"),this.onClickMaintheme=r("Главные темы"),this.onClickMediaLink=r(se),this.onMediaPrevButtonClick=function(){ne.sendStat(ct({},se,ct({},fe,"Влево")))},this.onMediaNextButtonClick=function(){ne.sendStat(ct({},se,ct({},fe,"Вправо")))}}])}},i={};function a(e){var n=i[e];if(void 0!==n)return n.exports;var r=i[e]={id:e,loaded:!1,exports:{}};return t[e].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=t,e=[],a.O=function(t,i,n,r){if(!i){var o=1/0;for(d=0;d<e.length;d++){i=e[d][0],n=e[d][1],r=e[d][2];for(var s=!0,l=0;l<i.length;l++)(!1&r||o>=r)&&Object.keys(a.O).every((function(e){return a.O[e](i[l])}))?i.splice(l--,1):(s=!1,r<o&&(o=r));if(s){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[i,n,r]},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},a.j=214,a.p="",function(){var e={214:0};a.O.j=function(t){return 0===e[t]};var t=function(t,i){var n,r,o=i[0],s=i[1],l=i[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(n in s)a.o(s,n)&&(a.m[n]=s[n]);if(l)var d=l(a)}for(t&&t(i);c<o.length;c++)r=o[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},i=self.webpackChunknews_app=self.webpackChunknews_app||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var n=a.O(void 0,[736],(function(){return a(5675)}));n=a.O(n)}();