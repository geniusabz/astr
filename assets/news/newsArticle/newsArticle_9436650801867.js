!function(){"use strict";var e,t,i,a={6529:function(e,t,i){i(6833);var a=i(7339),n=i(2789),r=(i(6719),i(7866),i(3205),i(7463),i(620),i(5815)),o=(i(2699),i(5273));r(i(7339)),o();var s=n.module("mosapp.tizerBlocks",[]).directive("isExists",["$interval","$timeout",function(e,t){return{restrict:"A",scope:{isExists:"@"},link:function(i,n){n.on("$destroy",(function(){i.$destroy()})),i.$el=a(n),i.total=i.$el.find(i.isExists).length,i.total&&(i.isResult=function(){i.checkEmpty()&&(i.$el.addClass("is-exists"),e.cancel(i.promise))},i.checkEmpty=function(){var e=i.$el.find(i.isExists+":empty").length;return i.total!==e},i.promise=e(i.isResult,100),i.isDebug=!1,i.isDebug&&t((function(){i.$el.find(i.isExists).html('<div style="width:100%;height:100%;background:#f00;"></div>')}),5e3))}}}]).directive("addClassIfIe",[function(){return{restrict:"A",compile:function(e,t){document.documentMode&&e.addClass(t.addClassIfIe)}}}]).name,l=(i.p,i.p,i.p,i(6228),n.module("newsMedia.gallery",["angular-click-outside"]).directive("gallery",["$timeout","$interval",function(e,t){return{restrict:"EA",scope:{items:"=",responsive:"=?",container:"@",css:"=",cssBreakpoints:"=",clickNext:"&",clickPrev:"&",clickNavItem:"&",clickMainImg:"&"},template:'<div class="b-carousel-with-miniatures"><div class="b-carousel-with-miniatures__carousels"><div class="b-carousel-with-miniatures__carousel_main"><div class="main-item" data-ng-repeat="img in items track by $index"><div class="main-item__img-wrapper" data-ng-click="clickOnMainSlide($event)"><img class="main-item__img" alt="{{img.alt}}" src="{{img.src}}" title="{{img.title}}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}"/></div><div class="main-item__description" data-ng-if="img.title"><span data-ng-if="img.title">{{img.title}}</span></div></div></div><div class="b-carousel-with-miniatures__carousel_nav"><div class="b-carousel-with-miniatures__carousel_nav-items"><button class="b-carousel-with-miniatures__icon b-carousel-with-miniatures__icon_prev-thumb" aria-label="Switch to previous slide" data-ng-if="!hideArrows" data-ng-click="prevPreview()"></button><div class="nav-item" data-ng-repeat="img in items track by $index" data-ng-click="onClickNavItem($index)"><div class="nav-item__img" alt="{{img.alt}}" title="{{img.title}}" data-ng-if="!hideArrows" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" data-ng-style="{\'background-image\': \'url(&quot;{{img.src}}&quot;)\'}"></div><button class="nav-item__img" alt="{{img.alt}}" title="{{img.title}}" data-ng-if="hideArrows" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" data-ng-style="{\'background-image\': \'url(&quot;{{img.src}}&quot;)\'}"></button></div><button class="b-carousel-with-miniatures__icon b-carousel-with-miniatures__icon_next-thumb" area-label="Switch to next slide" data-ng-if="!hideArrows" data-ng-click="nextPreview()"></button></div></div></div></div>',link:function(i,n){function r(){i.slidesToShow<i.items.length?i.hideArrows=!1:i.hideArrows=!0}function o(){i.navSlider.on("init",(function(t,n){e((function(){i.navSlick=n,a(window).off("resize.slick.slick-"+i.navSlick.instanceUid),i.navSlick.currentSlide=i.mainSlick.currentSlide,i.slidesToShow=s(),i.slidesToShow!==i.items.length&&i.navSlick.setPosition(),r(),s()}),10)})),i.navSlider.slick({slidesToShow:i.slidesToShow,variableWidth:!0,arrows:!1,asNavFor:i.mainSlider,slide:".b-carousel-with-miniatures .nav-item",responsive:!1,rows:-1})}function s(){var e=i.navSlider.find(".slick-list"),t=i.mainSlider[0].clientWidth,a=i.items.length>6?6:i.items.length,n=window.innerWidth,o=i.navSlick.$slides[0].offsetWidth,s=12,l=0,c=0;n<1280&&(s=8);for(var d=0;d<a;d++){var m=l+o+s;m+68<t&&(l=m,c+=1)}if(e.css("max-width",t-(a<=6?68:0)),i.slidesToShow=c,!i.navSlick)return c;var u=i.navSlick.currentSlide;i.navSlick.slickSetOption("slidesToShow",c,!0),i.navSlider.slick("setSlideClasses",u),i.navSlick.currentSlide=u,r()}n.on("$destroy",(function(){i.$destroy(),a(document).off("keyup.mos-carousel")})),i.carousel=n.find(".b-carousel-with-miniatures__carousels"),i.contentBlock=n.closest(i.container),i.mainSlider=n.find(".b-carousel-with-miniatures__carousel_main"),i.mainSlider.hide(),i.navSlider=n.find(".b-carousel-with-miniatures__carousel_nav-items"),e((function(){i.mainSlider.on("init",(function(e,t){i.mainSlick=t,i.imgTitle=i.items[0]?i.items[0].originalTitle:"",i.imgCopyright=i.items[0]?i.items[0].copyright:"",o()})),i.mainSlider.show(0,(function(){i.mainSlider.slick({slidesToShow:1,arrows:!1,slide:".b-carousel-with-miniatures .main-item",adaptiveHeight:!0,rows:-1})})),i.mainSlider.on("beforeChange",(function(e,t,a,n){i.imgTitle=i.items[n]?i.items[n].originalTitle:"",i.imgCopyright=i.items[n]?i.items[n].copyright:"",i.navSlider.slick("setSlideClasses",n),i.navSlick&&i.slidesToShow<i.items.length&&(i.navSlick.slickGoTo(n),r())})),i.mainSlider.on("afterChange",(function(e,t,a){i.navSlider.slick("setSlideClasses",a)})),t((function(){i.paneWidth=i.contentBlock.width()}),300),i.$watch("paneWidth",(function(e,t){i.mainSlick&&i.navSlick&&e&&(!e||e!==t||i.carousel.width()!==i.paneWidth)&&i.mainSlick.setPosition()})),i.$watch((function(){e.cancel(i.t),i.t=e((function(){i.navSlick?s():o()}),100)}))}),0),i.clickOnMainSlide=function(e){var t=e.target.getBoundingClientRect();(e.clientX-t.left)/t.width*100>20?(i.mainSlider.slick("next"),i.clickNext()):(i.mainSlider.slick("prev"),i.clickPrev())},i.onClickNavItem=function(e){i.clickNavItem(),i.mainSlick.slickGoTo(e)},i.nextPreview=function(){i.mainSlider.slick("next")},i.prevPreview=function(){i.mainSlider.slick("prev")}}}}]).service("galleryTools",[function(){var e,t=document.body,i=document.documentElement;this.fixBody=function(){e=window.pageYOffset||t.scrollTop,t.style.position="fixed",t.style.top=-e+"px",t.style.width="100%"},this.unfixBody=function(){t.style.position="",t.style.width="",t.style.top="",i.scrollTop=e,t.scrollTop=e},this.getCoordinates=function(e){return[e.pageY,e.pageX,!1]}}]).directive("zoomableImage",[function(){return{restrict:"A",scope:{imageSrc:"=",onMouseSwipeStart:"=",onMouseSwipe:"=",onPinchZoom:"="},template:'<img data-ng-src="{{imageSrc}}"/>',link:function(e,t,i){var a,n="",r=0,o=0,s=1,l=1,c=1,d=parseInt(i.maxScale,10);(isNaN(d)||d<=1)&&(d=3);var m,u=0,p=0,f=0,g=0,h=0,v=0,y=0,w=0,b=0,_=0,x=t.find("img");function A(t){if(t.type.indexOf("mouse")>-1)t=t.originalEvent?t.originalEvent:t,y=t.clientX,w=t.clientY,f=u,g=p,b=0,_=0,m=!0,e.onMouseSwipeStart&&e.onMouseSwipeStart(t);else{var i=t.originalEvent?t.originalEvent.touches:t.touches;y=i[0].clientX,w=i[0].clientY,f=u,g=p,b=0,_=0}}function S(t){if(t.type.indexOf("mouse")>-1)m&&(t=t.originalEvent?t.originalEvent:t,b=t.clientX-y,_=t.clientY-w,u=f+b,p=g+_,e.onMouseSwipe&&e.onMouseSwipe(t));else{var i=t.originalEvent?t.originalEvent.touches:t.touches;""===n&&(1===i.length&&s>1?n="swipe":2===i.length&&(n="pinch",c=s,o=k(i),h=i[0].clientX-parseInt((i[0].clientX-i[1].clientX)/2,10)-x[0].offsetLeft-f,v=i[0].clientY-parseInt((i[0].clientY-i[1].clientY)/2,10)-x[0].offsetTop-g)),"swipe"===n?(b=i[0].clientX-y,_=i[0].clientY-w,u=f+b,p=g+_):"pinch"===n&&2===i.length&&(t.preventDefault(),r=k(i),u=h*(1-(l=r/o))+f+b,p=v*(1-l)+g+_,s=(s=(s=l*c)<1?1:s)>d?d:s,window.clearTimeout(a),a=window.setTimeout((function(){!function(t){e.onPinchZoom&&e.onPinchZoom(t,s)}(t),n=""}),100))}}function C(e){if(e.type.indexOf("mouse")>-1)e=e.originalEvent?e.originalEvent:e,m=!1;else{var t=e.originalEvent?e.originalEvent.touches:e.touches;if(""===n||t.length>0)return;n=""}}function k(e){var t;return t=2===e.length?Math.sqrt(Math.pow(e[0].clientX-e[1].clientX,2)+Math.pow(e[0].clientY-e[1].clientY,2)):0,parseInt(t,10)}x[0].onload=function(){x.css({"-webkit-transform-origin":"0 0","transform-origin":"0 0"}),x.on("touchstart mousedown",A),x.on("touchmove mousemove",S),x.on("touchend mouseup mouseleave",C)}}}}]).name),c=n.module("newsMedia.lightbox",[]).directive("lightbox",["$timeout",function(e){return{restrict:"A",scope:{fullImageLink:"@",description:"@",prefixClass:"@",scrollOn:"@",container:"@"},template:"",link:function(t,i){var a=n.element(window),r=t.container&&i.parents(t.container),o=parseInt(i.attr("width")),s=parseInt(i.attr("height")),l=!o&&(s||0);function c(n){var r=n.naturalWidth,c=(n.naturalHeight,i.width()),m=i.height();(o||s)&&(d(r,o,c,m,l),a.on("resize.lightboxImage",(function(){e.cancel(t.debounceTimer),t.debounceTimer=e((function(){var e=i.width(),t=i.height();d(r,o,e,t,l)}),100)})))}function d(e,t,a,n,o){if(!t&&e!=a||t&&t!=a){if(i.attr("height",Math.ceil(a/o)),!t||a<t){var s=Math.min(r&&r.width(),t||e);s>a&&i.attr("height",Math.ceil(s/o))}}else t===a&&n&&i.attr("height",n)}!s&&i.attr("height",""),i[0].complete&&i[0].naturalWidth?c(i[0]):i.on("load",(function(){c(i[0])}))}}}]).name,d=(n.module("mosapp",["pascalprecht.translate"]).constant("mosconfig",{altParams:{ru:"Официальный сайт Мэра Москвы",en:"Moscow Mayor official website"},domain:"www.mos.ru",vendor:"/news/assets/vendor/",imagesPath:"/news/assets/static/images/",i18nPath:"/news/assets/news/",jsPath:"/news/assets/vendor/",assetsPath:"/news/assets/",searchPath:{search:"/search?category=%category%&page=1&q=",suggest:"/aisearch/suggest/ais/api/suggests/serp/%query%/"},"2GisApi":{url:"//maps.api.2gis.ru/2.0/loader.js?pkg=full&lazy=true",search_url:"//catalog.api.2gis.ru/geo/search"},mapsLoaderPath:"/front/markup/maps/js/loader.min.js",linksPath:{windowCams:"http://video.dit.mos.ru/window/"},pagePath:{page404:"/404/",mainpage:"/index/",feedback:"/feedback/",reception:"/reception/",authority:"/authority/",news:"/news/",afisha:"/afisha/",pulse:"/news/",press:"/mayor/themes/",department:"/authority/structure/",departmentScheme:"/scheme/",programs:"/city/progress/programs/",mayor:"/mayor/biography/",mayorMain:"/mayor/",mayorNews:"/mayor/themes/",mayorInfographic:"/mayor/infographic/",interviews:"/mayor/interviews/",progress:"/city/progress/result/",projects:"/city/projects/",city:"/city/progress/","mos.seasons":"/city/seasons/",festivals:"/city/festivals/",departmentSchemePrint:"/schemePrint/",search:"/search/",errorMessage:"/api/widgets/v1/json/bugreport",ritual:"/ritual/",documents:"/authority/documents/",documentslegacy:"/docs/",maslenica:"/maslenica/",conferences:"/conferences/",services:"/services/",servicesPgu:"/pgu",mediaMain:"/media/",myRegion:"/moi-raion/",venues:"/afisha/venues/"},banners:{},restAPI:{newsfeed:{pressStory:"/api/newsfeed/v4/frontend/json/[lang]/press/news/%id%",articlesList:"/api/newsfeed/v4/frontend/json/[lang]/articles",newsArticle:"/api/newsfeed/v4/frontend/json/[lang]/articles/%id%",afishaV4Event:"/api/newsfeed/v4/frontend/json/[lang]/afisha/%id%",mediaGallery:"/api/newsfeed/v4/frontend/json/[lang]/press/media/info/%id%",pressVideo:"/api/newsfeed/v4/frontend/json/[lang]/press/media/video",pressPresentation:"/api/newsfeed/v4/frontend/json/[lang]/press/presentation/%id%",pressInfographic:"/api/newsfeed/v4/frontend/json/[lang]/infographic/%id%",media_photo:"/api/newsfeed/v4/frontend/json/[lang]/press/media/photo",afishaV4List:"/api/newsfeed/v4/frontend/json/[lang]/afisha",spheres:"/api/newsfeed/v4/frontend/json/[lang]/spheres",daytimes:"/api/newsfeed/v4/frontend/json/[lang]/afisha/daytimes",auditories:"/api/newsfeed/v4/frontend/json/ru/afisha/auditories",place_types:"/api/newsfeed/v4/frontend/json/ru/afisha/place_types",spots:"/api/newsfeed/v4/frontend/json/ru/spot",mainMediaPhoto:"/api/newsfeed/v4/frontend/json/[lang]/press/main_media/info/%id%",mainMediaVideo:"/api/newsfeed/v4/frontend/json/[lang]/press/main_media/video",proxy:"/api/newsfeed/v4/frontend/json/[lang]/proxy/%id%",materials:"/api/newsfeed/v4/frontend/json/[lang]/materials",mainDistrics:"/api/newsfeed/v4/frontend/json/[lang]/articles",occurrences:"/api/newsfeed/v4/frontend/json/[lang]/afisha/%id%/occurrences",abcdRandomLastMaterials:'/api/newsfeed/v4/frontend/json/ru/materials?filter={"entity_suffix":["050","073"],"status":"public","has_image":1}&fields=id,entity_id,lang,date,entity_suffix,status&perPage=20&page=1&sort=-date'},projects:{projectSpecDetail:"/api/projects/v1/frontend/json/[lang]/projects/%id%",festivalDetail:"/api/projects/v1/frontend/json/[lang]/festivals/%id%"},moldings:{moldings:"/api/moldings/v1/frontend/json/[lang]/moldings/%id%"},structure:{institutions:"/api/structure/v1/frontend/json/[lang]/institutions",institution:"/api/structure/v1/frontend/json/[lang]/institutions/%id%",person:"/api/structure/v1/frontend/json/[lang]/persons/%id%"},department:{all:"/api/structure/v1/frontend/json/ru/institutions",personsDetail:"/api/government/v1/json/persons/detail.php?personId=%id%",departmentDetail:"/api/government/v1/json/department/detail.php"},suggest:{newsfeed:"/aisearch/suggest/ais/api/suggests/serp/%query%/",afisha:'/aisearch/ais_searchapi/ru/search/afisha/?q=%query%*&simple_query_string=1&skip_stat=9&filter_not={"f_published":[false]}'},directories:{districts:"/api/directories/v2/frontend/json/territory/districts",areas:"/api/directories/v2/frontend/json/territory/areas",area:"/api/directories/v2/frontend/json/territory/areas/%id%"},"moi-raion":{districts:"/api/moi-raion/v1/districts"},services:{segments:"/services/segments/v1/%mosId%"},search:{weather:"/aisearch/wizards/widgets/section_news/?q=погода&no_cache=1"},foundations:{list:"/api/newsfeed/v4/frontend/json/ru/foundations"},newsRecommender:{recommend:"/api/news-recommender/v1/frontend/json/ru/recommend"}}}).name,n.module("mosapp").service("APsrvc",["UrlSrvc","$q","$rootScope","$window",function(e,t,i,n){var r={default:"audioPlayer",v4:"audioPlayer_v4"};this.playerLoad=function(o){return t((function(t){var s,l=o.skin&&r[o.skin]||r.default;if(i.audioPlayer)"ready"!==i.audioPlayer.status?(s=document.getElementById("jplayerapiscript"),a(s).on("load",(function(){t()}))):t();else if(i.audioPlayer={},i.audioPlayer.status="load",(s=document.createElement("script")).id="jplayerapiscript",s.async="true",document.getElementsByTagName("head")[0].appendChild(s),s.src=e.jsPath("jplayer/jquery.jplayer.min.js"),a(s).on("load",(function(){i.audioPlayer.api=n.jPlayer,i.audioPlayer.status="ready",t()})),!o.nocss){var c=document.createElement("link");c.rel="stylesheet",c.href=e.assetsPath("static/jplayer/skin/"+l+".css"),c.type="text/css",document.getElementsByTagName("head")[0].appendChild(c)}}))}}]).name,n.module("newsMedia.audioPlayer",[]).directive("mosAudioPlayer",["UrlSrvc","APsrvc",function(e,t){return{restrict:"A",scope:{audioFormat:"@",audioHref:"@",audioVolum:"@",autoPlay:"=",audioTitle:"="},template:'<div class="media"><a rel="" href=""></a></div>',link:function(i,n,r){i.initPlayer=function(){t.playerLoad({skin:"v4"}).then((function(){i.createPlayer()}),(function(){}))},i.initPlayer(),i.createPlayer=function(){i.audioPlay=r.audioPlay,i.audioFormat=r.audioFormat,i.audioHref=r.src||r.audioHref,i.audioVolum=r.audioVolum;var t,o=a(n),s=a('<div class="audioplayer"></div>').prependTo(o),l=i.audioTitle||"",c={},d="",m=o.attr("id")?o.attr("id"):"a"+(new Date).getTime();o.find(".media a").each((function(e){d+=e>0?","+i.audioFormat:i.audioFormat,c[i.audioFormat]=i.audioHref})),i.audioVolum?(t=i.audioVolum,null!=localStorage.getItem("volume")&&(t=localStorage.getItem("volume"))):t=.6,a('<div id="container_'+m+'" class="nota_audio"><div class="nota_title-container"><div class="nota_title">'+l+'</div></div><div class="nota_type-single"><div id="notaplayer_'+m+'" class="nota_jplayer"></div><div class="nota_gui"><div class="nota_interface"><div class="nota_progress-container"><div class="nota_progress jp-progress-slider"><div class="nota_seek-bar"><div class="nota_play-bar"><div class="nota_time-container"><span class="nota_current-time"></span></div></div></div></div><div class="nota_time-tooltip"><span>00:00</span><i></i></div><div class="nota_duration"></div></div><div class="nota_controls-holder"><div class="nota_controls"><a href="javascript:;" class="nota_play" tabindex="1"><span class="icon-play_grey">воспр.</span></a><a href="javascript:;" class="nota_pause" tabindex="1"><span class="icon-pause_grey">пауза</span></a><a href="javascript:;" class="nota_stop" tabindex="1"><span  class="icon-pause_grey">стоп</span></a><div class="nota_rewind-controls"><a href="javascript:;" class="nota_rewind" tabindex="1"><span class="icon-rewind_grey">назад</span></a><a href="javascript:;" class="nota_fastforward" tabindex="1"><span  class="icon-fastforward_grey">стоп</span></a></div><div class="nota_volume-controls"><a href="javascript:;" class="nota_mute" tabindex="1" title="выкл."><span class="icon-mute_grey">выкл.</span></a><a href="javascript:;" class="nota_unmute" tabindex="1" title="вкл."><span class="icon-unmute_grey">вкл.</span></a><a href="javascript:;" class="nota_volume-max" tabindex="1" title="max volume"><span class="icon-mute_grey">вжарить</span></a><div class="nota_volume-bar"><div class="nota_volume-bar-value"></div></div></div></div></div></div></div><div class="errorlayer"><div class="errorstatus"></div></div><div class="waitinglayer"><div class="waitingstatus">Подождите, загрузка...</div></div><div class="nota_no-solution"><span>Нужен плагин</span>Для воспроизведения аудио вам нужно обновить браузер или <a href="http://get.adobe.com/flashplayer/" target="_blank">Flash plugin</a>.</div></div></div>').appendTo(s);var u,p=0,f=0,g=0,h=0,v=0,y=0,w=s.find(".errorlayer"),b=w.find(".errorstatus"),_=s.find(".waitinglayer");"apready"!=s.data("apready")&&(a("#notaplayer_"+m).jPlayer({ready:function(){var e=a(this);e.jPlayer("setMedia",c),s.data("apready","apready"),i.autoPlay&&e.jPlayer("play",0)},loadedmetadata:function(){},timeupdate:function(){},error:function(e){var t=a(this);null!=e.jPlayer.status.currentTime&&e.jPlayer.status.currentTime>0&&(p=e.jPlayer.status.currentTime,f=e.jPlayer.status.currentPercentRelative,g=e.jPlayer.status.currentPercentAbsolute,h=e.jPlayer.status.currentTime,v=e.jPlayer.status.duration,y=e.jPlayer.status.remaining),"play"==u&&(window.setTimeout((function(){e.jPlayer.status.currentPercentRelative=f,e.jPlayer.status.currentPercentAbsolute=g,e.jPlayer.status.currentTime=h,e.jPlayer.status.duration=v,e.jPlayer.status.remaining=y,w.css("display",""),t.jPlayer("play",p)}),1e4),w.css("display","block"),b.html("Соединение с сервером прервано.<br>Восстановление соединения..."))},play:function(){u="play"},pause:function(){u="pause"},stop:function(){u="stop"},waiting:function(){_.css("display","block")},canplay:function(){_.css("display","")},seeking:function(e){p=e.jPlayer.status.currentTime},swfPath:e.jsPath("jplayer/"),errorAlerts:!1,cssSelectorAncestor:"#container_"+m,cssSelector:{play:".nota_play",pause:".nota_pause",stop:".nota_stop",seekBar:".nota_seek-bar",playBar:".nota_play-bar",mute:".nota_mute",unmute:".nota_unmute",volumeBar:".nota_volume-bar",volumeBarValue:".nota_volume-bar-value",volumeMax:".nota_volume-max",currentTime:".nota_current-time",duration:".nota_duration",fullScreen:".nota_full-screen",restoreScreen:".nota_restore-screen",repeat:".nota_repeat",repeatOff:".nota_repeat-off",gui:".nota_gui",noSolution:".nota_no-solution"},volumechange:function(e){var t=e.jPlayer.options.volume;localStorage.setItem("volume",t)},volume:t,supplied:d,wmode:"window",smoothPlayBar:!1,keyEnabled:!1}),s.find(".nota_rewind").on("click",(function(){var e=s.find("#notaplayer_"+m),t=s.find("#notaplayer_"+m).data("jPlayer");if(t){var i=t.status.currentPercentAbsolute-5;i<=0?e.jPlayer("pause",0):e.jPlayer("playHead",i)}})),s.find(".nota_fastforward").on("click",(function(){var e=s.find("#notaplayer_"+m),t=s.find("#notaplayer_"+m).data("jPlayer");if(t){var i=t.status.currentPercentAbsolute+5;i>=100?e.jPlayer("pause",0):e.jPlayer("playHead",i)}})))}}}}]).name);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}var u=n.module("newsMedia.videoPlayer",[]).name;n.module("newsMedia.videoPlayer").directive("mosVideoPlayer",["VPsrvc","UrlSrvc",function(e,t){return{restrict:"A",replace:!0,link:function(i,n,r){i.player=null,i.autoplay=!!i.autoplay,i.playlist=[];var o=r.src;function s(){e.playerLoad({}).then((function(){i.createPlayer(),i.attachPlayerEvents()}),(function(){}))}o?(i.playlist.push([{mp4:o}]),s()):i.$watch("sources",(function(e){void 0!==e&&(i.playlist=[],i.playlist.push(e),s())})),i.createPlayer=function(){a(n).flowplayer({playlist:i.playlist,swf:t.jsPath("flowplayer/flowplayer.swf")}),i.player=flowplayer(n[0]),i.autoplay&&i.player.play(0),i.isAutoStart&&a(".fp-ui").trigger("click")},i.attachPlayerEvents=function(){i.player.bind("resume",(function(){r.evtPlay&&i.evtPlay({state:"play"})})),i.player.bind("pause",(function(){r.evtPause&&i.evtPause({state:"pause"})})),i.player.bind("stop",(function(){r.evtStop&&i.evtStop({state:"stop"})})),i.player.bind("fullscreen",(function(){void 0!==window.$mos_layouts&&window.$mos_layouts.api.header.set("displayHeader",!1)})),i.player.bind("fullscreen-exit",(function(){void 0!==window.$mos_layouts&&window.$mos_layouts.api.header.set("displayHeader",!0)}))}},scope:{isAutoStart:"@",sources:"=",evtPlay:"&",evtPause:"&",evtStop:"&",autoplay:"=?"},template:'<div class="b-video-player"></div>'}}]).directive("mosVideoJs",["VPsrvc",function(e){return{restrict:"A",link:function(t,i){t.player=null,t.$watch("sources",(function(e){(void 0!==e||i.find("source").length)&&t.initPlayer()})),t.$on("$destroy",(function(){t.player&&t.player.dispose()})),t.initPlayer=function(){i.hasClass("vjs-big-play-centered")||i.addClass("vjs-big-play-centered");var r={fluid:!1,preload:"auto",techOrder:["flash","html5"],controls:!0,autoplay:!!t.isAutoStart};if(t.image&&(r.poster=t.image),t.sources)r.sources=t.sources;else{var o=i.find("source");o.length&&n.forEach(o,(function(e){var t=navigator.userAgent.toLowerCase(),a=-1!=t.indexOf("android");((-1!=t.indexOf("ipad")||-1!=t.indexOf("iphone")||-1!=t.indexOf("windows phone"))&&"m3u"==e.dataset.format||a&&"m3u8"==e.dataset.format)&&i[0].replaceChild(e,i[0].firstChild)})),"flv"===i[0].firstChild.dataset.format?function(e){if(void 0===navigator.plugins||"object"!=m(navigator.plugins["Shockwave Flash"])){var t=a('<div style="height: 150px; background-color: rgba(0, 0, 0, 0.05); display: table; width: 100%; text-align: center;"><div style="display: table-cell; vertical-align: middle;">Чтобы воспроизвести видеопоток требуется <a href="http://www.adobe.com/go/getflashplayer"> установить Flash-плеер </a>.</div></div>');e.replaceWith(t)}else s()}(i):s()}function s(){e.playerVideoJSLoad({}).then((function(){t.player=videojs(i[0],r,(function(){var e=this;this.ready((function(){e.poster(r.poster),e.el_&&a(e.el_).find(".vjs-poster").css("background-image",r.poster)}))}))}),(function(){}))}}},scope:{isAutoStart:"=?",sources:"=",image:"@"}}}]).service("VPsrvc",["UrlSrvc","$q","$rootScope","$window","$timeout",function(e,t,i,n,r){this.playerLoad=function(e){return t((function(t){var r;if(i.videoPlayer)"ready"!==i.videoPlayer.status?(r=document.getElementById("flowplayerapiscript"),a(r).on("load",(function(){t()}))):t();else if(i.videoPlayer={},i.videoPlayer.status="load",(r=document.createElement("script")).id="flowplayerapiscript",r.async="true",document.getElementsByTagName("head")[0].appendChild(r),r.src="/news/assets/static/flowplayer/flowplayer.min.js",a(r).on("load",(function(){i.videoPlayer.api=n.flowplayer,i.videoPlayer.status="ready",i.videoPlayer.api.conf={splash:!0,key:"$219658761613389, $156847843995181, $217505261009336, $438958512312610"},t()})),!e.nocss){var o=document.createElement("link");o.rel="stylesheet",o.href="/news/assets/static/flowplayer/playful.css",o.type="text/css",document.getElementsByTagName("head")[0].appendChild(o)}}))},this.playerVideoJSLoad=function(o){return t((function(t){var s,l;if(i.videoPlayerJS)"load"===i.videoPlayerJS.status?r((function e(){"ready"===i.videoPlayerJS.status?t():r(e,100)}),100):t();else{i.videoPlayerJS={},i.videoPlayerJS.status="load",(s=document.createElement("script")).id="videojs_script",s.async="true";var c=document.getElementsByTagName("head")[0];if(c.appendChild(s),s.src=e.jsPath("/videojs/video.js"),a(s).on("load",(function(){(l=document.createElement("script")).id="videojs_hls_script",l.async="true",l.src=e.jsPath("/videojs/videojs-contrib-hls.min.js"),c.appendChild(l),a(l).on("load",(function(){window.videojs.options.flash.swf=e.jsPath("videojs/video-js.swf"),i.videoPlayerJS.api=n.videojs,i.videoPlayerJS.status="ready",t()}))})),!o.nocss){var d=document.createElement("link");d.rel="stylesheet",d.href=e.jsPath("/videojs/video-js.min.css"),d.type="text/css",c.appendChild(d)}}}))}}]);var p=i(7339),f=i(7339),g=n.module("newsMedia.videoMvsr",[]).directive("videoMvsrPlayer",["MvsrPlayerSrvc","$rootScope","$window",function(e,t,i){return{restrict:"A",template:'<div class="videoMvsrPlayer-container" id="player-container-{{::guid}}"></div>',link:function(t,a){t.$watch("guid",(function(e){void 0!==e&&t.initPlayer()})),t.guid=t.videoMvsrPlayer,a.on("$destroy",(function(){t.$destroy()})),t.initPlayer=function(){e.load({}).then((function(){i.publicPlayer&&i.publicPlayer.create({element:"player-container-"+t.guid,guid:t.guid})}),(function(){}))}},scope:{videoMvsrPlayer:"@"}}}]).service("MvsrPlayerSrvc",["$q","$rootScope",function(e,t){function i(){var e=f&&f.fn.jquery;if(e){var t=e.split(".");return{major:t[0],minor:t[1],mod:t[2]}}}this.load=function(){return e((function(e){var n;t.videoMvsrPlayer?"ready"!==t.videoMvsrPlayer.status?(n=document.getElementById("public-player-script"),a(n).on("load",(function(){var t=i();t&&"1"===t.major&&p.noConflict(),e()}))):e():(t.videoMvsrPlayer={},t.videoMvsrPlayer.status="load",(n=document.createElement("script")).id="public-player-script",n.async="true",document.getElementsByTagName("head")[0].appendChild(n),n.src="https://mvsr.mos.ru/player/assets/private-cameras/public-player.js",a(n).on("load",(function(){t.videoMvsrPlayer.status="ready";var a=i();a&&"1"===a.major&&p.noConflict(),e()})))}))}}]).name,h=n.module("newsMedia.2gisMap",[]).directive("mos2GisMap",["$q","$timeout","LangSrvc","GIS2srvc","mos2GisMapSrvc",function(e,t,i,r,o){return{restrict:"A",scope:{center:"=?",height:"=?",zoom:"=?",onClick:"&",controls:"@?",onMapReady:"&",eventsMap:"=?",scrollZoom:"@?",zoomChange:"&",resize:"&",moveend:"&"},transclude:!0,controller:["$scope",function(t){t.mapDeffered=e.defer(),this.getMap=function(){return t.mapDeffered.promise},this.getMapId=function(){return t.mapId}}],link:function(e,s,l){var c,d=e.mapDeffered,m=!1;e.center=e.center||{y:55.751206,x:37.61778},e.zoom=parseInt(l.zoom),e.zoom=isNaN(e.zoom)?12:e.zoom;var u="false"!==e.scrollZoom,p={};function f(){d.promise.then((function(e){t((function(){e.invalidateSize()}),100)}))}e.eventsMap?(p.zoom=!1,p.fullScreen=!1):(p.zoom=!1,p.fullScreen=!0,p.customZoom=!0),e.map=null,e.mapId="map"+(new Date).getTime(),e.mapElement=a('<div id = "'+e.mapId+'"/>').width("auto"),e.height&&e.mapElement.height(e.height),s.attr("data-map-id",e.mapId),a(s).append(e.mapElement),t((function(){e.loader=a('<div class="loader"><div class="loader-image"><div class="cssload-progress cssload-float cssload-shadow"><div class="cssload-progress-item"></div></div></div></div>').appendTo(e.mapElement)}),10),e.zoomIn=function(){gcapi.SetZoomLevelPlus()},e.zoomOut=function(){gcapi.SetZoomLevelMinus()},e.$on("$destroy",(function(){n.element(window).off("resize",f)})),r.loadLibrary().then((function(){function t(){e.loader.remove(),e.mapLoadedAndReady=!0,d.resolve(e.map);var t=i.getCurrentLang();"ru"!==t&&e.map.setLang(t)}return DG.then((function(){return DG.config=Object.assign(DG.config,{tileServer:"//tile{s}.maps.2gis.com/tiles?x={x}&y={y}&z={z}&v=1&ts=online_sd&layerType=nc",retinaTileServer:"//tile{s}.maps.2gis.com/tiles?x={x}&y={y}&z={z}&v=1&ts=online_hd&layerType=nc",poiMetaServer:"//tile{s}.maps.2gis.com/poi?x={x}&y={y}&z={z}&v=1&ts=online_sd&layerType=nc",retinaPoiMetaServer:"//tile{s}.maps.2gis.com/poi?x={x}&y={y}&z={z}&v=1&ts=online_hd&layerType=nc"}),DG.plugin("//2gis.github.io/mapsapi/vendors/Leaflet.markerCluster/leaflet.markercluster-src.js")})).then((function(){e.map=DG.map(e.mapId,{scrollWheelZoom:u,center:[e.center.y,e.center.x],zoom:e.zoom,minZoom:9,zoomControl:p.zoom,fullscreenControl:p.fullScreen}),t(),r.add(e.mapId,e.map),o.setMap(e.mapId,e.map),o.setMapEl(e.mapId,e.mapElement),e.eventsMap&&DG.control.zoom({position:"bottomright"}).addTo(e.map),p.customZoom&&DG.control.customZoom({position:"bottomright"}).addTo(e.map),e.onMapReady&&"function"==typeof e.onMapReady&&e.onMapReady()})),window.onMapApiLoad=t,d.promise})).then((function(t){return l.onClick&&t.on("click",(function(t){e.onClick({event:t})})),t.on("resize",(function(t){e.resize({event:t})})),t.on("moveend",(function(t){m&&e.moveend({event:t})})),t.on("zoom",(function(t){m&&(e.zoomChange({event:t,oldZoom:c}),c=t.target.getZoom())})),t})).then((function(){e.height||(n.element(window).resize(f),f())})).then((function(){e.map.setView([e.center.y,e.center.x],e.zoom)})).then((function(){return new Promise((function(e){t((function(){e()}),400)}))})).then((function(){c=e.map.getZoom(),m=!0}))},template:'<div class="b-egip-map"><div class="b-egip-items" data-ng-transclude="data-ng-transclude"></div></div>'}}]).service("mos2GisMapSrvc",[function(){var e={};return{setMap:function(t,i){e[t]={id:t,map:i,pointsLength:0,latlngs:[]}},getMap:function(t){if(t&&e[t]&&e[t].map)return e[t].map},setMapEl:function(t,i){e[t].el=i},getMapEl:function(t){if(t&&e[t]&&e[t].el)return e[t].el},setPointsLength:function(t,i){e[t].pointsLength=i,e[t].latlngs=[]},addLatLng:function(t,i){e[t].latlngs.push(i)},fitMap:function(t,i){i||(i={}),e[t].pointsLength==e[t].latlngs.length&&e[t].pointsLength>0&&e[t].latlngs.length>0&&(e[t].map.invalidateSize(!0),e[t].map.fitBounds(DG.latLngBounds(e[t].latlngs,{}),i))},senterPoint:function(t,i){var a=e[t].map.getZoom();e[t].map.setView([i.lon,i.lat],a>13?a:13)}}}]).service("GIS2srvc",["$q","mosconfig","$timeout",function(e,t,i){var n={},r="no";this.add=function(e,t){n[e]=t},this.get=function(e){return n[e]},this.loadLibrary=function(){var n=e.defer();if("no"!==r)i((function e(){"yes"===r?n.resolve():"loading"===r&&i(e,100)}),100);else{r="loading";var o=document.createElement("script");o.id="GisApi",o.async="true",document.getElementsByTagName("head")[0].appendChild(o),o.src=t["2GisApi"].url,a(o).on("load",(function(){void 0===window.DG?(r="no",n.reject("API not found")):(r="yes",window.DG.then((function(){DG.Control.CustomZoom=DG.Control.Zoom.extend({onAdd:function(e){var t="mos-custom-zoom",i='<div class="'+t+"__control-icon "+t+'__control-icon_{type}">',a=DG.DomUtil.create("div",t);return this._map=e,this._zoomInButton=this._createButton(DG.Util.template(i,{type:"in"}),this.t("zoom_in"),t+"__control",a,this._zoomIn,this),this._zoomOutButton=this._createButton(DG.Util.template(i,{type:"out"}),this.t("zoom_out"),t+"__control",a,this._zoomOut,this),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),a},_createButton:function(){var e=Array.prototype.slice.call(arguments),t=this._originalCreateButton.apply(this,e),i=t.children[0],a="mos-custom-zoom__control_active",n="mos-custom-zoom__icon_active";return DG.DomEvent.on(t,"touchstart",(function(){DG.DomUtil.addClass(t,a),DG.DomUtil.addClass(i,n)})).on(t,"touchend touchcancel",(function(){DG.DomUtil.removeClass(t,a),DG.DomUtil.removeClass(i,n)})),t}}),DG.control.customZoom=function(e){return new DG.Control.CustomZoom(e)}})),n.resolve())}))}return n.promise}}]).name,v=n.module("newsMedia.2gisMap").directive("mos2GisMapMarker",["UrlSrvc","mosconfig","$q","apiSrvc","$timeout","GIS2srvc","mosconfig",function(e,t,i,r,o,s,l){return{restrict:"A",scope:{address:"=?",latLng:"=?",label:"=?",labelClass:"=?",labelPosition:"=?",focus:"=?",focusZoom:"@?",iconUrl:"@",width:"@?",height:"@?",iconClass:"@?",iconOffsetX:"=?",iconOffsetY:"=?",onClick:"&?"},link:function(e,t,i){var c,d;function m(){var t=DG.icon({iconUrl:e.iconUrl,iconSize:[e.width,e.height],iconClass:e.iconClass||"",iconAnchor:[e.iconOffsetX,e.iconOffsetY]});e.marker=DG.marker([e.latLng.y,e.latLng.x],{icon:t}).addTo(e.map);var i={};e.labelPosition&&(i.position=DG.point(e.labelPosition.x,e.labelPosition.y)),e.labelClass&&(i.className=e.labelClass),e.label&&e.marker.bindLabel(e.label,i),e.marker.on("dblclick",h),e.marker.on("click",g);var a=[];e.map.eachLayer((function(e){e._latlng&&a.push(e._latlng)})),a.length&&e.map.fitBounds(DG.latLngBounds(a,{}))}function u(t){var i;if(t.result&&t.result.length){var a=t.result[0].selection;a&&(i=a.replace("POINT(","").replace(")","").split(" ")),2===i.length&&(e.latLng={x:i[0],y:i[1]},m())}}function p(e){if(!e)return"";var t=e.split(",");return 6===t[0].length&&n.isNumber(+t[0])&&t.shift(),t.join(" ")}function f(){e.focusZoom=parseInt(i.focusZoom),e.focusZoom=isNaN(e.focusZoom)?13:e.focusZoom,e.latLng&&e.focus&&(e.map.setView([e.latLng.y,e.latLng.x],e.focusZoom),e.onClick&&e.onClick())}function g(){e.onClick&&e.onClick()}function h(){e.map.setView([e.latLng.y,e.latLng.x],11)}function v(){e.marker&&e.marker.remove()}c=a(t).closest("[data-mos2-gis-map]"),o((function t(){var i;d=c.attr("data-map-id"),e.map=s.get(d),e.map?(e.$watch("iconUrl",(function(t,i){t!==i&&(e.iconUrl=t,e.marker.remove(),m())})),e.$watch("latLng",(function(t,i){t!==i&&(e.marker.remove(),m())})),e.$watch("focus",f),e.$on("$destroy",v),e.latLng&&m(e.latLng),e.address&&(i={q:p(e.address),key:"rukrlf1286",version:"1.3"},r.getDataByUrl(l["2GisApi"].search_url,i,!0).then(u))):o(t,100)}),100)}}}]).name,y=n.module("newsMedia",[c,l,d,u,g,h,v]).name,w=n.module("mosapp.filters.imageSrc",[]).value("imageSet",{defaultImage:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",ratioMask:"x1_",size:{s:"small",m:"middle",b:"big"}}).service("imgSrvc",["mosconfig",function(e){this.isMarkupImage=function(t){return t.indexOf("%markup_images_dir%")>-1?t.replace("%markup_images_dir%",e.imagesPath):t},this.testSrc=function(e){return""!==e&&e},this.testObj=function(e,t){return!!(n.isObject(e)&&n.isObject(e[t])&&n.isDefined(e[t].src)&&this.testSrc(e[t].src))&&e[t].src}}]).filter("imgThumb",["imgSrvc","imageSet",function(e,t){return function(i){var a,r=t.defaultImage;return n.isObject(i)?n.isDefined(i.src)&&e.testSrc(i.src)?e.isMarkupImage(i.src):(a=e.testObj(i,"thumb")||e.testObj(i,"small")||e.testObj(i,"middle")||e.testObj(i,"big"))?e.isMarkupImage(a):r:r}}]).filter("imgShow",["imgSrvc","imageSet",function(e,t){return function(i){var a,r=t.defaultImage;return n.isObject(i)?n.isDefined(i.src)&&e.testSrc(i.src)?e.isMarkupImage(i.src):(a=e.testObj(i,"show")||e.testObj(i,"big")||e.testObj(i,"original"))?e.isMarkupImage(a):r:r}}]).filter("imgDownload",["imgSrvc","imageSet",function(e,t){return function(i){var a,r=t.defaultImage;if(n.isObject(i)){if(n.isDefined(i.src)&&e.testSrc(i.src))return e.isMarkupImage(i.src);if(a=e.testObj(i,"download")||e.testObj(i,"show")||e.testObj(i,"big")||e.testObj(i,"original")){var o=e.isMarkupImage(a);0===(o=o.split("/").pop()).indexOf("undefined(",0)&&(a=e.testObj(i,"show")||e.testObj(i,"big")||e.testObj(i,"original"))}return a?e.isMarkupImage(a):r}return r}}]).filter("imageSrc",["imgSrvc","imageSet",function(e,t){return function(i){var a,r=t.defaultImage;return n.isObject(i)?n.isDefined(i.src)&&e.testSrc(i.src)?e.isMarkupImage(i.src):(a=e.testObj(i,"small")||e.testObj(i,"middle")||e.testObj(i,"big"))?e.isMarkupImage(a):r:r}}]).filter("imageSrcBig",["imgSrvc","imageSet",function(e,t){return function(i){var a,r=t.defaultImage;return n.isObject(i)?n.isDefined(i.src)&&e.testSrc(i.src)?e.isMarkupImage(i.src):(a=device.mobile()?e.testObj(i,"small")||e.testObj(i,"middle")||e.testObj(i,"big"):device.tablet()?e.testObj(i,"middle")||e.testObj(i,"big")||e.testObj(i,"small"):e.testObj(i,"big")||e.testObj(i,"middle")||e.testObj(i,"small"))?e.isMarkupImage(a):r:r}}]).filter("imageSrcMiddle",["imgSrvc","imageSet",function(e,t){return function(i){var a,r=t.defaultImage;return n.isObject(i)?n.isDefined(i.src)&&e.testSrc(i.src)?e.isMarkupImage(i.src):(a=e.testObj(i,"middle")||e.testObj(i,"big")||e.testObj(i,"small"))?e.isMarkupImage(a):r:r}}]).filter("imageSetSrc",["imgSrvc","imageSet",function(e,t){return function(i,a,r,o,s,l){var c,d=t.defaultImage,m=document.documentElement.clientWidth,u=o;m&&(u=a,m>480&&(u=r),m>768&&(u=o),m>1024&&(u=s),m>1280&&(u=l));var p=(u=u.split("|"))[1]||"3",f=u[2]||"m";return n.isObject(i)?n.isDefined(i.src)&&e.testSrc(i.src)?e.isMarkupImage(i.src):(c=e.testObj(i,p+t.ratioMask+f)||e.testObj(i,t.size[f]))?e.isMarkupImage(c):d:d}}]).filter("imageSrcOriginal",["imgSrvc","imageSet",function(e,t){return function(i){var a,r=t.defaultImage;return n.isObject(i)?n.isDefined(i.src)&&e.testSrc(i.src)?e.isMarkupImage(i.src):(a=e.testObj(i,"original")||e.testObj(i,"big")||e.testObj(i,"middle")||e.testObj(i,"small"))?e.isMarkupImage(a):r:r}}]).filter("imgFileName",["imgSrvc",function(e){return function(t){var i;return n.isObject(t)&&(i=n.isDefined(t.src)&&e.testSrc(t.src)?e.isMarkupImage(t.src):e.isMarkupImage(e.testObj(t,"original")))?i.split("/").pop():"Moscow.jpg"}}]).directive("fixHeadImage",[function(){return{restrict:"A",scope:{},link:function(e,t){t.on("$destroy",(function(){e.$destroy()})),e.EL=a(t),e.HDR=a(".b-header.attached"),e.WND=a(window),e.WND.on("scroll",(function(){var t=e.EL.offset().top,i=e.HDR.length?e.HDR.height():0,a=e.WND.scrollTop();a=a>t-i?a+i-t:0,e.EL.css({"background-position":"center "+a+"px"})}))}}}]).directive("imageSetElement",["imgSrvc","imageSet","$timeout","toolsSrvc","loaderIndicator",function(e,t,i,a,r){return{restrict:"A",link:function(o,s){s.on("$destroy",(function(){o.$destroy()})),o.removeLoader=function(){var e=s;o.loaderType&&(e={loaderType:o.loaderType,elems:s}),r.switchOff(e)},o.firstStart=!0,o.getSrc=function(){var i,a,l,c=t.defaultImage;if(a=s.width(),l=s.height(),o.firstStart){var d=s;o.loaderType&&(d={loaderType:o.loaderType,elems:s}),r.switchOn(d)}var m=Math.round(a/l);m=(m=m>4?4:m)<1?1:m;var u="s";return a>480&&(u="m"),a>800&&(u="b"),n.isObject(o.imageSetElement)?n.isDefined(o.imageSetElement.src)&&e.testSrc(o.imageSetElement.src)?e.isMarkupImage(o.imageSetElement.src):(i=e.testObj(o.imageSetElement,m+t.ratioMask+u)||e.testObj(o.imageSetElement,t.size[u]))?e.isMarkupImage(i):c:c},o.setBackground=function(){o.firstStart&&(o.firstStart=!1,a.hideContentArea(n.element(s))),o.removeLoader(),s.css("background-image",'url("'+o.img.src+'")'),a.showContentArea(n.element(s))},o.loadBackground=function(){o.img=new Image,o.img.src=o.getSrc(),n.element(o.img).on("load",o.setBackground).on("error",o.removeLoader)},i((function(){o.childImgEl=s.children("img"),o.childImgEl.length&&o.childImgEl[0]?o.$watch((function(){return o.childImgEl[0].src}),(function(){i.cancel(o.loadBGTimer),o.loadBGTimer=i((function(){o.loadBackground()}),1e3)})):(o.loadBackground(),o.enableWatch&&(o.parentNode=n.element(s[0].parentNode),o.$watch((function(){return{width:s.width(),height:s.height()}}),(function(e,t){e.width===t.width&&e.height===t.height||o.loadBackground()}),!0)))}))},scope:{imageSetElement:"=",loadHeight:"@",enableWatch:"@",loaderType:"@"}}}]).directive("imgSpacer",[function(){return{restrict:"A",link:function(e,t,i){var n="imgSpacer"+(new Date).getTime()+(9998*Math.random()+1);t.on("$destroy",(function(){a(window).off("resize."+n),e.$destroy()})),e.attrParams=i.imgSpacer,e.attrParams=e.attrParams.split(":"),e.params={};for(var r=e.attrParams.length;r--;){var o=e.attrParams[r].split("|");e.params[o[0]]=o[1]}e.images={"1x1":"data:image/gif;base64,R0lGODlhDwAPAIAAAP///wAAACH5BAEAAAAALAAAAAAPAA8AAAINhI+py+0Po5y02otnAQA7","2x1":"data:image/gif;base64,R0lGODlhHgAPAIAAAP///wAAACH5BAEAAAAALAAAAAAeAA8AAAIThI+py+0Po5y02ouz3rz7D4ZTAQA7","3x1":"data:image/gif;base64,R0lGODlhLQAPAIAAAP///wAAACH5BAEAAAAALAAAAAAtAA8AAAIYhI+py+0Po5y02ouz3rz7D4biSJbmiTYFADs=","4x1":"data:image/gif;base64,R0lGODlhPAAPAIAAAP///wAAACH5BAEAAAAALAAAAAA8AA8AAAIchI+py+0Po5y02ouz3rz7D4biSJbmiabqyrZrAQA7"},e.rewriteSet=function(){e.w=document.documentElement.clientWidth,e.set="a",e.w&&(e.set="a",e.w>463&&(e.set="b"),e.w>750&&(e.set="c"),e.w>970&&(e.set="d"),e.w>1170&&(e.set="e")),t[0].src=e.images[e.params[e.set]+"x1"],t[0].style.width="100%",t[0].style.height="auto"},e.rewriteSet(),a(window).on("resize."+n,(function(){e.t&&clearTimeout(e.t),e.t=setTimeout((function(){e.rewriteSet()}),Math.floor(400*Math.random())+100)}))},scope:{imgSpacer:"@"}}}]).directive("imgRatio",["mosconfig","$timeout","imgSrvc","imageSet","toolsSrvc","loaderIndicator",function(e,t,i,r,o,s){return{restrict:"A",link:function(e,l,c){var d="imgRatio"+(new Date).getTime()+(9998*Math.random()+1);l.on("$destroy",(function(){a(window).off("resize."+d),e.$destroy()})),e.images={"1x1":"data:image/gif;base64,R0lGODlhDwAPAIAAAP///wAAACH5BAEAAAAALAAAAAAPAA8AAAINhI+py+0Po5y02otnAQA7","2x1":"data:image/gif;base64,R0lGODlhHgAPAIAAAP///wAAACH5BAEAAAAALAAAAAAeAA8AAAIThI+py+0Po5y02ouz3rz7D4ZTAQA7","3x1":"data:image/gif;base64,R0lGODlhLQAPAIAAAP///wAAACH5BAEAAAAALAAAAAAtAA8AAAIYhI+py+0Po5y02ouz3rz7D4biSJbmiTYFADs=","4x1":"data:image/gif;base64,R0lGODlhPAAPAIAAAP///wAAACH5BAEAAAAALAAAAAA8AA8AAAIchI+py+0Po5y02ouz3rz7D4biSJbmiabqyrZrAQA7"},e.noAnimation="true"===c.noAnimation,e.attrParams=c.imgRatio,e.attrParams=e.attrParams.split(":"),e.params={};for(var m=e.attrParams.length;m--;){var u=e.attrParams[m].split("|");e.params[u[0]]=u[1]}e.parentNode=n.element(l[0].parentNode),e.removeLoader=function(){s.switchOff(e.parentNode[0])},e.firstStart=!0,e.getSrc=function(t){var a,o,l=e.images[t+"x1"];o=e.parentNode.width(),!e.noAnimation&&e.firstStart&&s.switchOn(e.parentNode[0]);var c="s";if(o>480&&(c="m"),o>800&&(c="b"),e.parentNode.height(o/t),n.isObject(e.imgSource)){if(n.isDefined(e.imgSource.src)&&i.testSrc(e.imgSource.src)){var d=i.isMarkupImage(e.imgSource.src);return/^(\/)|(http(s):\/\/)/.test(d)||(d="/"+d),d}return(a=i.testObj(e.imgSource,t+r.ratioMask+c)||i.testObj(e.imgSource,r.size[c]))?i.isMarkupImage(a):l}return l},e.restoreStyle=function(i){e.needForRestore=!1,t.cancel(e.needForRestoreTimer),e.noAnimation||e.removeLoader(),!e.noAnimation&&e.firstStart&&(e.firstStart=!1,o.hideContentArea(e.parentNode)),l[0].src=i,l[0].style.height="auto",e.noAnimation||o.showContentArea(e.parentNode)},e.brokenImageSrc=function(t){c.setBrokenImageSrc&&e.setBrokenImageSrc(t)},e.rewriteSet=function(){e.needForRestore=!0,l[0].style.width="100%";var i=new Image,a=e.params[e.ratio];i.src=e.getSrc(a),e.noAnimation&&(l[0].src=i.src),n.element(i).on("load",(function(){e.needForRestore&&(e.brokenImageSrc(!1),e.restoreStyle(i.src,a))})),n.element(i).on("error",(function(){i.src=e.images[a+"x1"],e.needForRestore&&(e.brokenImageSrc(!0),e.restoreStyle(i.src,a))})),e.needForRestoreTimer=t((function(){e.needForRestore&&(e.brokenImageSrc(!1),e.restoreStyle(i.src,a))}),1e4)},e.getRatio=function(){var e=document.documentElement.clientWidth,t="a";return e&&(t="a",e>463&&(t="b"),e>750&&(t="c"),e>970&&(t="d"),e>1170&&(t="e")),t},e.ratio=e.getRatio(),e.rewriteSet(),e.$watch((function(){return e.parentNode.width()}),(function(t,i){t!==i&&(e.ratio=e.getRatio(),e.parentNode.css({height:t/e.params[e.ratio],overflow:"hidden"}),l[0].style.height="100%",e.t&&clearTimeout(e.t),e.t=setTimeout((function(){e.rewriteSet()}),Math.floor(100*Math.random())+50))}))},scope:{imgRatio:"@",imgSource:"=",noAnimation:"@",setBrokenImageSrc:"=?"}}}]).name,b=n.module("mosapp.extralistPopup",["mgcrea.ngStrap","mosapp","ngAnimate"]).directive("mosExtraListPopup",["$popover","$sce",function(e,t){return{restrict:"A",priority:0,link:function(i,a){var r,o=a.find(i.selector);i.extrasLength=o.length;var s=o.slice(0,i.max-1);(o=o.slice(i.max-1)).detach();var l=n.element('<span class="extraList__item extraList__item-more"><span class="extraList__link link-gray">'+i.moreTitle+"</span></span>"),c=e(l,{scope:i,content:t.trustAsHtml(o.toArray().map((function(e){return e.outerHTML})).join("")),html:!0,placement:"bottom",trigger:"manual",prefixEvent:"extraListPopup"});s.last().after(l),a.removeClass("extraList_hide-items"),l.on("mouseenter mouseover",(function(){c.show(),l.addClass("extraList_open"),clearTimeout(r)})),l.on("mouseleave",(function(){r=setTimeout((function(){c.hide(),l.removeClass("extraList_open")}),200)})),i.$on("extraListPopup.show",(function(e,t){t.$element.on("mouseenter mouseover",(function(){clearTimeout(r)})),t.$element.on("mouseleave",(function(){r=setTimeout((function(){c.hide(),l.removeClass("extraList_open")}),200)}))}))},scope:{max:"=",moreTitle:"@",selector:"@"}}}]).name,_=n.module("newsCards.commonCard",[w,b]).directive("commonCard",["imgSrvc",function(e){return{restrict:"EA",scope:{item:"="},link:function(t,i){function a(){if(n.isObject(t.item)){t.showCard=(t.item.title||t.item.image)&&t.item.href;var i=t.item.type;if(n.isObject(i)&&i.title&&(!i.place||t.typeEnum.indexOf(i.place)<0)&&(i.place=t.typeEnum[0]),(!t.item.modifier||t.modifierEnum.indexOf(t.item.modifier)<0)&&(t.item.modifier=t.modifierEnum[0]),n.isDefined(t.item.image)){t.imageRatio=t.item.imageRatio&&t.imageRatioEnum.indexOf(t.item.imageRatio)>-1?t.item.imageRatio:t.imageRatio;var a=n.isArray(t.item.image)&&n.isObject(t.item.image[0])?t.item.image[0]:t.item.image;if(Array.isArray(t.imageRatio))for(var r=0;r<t.imageRatio.length;r++){var o=e.testObj(a,t.imageRatio[r]);if(o){a=o;break}}else a=e.testObj(a,t.imageRatio);t.image=a||t.item.image}t.item.target=t.item.target||"_top"}}i.on("$destroy",(function(){t.$destroy()})),t.imageRatio=["2x1_m","small"],t.imageRatioEnum=["1x1_m","1x1_s","2x1_b","2x1_m","2x1_s","3x1_b","3x1_m","3x1_s","4x1_b","4x1_m","4x1_s","big","download","middle","original","show","small","thumb"],t.typeEnum=["lead","head"],t.modifierEnum=["default","highlight","strong","molding"],a(),t.$watch("item",(function(){a()}))},template:'<div class="commonCard" data-ng-if="showCard" data-ng-class="[\n    item.type.media,\n    {\n      \'commonCard-highlight\': item.modifier==\'highlight\',\n      \'commonCard-strong\': item.modifier==\'strong\',\n      \'commonCard-molding\': item.modifier === \'molding\',\n    },\n  ]"><a class="commonCard__link link-black" data-ng-href="{{item.href}}" target="{{item.target}}"><span class="commonCard__type" data-ng-if="item.type &amp;&amp; item.type.title &amp;&amp; item.type.place===\'head\'">{{item.type.title}}</span><span class="commonCard__image" data-ng-if="image &amp;&amp; item.image"><img data-ng-src="{{image}}" role="presentation" alt="{{item.title}}" title="{{item.title}}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}"/><span class="commonCard__label" data-ng-if="item.label &amp;&amp; item.modifier !== \'molding\'">{{item.label}}</span><span class="commonCard__typeicon" data-ng-if="item.typeicon &amp;&amp; item.type.media !== \'infographic\'" aria-hidden="true"><svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{{item.typeicon}}"></use></svg><span class="commonCard__info" data-ng-if="item.info">{{item.info}}</span></span></span><span class="commonCard__moldingLabel" data-ng-if="item.label &amp;&amp; item.modifier === \'molding\'"><span class="moldingLabel__text">{{item.label}}</span><div class="moldingLabel__star" ng-if="item.hasStar"></div></span><div class="commonCard__text"><span class="commonCard__extra extraList" ng-if="(item.type &amp;&amp; item.type.title &amp;&amp; item.type.place===\'lead\') || item.icon || (item.extra &amp;&amp; item.extra.length)"><span class="commonCard__type" data-ng-if="item.type &amp;&amp; item.type.title &amp;&amp; item.type.place===\'lead\'">{{item.type.title}}</span><em class="extraList__icon" ng-if="item.icon" ng-bind-html="item.icon"></em><span class="extraList__item" ng-class="{\'extraList__item-icon\':item.icon}" ng-repeat="extraitem in item.extra">{{extraitem.title}}</span></span><br/><span class="commonCard__title" data-ng-if="item.title" data-ng-class="{\n        \'commonCard__title_extra-padding\': !item.extra || !item.extra.length\n      }">{{item.title}}</span></div></a></div>'}}]).name,x=n.module("newsCards.themeCard",[w]).directive("themeCard",["imgSrvc",function(e){return{restrict:"EA",scope:{item:"="},link:function(t,i){if(i.on("$destroy",(function(){t.$destroy()})),n.isObject(t.item)){t.imageRatio=["2x1_m","small"],t.imageRatioEnum=["1x1_m","1x1_s","2x1_b","2x1_m","2x1_s","3x1_b","3x1_m","3x1_s","4x1_b","4x1_m","4x1_s","big","download","middle","original","show","small","thumb"],t.typeEnum=["lead","head"],t.modifierEnum=["default"],t.showCard=(t.item.title||t.item.image)&&t.item.href;var a=t.item.type;if(n.isObject(a)&&a.title&&(!a.place||t.typeEnum.indexOf(a.place)<0)&&(a.place=t.typeEnum[0]),(!t.item.modifier||t.modifierEnum.indexOf(t.item.modifier)<0)&&(t.item.modifier=t.modifierEnum[0]),n.isDefined(t.item.image)){t.imageRatio=t.item.imageRatio&&t.imageRatioEnum.indexOf(t.item.imageRatio)>-1?t.item.imageRatio:t.imageRatio;var r=n.isArray(t.item.image)&&n.isObject(t.item.image[0])?t.item.image[0]:t.item.image;if(Array.isArray(t.imageRatio))for(var o=0;o<t.imageRatio.length;o++){var s=e.testObj(r,t.imageRatio[o]);if(s){r=s;break}}else r=e.testObj(r,t.imageRatio);t.image=r||t.item.image}t.item.target=t.item.target||"_top"}},template:'<div class="themeCard" data-ng-if="showCard"><a class="themeCard__link link-black" data-ng-href="{{item.href}}" target="{{item.target}}"><span class="themeCard__image" data-ng-class="{\'themeCard__image-noimage\':!item.image}"><img data-ng-src="{{image}}" data-ng-if="image &amp;&amp; item.image" alt="{{item.title}}" title="{{item.title}}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}"/></span><span class="themeCard__extra extraList"><span class="extraList__item" ng-class="{\'extraList__item-icon\':item.icon}" ng-repeat="extraitem in item.extra">{{extraitem.title}}</span></span><span class="themeCard__title" data-ng-if="item.title">{{item.text}}</span><span class="themeCard__text" data-ng-if="item.text">{{item.text}}</span></a></div>'}}]).name,A=n.module("newsCards.afishaCard",[w]).directive("afishaCard",["imgSrvc",function(e){return{restrict:"EA",scope:{item:"=",itemIndex:"=",pageIndex:"=",click:"&"},link:function(t,i){if(i.on("$destroy",(function(){t.$destroy()})),n.isObject(t.item)){t.imageRatio="2x1_m",t.imageRatioEnum=["1x1_m","1x1_s","2x1_b","2x1_m","2x1_s","3x1_b","3x1_m","3x1_s","4x1_b","4x1_m","4x1_s","big","download","middle","original","show","small","thumb"],t.typeEnum=["lead","head"],t.modifierEnum=["default","highlight","strong","molding"],t.showCard=(t.item.title||t.item.image)&&t.item.href;var a=t.item.type;if(n.isObject(a)&&a.title&&(!a.place||t.typeEnum.indexOf(a.place)<0)&&(a.place=t.typeEnum[0]),(!t.item.modifier||t.modifierEnum.indexOf(t.item.modifier)<0)&&(t.item.modifier=t.modifierEnum[0]),n.isDefined(t.item.image)){t.imageRatio=t.item.imageRatio&&t.imageRatioEnum.indexOf(t.item.imageRatio)>-1?t.item.imageRatio:t.imageRatio;var r=n.isArray(t.item.image)&&n.isObject(t.item.image[0])?t.item.image[0]:t.item.image;r=e.testObj(r,t.imageRatio),t.image=r||t.item.image}t.item.target=t.item.target||"_top"}},template:'<div class="afishaCard" ng-class="{\'top-border\': (itemIndex &gt; 3 || pageIndex &gt; 1)}"><div class="afishaCard__content"><a class="afishaCard__link link-black" href="{{item.href}}" target="{{item.target}}" data-ng-click="click({ $event })"><div class="afishaCard__image" data-ng-if="item.hasImage"><figure class="afishaCard__figure" data-ng-if="image &amp;&amp; item.image"><img data-ng-src="{{image}}" alt="{{item.title}}" title="{{item.title}}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}"/></figure></div><div class="afishaCard__text" data-ng-if="item.title"><div class="afishaCard__extra" data-ng-if="item.date"> {{item.date}}</div><div class="card__label card__label-transparent" data-ng-if="item.label">{{item.label}}</div><div class="afishaCard__title" data-ng-if="item.title">{{item.title}}</div></div></a></div></div>'}}]).name,S=n.module("newsCards.articleCard",[w]).directive("articleCard",["imgSrvc",function(e){return{restrict:"EA",scope:{item:"=",itemIndex:"=",pageIndex:"=",click:"&"},link:function(t,i){if(t.baseId="article-card-"+(t.item.id||Date.now()),i.on("$destroy",(function(){t.$destroy()})),n.isObject(t.item)){t.imageRatio="2x1_m",t.imageRatioEnum=["1x1_m","1x1_s","2x1_b","2x1_m","2x1_s","3x1_b","3x1_m","3x1_s","4x1_b","4x1_m","4x1_s","big","download","middle","original","show","small","thumb"],t.typeEnum=["lead","head"],t.modifierEnum=["default","highlight","strong","molding"],t.showCard=(t.item.title||t.item.image)&&t.item.href;var a=t.item.type;if(n.isObject(a)&&a.title&&(!a.place||t.typeEnum.indexOf(a.place)<0)&&(a.place=t.typeEnum[0]),(!t.item.modifier||t.modifierEnum.indexOf(t.item.modifier)<0)&&(t.item.modifier=t.modifierEnum[0]),n.isDefined(t.item.image)){t.imageRatio=t.item.imageRatio&&t.imageRatioEnum.indexOf(t.item.imageRatio)>-1?t.item.imageRatio:t.imageRatio;var r=n.isArray(t.item.image)&&n.isObject(t.item.image[0])?t.item.image[0]:t.item.image;r=e.testObj(r,t.imageRatio),t.image=r||t.item.image}t.item.target=t.item.target||"_top"}},template:'<div class="articleCard" ng-class="{\'top-border\': (itemIndex &gt; 3 || pageIndex &gt; 1)}"><div class="articleCard__content"><a class="articleCard__link link-black" href="{{item.href}}" target="{{item.target}}" data-ng-click="click({ $event })" aria-labelledby="{{baseId}}-date {{baseId}}-sphere {{baseId}}-title"><div class="articleCard__image" data-ng-if="item.hasImage"><figure class="articleCard__figure" data-ng-if="image &amp;&amp; item.image"><img data-ng-src="{{image}}" alt="{{item.title}}" title="{{item.title}}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}"/></figure></div><div class="articleCard__text" data-ng-if="item.title"><div class="articleCard__wrapper"><div class="articleCard__extra" data-ng-if="item.date" id="{{baseId}}-date"> {{item.date}}</div><div class="card__label card__label-transparent" id="{{baseId}}-sphere" data-ng-if="item.label || (item.extra &amp;&amp; item.extra.length &gt; 0)">{{item.label || item.extra[0].title}}</div></div><div class="articleCard__title" data-ng-if="item.title" id="{{baseId}}-title">{{item.title}}</div></div></a></div></div>'}}]).name,C=n.module("newsCards.eventCard",[w]).directive("eventCard",["imgSrvc",function(e){return{restrict:"EA",scope:{item:"=",itemIndex:"=",pageIndex:"=",click:"&"},link:function(t,i){if(i.on("$destroy",(function(){t.$destroy()})),n.isObject(t.item)){t.imageRatio="2x1_m",t.imageRatioEnum=["1x1_m","1x1_s","2x1_b","2x1_m","2x1_s","3x1_b","3x1_m","3x1_s","4x1_b","4x1_m","4x1_s","big","download","middle","original","show","small","thumb"],t.typeEnum=["lead","head"],t.modifierEnum=["default","highlight","strong","molding"],t.showCard=(t.item.title||t.item.image)&&t.item.href;var a=t.item.type;if(n.isObject(a)&&a.title&&(!a.place||t.typeEnum.indexOf(a.place)<0)&&(a.place=t.typeEnum[0]),(!t.item.modifier||t.modifierEnum.indexOf(t.item.modifier)<0)&&(t.item.modifier=t.modifierEnum[0]),t.item.image){t.imageRatio=t.item.imageRatio&&t.imageRatioEnum.indexOf(t.item.imageRatio)>-1?t.item.imageRatio:t.imageRatio;var r=n.isArray(t.item.image)&&n.isObject(t.item.image[0])?t.item.image[0]:t.item.image;r=e.testObj(r,t.imageRatio),t.image=r||t.item.image}else t.image="/news/assets/static/images/placeholder-event.png";t.item.target=t.item.target||"_top"}},template:'<div class="eventCard" ng-class="{\'top-border\': (itemIndex &gt; 1 || pageIndex &gt; 1)}"><div class="eventCard__content"><a class="eventCard__link link-black" href="{{item.href}}" target="{{item.target}}" data-ng-click="click({$event, item})"><div class="eventCard__image"><figure class="eventCard__figure"><img data-ng-src="{{image}}" alt="{{item.title}}" title="{{item.title}}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}"/></figure></div><div class="eventCard__text" data-ng-if="item.title"><div class="eventCard__wrapper-extra" data-ng-class="{\'eventCard__wrapper-extra--flexWrap\':item.label}"> <div class="eventCard__free-label" data-ng-if="item.label"> {{item.label}}</div><div class="eventCard__extra" data-ng-if="item.date"> {{item.date}}</div><div class="card__label card__label-transparent">{{item.spheres}}</div></div><div class="eventCard__title" data-ng-if="item.title">{{item.title}}</div></div></a></div></div>'}}]).name,k=n.module("newsCards.textOverImageCard",[w]).directive("textOverImageCard",["imgSrvc",function(e){return{restrict:"EA",scope:{item:"="},link:function(t,i){if(i.on("$destroy",(function(){t.$destroy()})),n.isObject(t.item)){if(t.imageRatio="2x1_m",t.imageRatioEnum=["1x1_m","1x1_s","2x1_b","2x1_m","2x1_s","3x1_b","3x1_m","3x1_s","4x1_b","4x1_m","4x1_s","big","download","middle","original","show","small","thumb"],t.showCard=(t.item.title||t.item.image)&&t.item.href,n.isDefined(t.item.image)){t.imageRatio=t.item.imageRatio&&t.imageRatioEnum.indexOf(t.item.imageRatio)>-1?t.item.imageRatio:t.imageRatio;var a=n.isArray(t.item.image)&&n.isObject(t.item.image[0])?t.item.image[0]:t.item.image;a=e.testObj(a,t.imageRatio),t.image=a||t.item.image}t.item.target=t.item.target||"_top"}},template:'<div class="textOverImageCard" data-ng-if="showCard"><a class="textOverImageCard__link" data-ng-href="{{item.href}}" target="{{item.target}}"><div class="textOverImageCard__image" data-ng-if="image" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" data-ng-style="{\'background-image\': \'url(&quot;{{image}}&quot;)\'}"><div class="textOverImageCard__label" data-ng-if="item.label">{{item.label}}</div><div class="textOverImageCard__title" data-ng-if="item.title">{{item.title}}</div></div></a></div>'}}]).name,P=n.module("newsCards.embedSocial",[]).directive("embedSocialRender",[function(){return{restrict:"EA",scope:{code:"@"},link:function(e,t){t.on("$destroy",(function(){e.$destroy()}));var i,n=[{name:"facebook-video",regexp:/facebook\.com\/plugins\/video\.php/},{name:"facebook-post",regexp:/facebook\.com\/plugins\/post\.php/},{name:"instagram",regexp:/instagram\.com/},{name:"vk",regexp:/vk\.com/}],r=decodeURIComponent(escape(window.atob(e.code)));a(t).find(".embed-social").html(r);for(var o=0;o<n.length;o++)n[o].regexp.test(r)&&(i=n[o].name);switch(i){case"facebook-video":e.displayBlock=!0,e.responsiveFrame=!0;break;case"facebook-post":case"vk":e.displayBlock=!0;break;case"instagram":e.displayBlock=!0,window.instgrm&&window.instgrm.Embeds&&window.instgrm.Embeds.process()}},template:'<div class="embed-social-wrapper"><div class="embed-social" data-ng-class="{\'embed-social_displayb\': displayBlock, \'embed-social_resp-frame\': responsiveFrame}"></div></div>'}}]).name,j=n.module("newsCards.personBlockquote",[]).directive("personBlockquote",[function(){return{restrict:"A",scope:{quote:"@",quoteText:"=?",personImage:"@",personName:"@",personPosition:"@"},link:function(e,t){e.quoteText=e.quote.replace(/%quot%/g,'"'),t.on("$destroy",(function(){e.$destroy()}))},template:'<blockquote class="person-blockquote"><svg class="person-blockquote__icon" role="presentation"><use xlink:href="/news/assets/icons/sprite.svg#quote"></use></svg><div class="person-blockquote__content"><div class="person-blockquote__text" data-ng-show="quote">{{quoteText}}</div><div class="person-blockquote-author person-blockquote__author"><img class="person-blockquote-author__image" alt="{{personName+\', \'+personPosition}}" role="presentation" title="{{personName+\', \'+personPosition}}" data-ng-src="{{personImage}}"/><div class="person-blockquote-author__info"><div class="person-blockquote-author__info-name">{{personName}}</div><div class="person-blockquote-author__info-position">{{personPosition}}</div></div></div></div></blockquote>'}}]).name,I=n.module("newsCards.personCard",[]).directive("personCard",[function(){return{restrict:"EA",scope:{item:"="},link:function(e,t){t.on("$destroy",(function(){e.$destroy()})),n.isObject(e.item)&&(e.modifierEnum=["default","highlight","strong","molding"],e.showCard=e.item.surname||e.item.fullname,(!e.item.modifier||e.modifierEnum.indexOf(e.item.modifier)<0)&&(e.item.modifier=e.modifierEnum[0]),e.item.target=e.item.target||"_top")},template:'<div class="personCard" data-ng-if="showCard" data-ng-class="{\n    \'personCard-highlight\': item.modifier === \'highlight\',\n    \'personCard-strong\': item.modifier === \'strong\',\n    \'personCard-molding\': item.modifier === \'molding\',\n  }"><a class="personCard__link" data-ng-href="{{item.href}}" target="{{item.target}}"><div class="personCard__wrapper"><div class="personCard__image" data-ng-if="item.image" data-ng-style="{\'background-image\': \'url(&quot;{{item.image}}&quot;)\'}"></div><div class="personCard__fio" data-ng-if="item.surname"><div class="personCard__surname">{{item.surname}}</div><div class="personCard__name" data-ng-if="item.name">{{item.name}}</div><div class="personCard__patronymic" data-ng-if="item.patronymic">{{item.patronymic}}</div></div><div class="personCard__fio" data-ng-if="!item.surname &amp;&amp; item.fullname">{{item.fullname}}</div></div><div class="personCard__post" data-ng-if="item.post">{{item.post}}</div></a></div>'}}]).name,O=n.module("newsCards.oivCard",[]).directive("oivCard",[function(){return{restrict:"EA",scope:{item:"="},link:function(e,t){t.on("$destroy",(function(){e.$destroy()})),n.isObject(e.item)&&(e.modifierEnum=["default","highlight","strong","molding"],(!e.item.modifier||e.modifierEnum.indexOf(e.item.modifier)<0)&&(e.item.modifier=e.modifierEnum[0]),e.item.target=e.item.target||"_top",e.showCard=!!e.item.title)},template:'<div class="oivCard" data-ng-if="showCard" data-ng-class="{\n    \'oivCard-highlight\': item.modifier == \'highlight\', \n    \'oivCard-strong\': item.modifier == \'strong\', \n    \'oivCard-molding\': item.modifier == \'molding\',\n  }"><a class="oivCard__link" data-ng-href="{{item.href}}" target="{{item.target}}"><div class="oivCard__image" data-ng-if="item.image"><img data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" data-ng-src="{{item.image}}"/></div><div class="oivCard__title" data-ng-if="item.title">{{item.title}}</div></a><div class="oivCard__contacts"></div></div>'}}]).name,E=n.module("newsCards.raionCard",[w]).directive("raionCard",["imgSrvc",function(e){return{restrict:"EA",scope:{item:"="},link:function(t,i){if(i.on("$destroy",(function(){t.$destroy()})),n.isObject(t.item)){t.imageRatio=["2x1_m","small"],t.imageRatioEnum=["1x1_m","1x1_s","2x1_b","2x1_m","2x1_s","3x1_b","3x1_m","3x1_s","4x1_b","4x1_m","4x1_s","big","download","middle","original","show","small","thumb"],t.typeEnum=["lead","head"],t.modifierEnum=["default","highlight","strong","molding"],t.showCard=(t.item.title||t.item.image)&&t.item.href;var a=t.item.type;if(n.isObject(a)&&a.title&&(!a.place||t.typeEnum.indexOf(a.place)<0)&&(a.place=t.typeEnum[0]),(!t.item.modifier||t.modifierEnum.indexOf(t.item.modifier)<0)&&(t.item.modifier=t.modifierEnum[0]),n.isDefined(t.item.image)){t.imageRatio=t.item.imageRatio&&t.imageRatioEnum.indexOf(t.item.imageRatio)>-1?t.item.imageRatio:t.imageRatio;var r=n.isArray(t.item.image)&&n.isObject(t.item.image[0])?t.item.image[0]:t.item.image;if(Array.isArray(t.imageRatio))for(var o=0;o<t.imageRatio.length;o++){var s=e.testObj(r,t.imageRatio[o]);if(s){r=s;break}}else r=e.testObj(r,t.imageRatio);t.image=r||t.item.image}t.item.target=t.item.target||"_top"}},template:'<div class="raionCard" data-ng-if="showCard"><a class="raionCard__link link-black" data-ng-href="{{item.href}}" target="{{item.target}}"><span class="raionCard__image" data-ng-if="image &amp;&amp; item.image"><picture><source srcset="{{image.double}}" media="{{image.media}}"/><source srcset="{{image.single}}"/><img data-ng-src="{{image.single}}" alt="{{item.title}}" title="{{item.title}}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}"/></picture></span><div class="raionCard__text"><span class="raionCard__extra extraList" ng-if="(item.type &amp;&amp; item.type.title &amp;&amp; item.type.place===\'lead\') || item.icon || (item.extra &amp;&amp; item.extra.length) || (item.label &amp;&amp; item.modifier === \'molding\')"><span class="raionCard__type" data-ng-if="item.type &amp;&amp; item.type.title &amp;&amp; item.type.place===\'lead\'">{{item.type.title}}</span><em class="extraList__icon" ng-if="item.icon" ng-bind-html="item.icon"></em><span class="extraList__item" ng-class="{\'extraList__item-icon\':item.icon}" ng-repeat="extraitem in item.extra">{{extraitem.title}}</span></span><br/><span class="raionCard__title" data-ng-if="item.title">{{item.title}}</span></div></a></div>'}}]).name,M=n.module("newsCards.tellyCard",[w]).directive("tellyCard",[function(){return{restrict:"EA",scope:{item:"=",itemIndex:"=",pageIndex:"="},link:function(e,t){t.on("$destroy",(function(){e.$destroy()})),n.isObject(e.item)&&(e.wide=e.item.wide,e.showPowerIcon=e.item.is_powered,e.cropSmall="2x1_m",e.cropBig="2x1_b",e.item.target=e.item.target||"_top")},template:'<a class="tellyCard" href="{{item.href}}" target="{{item.target}}" ng-class="{\'telleyCard_wide\': wide}"><div class="tellyCard__time-and-icon"><time class="tellyCard__time" ng-if="item.date">{{item.date}}</time><span class="tellyCard__alert-icon" ng-if="showPowerIcon"></span></div><span class="tellyCard__alert-icon-square" ng-if="wide &amp;&amp; showPowerIcon"></span><aside class="tellyCard__sphere" ng-if="sphereTitle">{{item.sphereTitle}}</aside><picture><source srcset="{{item.image &amp;&amp; item.image[cropSmall] &amp;&amp; item.image[cropSmall].src ? item.image[cropSmall].src : \'\'}}" media="(max-width: 1023px)"/><source srcset="{{item.image &amp;&amp; item.image[cropBig] &amp;&amp; item.image[cropBig].src ? item.image[cropBig].src : \'\'}}" media="(min-width: 1024px)"/><img src="{{item.image &amp;&amp; item.image[cropBig] &amp;&amp; item.image[cropBig].src ? item.image[cropBig].src : \'\'}}" alt="{{item.title}}" title="{{item.title}}"/></picture><div class="tellyCard__title">{{item.title}}</div></a>'}}]).name,T=n.module("newsCards",[_,x,E,k,P,A,S,C,j,O,I,M]).name,L=n.module("breadcrumbs",[]).controller("BreadcrumbsController",["$scope",function(){}]).name,$=(i.p,i.p,i.p,angular.module("mosapp.filters.prepareDateSince",[]).filter("prepareDateSince",["$filter",function(e){return function(t,i){var a=new Date,n=a.getTimezoneOffset()/60;-3!==n&&(a=new Date(a.getTime()+3600*n*1e3+108e5));var r=Math.abs(t-a.getTime());if(Math.floor(r/864e5)>=1)return e("date")(t,i);var o=Math.floor(r/36e5);if(o>0&&o<24)return o+e("translate")("prepareDateSince.hours");var s=Math.floor(r/6e4);return s>0&&s<60?s+e("translate")("prepareDateSince.minutes"):0==s?e("translate")("prepareDateSince.momentAgo"):e("date")(t,i)}}]).name),R=n.module("newsArticle.embeddedContent.embedMedia",[_,$]).directive("embedMedia",["toolsSrvc","UrlSrvc","$sce","$filter",function(e,t,i,a){return{restrict:"A",scope:{item:"=",type:"@"},link:function(e,n){n.on("$destroy",(function(){e.$destroy()})),e.item.url&&!e.item.target&&(t.isExternalUrl(e.item.url)?e.item.target="_blank":e.item.target="_top");var r="/news/assets/icons/sprite.svg#media-";switch(e.type){case"media_photo":case"main_media_photo":e.typeicon=i.trustAsResourceUrl(r+"camera");break;case"media_video":case"main_media_video":e.typeicon=i.trustAsResourceUrl(r+"play");break;default:e.typeicon=i.trustAsResourceUrl(r+e.type)}e.date=a("prepareDateSince")(1e3*e.item.data.date_timestamp,"d MMMM"),e.cardContent={title:e.item.data.title,image:e.item.data.image,href:e.item.url,target:e.item.target,label:null,type:{media:e.type,title:a("translate")("embedMedia."+e.type),place:"head"},modifier:"strong"},e.typeicon&&(e.cardContent.typeicon=e.typeicon),"media_photo"!==e.type&&"main_media_photo"!==e.type||!e.item.data.count||e.item.data.count&&!isNaN(parseInt(e.item.data.count))&&(e.cardContent.info=e.item.data.count),e.showCard=!0},template:'<common-card data-ng-if="showCard" data-item="cardContent"></common-card>'}}]).name;function D(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var z={type:"newsfeed",section:null,src:window.location.href},q=new function(e){var t=z,i=!1;this.initialize=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!i&&e){t=Object.assign({},z,a);var n=document.createElement("script"),r=document.getElementsByTagName("script")[0];n.src="/shared/counters/spatz.js",r.parentNode.insertBefore(n,r),i=!0}},this.sendStat=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;a||(i=Object.assign({},t,i));var n=e;i.section&&(n=D({},i.section,n)),i.type&&(n=D({},i.type,n)),window.Spatz&&window.Spatz.send({type:i.type,src:i.src,data:n})}}("true"==="True".toLowerCase()),B=q,N="Просмотр новости",U="Поделиться в соцсети",H="Клик по ссылке",G="Клик по баннеру обвесов",V="Показ обвеса на мобильном",F="Клик по обвесу на мобильном",W="Клик по обвесу",Z="Клик по галерее",Y="Взаимодействие с картой",J="Клик по тегу",Q="Клик по сфере",X="Клик по округу",K="Клик по району",ee="Доскролл",te="Закрыл страницу",ie="Потерял фокус",ae="ABC";function ne(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var re=n.module("newsArticle.embeddedContent.embedGallery",[]).directive("embedGallery",["toolsSrvc","$rootScope",function(e,t){return{restrict:"A",scope:{item:"=",additionals:"="},template:'<gallery data-items="images" data-container=".article-content__text-wrap" click-next="onClickNext()" click-prev="onClickPrev()" click-nav-item="onClickNavItem()" click-main-img="onClickMainImg()"></gallery>',link:function(i,a){a.on("$destroy",(function(){i.$destroy()})),i.images=[];for(var r=0;r<i.item.data.length;r++){var o=i.item.data[r];if(n.isObject(o)&&n.isObject(o.original)){var s={},l=o.title||"";""===l&&(s=e.getMetaForImage(config.article.title)),i.images.push({src:o.original.src,alt:l||s.alt,title:l,originalTitle:l,copyright:o.copyright})}}t.materialIdTitle&&(i.onClickNext=function(){B.sendStat(ne({},Z,ne({},t.materialIdTitle,"Листание вправо")))},i.onClickPrev=function(){B.sendStat(ne({},Z,ne({},t.materialIdTitle,"Листание влево")))},i.onClickNavItem=function(){B.sendStat(ne({},Z,ne({},t.materialIdTitle,"Клик по превью")))},i.onClickMainImg=function(){B.sendStat(ne({},Z,ne({},t.materialIdTitle,"Клик по фото")))})}}}]).name,oe=n.module("newsArticle.embeddedContent.embedAudio",[]).directive("embedAudio",[function(){return{restrict:"A",scope:{item:"="},template:'<audio controls="controls" data-mos-audio-player="" src="{{item.data.source}}" data-audio-title="item.data.title" data-audio-href="{{item.data.source}}" data-audio-format="mp3"></audio>',link:function(e,t){t.on("$destroy",(function(){e.$destroy()}))}}}]).name,se=n.module("newsArticle.embeddedContent.embedVideo",[]).directive("embedVideo",[function(){return{restrict:"A",scope:{item:"="},template:"<video data-mos-video-player=\"\" src=\"{{source}}\" data-ng-style=\"{'background-image': background, 'background-size': 'cover'}\"></video>",link:{pre:function(e,t){t.on("$destroy",(function(){e.$destroy()})),e.background='url("'+e.item.data.poster+'")',e.source=e.item.data.source,e.sources=[{mp4:e.source}]}}}}]).name;function le(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var ce=n.module("newsArticle.embeddedContent.embedMap",[]).directive("embedMap",["$rootScope",function(e){return{restrict:"A",replace:!0,scope:{item:"="},template:'<div class="article-content__map-wrapper"><div class="article-content__map" data-mos2-gis-map="" data-controls="zoom" zoom-change="onZoomChange(event, oldZoom)" resize="onMapResize(event)" moveend="onMapMoveend(event)"><div data-mos2-gis-map-marker="" data-lat-lng="{x: item.data.lng, y:  item.data.lat}" data-focus="true" data-focus-zoom="16" data-icon-url="{{\'map-marker-active.svg\' | imagesPath}}" data-width="46" data-height="55" data-icon-offset-x="23" data-icon-offset-y="51" data-label="item.data.title"></div></div></div>',link:function(t,i){i.on("$destroy",(function(){t.$destroy()})),t.onZoomChange=function(t,i){t.target.getZoom()>i?B.sendStat(le({},Y,le({},e.materialIdTitle,"Приблизил"))):B.sendStat(le({},Y,le({},e.materialIdTitle,"Отдалил")))},t.onMapResize=function(t){t.target.fullscreenControl._isFullscreen&&B.sendStat(le({},Y,le({},e.materialIdTitle,"Развернул на весь экран")))},t.onMapMoveend=function(){B.sendStat(le({},Y,le({},e.materialIdTitle,"Передвинул карту")))}}}}]).name,de=i(7339),me=n.module("newsArticle.embeddedContent.embedEhdMap",[]).directive("embedEhdMap",["$timeout","mosconfig",function(e,t){return{restrict:"A",scope:{},compile:function(i){i.addClass("data-mos-map"),e((function(){if(t.mapsLoaderPath)if(document.querySelector('script[src*="'+t.mapsLoaderPath+'"]'))window.$mosMaps&&window.$mosMaps.registerMaps();else{var e=document.createElement("script");e.async=!0,e.src=t.mapsLoaderPath,de("body").append(e)}}),0)}}}]).name,ue=n.module("newsArticle.embeddedContent",[R,re,oe,se,ce,me,$,w]).name;function pe(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var fe=n.module("article.content",[ue]).directive("articleContent",["$compile","$rootScope",function(e,t){return{restrict:"A",scope:{},link:function(i,r){r.on("$destroy",(function(){i.$destroy()})),i.sectionAll=i.sectionNews,i.hideme=!1,i.items={attach:config.article.attach};var o,s,l,c,d,m=config.article.title;r.find("img").each((function(){var e=n.element(this);e[0].alt?(e[0].title=e[0].alt,e[0].emptyAlt=!1):(e[0].alt=m,e[0].emptyAlt=!0)})),o={questionHistory:{selector:".inline_question_history",init:function(e){var t=e.find("a"),i=n.element(document.createElement("ul")).addClass("question-history__list");t.each((function(e,t){var r=a(t).addClass("question-history__list-link"),o=n.element(document.createElement("li")).addClass("question-history__list-item").append(r);i.append(o)}));var r=n.element('\n              <section class="question-history">\n                <div class="question-history__content">\n                  <h3 class="question-history__title">{{ "articleContent.history" | translate }}</h3>\n                </div>\n              </section>\n            ');r.find(".question-history__content").append(i),e.replaceWith(r)}},commonBlockquote:{selector:"blockquote:not(.inline_blockquote)",init:function(e){var t=e.html(),i=n.element('<blockquote class="common-blockquote">'+t+"</blockquote>");e.replaceWith(i)}},personalBlockquote:{selector:".inline_blockquote",init:function(e){var t=e.attr("data-quote");if(t){var i=n.element('<div data-person-blockquote="" data-quote="'+t+'" data-person-name="'+e.attr("data-person-name")+'" data-person-position="'+e.attr("data-person-position")+'" data-person-image="'+e.attr("data-person-image")+'"></div>');e.replaceWith(i)}}},importantFacts:{selector:".inline-important-facts",init:function(e){var t=e.html();e.replaceWith('<div class="important-fact"><div class="important-fact__content"><div class="important-fact__title">{{ "articleContent.facts" | translate }}</div><div class="important-fact__text">'+t+"</div></div></div>")}},lightbox:{selector:"p:not(.inline-carousel) > img:not(.inline-carousel)",init:function(e){e.each((function(e,t){var i=a(t);i.attr({lightbox:"","data-container":".lightbox"}),i.attr("data-jsalt")||!i.attr("alt")||""===i.attr("alt")||i[0].emptyAlt?a('<span class="photo_descr" aria-hidden="true"></span>').insertAfter(i):a('<span class="photo_descr" aria-hidden="true"><span>'+i.attr("alt")+"</span></span>").insertAfter(i),i.wrap('<span class="lightbox"><span class="lightbox__wrapper"></span></span>')}))}},table:{selector:"table",init:function(e){a(e).wrap('<div class="table-overflow"></div>')}}},n.forEach(o,(function(e){var t=r.find(e.selector);if(t.length>0)for(var i=0;i<t.length;i++)e.init(n.element(t[i]))})),i.carousels=(s=r,"inline-carousel",l=[],c={domElements:[],images:[]},d=n.copy(c),r.find("p.inline-carousel, p:has(img.inline-carousel)",s).each((function(){var e=n.element(this);d.domElements.push(e),function(e,t){t.find("img").each((function(){var t=this,i=t.hasAttribute("data-jsalt")?"":t.alt,a=""!==i?i:t.alt;e.images.push({src:t.src,alt:a,title:t.title,originalTitle:i})}))}(d,e),e.next().hasClass("inline-carousel")||(l.push(d),d=n.copy(c))})),l.filter((function(e){return e.images.length>1}))),i.carousels.forEach((function(e,t){e.domElements.shift().replaceWith("<div data-gallery='' data-items='carousels["+t+"].images' data-responsive='[{breakpoint: 1200,settings: {slidesToShow:2,slidesToScroll:1}},{breakpoint: 767,settings: {slidesToShow:1,slidesToScroll:1}}]' data-container='.article-content__text-wrap' data-css='{}' data-css-breakpoints='[{breakpoint:992, css:{}}]'></div>"),e.domElements.forEach((function(e){return e.remove()}))})),function(){for(var e=r.find("[data-entity]"),t={media_photo:0,media_video:0,presentation:0,main_media_photo:0,main_media_video:0,map:0,audio:0,video:0,gallery:0},i=0;i<e.length;i++){var o=n.element(e[i]),s=o.data("entity"),l=-1;t[s]++;for(var c=0;c<config.article.attach.length;c++)config.article.attach[c].marker===s+"_"+t[s]&&(l=c);if(!(l<0&&["ehd-map"].indexOf(s)<0))if("media_photo"===s||"media_video"===s||"presentation"===s||"infographic"===s||"main_media_photo"===s||"main_media_video"===s)o.replaceWith('<div class="embed-media" data-type="'+s+'" data-embed-media="" data-item="items.attach['+l+']"></div>');else if(["ehd-map"].indexOf(s)>-1){var d=a("<div data-embed-"+s+'=""></div>');n.forEach(o[0].dataset,(function(e,t){d[0].dataset[t]=e})),o.replaceWith(d)}else o.replaceWith('<div class="embed-'+s+'" data-embed-'+s+'="" data-item="items.attach['+l+']" data-additionals="items.title"></div>')}}(),r.find("[data-embed-social]").attr({"data-embed-social-render":""}),e(r.contents())(i),i.onClickContent=function(e){"A"===e.target.tagName&&B.sendStat(pe({},H,pe({},t.materialIdTitle,pe({},e.target.innerText,e.target.href))))}}}}]).name,ge=(i.p,Modernizr,n.module("article.image",[])),he=ge.name;function ve(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function ye(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(i),!0).forEach((function(t){we(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ve(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function we(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}ge.directive("articleImage",["$window","toolsSrvc",function(e,t){return{restrict:"A",scope:{srcset:"@"},link:function(i,n){if(i.$watch((function(){return t.colorScheme()}),(function(e){i.colorScheme=e,"contrast"==i.colorScheme?n.addClass("grayscale"):n.removeClass("grayscale")})),i.colorScheme=t.colorScheme(),"contrast"==i.colorScheme&&n.addClass("grayscale"),Modernizr.srcset||!i.srcset)return!1;var r=e.innerWidth,o=!1,s=i.srcset.trim().split(","),l={},c=!1,d=!1,m=!1;function u(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(d=!1,(t||!(r>e.innerWidth))&&m!==l[l.length-1]){var i=Object.keys(l);if(Object.keys(l).some((function(t){if(e.innerWidth<t)return d=l[t],!0})),d||(d=l[i[i.length-1]]),r=e.innerWidth,d&&d!=m){var a=new Image;a.onload=function(){n.attr("src",d),m=d},a.src=d}}}i.image="",Array.isArray(s)?(s.forEach((function(e){(e=e.trim().split(" ")).length<2?o=!0:"w"===e[1].substr(-1)?o||(l[e[1].slice(0,-1)]=e[0]):o=!0})),a(e).on("resize",(function(){clearTimeout(c),e.innerWidth!==r&&(c=setTimeout(u,250))})),u(!0)):o=!0}}}]);var be=/([.$?*|{}()[\]\\/+^])/g;function _e(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(be,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function xe(e){var t,i=new RegExp("(?:^|; )".concat(e.replace(be,"\\$1"),"=([^;]*)"));return function(){if(t)return t;var e=document.cookie.match(i);return t=e?decodeURIComponent(e[1]):void 0}}n.module("mosapp").service("statMoldingsSrvc",["$timeout","$http",function(e,t){function i(t){var a=window.yaCounter32628510;if(a&&"function"==typeof a.getClientID)return a.getClientID();t>0&&e((function(){return i(t--)}),100)}this.sendStat=function(e){e.mosId=this.getMosId()||"",e.clientId=i(10),e.action=a[e.action]||e.action;var n={method:"POST",url:"/stproxy/molding/",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:'"'+e.clientId+'"\t"'+e.mosId+'"\t"'+e.url+'"\t"'+e.action+'"\t"'+e.placeIndex+'"\t"'+e.title+'"'};try{t(n).then((function(){}),(function(){}))}catch(e){}},this.getMosId=xe("mos_id");var a={view:"Показ",click:"Клик"}}]).name,i.p;var Ae=n.module("newsArticle.moldings.moldingArticle",[]).directive("moldingArticle",["UrlSrvc","apiSrvc","LangSrvc","$sce","$filter","$timeout",function(e,t,i,a,r,o){return{restrict:"A",scope:{modelId:"@",type:"@",placeIndex:"@",eventsCtrl:"="},template:'<div class="card-wrapper" data-on-click-capture="" data-url="{{cardContent.href}}" data-place-index="{{placeIndex}}"><common-card class="card" data-ng-if="showCard" data-item="cardContent"></common-card></div>',link:function(s,l,c){if(l.on("$destroy",(function(){s.$destroy()})),s.lang=i.getCurrentLang(),s.modelId){switch(s.params={id:s.modelId,fields:"id,title,image,sphere,spheres",expand:"spheres"},s.type){case"press_news":s.apiPath="pressStory";break;case"proxy":s.apiPath="proxy",s.params.expand=null,s.params.fields="id,title,image,url";break;default:s.apiPath="newsArticle"}t.getData("newsfeed",s.apiPath,s.params,!1,l.find(".card-wrapper")).then((function(t){if(t&&t.data.items&&200===t.status){if(!t.data.items.length)return;s.item=t.data.items[0]}else{if(!t.data||200!==t.status)return;s.item=t.data}"press_news"===s.type?s.url=e.getLangLink(e.pagePath("press",(s.item.sphere?s.item.sphere.id:"gov")+"/"+s.item.id+"/")):"proxy"===s.type?s.url=s.item.url:s.url=e.getLangLink(e.pagePath("news","/item/"+s.item.id+"/")),s.cardContent={title:a.trustAsHtml(s.item.title),image:s.item.image,href:s.url,label:null,extra:[],modifier:"molding",type:{media:s.type}},"press_news"===s.type?(s.cardContent.label=r("translate")("moldingArticle.press_news"),s.cardContent.hasStar=!0):n.isArray(s.item.spheres)&&n.isObject(s.item.spheres[0])&&s.item.spheres[0].title&&s.cardContent.extra.push({title:s.item.spheres[0].title}),s.showCard=!0,s.statParams={placeIndex:s.placeIndex,title:s.item.title,href:s.url},c.eventsCtrl&&o(s.eventsCtrl.onRendered(l,s.statParams))}),(function(){s.eventsCtrl.onApiError(parseInt(s.modelId)),s.showCard=!1}))}}}}]).name,Se=n.module("newsArticle.moldings.moldingAfisha",[]).directive("moldingAfisha",["UrlSrvc","apiSrvc","$timeout","LangSrvc","$sce",function(e,t,i,a,n){return{restrict:"A",scope:{modelId:"@",placeIndex:"@",eventsCtrl:"="},template:'<div class="card-wrapper" data-on-click-capture="" data-url="{{cardContent.href}}" data-place-index="{{placeIndex}}"><common-card class="card" data-ng-if="showCard" data-item="cardContent"></common-card></div>',link:function(r,o,s){o.on("$destroy",(function(){r.$destroy()})),r.lang=a.getCurrentLang(),r.modelId&&t.getData("newsfeed","afishaV4Event",{id:r.modelId,fields:"id,title,image",expand:"spheres"},!1,o.find(".card-wrapper")).then((function(t){r.item=t.data,r.url=e.getLangLink(e.pagePath("afisha","/event/"+r.item.id+"/")),r.cardContent={title:n.trustAsHtml(r.item.title),image:r.item.image,href:r.url,modifier:"molding"},r.item.spheres.length&&r.item.spheres[0].title&&(r.cardContent.label=r.item.spheres[0].title),r.showCard=!0,r.statParams={placeIndex:r.placeIndex,title:r.item.title,href:r.url},s.eventsCtrl&&i(r.eventsCtrl.onRendered(o,r.statParams))}),(function(){r.eventsCtrl.onApiError(parseInt(r.modelId)),r.showCard=!1}))}}}]).name,Ce=(i.p,angular.module("mosapp.filters.dateRange",[]).filter("dateRange",["$filter",function(e){function t(e){var t=new Date(e);if("Invalid Date"!==t.toString())return t;var i=e.split(" ");if(2===i.length){var a=i[0].split("-"),n=i[1].split(":");return new Date(a[0],a[1]-1,a[2],n[0],n[1],n[2])}}return function(i,a){var n,r,o="d MMMM",s="d MMMM yyyy";i=!!i&&t(i),a=!!a&&t(a);var l=new Date,c=l.getTimezoneOffset()/60;if(-3!==c&&(l=new Date(l.getTime()+3600*c*1e3+108e5)),!i&&!a)return"";if(!i||!a){var d=i||a;return r=d.getFullYear()===l.getFullYear(),e("date")(d,r?o:s)}return n=(r=i.getFullYear()===l.getFullYear())?o:s,i.getFullYear()===a.getFullYear()?i.getMonth()===a.getMonth()?i.getDate()===a.getDate()?e("date")(i,n):i.getDate()+" – "+e("date")(a,n):e("date")(i,o)+" – "+e("date")(a,n):e("date")(i,s)+" – "+e("date")(a,s)}}]).name),ke=n.module("newsArticle.moldings.moldingProject",[Ce,k]).directive("moldingProject",["UrlSrvc","apiSrvc","$sce","$filter","$timeout",function(e,t,i,a,n){return{restrict:"A",scope:{modelId:"@",type:"@",placeIndex:"@",eventsCtrl:"="},template:'<div class="card-wrapper" data-on-click-capture="" data-url="{{cardContent.href}}" data-place-index="{{placeIndex}}"><text-over-image-card class="card" data-ng-if="showCard" data-item="cardContent"></text-over-image-card></div>',link:function(r,o,s){if(r.isProject="project"==r.type||"festival"==r.type?"project"==r.type:null,o.on("$destroy",(function(){r.$destroy()})),r.modelId&&null!=r.isProject){var l,c=r.isProject?"projectSpecDetail":"festivalDetail",d=r.isProject?"image":"background";l=r.isProject?"id,title,code,url,image,type":"id,title,code,url,background,type,date_begin,date_end",t.getData("projects",c,{id:r.modelId,expand:d,fields:l},!1,o.find(".card-wrapper")).then((function(t){r.item=t.data,r.item.type&&"outer"===r.item.type&&r.item.url?r.url=r.item.url:r.item.type&&"tilda"===r.item.type&&r.item.code&&(r.url=e.getLangLink(e.pagePath(r.isProject?"projects":"festivals",r.item.code+"/"))),r.cardContent={title:i.trustAsHtml(r.item.title),image:r.item[d].src,href:r.url,modifier:"molding",type:{media:"festival"}},r.item&&279550===r.item.id?r.cardContent.label="":r.cardContent.label=a("translate")("moldingProject."+r.type),r.isProject||(r.cardContent.extra=[{title:a("dateRange")(r.item.date_begin,r.item.date_end)}]),r.showCard=!0,r.statParams={placeIndex:r.placeIndex,title:r.item.title,href:r.url},s.eventsCtrl&&n(r.eventsCtrl.onRendered(o,r.statParams))}),(function(){r.showCard=!1}))}}}}]).name,Pe=(i.p,n.module("newsArticle.moldings.moldingMedia",[_,$]).directive("moldingMedia",["toolsSrvc","UrlSrvc","apiSrvc","$filter","$sce","$timeout",function(e,t,i,a,r,o){return{restrict:"A",scope:{modelId:"@",type:"@",apiRoot:"@",apiPath:"@",placeIndex:"@",eventsCtrl:"="},template:'<div class="card-wrapper" data-on-click-capture="" data-url="{{cardContent.href}}" data-place-index="{{placeIndex}}"><common-card class="card" data-item="cardContent"></common-card></div>',link:function(s,l,c){var d;if(l.on("$destroy",(function(){s.$destroy()})),s.hideme=!0,s.fields="id,title,image,kind",s.target="_top",s.modelId){var m="/news/assets/icons/sprite.svg#media-";switch(s.type){case"media_photo":d="mediaGallery",s.typeicon=r.trustAsResourceUrl(m+"camera"),s.moreUrl=t.pagePath("mayorMain","/media/"),s.url=t.getLangLink(s.moreUrl+"photo/"+s.modelId+"/tiles/1/0/"),s.fields+=",count";break;case"media_video":d="pressVideo",s.typeicon=r.trustAsResourceUrl(m+"play"),s.moreUrl=t.pagePath("mayorMain","/media/"),s.url=t.getLangLink(s.moreUrl+"video/"+s.modelId+"/");break;case"presentation":d="pressPresentation",s.typeicon=r.trustAsResourceUrl(m+s.type),s.moreUrl=t.pagePath("mayorMain","/presentations/"),s.fields+=",href",s.target="_blank";break;case"infographic":d="pressInfographic",s.typeicon=r.trustAsResourceUrl(m+s.type),s.moreUrl=t.pagePath("mayorMain","/infographic/"),s.url=t.getLangLink(s.moreUrl+s.modelId+"/");break;case"main_media_photo":d="mainMediaPhoto",s.typeicon=r.trustAsResourceUrl(m+"camera"),s.moreUrl=t.pagePath("mediaMain",""),s.url=t.getLangLink(s.moreUrl+"photo/"+s.modelId+"/tiles/1/0/"),s.fields+=",count";break;case"main_media_video":d="mainMediaVideo",s.typeicon=r.trustAsResourceUrl(m+"play"),s.moreUrl=t.pagePath("mediaMain",""),s.url=t.getLangLink(s.moreUrl+"video/"+s.modelId+"/")}if(d){var u={id:s.modelId,fields:s.fields};i.getData("newsfeed",d,u,!1,l.find(".card-wrapper")).then((function(e){n.isArray(e.data.items)&&e.data.items.length?s.item=e.data.items[0]:n.isObject(e.data)&&e.data.id&&(s.item=e.data),s.cardContent={title:r.trustAsHtml(s.item.title),image:s.item.image,href:"presentation"===s.type?s.item.href:s.url,label:null,type:{title:a("translate")("moldingMedia."+s.type),place:"lead",media:s.type},modifier:"molding"},s.typeicon&&(s.cardContent.typeicon=s.typeicon),s.target&&(s.cardContent.target=s.target),"media_photo"!==s.type&&"main_media_photo"!==s.type||!s.item.count||s.item.count&&!isNaN(parseInt(s.item.count))&&(s.cardContent.info=s.item.count),s.showCard=!0,s.statParams={placeIndex:s.placeIndex,title:s.item.title,href:"presentation"===s.type?s.item.href:s.url},c.eventsCtrl&&o(s.eventsCtrl.onRendered(l,s.statParams))}),(function(){s.hideme=!0})),s.photoInfo=function(){s.item.count&&!isNaN(parseInt(s.item.count))&&(s.cardContent.info=s.item.count+" "+e.localeNum(s.item.count,[a("translate")("moldingMedia.photoNumOne"),a("translate")("moldingMedia.photoNumFew"),a("translate")("moldingMedia.photoNumMany")]))}}}}}}]).name),je=n.module("newsArticle.moldings.moldingPerson",[]).directive("moldingPerson",["UrlSrvc","apiSrvc","LangSrvc","$timeout",function(e,t,i,a){return{restrict:"A",scope:{modelId:"@",placeIndex:"@",eventsCtrl:"="},template:'<div class="card-wrapper" data-on-click-capture="" data-url="{{cardContent.href}}" data-place-index="{{placeIndex}}"><person-card class="card" data-ng-if="showCard" data-item="cardContent"></person-card></div>',link:function(e,i,r){i.on("$destroy",(function(){e.$destroy()})),e.modelId&&(e.params={id:e.modelId,fields:"id,surname,name,patronymic,fullname,personal_page,thumbnail_url,photo_url",expand:"posts,url"},t.getData("structure","person",e.params,!1,i.find(".card-wrapper")).then((function(t){if(e.item=t.data,e.url=e.item.url||"",e.cardContent={href:e.url,target:"_top",image:e.item.thumbnail_url||e.item.photo_url,surname:e.item.surname,name:e.item.name,patronymic:e.item.patronymic,fullname:e.item.fullname,modifier:"molding"},n.isArray(e.item.posts)){e.posts=[];for(var o=0;o<e.item.posts.length;o++){var s=e.item.posts[o];n.isObject(s)&&!s.hidden&&"без должности"!==s.name&&e.posts.push(s.name)}e.cardContent.post=e.posts.join(", ")}e.showCard=!0,e.statParams={placeIndex:e.placeIndex,title:e.item.fullname,href:e.url},r.eventsCtrl&&a(e.eventsCtrl.onRendered(i,e.statParams))}),(function(){e.showCard=!1})))}}}]).name,Ie=n.module("newsArticle.moldings.moldingOiv",[]).directive("moldingOiv",["UrlSrvc","apiSrvc","mosconfig","$timeout",function(e,t,i,a){return{restrict:"A",scope:{modelId:"@",placeIndex:"@",eventsCtrl:"="},template:'<div class="card-wrapper" data-on-click-capture="" data-url="{{cardContent.href}}" data-place-index="{{placeIndex}}"><oiv-card class="card" data-ng-if="showCard" data-item="cardContent" click="onClickLink($event)"></oiv-card></div>',link:function(n,r,o){r.on("$destroy",(function(){n.$destroy()})),n.modelId&&t.getData("structure","institution",{id:n.modelId,fields:"name,icon",expand:"url"},!1,r.find(".card-wrapper")).then((function(t){n.item=t.data,n.url=n.item.url||"",""===n.item.url||n.item.target||(e.isExternalUrl(n.item.url)?n.item.target="_blank":n.item.target="_top");var s=(i.imagesPath||"")+"oiv-default.svg";n.cardContent={href:n.url,target:n.item.target,image:n.item.icon||s,title:n.item.name,modifier:"molding"},n.showCard=!0,n.statParams={placeIndex:n.placeIndex,title:n.item.name,href:n.url},o.eventsCtrl&&a(n.eventsCtrl.onRendered(r,n.statParams))}),(function(){n.showCard=!1}))}}}]).name,Oe=n.module("newsArticle.moldings.moiRaion",[]).directive("moldingMoiRaion",["$timeout",function(e){return{restrict:"A",scope:{areaId:"=",isCentral:"=",placeIndex:"@",eventsCtrl:"=",isCompiled:"="},controller:"MoldingMoiRaionController",controllerAs:"ctrl",template:'<div class="molding-moi-raion" data-ng-class="{\'molding-moi-raion_central\': isCentral,    \'molding-moi-raion_active\': isActive}"><a class="molding-moi-raion__link" data-on-click-capture="" data-url="{{ ctrl.href }}" data-place-index="{{ placeIndex }}" data-ng-href="{{ ctrl.href }}" target="_top"><div class="mr-navy mr-row plank"><span class="mr-logo"><span class="mr-title" data-ng-if="ctrl.title">{{ ctrl.title }}</span></span></div><div class="mr-body"><div class="mr-content"><span class="mr-red plank"><span>Новости и афиша</span></span><span class="mr-blue plank"><span>Достопримечательности</span></span><span class="mr-green-wrap"><span class="mr-green plank">Планы развития</span><span class="mr-yellow"></span></span></div></div></a></div>',link:function(t,i,a){i.on("$destroy",(function(){t.$destroy()})),t.statParams={placeIndex:"0",title:"Мой район"},a.eventsCtrl&&t.isCompiled&&e(t.eventsCtrl.onRendered(i,t.statParams,{renderSilent:!0})),e((function(){t.isActive=!0}),1e3)}}}]).controller("MoldingMoiRaionController",["$scope","UrlSrvc","apiSrvc",function(e,t,i){var a,n=this;n.href=t.pagePath("myRegion",""),e.areaId&&(a={fields:"mos_id,name,local_id"},i.getData("moi-raion","districts",a,!0).then((function(i){var a=i.data&&i.data.data;if(a&&a.list&&a.list.length){var r=a.list.filter((function(t){return t.mos_id===e.areaId}))[0];r&&(n.href=t.pagePath("myRegion",r.local_id),n.title=r.name,e.statParams.href=n.href)}}),(function(){})))}]).name,Ee=n.module("newsArticle.moldings.adv",[]).directive("moldingAd",["LangSrvc","$rootScope",function(e,t){return{restrict:"A",scope:{adItemCallback:"=",isCompiled:"=",isRerender:"=",settings:"=",material:"="},link:function(i,a){var n=function(e){e.id===i.settings.schmetterlingId&&i.returnResult(!1)};function r(){var e,i,n;document.activeElement===a[0].querySelector("iframe")&&B.sendStat((e={},i=t.materialIdTitle,n=G,i in e?Object.defineProperty(e,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[i]=n,e))}window.addEventListener("mosAdvBannerNotFound",n),window.addEventListener("blur",r),a.on("$destroy",(function(){i.$destroy(),window.removeEventListener("mosAdvBannerNotFound",n),window.removeEventListener("blur",r)})),i.lang=e.getCurrentLang(),"ru"===i.lang&&i.$watch("isRerender",(function(e){var t;e&&i.isCompiled&&((t=document.createElement("script")).src="/api/schmetterling/static/platform/get.js?id=".concat(i.settings.schmetterlingId),a.empty().append(t),i.isRerender=!1)})),i.returnResult=function(e){"function"==typeof i.adItemCallback&&i.adItemCallback(e)}}}}]).name,Me=i(7339);function Te(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function Le(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(i),!0).forEach((function(t){$e(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Te(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function $e(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var Re=window.config&&window.config.sectionCode||"news",De=n.module("newsArticle.moldings",[Ae,Se,ke,Pe,je,Ie,Oe,Ee]),ze=De.name;De.directive("moldingsList",["apiSrvc","$compile","$timeout","$interval","statMoldingsSrvc","LangSrvc","$filter","toolsSrvc","$rootScope","aaaaTestSrvc",function(e,t,i,a,r,o,s,l,c,d){return{restrict:"A",scope:{apiRoot:"@",apiPath:"@",articleId:"=",moiRaionEnable:"=",moiRaionId:"=",moiRaionIsCentral:"=",settings:"="},template:'<div class="moldingsList" ng-class="{\'moldingsList_shadow\': !isTotalScrolled}"><div class="moldingsList__title" ng-if="moiRaionEnable || !removeAdItem || items.length &gt; 0">{{ title }}</div><div class="moldingsList__list" ng-class="{\'moldingsList__list_hidden-items\': !isMoldingsShown}"><div class="moldingsList__item" ng-if="moiRaionEnable" molding-moi-raion="" data-events-ctrl="eventsCtrl" is-compiled="isCompiled" area-id="moiRaionId" is-central="moiRaionIsCentral" place-index="moi_raion"></div><div class="moldingsList__item moldingsList__item-ad" ng-class="{\'hidden\': removeAdItem}"><div class="molding-ad" molding-ad="" settings="settings" is-compiled="isCompiled" is-rerender="isRerender" ad-item-callback="adItemCallback"></div></div></div></div>',link:function(m,u){var p,f;m.title=s("translate")("newsArticle.moldingsTitle"),j();var g=!f;m.isCompiled=!1;var h=[],v={click:W,clickMobile:F,showMobile:V};function y(){p||(p=m.$watch((function(){return Me(".news-article-content").height()}),(function(e){e&&u.outerHeight(Math.floor(e))})))}function w(e){_(),B.sendStat({ab_test:{recommendations:$e({},ae,e)}},{section:Re})}function b(e){var t=e.split(":"),i=parseInt(t[4],10);switch(t[3]){case"articles":return{type:"article",model_id:i,lang:t[5]};case"news":return{type:"press_news",model_id:i,lang:t[5]};default:return}}function _(){m.items=n.copy(m.editorialMoldings),m.items.map((function(e){return e.isVisible=!0})),x()}function x(){for(var e=0;e<m.items.length;e++)if(m.items[e].type){var t=(i=e,a=m.items[e].type,r=m.apiRoot,void 0,void 0,void 0,o=i+1,l={media_photo:(s={media:{moldingType:"media",needType:!0,needApiRoot:n.isDefined(r)},press_news:{moldingType:"article",needType:!0},projects:{moldingType:"project",needType:!0},proxy:{moldingType:"article",needType:!0},default:{moldingType:a,needType:!1}}).media,media_video:s.media,presentation:s.media,infographic:s.media,press_news:s.press_news,project:s.projects,festival:s.projects,main_media_photo:s.media,main_media_video:s.media,proxy:s.proxy}[a]||s.default,n.element('<div class="moldingsList__item" data-events-ctrl="eventsCtrl" data-molding-'+l.moldingType+'="" data-ng-if="items['+i+'].isVisible"  data-model-id="{{items['+i+'].model_id}}"'+(l.needType?' data-type="'+a+'"':"")+(l.needApiRoot?' data-api-root="'+r+'"':"")+' data-place-index="'+o+'"></div>'));m.moldingsList.append(t)}var i,a,r,o,s,l;A()}function A(){i((function(){var e=t(m.moldingsList.html())(m);m.moldingsList.html(e),m.isCompiled=!0,m.windowEvents(),m.bindResize()}))}function S(e){e.action="click",r.sendStat(e)}function C(e,t){var i=v[e];B.sendStat($e({},i,$e({},c.materialIdTitle,$e({},t.placeIndex,$e({},t.title,t.href)))))}function k(e){var t=e.find("img:not(.item_img_loaded)");t.length&&t.off("load").on("load",(function(){t.addClass("item_img_loaded"),m.bindResize()}))}function P(e){m.moldingsList.css("height",""),e&&(e=Math.ceil(e)),m.listItems.css("height",e)}function j(){f=Modernizr&&Modernizr.mq("(max-width: 1279px)")}function I(e){var t=l.debounce(O,100);m.moldingsList.mCustomScrollbar({axis:e,scrollInertia:"x"===e?600:250,scrollButtons:{enable:!1},advanced:{autoUpdateTimeout:1e3,updateOnContentResize:!1,autoExpandHorizontalScroll:!1,alwaysShowScrollbar:2},documentTouchScroll:!0,keyboard:{enable:!1},callbacks:{onCreate:function(){m.isRerender=!0,m.autoupdater()},onInit:function(){},onUpdate:function(){},whileScrolling:function(){this.mcs.topPct>97?m.isTotalScrolled=!0:f||(m.isTotalScrolled=!1),t()},onScroll:function(){}}})}function O(){h.length&&(h=h.filter((function(e){return!l.isInViewport(e.el)||(C("showMobile",e.params),!1)})))}u.on("$destroy",(function(){Me(window).off("resize.moldings"),m.$destroy()})),m.articleId&&(m.moldingsList=u.find(".moldingsList__list"),m.moldingsAdItem=m.moldingsList.find(".moldingsList__item-ad"),m.adItemCallback=function(e){m.removeAdItem=!e,m.isMoldingsShown=!0,i.cancel(m.isMoldingsShownTO),i((function(){f&&O()})),m.removeAdItem&&i((function(){m.moldingsList.hasClass("mCustomScrollbar")&&m.moldingsList.mCustomScrollbar("update")}),100)},f||y(),m.windowEvents=function(){Me(window).off("resize.moldings").on("resize.moldings",m.bindResize)},m.isMoldingsShownTO=i((function(){m.isMoldingsShown=!0,i((function(){f&&O()}))}),5e3),e.getData(m.apiRoot,m.apiPath,{id:m.articleId},!1).then((function(t){var i=t.data.items;if(n.isArray(i)&&i.length){m.editorialMoldings=n.copy(i);var a=o.getCurrentLang();if("news"===Re&&"ru"===a&&d.ABCTestOn)switch(d.getAAAAVariant()){case"group_editorial":_();break;case"group_stats":e.postDataByUrl("https://stats2.mos.ru/api/recomendation/news/",{urn:"urn:mosru:newsfeed:articles:".concat(m.articleId,":").concat(o.getCurrentLang())},void 0,void 0,void 0,!0).then((function(e){return function(e){m.items=[];for(var t=0;t<Math.min(e.length,m.editorialMoldings.length);t++){var i=b(e[t]);void 0!==(i=Le(Le({},i),{},{isVisible:!0}))&&m.items.push(i)}x()}(e.data.items)}),(function(){return w("error_stats")}));break;case"group_random":e.getData("newsfeed","abcdRandomLastMaterials").then((function(e){m.items=[];var t=e.data.items,i=function(e){return parseInt("".concat(e.entity_id).concat(e.entity_suffix),10)};(t=t.filter((function(e){return i(e)!==m.articleId}))).sort((function(){return Math.random()-.5}));for(var a={"073":"article","050":"press_news"},n=0;n<Math.min(m.editorialMoldings.length,t.length);n++){var r=t[n];m.items.push({type:a[r.entity_suffix],model_id:i(r),lang:r.lang,isVisible:!0})}x()}),(function(){return w("error_random")}))}else _()}}),(function(){return A()})),m.eventsCtrl={onApiSend:function(){},onApiOk:function(){},onApiError:function(e){m.items.forEach((function(t){t.model_id===e&&(t.isVisible=!1)}))},onRendered:function(e,t,i){t.action="view",t.url=window.location.href,r.sendStat(t),t.placeIndex&&t.href&&("A"==e[0].tagName&&e.on("click",(function(){C(f?"clickMobile":"click",t),S(t)})),e.on("click","a",(function(){C(f?"clickMobile":"click",t),S(t)}))),(!i||i&&!i.renderSilent)&&(k(e),m.bindResize()),f&&(h.push({el:e[0],params:t}),m.isMoldingsShown&&O())}},m.bindResize=function(){m.Timer&&i.cancel(m.Timer),m.Timer=i((function(){if(m.listItems=m.listItems&&m.listItems.length?m.listItems:m.moldingsList.find(".moldingsList__item"),m.listItems.length){j();var e=m.moldingsList.hasClass("mCustomScrollbar");g!==f?(m.moldingsList.mCustomScrollbar("destroy"),f?(m.isTotalScrolled=!0,p&&(u.outerHeight(""),p(),p=null),i.cancel(m.tDebounce),m.tDebounce=i((function(){P("");var e=0;m.listItems.each((function(){var t=Me(this);e=Math.max(t.outerHeight(),e,316),k(t)})),P(e)})),m.moldingsList.addClass("moldingsList-carousel"),I("x")):(P(""),y(),m.moldingsList.removeClass("moldingsList-carousel"),I("y"))):e&&(m.tUpdDebounce&&i.cancel(m.tUpdDebounce),m.tUpdDebounce=i((function(){m.moldingsList.find(".mCSB_container").css("width","").css("height",""),m.moldingsList.mCustomScrollbar("update")}))),g=f}}),50)},m.autoupdater=function(){m.Interval&&a.cancel(m.Interval),a(m.bindResize,1e3)})}}}]).directive("onClickCapture",["UrlSrvc",function(e){return{restrict:"A",scope:{url:"@",placeIndex:"@"},link:function(t,i){function a(i){i.href==window.location.origin+t.url&&(i.href=e.addParamsToUrl(t.url,{onsite_molding:t.placeIndex}))}i.on("destroy",(function(){t.$destroy()})),"A"==i[0].tagName&&i.on("click",(function(){a(this)})),i.on("click","a",(function(){a(this)}))}}}]),i.p;var qe=i(7339),Be=n.module("newsArticleSharing.links",[]),Ne=Be.name;Be.directive("articleSharing",["$timeout","mosconfig","LangSrvc",function(e,t,a){return{restrict:"A",priority:0,link:function(r,o,s){o.on("$destroy",(function(){return r.$destroy()})),r.lang=a.getCurrentLang(),s.socials||("ru"===r.lang?r.socials="telegram,vk,ok,viber,whatsapp,copy":r.socials="telegram,vk,viber,whatsapp,copy");var l=function(e){return e?String(e).replace(/&\w{4,5};/gm," ").replace(/<[^>]+>/gm,""):""};e((function(){i.e(736).then(i.t.bind(i,5508,19));var e="";if(t.domain){var a=t.domain.indexOf("http");e="".concat(a?"":location.protocol+"//").concat(t.domain).replace(new RegExp("/$"),"")}var s,c,d,m,u,p,f,g,h,v,y,w,b,_,x,A,S,C,k,P,j,I,O,E=r.image&&""!==r.image&&r.image.indexOf("data:image",0)<0?"/open-graph/v1/frontend/".concat(r.image):"".concat(t.imagesPath||"","icon200x200.png"),M=location.pathname;r.image=0===E.indexOf("http")?E:"".concat(e,"/").concat(E.replace(new RegExp("^/"),"")),r.url="https://".concat(e,"/").concat(M.replace(new RegExp("^/"),"")),r.titleText=l(r.title),r.descriptionText=l(r.description),r.utmContent=(s=location.pathname.split("/")).length>=2?2===s[1].length?s[2]:s[1]:"",r.orientation=M.includes("news")||M.includes("mayor")?"vertical":"horizontal",document.addEventListener("onshare",(function(e){var t=e.detail.buttonName;r.share({name:t})})),"vertical"===r.orientation&&(96,205,40,c=o[0],d=n.element(".news-breadcrumbs")[0],m=n.element(".news-article-footer")[0],u=n.element(".news-article-aside")[0],p=n.element(".news-article-container")[0],f=(null==d?void 0:d.offsetHeight)+(null==d?void 0:d.offsetTop),g=window.matchMedia("(min-width: 1024px)"),32,36,h=24,v=0,y=0,w=0,b=0,_=0,x=!1,A=function(){return window.matchMedia("(min-width: 1280px)").matches?32:window.matchMedia("(min-width: 1600px)").matches?36:24},S=function(){var e=null==d?void 0:d.getBoundingClientRect().left,t=parseInt(window.getComputedStyle(d).paddingLeft,10),i=window.matchMedia("(max-width: 1279px)").matches;v=e+t,y=null==p?void 0:p.offsetTop,w=null==m?void 0:m.offsetTop,b=null==m?void 0:m.offsetHeight,_=i?null==u?void 0:u.offsetHeight:0},C=function(){return c.style.left="".concat(v,"px")},k=function(){h=A(),j()},P=function(){S(),x&&(C(),k())},j=function(){var e=window.pageYOffset,t=y-e,i=e+(null==c?void 0:c.offsetHeight)-f+96,a=!!document.querySelector('[class*="Emergency_wrapper"]');if(x=e>=h-(a?f:-(null==d?void 0:d.offsetHeight))+(a?205:0)-b-_,S(),t>h-(a?96:0)?(c.classList.remove("is-sticky"),c.style.top="",c.style.left=""):x?(c.classList.add("is-sticky"),c.style.top="".concat(h+96,"px"),c.style.bottom="",C()):(c.removeAttribute("style"),c.classList.remove("is-sticky"),c.style.top=""),i>=w+(a?c.offsetHeight/2:0)){var n=b+h+_+40;c.classList.remove("is-sticky"),c.style.top="auto",c.style.bottom="".concat(n,"px"),c.style.left=""}},I=function(){return j()},O=function(e){e.matches?(qe(document).on("scroll",I),qe(window).on("resize",P),P()):(qe(document).off("scroll",I),qe(window).off("resize",P),c.removeAttribute("style"),c.classList.remove("is-sticky"))},g.addEventListener("change",O),O(g),k())}),10)},scope:{label:"@",socials:"@",image:"@",title:"@",description:"@",share:"&"},template:'<div class="sharing" data-widget="widget-share" data-widget-share-url="{{url}}" data-widget-share-label="{{label}}" data-widget-share-title="{{titleText}}" data-widget-share-description="{{descriptionText}}" data-widget-share-image="{{image}}" data-widget-share-content-type="{{utmContent}}" data-widget-share-buttons="{{socials}}" data-widget-share-lang="{{lang}}" data-widget-share-orientation="{{orientation}}"></div>'}}]);var Ue=n.module("mosapp.hiddenList",["mgcrea.ngStrap","mosapp","ngAnimate"]).directive("mosHiddenList",["$tooltip","$sce","$window",function(e,t,i){return{restrict:"A",priority:0,link:function(t,a){var r,o,s=n.element(i);a.on("$destroy",(function(){t.$destroy(),s.off("resize.hiddenList")}));var l=a.find(t.selector),c=l.slice(0,t.max);p(),o=r;var d=n.element(t.more),m=e(a,{scope:t,show:!1,target:"body",template:'<div class="hidden-list-popup"><div class="hidden-list-popup__wrapper"><div class="hidden-list-popup__header"><div class="hidden-list-popup__title">{{ popupTitle }}</div><div class="hidden-list-popup__close" ng-click="$hide()"></div></div><div class="hidden-list-popup__body"></div></div></div>',trigger:"manual",prefixEvent:"hiddenListPopup"});c.last().after(d);var u=d.filter("[trigger]").add(d.find("[trigger]"));function p(){r=Modernizr&&Modernizr.mq("(max-width: 767px)")}(u=u.length?u:d).on("click",(function(e){e.preventDefault(),r?m.show():(a.removeClass("news-article-place_more-hidden"),d.hide())})),s.on("resize.hiddenList",(function(){p(),o!==r&&(a.addClass("news-article-place_more-hidden"),r?d.show():m.hide()),o=r})),t.$on("hiddenListPopup.show",(function(e,t){var i=t.$element.find(".hidden-list-popup__body");i.html(l.toArray().map((function(e){return e.outerHTML})).join("")),i.mCustomScrollbar()}))},scope:{max:"=",more:"@",selector:"@",popupTitle:"@"}}}]).name,He=(i.p,n.module("articleFooter",[]).name),Ge=n.module("newsArticleHeader",[]).name,Ve=n.module("mosapp.blackAndWhite",[]),Fe=Ve.name;function We(e){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},We(e)}function Ze(e){return Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ze(e)}Ve.directive("blackAndWhite",[function(){return{restrict:"A",link:function(e){function t(){if(i()){var e,t,a,n=localStorage.getItem("contrast");n&&"true"===n||"Y"===_e("EVP_blindVersion")?(e="false",t="N"):(e="true",t="Y"),localStorage.setItem("contrast",e),document.cookie="EVP_blindVersion="+t+"; path=.mos.ru; domain=.mos.ru; expires=0",(window.opera||window.webkit)&&onStorage(),function(){if(i()){var e=localStorage.getItem("contrast"),t=_e("EVP_blindVersion");e&&"true"===e||"Y"===t?(a=document.getElementsByTagName("html")[0],n="contrast","true"===localStorage.getItem("contrast")?a.classList?a.classList.add(n):a.className+=" contrast":a.classList.remove(n)):function(){var e=document.getElementsByTagName("html")[0],t="contrast";e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}()}var a,n}(),window.CustomEvent?a=new CustomEvent("contrastTrigger",{detail:{contrast:e}}):(a=document.createEvent("CustomEvent")).initCustomEvent("contrastTrigger",!0,!0,{contrast:e}),window.dispatchEvent(a)}}function i(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}e.$on("$destroy",(function(){a("body").off("click","#contrastlink",t)})),a("body").on("click","#contrastlink",t)}}}]),n.module("mosapp").service("UrlSrvc",["mosconfig","LangSrvc","$location",function(e,t,i){this.getMainDomain=function(){var t="";return e.domain&&(t=(t=(0===e.domain.indexOf("http")?"":location.protocol+"//")+e.domain).replace(new RegExp("/$"),"")),t},this.getLangLink=function(e){var i=t.getCurrentLang();return"ru"==i?e:"/"+i+e},this.getLangLinkPrefix=function(){var e=t.getCurrentLang();return"ru"==e?"":"/"+e},this.tmplPath=function(e){return e},this.apiPath=function(t){return e.restAPI[t]},this.jsPath=function(t){return((e.jsPath||"")+t).replace(new RegExp("//","g"),"/")},this.cssPath=function(t){return((e.cssPath||"")+t).replace(new RegExp("//","g"),"/")},this.pagePath=function(t,i){return((e.pagePath[t]||"")+i).replace(new RegExp("//","g"),"/")},this.assetsPath=function(t){return((e.assetsPath||"")+t).replace(new RegExp("//","g"),"/")},this.linksPath=function(t){return e.linksPath[t]},this.specialType=function(t){return e.specialType[t]||""},this.currentEmergency=function(t){if(t||e.emergency)return e.emergency[t]||""},this.currentEmergencyPath=function(t){if(t||e.emergency||e.emergency.path)return e.emergency.path[t]||""},this.getBanners=function(t){return{items:e.banners[t]}},this.isExternalUrl=function(e){return!/(^((http(s)?:\/\/)?(www.)?|\/\/)?mos.ru)|^\/{1}([^/]+|$)/gi.test(e)},this.addParamsToUrl=function(e,t){if(!t)return e;var i=e.split("#"),a=i[1]?"#"+i[1]:"",r=[];return i=i[0].split("?"),n.forEach(t,(function(e,t){r.push(t+"="+e)})),1===i.length?e=i[0]+"?"+r.join("&"):2===i.length&&(e=i[0]+"?"+i[1]+"&"+r.join("&")),e+a},this.setCanonical=function(t){var a=document.querySelector('link[rel="canonical"]');if(a||((a=document.createElement("link")).rel="canonical",document.getElementsByTagName("head")[0].appendChild(a)),!t){t=i.absUrl();var n=/([a-z][a-z0-9+\-.]*:(\/\/[^/?#]+)?)?([a-z0-9\-._~%!$&'()*+,;=:@/]*)/.exec(t)[3];t=e.domain?(0===e.domain.indexOf("http")?"":"https://")+e.domain:"https://mos.ru",t+=n}a.setAttribute("href",t)}}]),n.module("mosapp").filter("imagesPath",["mosconfig",function(e){return function(t){return((e.imagesPath||"")+t).replace(new RegExp("//","g"),"/")}}]),n.module("mosapp").provider("LangSrvc",(function(){var e=!1;this.setCurrentLang=function(){return e||(e=(e=document.documentElement.lang)||"ru"),e},this.$get=function(){return{getCurrentLang:function(){return e}}}})).service("linksInterceptor",[function(){var e=0,t=new Object(null);t[++e]={regExp:[/\/pgu./],attr:"href",callback:function(e,t){if("object"===("undefined"==typeof _paq?"undefined":We(_paq))&&"function"==typeof _paq.push){e.preventDefault();var i=a(t).attr("href");_paq.push(["trackLink",i,"link"]);var n=window.open(i,"_blank");n&&n.focus()}},id:e},t[++e]={regExp:[/\/pgu\//],attr:"href",callback:function(e,t){if("object"===We(window._paq)&&"function"==typeof window._paq.push){var i=a(t).attr("href");_paq.push(["trackLink",i,"link"])}},id:e};var i={openInNewTab:function(e,t){e.preventDefault();var i=a(t).attr("href"),n=window.open(i,"_blank");n&&n.focus()}};function n(e){return"function"==typeof e.exec}return a(document).on("click","a",(function(e){var i=a(this);Object.keys(t).forEach((function(a){var n=t[a],r=i.attr(n.attr);if(r&&""!==r)for(var o=0;o<n.regExp.length;o++)if(null!==n.regExp[o].exec(r)){n.callback(e,i,n.cbParams);break}}))})),{add:function(a,r,o,s){var l=new Object(null);if(Array.isArray(a)){var c=[];a.forEach((function(e){n(e)&&c.push(e)})),l.regExp=c}else n(a)&&(l.regExp=[a]);if(l.attr="string"==typeof o?o:"href","function"==typeof r)l.callback=r;else if("string"==typeof r){if("function"!=typeof i[r])return!1;l.callback=i[r]}return"object"==We(s)?l.cbParams=s:l.cbParams=new Object(null),l.id=++e,t[e]=l,l},remove:function(e){return!!t[e]&&(delete t[e],!0)},check:function(e){return!!t[e]}}}]),n.module("mosapp").service("toolsSrvc",["mosconfig","$timeout","LangSrvc","UrlSrvc","$filter",function(e,t,i,r,o){var s,l=this;this.ruStrToDate=function(e){var t=!1;if(n.isString(e)){var i=e.split(".");i.length>2&&(t=new Date(i[2],i[1]-1,i[0]))}return t||e},this.getSiteLogo=function(){return e.siteLogo||null},this.fillOutPages=function(e,t){for(var i=[],a=1;a<t+1;a++)i.push({num:a});return i},this.scrollTop=function(){a("html, body").animate({scrollTop:0},750)},this.scrollTo=function(e){var t=e.top,i=e.speed,n=e.substractHeaderHeight,r=0;(void 0===n||n)&&(r=a("#mos-header").outerHeight(!0)||0),a("html, body").animate({scrollTop:t-r},i||750)},this.colorScheme=function(){return"true"===localStorage.getItem("contrast")?"contrast":"default"},this.htmlToPlaintext=function(e){return(e=e?String(e).replace(/&\w{4,5};/gm," "):"")?String(e).replace(/<[^>]+>/gm,""):""},this.setMeta=function(t,i,n){var o;o=r.getMainDomain();var s=t.image&&""!==t.image&&t.image.indexOf("data:image",0)<0?t.image:(e.imagesPath||"")+"favicon/icon200x200.png";if(s=0===s.indexOf("http")?s:o+"/"+s.replace(new RegExp("^/"),""),a('meta[property="og:url"]').attr("content",o+"/"+location.pathname.replace(new RegExp("^/"),"")),n&&i[n]){var c=this.htmlToPlaintext(i[n].description);a('meta[property="og:title"]').attr("content",this.htmlToPlaintext(i[n].title)),a('meta[property="og:description"]').attr("content",c),l.setDescription(c)}a('meta[property="og:image"]').attr("content",s),a('meta[property="og:image:url"]').attr("content",s)},this.getMetaForImage=function(t){var a=i.getCurrentLang();return{alt:t+". "+e.altParams[a],title:t}},this.setTitle=function(){for(var t=i.getCurrentLang(),n=e.titleParams||{},r=n.separator||" / ",o=n.siteName&&n.siteName[t]||"Сайт Москвы",s=[],l=0;l<arguments.length;l++)s.push(this.htmlToPlaintext(arguments[l]));var c=Array.prototype.slice.call(s,0);c.push(o),a("title").text(c.join(r))},this.setDescription=function(t){var a=i.getCurrentLang();if(t&&""!=t){var n=(e.altParams||{})[a]||"Официальный сайт Мэра Москвы",r=" ";"."!==t[t.length-1]&&(r=". "),l._setMeta("description",t+r+n)}},this.setKeywords=function(e){e&&""!=e&&l._setMeta("keywords",e)},this._setMeta=function(e,t){if(e&&0!=e.length){var i=a("meta[name="+e+"]");if(i.length>0)i.attr("content",t);else{var n=document.createElement("meta");n.name=e,n.content=t,document.getElementsByTagName("head")[0].appendChild(n)}}},this.togglerBlackAndWhite=function(e,t,i){i instanceof a||"string"!=typeof i?i instanceof a&&void 0!==i||(i=a(document.body)):i=a(i),"contrast"===t?(i.find(e).addClass("grayscale"),i.find(".grayscale-img").addClass("grayscale"),i.find(".grayscale").gray()):(i.find(".grayscale").toggleClass("grayscale-off"),i.find(e).removeClass("grayscale"),i.find(".grayscale-img").removeClass("grayscale"))},this.prepareTags=function(e){var t=[];return n.isString(e)?e:n.isArray(e)?(e.forEach((function(e){t.push(e.title)})),t.join(", ")):void 0},this.setErrorInfo=function(e){s=e},this.getErrorInfo=function(){return s},this.localeNum=function(e,t){if("number"!=typeof(e*=1))return"";if((!t||t.length<1)&&(t=new Array("")),(e=e.toString()).indexOf(".")>0||e.indexOf(",")>0)return t[1];var i,a,n=e.length;return i=new Number(n<2?0:e.substr(n-2,1)),a=new Number(e.substr(n-1,1)),1==i?t[2]:a>1&&a<5?t[1]:a>4&&a<=9||0==a?t[2]:1==a?t[0]:void 0},this.hideContentArea=function(e){e.css("opacity",0)},this.showContentArea=function(e){e&&e.length&&e.animate({opacity:1},500,(function(){e.css("opacity","")}))},this.convertDateToMos=function(e){var t=(new Date).getTimezoneOffset()/60;return-3!==t&&(e=new Date(e.getTime()+3600*t*1e3+108e5)),e},this.compileDate=function(e,t){return t?o("date")(e,"yyyy-MM-dd")+" 00:00:00":o("date")(e,"yyyy-MM-dd")+" 23:59:59"},this.testDateString=function(e){var t={date:e,status:0};if(""!==e){var i=/([0-3]\d).([01]\d).([12][09]\d{2})/.exec(e);if(i&&i.length&&i[0]){var a=new Date(1*i[3],1*i[2]-1,i[1]);if(a){var n=a.getDate();n=n<10?"0"+n:""+n;var r=a.getMonth()+1;r=r<10?"0"+r:""+r;var o=a.getFullYear(),s=n+"."+r+"."+o;i[0]===s&&o>1989&&o<2091&&(t={date:i[0],status:i[0]===e?1:2})}}}return t},this.isIE=function(){return!!document.documentMode},this.getScreenWidth=function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},this.disableScroll=function(){var e=document.getElementsByTagName("html")[0],t=e.scrollTop;e.style.overflowY="scroll",e.style.width="100%",e.style.top="-".concat(t,"px"),e.style.position="fixed"},this.enableScroll=function(){var e=document.getElementsByTagName("html")[0],t=parseInt(e.style.top.split("px")[0],10);e.style.overflowY="",e.style.width="",e.style.top="",e.style.position="",e.scrollTop=-t},this.getVisibilityApiKeys=function(){var e,t;return void 0!==document.hidden?(e="hidden",t="visibilitychange"):void 0!==document.msHidden?(e="msHidden",t="msvisibilitychange"):void 0!==document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),{hidden:e,visibilityChange:t}},this.debounce=function(e,i){var a=!1;return function(){if(!a)return e.apply(this,arguments),a=!0,t((function(){return a=!1}),i)}},this.isInViewport=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=e.getBoundingClientRect(),a=i.height;return i.top+a*t>=0&&i.left>=0&&i.bottom-a*t<=(window.innerHeight||document.documentElement.clientHeight)&&i.right<=(window.innerWidth||document.documentElement.clientWidth)}}]).name,n.module("mosapp").service("loaderIndicator",[function(){var e=function(){var e=56;return Modernizr&&Modernizr.mq("(max-width: 1365px)")&&(e=48),e},t='<div class="dots-loader-backdrop"></div><div class="dots-loader"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>';function i(i,a){i.css({position:"relative",height:e()+"px",overflow:"hidden"}),"plainDots"===a.loaderType?(a.animate&&i.css({height:e()+"px",overflow:"hidden"}),i.prepend(t)):i.prepend(t)}function a(e){e.css({position:"",height:"",overflow:""}),e.find(".dots-loader-backdrop,.dots-loader").remove()}function r(t,i){"plainDots"===i.loaderType&&i.animate?function(t){t.css({height:""}),t.animate({height:e()+"px"},.7,(function(){a(t)}))}(t):a(t)}function o(e){return e instanceof n.element||("object"===("undefined"==typeof HTMLElement?"undefined":Ze(HTMLElement))||"function"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"===Ze(e)&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName)}this.switchOn=function(e){var t;e&&(o(e)?(t=n.element(e)).length&&i(t,e):e.hasOwnProperty("elems")&&(e.elems.hasOwnProperty("length")?e.elems.length&&n.forEach(e.elems,(function(t,a){i(n.element(t),e),e.elems.length===a&&"function"==typeof e.onSwitchOn&&e.onSwitchOn()})):(i(t=n.element(e.elems),e),"function"==typeof e.onSwitchOn&&e.onSwitchOn())))},this.switchOff=function(e){var t;e&&(o(e)?(t=n.element(e)).length&&r(t,e):e.hasOwnProperty("elems")&&(e.elems.hasOwnProperty("length")?e.elems.length&&n.forEach(e.elems,(function(t,i){r(n.element(t),e),e.elems.length===i&&"function"==typeof e.onSwitchOn&&e.onSwitchOn()})):(r(t=n.element(e.elems),e),"function"==typeof e.onSwitchOff&&e.onSwitchOff()),"function"==typeof e.onSwitchOff&&e.onSwitchOff()))}}]),n.module("mosapp").value("apiQueue",[]).value("lastReq",!1).run(["$http",function(e){e.defaults.headers.common["x-caller-id"]="mosru.news-app-frontend"}]).service("apiSrvc",["UrlSrvc","$http","$q","transformRequestAsFormPost","apiQueue","$timeout","loaderIndicator","lastReq","LangSrvc","$log",function(e,t,i,a,r,o,s,l,c,d){var m=this;function u(){l&&(l=!1,o((function(){"function"==typeof window.callPhantom&&window.callPhantom({queue:"isempty"})}),100))}function p(e,t,i,a){return d.error("Object '"+e+"' not found! Check config, please."),s.switchOff(a),"function"==typeof i?i({error:"Object '"+e+"' not found! Check config, please."}):t({error:"Object '"+e+"' not found! Check config, please."}),!1}function f(e,t){var i=[];n.forEach(t,(function(t,a){e.indexOf("%"+a+"%")>-1&&(e=e.replace("%"+a+"%",t),i.indexOf(a)<0&&i.push(a))}));for(var a=0;a<i.length;a++)delete t[i[a]];return e.indexOf("[lang]")>-1&&(e=e.replace("[lang]",c.getCurrentLang())),e}this.sendRequestFromQueue=function e(){var i=Math.floor(50*Math.random()+25);if(r.length>0){var c={};n.forEach(r[0],(function(e,t){c[t]=r[0][t]})),"POST"===c.method?function(e){var i=e.header,n=e.notTransform,r={url:e.url,method:"POST",data:e.params,headers:i,withCredentials:!0};n||(r.transformRequest=a),t(r).then((function(t){if(e.showError&&t.error){var i={title:"Ошибка получения данных из API.",content:t.description,placement:"top",type:"warning",show:!0};t.errorMessage=i}s.switchOff(e.loaderEl),u(),e.resolve(t)}),(function(t,i){s.switchOff(e.loaderEl),u();var a={content:t,code:i};e.reject(a)}))}(c):function(e){t({url:e.url,method:"GET",params:e.params}).then((function(t,i){if(e.showError&&t.error){var a={title:"Ошибка получения данных из API.",content:t.description,placement:"top",type:"warning",show:!0};t.errorMessage=a}e.loaderEl&&!e.loaderEl.dontSwitchOff&&s.switchOff(e.loaderEl),u(),e.resolve(t,i)}),(function(t,i){s.switchOff(e.loaderEl),u();var a={content:t,code:i};e.reject(a)}))}(c),r.shift(),0===r.length&&(l=!0)}o(e,i)},this.sendRequestFromQueue(),this.getData=function(t,a,o,l,c){return i((function(i,d){s.switchOn(c);var m=n.copy(o),u=e.apiPath(t);if(!n.isObject(u))return p(t,i,d,c);if(!(u=u[a]))return p(t+"."+a,i,d,c);n.isObject(m),u=f(u,m);var g={method:"GET",url:encodeURI(u),resolve:i,reject:d,params:m,showError:l,loaderEl:c};r.push(g)}))},this.getDataByUrl=function(e,t,a,o){return i((function(i,l){s.switchOn(o);var c=n.copy(t);if(!e)return p(e,i,l,o);n.isObject(c);var d={method:"GET",url:e=f(e,c),resolve:i,reject:l,params:c,showError:a,loaderEl:o};r.push(d)}))},this.getDataCancelable=function(t,a,o,l,c){var d,m=i((function(i,m){s.switchOn(c);var u=n.copy(o),g=e.apiPath(t);return n.isObject(g)?(g=g[a])?(n.isObject(u),g=f(g,u),d={method:"GET",url:g,resolve:i,reject:m,params:u,showError:l,loaderEl:c},void r.push(d)):p(t+"."+a,i,m,c):p(t,i,m,c)}));return m.cancel=function(){d.resolve({state:"cancelled"})},m},this.getAllPages=function(e,t,a){var n=i.defer(),r=[];return function i(o){o&&(a.page=o),m.getData(e,t,a).then((function(e){r=r.concat(e.data.items),e.data._meta&&e.data._meta.currentPage<e.data._meta.pageCount?i(e.data._meta.currentPage+1):(a&&delete a.page,n.resolve(r))}),(function(){n.reject()}))}(),n.promise},this.postDataByUrl=function(e,t,a,o,l,c){return i((function(i,d){s.switchOn(o);var m=n.copy(t);if(!e)return p(e,i,d,o);var u={method:"POST",url:e=f(e,m),resolve:i,reject:d,params:m,showError:a,loaderEl:o,header:l,notTransform:c};r.push(u)}))},this.postData=function(t,a,o,l,c,d,m){return i((function(i,u){s.switchOn(c);var g=n.copy(o),h=e.apiPath(t);if(!n.isObject(h))return p(t,i,u,c);if(!(h=h[a]))return p(t+"."+a,i,u,c);var v={method:"POST",url:h=f(h,g),resolve:i,reject:u,params:g,showError:l,loaderEl:c,header:d,notTransform:m};r.push(v)}))}}]).factory("transformRequestAsFormPost",(function(){return function(e,t){return t()["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8",function(e){if(!n.isObject(e))return null===e?"":e.toString();var t=[];for(var i in e)if(e.hasOwnProperty(i)){var a=e[i];t.push(encodeURIComponent(i)+"="+encodeURIComponent(null===a?"":a))}return t.join("&").replace(/%20/g,"+")}(e)}})).service("apiCache",["$q","apiSrvc",function(e,t){var i={};this.getData=function(a,n,r,o,s){var l=a+n+JSON.stringify(r);return i[l]?e.when(i[l]):t.getData(a,n,r,o,s).then((function(e){return i[l]=e,e}))}}]);var Ye=n.module("mosapp").config(["mosconfig","$translateProvider","LangSrvcProvider",function(e,t,i){t.usePostCompiling(!0),t.useSanitizeValueStrategy("escape"),t.useLoader("$translatePartialLoader",{urlTemplate:e.i18nPath+"{part}/{lang}.json?mosRuVersionControlFlag"}),t.preferredLanguage(i.setCurrentLang())}]).name;function Je(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}n.module("mosapp").service("aaaaTestSrvc",[function(){var e=["group_editorial","group_stats","group_random"],t=[33.3,33.3,33.3],i="molding-variant-v2",a=function(){var e;try{e=/\.?(([a-zA-Z0-9-])+\.[a-zA-Z]{2,})$/gi.exec(new URL(window.location).hostname)[1]}catch(e){}return e?".".concat(e):".mos.ru"}();this.ABCTestOn=!1,this.getAAAAVariant=function(){var n,r=xe(i)();return r||(n=function(e){for(var t=e.map((function(e){return e/100})),i=0,a=Math.random(),n=0;n<t.length;n++)if(a<=(i+=t[n]))return n}(t),function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(i=ye({path:"/"},i)).expires instanceof Date&&(i.expires=i.expires.toUTCString());var a=encodeURIComponent(e)+"="+encodeURIComponent(t);for(var n in i){a+=";"+n;var r=i[n];!0!==r&&(a+="="+r)}document.cookie=a}(i,r=e[n],{domain:a,"max-age":31536e4})),r}}]).name;var Qe=window.config&&window.config.sectionCode||"news";B.initialize({section:Qe}),n.module("newsArticle",[fe,he,y,T,L,ze,Ne,Fe,Ye,s,"pascalprecht.translate","mgcrea.ngStrap",Ue,Ge,He]).config(["$compileProvider","$translateProvider","LangSrvcProvider",function(e,t,i){e.debugInfoEnabled(!1),t.useSanitizeValueStrategy("escaped").translations(i.setCurrentLang(),config.translations).preferredLanguage(i.setCurrentLang())}]).run(["toolsSrvc","$rootScope","aaaaTestSrvc",function(e,t,i){var a=window.config.article;if(t.material=a,t.materialIdTitle="".concat(a.id," - ").concat(a.title),B.sendStat(Je({},N,t.materialIdTitle)),"news"===Qe&&i.ABCTestOn){var n=i.getAAAAVariant();n&&B.sendStat({ab_test:{recommendations:Je({},ae,n)}})}window.addEventListener("beforeunload",(function(){B.sendStat(Je({},te,t.materialIdTitle))}));var r=e.getVisibilityApiKeys();window.addEventListener(r.visibilityChange,(function(){document[r.hidden]&&B.sendStat(Je({},ie,t.materialIdTitle))}));var o=[function(){var i=document.querySelector(".article-image__wrapper");return!i||(e.isInViewport(i)?(B.sendStat(Je({},ee,Je({},t.materialIdTitle,"Обложка"))),!0):void 0)},function(){var i=document.querySelector(".news-article-footer__rows");if(e.isInViewport(i,.2))return B.sendStat(Je({},ee,Je({},t.materialIdTitle,"О новости"))),!0},function(){if(Math.abs(document.body.scrollHeight-(window.pageYOffset+window.innerHeight))<50)return B.sendStat(Je({},ee,Je({},t.materialIdTitle,"Подвал"))),!0}],s=e.debounce((function(){(o=o.filter((function(e){return!e()}))).length||window.removeEventListener("scroll",s)}),100);window.addEventListener("scroll",s)}]).controller("mainController",["toolsSrvc","$scope","$element","$rootScope",function(e,t,i,a){if(t.$watch((function(){return e.colorScheme()}),(function(e){t.colorScheme=e,"contrast"==t.colorScheme?i.addClass("contrast"):i.removeClass("contrast")})),a.material){var n={tags:J,spheres:Q,districts:X,areas:K};t.onShareSocial=function(e){B.sendStat(Je({},U,Je({},a.materialIdTitle,"Поделиться ".concat(e))))},t.onClickFooterLinks=function(e,t){var i=n[t],r=e.target;"A"===r.tagName&&r.dataset.index&&B.sendStat(Je({},i,Je({},r.dataset.index,Je({},r.innerText,Je({},r.href,a.materialIdTitle)))))},t.onClickFooterButton=function(){B.sendStat(Je({},H,{"Все новости":a.materialIdTitle}))}}t.colorScheme=e.colorScheme(),"contrast"==t.colorScheme&&i.addClass("contrast")}])}},n={};function r(e){var t=n[e];if(void 0!==t)return t.exports;var i=n[e]={id:e,loaded:!1,exports:{}};return a[e].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.m=a,e=[],r.O=function(t,i,a,n){if(!i){var o=1/0;for(d=0;d<e.length;d++){i=e[d][0],a=e[d][1],n=e[d][2];for(var s=!0,l=0;l<i.length;l++)(!1&n||o>=n)&&Object.keys(r.O).every((function(e){return r.O[e](i[l])}))?i.splice(l--,1):(s=!1,n<o&&(o=n));if(s){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[i,a,n]},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},i=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__},r.t=function(e,a){if(1&a&&(e=this(e)),8&a)return e;if("object"==typeof e&&e){if(4&a&&e.__esModule)return e;if(16&a&&"function"==typeof e.then)return e}var n=Object.create(null);r.r(n);var o={};t=t||[null,i({}),i([]),i(i)];for(var s=2&a&&e;"object"==typeof s&&!~t.indexOf(s);s=i(s))Object.getOwnPropertyNames(s).forEach((function(t){o[t]=function(){return e[t]}}));return o.default=function(){return e},r.d(n,o),n},r.d=function(e,t){for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.e=function(){return Promise.resolve()},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},r.j=244,r.p="",function(){var e={244:0};r.O.j=function(t){return 0===e[t]};var t=function(t,i){var a,n,o=i[0],s=i[1],l=i[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(a in s)r.o(s,a)&&(r.m[a]=s[a]);if(l)var d=l(r)}for(t&&t(i);c<o.length;c++)n=o[c],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(d)},i=self.webpackChunknews_app=self.webpackChunknews_app||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var o=r.O(void 0,[736],(function(){return r(6529)}));o=r.O(o)}();