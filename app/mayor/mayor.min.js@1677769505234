!function(window,angular,undefined){angular.module("mayor",["mosapp","ngAnimate","ui.router","mgcrea.ngStrap","mayor.templates","mosapp.department.person","mosapp.department.person.one","mosapp.filters.imageSrc","mosapp.quote.item.brick","mosapp.photobank.item.brick","mosapp.biography.item.brick","mosapp.banner","mosapp.banner.service","mosapp.tags","mosapp.spheres","mosapp.carousel.promo","mosapp.carousel.media","mosapp.video.player","mosapp.video.mvsr.player","mosapp.audio.player","mosapp.filter.calendar","mosapp.photo.gallery","mosapp.press.themes","mosapp.press.categories","mosapp.press.category","mosapp.press.story","mosapp.press.story.similar","mosapp.press.review","mosapp.press.brickwork","mosapp.press.item.brick","mosapp.press.presentations","mosapp.press.media","mosapp.press.photo","mosapp.press.video","mosapp.press.infographic","mosapp.press.infographic.item","mosapp.filter.news","mosapp.news.feed","mosapp.news.feed.additional","mosapp.news.media.additional","mosapp.press.plain.list","mosapp.search.form","mosapp.sharing","mosapp.sharing.popup","mosapp.photoBank","masonry","mosapp.media.photo","mosapp.media.photo.carousel","mosapp.media.photo.tiles","mosapp.mosError","mosapp.photoBankTabs","mosapp.banner.service","mosapp.sharing","mosapp.sharing.popup","mosapp.mosLightbox","mosapp.copyright","mos.embed.social","mosapp.hiddenList"]).factory("metaConfig",["mosconfig",function(e){var t="Мэр";return{page:"Мэр",themes:{section:"Новости города",sectionTitle:"Мэр Москвы Собянин Сергей Семенович",title:"Новости города от первого лица",description:"Страница Мэра Собянина Сергея Семеновича — это новости о Москве из первых уст. Кроме биографии , здесь вы найдете интервью, стенограммы, телеграммы, фото и видео, презентации проектов, постановлений, отчётов.",keywords:"собянин, собянин сергей семенович, мэр, мэр москвы, сергей собянин, собянин мэр, мэр москвы собянин",image:"img",url:"/mayor/themes/"},theme:{section:"Новости Мэра",sectionTitle:"Мэр Москвы",title:"Новости города от первого лица",description:"Все новости Мэра из первых уст на тему %theme%",image:"img"},biography:{section:t,sectionTitle:"Биография",title:"Мэр - биография",description:"",image:"img",url:"/mayor/biography/"},transcripts:{section:t,sectionTitle:"Стенограммы",title:"Мэр - стенограммы",description:"Стенограммы",image:"img",url:"/mayor/transcripts/"},telegrams:{section:t,sectionTitle:"Телеграммы",title:"Мэр - телеграммы",description:"Телеграммы",image:"img",url:"/mayor/telegrams/"},interviews:{section:t,sectionTitle:"Интервью",title:"Мэр - интервью",description:"Интервью",image:"img",url:"/mayor/interviews/"},presentations:{section:t,sectionTitle:"Презентации",title:"Мэр - презентации",description:"Презентации",keywords:"презентации, мэр, сайт москвы",image:"img",url:"/mayor/presentations/"},infographic:{section:t,sectionTitle:"Инфографика",title:"Инфографика",description:"Инфографика.",image:"img",url:"/mayor/infographic/"},media:{section:t,sectionTitle:"Медиа",title:"Мэр - медиа",description:"Медиа",sectionDescription:"Медиа",keywords:"медиа, мэр, сайт москвы",image:"img",url:"/mayor/media/"},video:{section:t,sectionTitle:"Видео",title:"Мэр - видео",description:". Видео. Мэр Москвы",keywords:", видео, мэр, сайт москвы",image:"img"},photo:{section:t,sectionTitle:"Фото",title:"Мэр - фото",description:"",keywords:", фото, мэр, сайт москвы",image:"img"},story:{section:t,title:"События",description:"События.",image:"img",url:""}}}]).run(["$rootScope","$state","$stateParams","toolsSrvc",function(e,s,t,n){e.$state=s,e.$stateParams=t,e.$on("$stateChangeStart",function(e,t,a){var i=document.getElementById("canonicalLink");i&&i.parentNode&&i.parentNode.removeChild(i),t.redirectTo&&(e.preventDefault(),s.go(t.redirectTo,a))}),e.$on("$stateChangeSuccess",function(e,t,a,i,r){t.TARGET_NAME&&n.statCounter({metrika:{TARGET_NAME:t.TARGET_NAME}}),n.handleAlternateTags(s,t.name,["home.biography"])})}]).config(["$compileProvider","$stateProvider","$urlRouterProvider","$urlMatcherFactoryProvider","$locationProvider","$translatePartialLoaderProvider","$translateProvider","LangSrvcProvider",function(e,t,a,i,r,s,n,o){i.strictMode(!1),r.html5Mode(!0),r.hashPrefix("!"),e.debugInfoEnabled(!1),s.addPart("mayor"),n.useSanitizeValueStrategy("escaped");var l="ru"===o.setCurrentLang()?"/themes/":"/biography/";a.when("",l).when("/",l).otherwise(function(e,t){var a=t.path(),e=e.get("$state");t.$$absUrl.match(/\/#!(\/)?$/)&&0==a.length?e.go(l,{},{location:!1}):e.go("404",{},{location:!1})}),a.rule(function(e,t){t=t.path();if(!(t.length<=1))return"/"===t[t.length-1]?void 0:t+"/"}),this.scrollTop=function(e){TweenLite.to(window,e||.75,{scrollTo:{y:0},ease:Power2.easeOut,onComplete:function(){}})},t.state("home",{onEnter:function(){},url:"/",abstract:!0}).state("404",{url:"/404/",template:'<div data-mos-error="404"></div>'}).state("home.themes",{TARGET_NAME:"mayor_view",url:"themes/",views:{"@":{template:'<div data-mos-press-themes="" data-section="home.themes" data-section-category="home.themes.sphere" data-section-story="home.themes.sphere.story" data-apisection="newsfeed" data-promoapi="mainPromoList" data-sectapi="mainNewsList" data-catapi="newsShperes"></div>'}}}).state("home.themes.page",{TARGET_NAME:"mayor_view",url:"page-{page:[0-9]+}/"}).state("home.themes.sphere",{TARGET_NAME:"mayor_view",url:"{sphere_id:[0-9]*}/",onEnter:function(){scrollTop(.4)}}).state("home.themes.sphere.page",{TARGET_NAME:"mayor_view",url:"page-{page:[0-9]+}/"}).state("home.transcripts",{TARGET_NAME:"mayor_view",url:"transcripts/",onEnter:function(){},views:{"@":{template:'<div data-mos-press-plain-list="" data-section="home.transcripts" data-section-story="home.transcripts.story" data-sectrange="home.transcripts.range" data-apisection="newsfeed" data-sectapi="pressTranscriptsList" class="b-press-overflow-hidden"></div>'}}}).state("home.transcripts.page",{TARGET_NAME:"mayor_view",url:"page-{page:[0-9]+}/",onEnter:function(){}}).state("home.transcripts.range",{TARGET_NAME:"mayor_view",url:"from/{fromDate:[^/]*}/until/{untilDate:[^/]*}/",onEnter:function(){}}).state("home.transcripts.range.page",{TARGET_NAME:"mayor_view",url:"page-{page:[0-9]+}/",onEnter:function(){}}).state("home.transcripts.story",{TARGET_NAME:"mayor_view",url:"{id:[^/]*}/",onEnter:function(){scrollTop(.4)},views:{"@":{template:'<div data-mos-press-story="" data-page-path="mayorMain" data-display-tags="false" data-section="home.transcripts" data-section-story="home.transcripts.story" data-apisection="newsfeed" data-sectapi="pressTranscriptStory"  class="b-press-overflow-hidden"></div>'}}}).state("home.biography",{TARGET_NAME:"mayor_view",url:"biography/",onEnter:function(){},views:{"@":{template:'<div data-mos-department-person-one=""></div>'}}}).state("home.photobank",{TARGET_NAME:"mayor_view",url:"photobank/",onEnter:function(){scrollTop(.4)},views:{"@":{template:'<div data-photo-bank="" data-state-root="home.photobank" data-state-mode="home.photobank.mode" data-person-photo="true" data-first-person="true" data-api-root="photoBank" data-gallery-api="photobankGallery" data-images-api="photobankImages" data-person-api="photobankPerson" data-person-details-api-root="structure" data-person-details-api="person"></div>'}}}).state("home.photobank.mode",{TARGET_NAME:"mayor_view",url:"{mode:[^/]*}/{page:[^/]*}/{item:[^/]*}/",onEnter:function(){}}).state("home.telegrams",{TARGET_NAME:"mayor_view",url:"telegrams/",onEnter:function(){},views:{"@":{template:'<div data-mos-press-plain-list="" data-section="home.telegrams" data-section-story="home.telegrams.story" data-sectrange="home.telegrams.range" data-apisection="newsfeed" data-sectapi="pressTelegramsList"  class="b-press-overflow-hidden"></div>'}}}).state("home.telegrams.page",{TARGET_NAME:"mayor_view",url:"page-{page:[0-9]+}/",onEnter:function(){}}).state("home.telegrams.range",{TARGET_NAME:"mayor_view",url:"from/{fromDate:[^/]*}/until/{untilDate:[^/]*}/",onEnter:function(){}}).state("home.telegrams.range.page",{TARGET_NAME:"mayor_view",url:"page-{page:[0-9]+}/",onEnter:function(){}}).state("home.telegrams.story",{TARGET_NAME:"mayor_view",url:"{id:[^/]*}/",onEnter:function(){scrollTop(.4)},views:{"@":{template:'<div data-mos-press-story="" data-page-path="mayorMain" data-section="home.telegrams"   data-display-tags="false" data-section-story="home.telegrams.story" data-apisection="newsfeed" data-sectapi="pressTelegramStory" class="b-press-overflow-hidden"></div>'}}}).state("home.interviews",{TARGET_NAME:"mayor_view",url:"interviews/",onEnter:function(){},views:{"@":{template:'<div data-mos-press-plain-list="" data-section="home.interviews" data-section-story="home.interviews.story" data-sectrange="home.interviews.range" data-apisection="newsfeed" data-sectapi="pressInterviewsList"  class="b-press-overflow-hidden"></div>'}}}).state("home.interviews.page",{TARGET_NAME:"mayor_view",url:"page-{page:[0-9]+}/",onEnter:function(){}}).state("home.interviews.range",{TARGET_NAME:"mayor_view",url:"from/{fromDate:[^/]*}/until/{untilDate:[^/]*}/",onEnter:function(){}}).state("home.interviews.range.page",{TARGET_NAME:"mayor_view",url:"page-{page:[0-9]+}/",onEnter:function(){}}).state("home.interviews.story",{TARGET_NAME:"mayor_view",url:"{id:[^/]*}/",onEnter:function(){scrollTop(.4)},views:{"@":{template:'<div data-mos-press-story=""   data-page-path="interviews" data-display-tags="false" data-section="home.interviews" data-section-story="home.interviews.story" data-apisection="newsfeed" data-sectapi="pressInterviewsStory" class="b-press-overflow-hidden"></div>'}}}).state("home.presentations",{TARGET_NAME:"mayor_view",url:"presentations/",onEnter:function(){},views:{"@":{template:'<div data-mos-press-presentations=""></div>'}}}).state("home.presentations.range",{TARGET_NAME:"mayor_view",url:"from/{fromDate:[^/]*}/until/{untilDate:[^/]*}/",onEnter:function(){}}).state("home.releases",{TARGET_NAME:"mayor_view",url:"releases/",onEnter:function(){},views:{"@":{template:'<div data-mos-press-plain-list="" data-section="home.releases" data-section-story="home.releases.story" data-sectrange="home.releases.range" data-apisection="newsfeed" data-sectapi="pressReleasesList"  data-root-search="search" data-root-search-api="searchResultsList" class="b-press-overflow-hidden"></div>'}}}).state("home.releases.range",{TARGET_NAME:"mayor_view",url:"from/{fromDate:[^/]*}/until/{untilDate:[^/]*}/",onEnter:function(){}}).state("home.releases.story",{TARGET_NAME:"mayor_view",url:"{id:[^/]*}/",onEnter:function(){scrollTop(.4)},views:{"@":{template:'<div data-mos-press-story="" data-page-path="mayorMain" data-section="home.releases" data-section-story="home.releases.story" data-apisection="newsfeed" data-sectapi="pressReleaseStory" class="b-press-overflow-hidden"></div>'}}}).state("home.infographic",{TARGET_NAME:"mayor_view",url:"infographic/",onEnter:function(){},views:{"@":{template:'<div data-mos-press-infographic="" data-root-state="home.infographic"></div>'}}}).state("home.infographic.item",{TARGET_NAME:"mayor_view",url:"{id:[0-9]+|all}/",views:{"@":{template:'<div data-mos-press-infographic-item="" data-display-tags="false"  data-root-state="home.infographic" data-api-root="newsfeed"data-page-path="mayorInfographic" data-api-path="pressInfographic"></div>'}}}).state("home.infographic.sphere_id",{url:"cat/{sphere_id:[0-9]+|all}/"}).state("home.infographic.sphere_id.type",{url:"type/{type:gallery|video|all}/"}).state("home.infographic.sphere_id.type.range",{url:"from/{from:[^/]*}/to/{to:[^/]*}/"}).state("home.media",{TARGET_NAME:"mayor_view",url:"media/",onEnter:function(){},views:{"@":{template:'<div data-mos-press-media="" data-page-path="media" data-section="home.media" data-api-root="newsfeed" data-section-main-api="mainMedia" data-section-api="pressMediaList" ></div>'}}}).state("home.media.page",{TARGET_NAME:"mayor_view",url:"page-{page:[0-9]+}/",onEnter:function(){}}).state("home.media.range",{TARGET_NAME:"mayor_view",url:"from/{fromDate:[^/]*}/until/{untilDate:[^/]*}/",onEnter:function(){}}).state("home.media.range.page",{TARGET_NAME:"mayor_view",url:"page-{page:[0-9]+}/",onEnter:function(){}}).state("home.media.photo",{TARGET_NAME:"mayor_view",url:"photo/{photoID:[^/]*}/",onEnter:function(){},redirectTo:"home.media.photo.mode"}).state("home.media.photo.mode",{TARGET_NAME:"mayor_view",url:"{mode:[^/]*}/{page:[^/]*}/{item:[^/]*}/",onEnter:function(){},views:{"@":{template:'<div data-mos-media-photo="" data-page-type="mayor" data-section-state="home.media" data-gallery-info-id="1" data-state-root="home.media.photo" data-state-mode="home.media.photo.mode" data-api-root="newsfeed" data-gallery-api="mediaGallery" images-api="mediaImages" data-postfix=""></div>'}}}).state("home.media.video",{TARGET_NAME:"mayor_view",url:"video/{videoID:[^/]*}/",onEnter:function(){},views:{"@":{template:'<div data-mos-press-video="" data-page-type="mayor" data-page-path="media"  data-section-state="home.media"  data-root-api="newsfeed" data-section-api="pressVideo"></div>'}}}).state("home.reviews",{TARGET_NAME:"mayor_view",url:"reviews/",onEnter:function(){},views:{"@":{template:'<div data-mos-press-plain-list="" data-section="home.reviews" data-section-story="home.reviews.story" data-sectrange="home.reviews.range" data-apisection="newsfeed" data-sectapi="pressReviewsList" class="b-press-overflow-hidden"></div>'}}}).state("home.reviews.page",{TARGET_NAME:"mayor_view",url:"page-{page:[0-9]+}/",onEnter:function(){}}).state("home.reviews.range",{TARGET_NAME:"mayor_view",url:"from/{fromDate:[^/]*}/until/{untilDate:[^/]*}/",onEnter:function(){}}).state("home.reviews.range.page",{TARGET_NAME:"mayor_view",url:"page-{page:[0-9]+}/",onEnter:function(){}}).state("home.reviews.story",{TARGET_NAME:"mayor_view",url:"{id:[^/]*}/",onEnter:function(){scrollTop(.4)},views:{"@":{template:'<div data-mos-press-review="" data-section="home.reviews" data-section-story="home.reviews.story" data-apisection="newsfeed" data-sectapi="pressReviewStory" class="b-press-overflow-hidden"></div>'}}})}]).service("newsFilter",["$stateParams","$filter","toolsSrvc","$state",function(i,s,n,t){var r=[],o={},l="";function c(e){e.from&&(e.from=s("date")(e.from,"dd.MM.yyyy")),e.to?e.to=s("date")(e.to,"dd.MM.yyyy"):e.to=s("date")(new Date,"dd.MM.yyyy")}function d(e,t){for(var a={},i=0,r=0;r<t.length;r++){var s=t[r];!(e[s]&&""!==e[s]||0<=i)||e[s]||"range"==s||(e[s]="all"),("all"!==e[s]||"all"===e[s]&&0<i)&&(a[s]=e[s],a.from=e.from,a.to=e.to,i++),(e.from&&e.to&&""!==e.from&&""!==e.to||0<i)&&(a.from=e.from,a.to=e.to,i++)}return a}function a(){var e=d(o,r);t.go(function(e,t,a){for(var i="",r=0,s=0;s<t.length;s++){var n=t[s];(e[n]&&""!==e[n]||0<r&&"range"!==n||"range"===n&&e.from&&e.to)&&(i="."+n+i,r++)}return a+i}(e,r,l),e)}this.getParams=function(){return o},this.init=function(e,t,a){r=t,l=e,o={},c(o=a?angular.extend({},i,a):i),o.page||(o.page=1),d(o,r)},this.setState=function(e){c(o=angular.extend({},o,e))},this.getDateForCalendar=function(){return{from:s("date")(o.from,"yyyy-MM-dd"),to:s("date")(o.to,"yyyy-MM-dd")}},this.getParam=function(e){return o[e]},this.setAndGetParams=function(e){var t,a,i,r=angular.extend({},o);for(t in o.page=r.page=e?++o.page:1,r)"from"===t||"to"===t?(a="from"===t,r[t]=""!==o[t]?(i=n.ruStrToDate(r[t]),a?s("date")(i,"yyyy-MM-dd")+" 00:00:00":s("date")(i,"yyyy-MM-dd")+" 23:59:59"):r[t]):(r[t]=""!==r[t]?r[t]:"all","all"!==r[t]&&""!==r[t]||delete r[t]);return r},this.setFilterCalendar=function(e,t){o.from=s("date")(e,"dd.MM.yyyy"),o.to=s("date")(t,"dd.MM.yyyy"),a()},this.setNewType=function(e){o.type=e||"all",a()},this.setNewSphere=function(e){o.sphere_id=e||"all",a()}}]),angular.module("mosapp.banner.service",[]).directive("mosExtcontsService",[function(){return{scope:{domain:"=",urlPath:"=",item:"="},link:function(e,t,a){if(e.banner=e.item,e.hideMe=!1,!e.item)return!(e.hideMe=!0);e.item.domain||(e.domain?e.item.domain=e.domain:e.item.domain="//"+window.location.hostname),e.item.urlPath||(e.banner.urlPath=e.urlPath),e.item.link=e.item.domain+(location.port?":"+location.port:"")+e.item.urlPath+"?id="+e.item.id;var i=document.createElement("script");i.type="text/javascript",i.language="JavaScript",i.id="mos-platform-"+e.item.id,i.src=e.item.link,angular.element(t).find(".extconts-service-container").append(i)},templateUrl:"mosBanner/mosBanner.tpl.html"}}]),angular.module("mosapp.social.widget",[]).directive("socialWidget",["UrlSrvc","LangSrvc",function(r,s){return{restrict:"A",scope:{stripeColor:"@?"},link:function(e,t){function a(){return-1<navigator.appVersion.indexOf("Edge/13",0)}function i(){a()&&angular.element(document).find(".mayor-social .icon").css({"background-size":"14px 14px"})}i(),a()&&e.$watch(function(){return angular.element(window).width()},function(){i()}),e.lang=s.getCurrentLang(),e.social=r.linksPath("social"),e.social=e.social[e.lang],e.stripeColor?e.border={"border-bottom":"3px solid "+e.stripeColor}:e.border={"border-bottom":"border: 3px solid #666"}},templateUrl:r.tmplPath("socialWidget/socialWidget.tpl.html")}}]).directive("informerWeatherTraffic",["UrlSrvc","dataSrvc",function(e,a){return{restrict:"A",scope:{color:"@"},link:function(e,t){a.el=t,e.informers=a.data.informers,e.colorScheme=a.data.colorScheme,e.error=a.data.error},templateUrl:e.tmplPath("socialWidget/informerWeatherTraffic.tpl.html")}}]).service("dataSrvc",["UrlSrvc","apiSrvc","toolsSrvc","$translate",function(e,t,i,r){this.data={informers:[{api:"infoTraffic",title:"social_widget.jam",units:"social_widget.jam_units_many",hideme:!0}],error:!1,colorScheme:!1,flag:!1},this.el=!1;var s=this;function a(a){t.getData("citypulse",a.api,{},!0,s.el).then(function(e){var t;angular.isObject(e)?(s.data.error=!1,a.data=e,a.hideme=!1,"infoTraffic"==a.api&&(e=a,t=parseInt(e.data.value),e.class=t<4?"icon-traffic-lights__green":t<8?"icon-traffic-lights__yellow":"icon-traffic-lights__red",e.units=1===t?"social_widget.jam_units_one":1<t&&t<5?"social_widget.jam_units_few":"social_widget.jam_units_many"),s.data.colorScheme=i.colorScheme(),r([a.title,a.units]).then(function(e){a.title=e[a.title],a.units=e[a.units]})):a.hideme=!0},function(e){s.data.error=e})}if(!this.flag)for(var n=0;n<this.data.informers.length;n++)a(this.data.informers[n])}]),angular.module("mosapp.carousel.four.items",["ngSanitize","slick","mosapp.customisation"]).directive("mosCarouselFourItems",["UrlSrvc","$timeout","$compile","CustomisationSrvc",function(n,o,e,l){return{restrict:"A",link:function(s,a,e,t){var i,r;s.uniqueeventsid="mosCarouselFourItems"+(new Date).getTime(),a.on("$destroy",function(){s.$destroy(),$(window).off("resize."+s.uniqueeventsid)}),s.speed=parseInt(e.speed)||1500,s.getCurrentVisibleSlides=function(){if(s.slick){var e=s.slick.slickGetOption("slidesToShow"),t=s.slick.slickGetOption("responsive");if(t&&t.length){for(var a=$(window).width(),i=5e3,r=0;r<t.length;r++)t[r].breakpoint>a&&(i=Math.min(i,t[r].breakpoint));for(r=0;r<t.length;r++)if(t[r].breakpoint===i){e=t[r].settings.slidesToShow;break}}return e}},s.navArrowsLogic=function(){var e=s.getCurrentVisibleSlides();s.items&&s.items.length>e?s.showArrows=!0:s.showArrows=!1},s.onAfterChange=function(){s.isAnimation=!1},s.onInitCarousel=function(e,t){s.slick=t,s.carousel=a.find(".b-slick-carousel"),s.carousel.on("afterChange",s.onAfterChange),s.navArrowsLogic()},s.locker=function(){s.isAnimation=!0,o(s.onAfterChange,s.speed)},s.gotoPrev=function(){if(s.isAnimation)return!1;s.locker(),s.slick.prev()},s.gotoNext=function(){if(s.isAnimation)return!1;s.locker(),s.slick.next()},$(window).on("resize."+s.uniqueeventsid,function(){i&&window.clearTimeout(i),i=window.setTimeout(function(){s.navArrowsLogic()},500)}),s.titleClick=function(){},s.utmType&&l.get("mosapp.carousel.four.items.titleClick")&&((e=l.get("mosapp.carousel.four.items.titleClick")).options&&e.options[s.utmType]&&(r=e.options[s.utmType],s.titleClick=function(e){e.preventDefault(),window.location=n.addParamsToUrl(e.currentTarget.href,r)}))},scope:{title:"@",titleImage:"=",moreLink:"@",moreLinkText:"@",items:"=",slidesToShow:"@",slidesToScroll:"@",rows:"@",slidesPerRow:"@",responsive:"=",infinite:"=",section:"@",sectionStory:"@",template:"@",swipe:"=",adaptiveHeight:"@",variableWidth:"@",moreLinkTarget:"@",speed:"@",initDelay:"@",utmType:"@?"},templateUrl:n.tmplPath("carouselFourItems/carouselFourItems.tpl.html")}}]).directive("compileTemplate",["$compile",function(r){return{scope:!0,link:function(t,a,e){var i;e.$observe("template",function(e){angular.isDefined(e)&&""!==e&&(i=r(e)(t),a.replaceWith(i))})}}}]),angular.module("mosapp.department.person",["ngSanitize","mosapp.carousel.four.items","mosapp.press.item.brick","mosapp.presentation.viewer"]).directive("mosDepartmentPerson",["UrlSrvc","$stateParams","apiSrvc","$rootScope","$location","mosconfig","toolsSrvc","metaConfig","$state",function(e,a,s,t,i,r,n,o,l){return{restrict:"A",link:function(i,r,e,t){$(r);r.on("$destroy",function(){i.$destroy()}),i.backButton=function(){window.history.length<=2?l.go("home.structure.structureId",{structureId:a.structureId}):window.history.back()},a.personId||l.go("home.structure"),i.contentArea=r.find(".b-content__block"),n.hideContentArea(i.contentArea),s.getData("department","departmentPersonList",{personId:a.personId},!0,r).then(function(e){if(angular.isArray(e.items)&&e.items.length){i.person=e.items[0],i.mosError=undefined,n.setMeta(i,{person:{title:i.person.name,description:i.person.post}},"person"),i.$watch(function(){return n.colorScheme()},function(e){i.colorScheme=e,setTimeout(function(){n.togglerBlackAndWhite("img",e,r)})}),n.setTitle(i.person.name,o.structure.sectionTitle);var t={personId:i.person.id};if(angular.isArray(i.person.tags)&&i.person.tags.length){t["tag[]"]=[];for(var a=0;a<i.person.tags.length;a++)t["tag[]"].push(i.person.tags[a].id)}angular.isDefined(i.person.section)&&(t.sectionId=i.person.section.id),n.showContentArea(i.contentArea)}else i.mosError=404},function(e){i.error=e,i.mosError=e.code})},templateUrl:e.tmplPath("departmentPerson/departmentPerson.tpl.html")}}]),angular.module("mosapp.department.person.one",["ngSanitize","mosapp.carousel.four.items","mosapp.quote.item.brick","mosapp.photobank.item.brick","mosapp.biography.item.brick"]).directive("mosDepartmentPersonOne",["UrlSrvc","$stateParams","apiSrvc","$rootScope","$location","toolsSrvc","metaConfig","mosconfig","LangSrvc","$translate","imageSrcFilter","headmetaSrvc",function(e,t,i,a,r,s,n,o,l,c,d,m){return{restrict:"A",link:function(t,a){t.lang=l.getCurrentLang(),t.class="b-content__person_one_"+t.lang,t.$watch(function(){return s.colorScheme()},function(e){t.colorScheme=e,setTimeout(function(){s.togglerBlackAndWhite(".b-person__photo-img img",e,a)},700)}),t.social=e.linksPath("social")[t.lang],e.setCanonical(e.getLangLink(e.pagePath("mayor",""))),i.getData("mayor","departmentPersonOne",{},!0,a).then(function(e){angular.isArray(e.items)&&e.items.length&&(t.person=e.items[0],t.image=d(t.person.image),c(["mosDepartmentPersonOne.bio.sectionTitle","mosDepartmentPersonOne.bio.title","mosDepartmentPersonOne.bio.description","mosDepartmentPersonOne.bio.keywords","mosDepartmentPersonOne.section"]).then(function(e){n.biography.sectionTitle=e["mosDepartmentPersonOne.bio.sectionTitle"],n.biography.title=e["mosDepartmentPersonOne.bio.title"],n.biography.description=e["mosDepartmentPersonOne.bio.description"],n.biography.keywords=e["mosDepartmentPersonOne.bio.keywords"],n.biography.section=e["mosDepartmentPersonOne.section"],n.biography.image=t.person.image,n.biography.image.src=t.image,m.setPageMeta(n,"biography"),m.setTitle(t.person.name,n.biography.sectionTitle,n.biography.section),m.setKeywords(n.biography.keywords)}))},function(e){t.error=e})},templateUrl:e.tmplPath("departmentPersonOne/departmentPersonOne.tpl.html")}}]),angular.module("mosapp.filters.containers",[]).directive("containerRatio",["$timeout",function(e){return{restrict:"A",link:function(a,e,t){for(var i="containerRatio"+(new Date).getTime()+(9998*Math.random()+1),r=(e.on("$destroy",function(){$(window).off("resize."+i),a.$destroy()}),a.attrParams=t.containerRatio,a.attrParams=a.attrParams.split(":"),a.params={},a.attrParams.length);r--;){var s=a.attrParams[r].split("|");a.params[s[0]]=s[1]}a.getRatio=function(){var e=document.documentElement.clientWidth;return e?1170<e?"e":970<e?"d":750<e?"c":463<e?"b":"a":"a"},a.setElementSize=function(){a.ratio=a.getRatio(),e.height(e.width()*a.params[a.ratio])},a.setElementSize(),a.$watch(function(){return e.width()},function(e,t){e!==t&&(a.t&&clearTimeout(a.t),a.t=setTimeout(function(){a.setElementSize()},50))})},scope:{containerRatio:"@"}}}]),angular.module("mosapp.filters.imageSrc",[]).value("imageSet",{defaultImage:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",ratioMask:"x1_",size:{s:"small",m:"middle",b:"big"}}).service("imgSrvc",["mosconfig",function(t){this.isMarkupImage=function(e){return-1<e.indexOf("%markup_images_dir%")?e.replace("%markup_images_dir%",t.imagesPath):e},this.testSrc=function(e){return""!==e&&e},this.testObj=function(e,t){return!!(angular.isObject(e)&&angular.isObject(e[t])&&angular.isDefined(e[t].src)&&this.testSrc(e[t].src))&&e[t].src}}]).filter("imgThumb",["imgSrvc","imageSet",function(a,i){return function(e){var t=i.defaultImage;return angular.isObject(e)?angular.isDefined(e.src)&&a.testSrc(e.src)?a.isMarkupImage(e.src):(e=a.testObj(e,"thumb")||a.testObj(e,"small")||a.testObj(e,"middle")||a.testObj(e,"big"))?a.isMarkupImage(e):t:t}}]).filter("imgShow",["imgSrvc","imageSet",function(a,i){return function(e){var t=i.defaultImage;return angular.isObject(e)?angular.isDefined(e.src)&&a.testSrc(e.src)?a.isMarkupImage(e.src):(e=a.testObj(e,"show")||a.testObj(e,"big")||a.testObj(e,"original"))?a.isMarkupImage(e):t:t}}]).filter("imgDownload",["imgSrvc","imageSet",function(i,r){return function(e){var t,a=r.defaultImage;return angular.isObject(e)?angular.isDefined(e.src)&&i.testSrc(e.src)?i.isMarkupImage(e.src):(t=(t=i.testObj(e,"download")||i.testObj(e,"show")||i.testObj(e,"big")||i.testObj(e,"original"))&&0===i.isMarkupImage(t).split("/").pop().indexOf("undefined(",0)?i.testObj(e,"show")||i.testObj(e,"big")||i.testObj(e,"original"):t)?i.isMarkupImage(t):a:a}}]).filter("imageSrc",["imgSrvc","imageSet",function(a,i){return function(e){var t=i.defaultImage;return angular.isObject(e)?angular.isDefined(e.src)&&a.testSrc(e.src)?a.isMarkupImage(e.src):(e=a.testObj(e,"small")||a.testObj(e,"middle")||a.testObj(e,"big"))?a.isMarkupImage(e):t:t}}]).filter("imageSrcBig",["imgSrvc","imageSet",function(a,i){return function(e){var t=i.defaultImage;return angular.isObject(e)?angular.isDefined(e.src)&&a.testSrc(e.src)?a.isMarkupImage(e.src):(e=device.mobile()?a.testObj(e,"small")||a.testObj(e,"middle")||a.testObj(e,"big"):device.tablet()?a.testObj(e,"middle")||a.testObj(e,"big")||a.testObj(e,"small"):a.testObj(e,"big")||a.testObj(e,"middle")||a.testObj(e,"small"))?a.isMarkupImage(e):t:t}}]).filter("imageSrcMiddle",["imgSrvc","imageSet",function(a,i){return function(e){var t=i.defaultImage;return angular.isObject(e)?angular.isDefined(e.src)&&a.testSrc(e.src)?a.isMarkupImage(e.src):(e=a.testObj(e,"middle")||a.testObj(e,"big")||a.testObj(e,"small"))?a.isMarkupImage(e):t:t}}]).filter("imageSetSrc",["imgSrvc","imageSet",function(l,c){return function(e,t,a,i,r,s){var n=c.defaultImage,o=document.documentElement.clientWidth,s=o?1280<o?s:1024<o?r:768<o?i:480<o?a:t:i,r=(s=s.split("|"))[1]||"3",o=s[2]||"m";return angular.isObject(e)?angular.isDefined(e.src)&&l.testSrc(e.src)?l.isMarkupImage(e.src):(a=l.testObj(e,r+c.ratioMask+o)||l.testObj(e,c.size[o]))?l.isMarkupImage(a):n:n}}]).filter("imageSrcOriginal",["imgSrvc","imageSet",function(a,i){return function(e){var t=i.defaultImage;return angular.isObject(e)?angular.isDefined(e.src)&&a.testSrc(e.src)?a.isMarkupImage(e.src):(e=a.testObj(e,"original")||a.testObj(e,"big")||a.testObj(e,"middle")||a.testObj(e,"small"))?a.isMarkupImage(e):t:t}}]).filter("imgFileName",["imgSrvc",function(i){return function(e){var t="Moscow.jpg",a=angular.isObject(e)&&(a=angular.isDefined(e.src)&&i.testSrc(e.src)?i.isMarkupImage(e.src):i.isMarkupImage(i.testObj(e,"original")))?a.split("/").pop():t;return a}}]).directive("fixHeadImage",[function(){return{restrict:"A",scope:{},link:function(i,e){e.on("$destroy",function(){i.$destroy()}),i.EL=$(e),i.HDR=$(".b-header.attached"),i.WND=$(window),i.WND.on("scroll",function(){var e=i.EL.offset().top,t=i.HDR.length?i.HDR.height():0,a=e-t<(a=i.WND.scrollTop())?a+t-e:0;i.EL.css({"background-position":"center "+a+"px"})})}}}]).directive("imageSetElement",["imgSrvc","imageSet","$timeout","toolsSrvc","loader",function(n,o,e,t,l){return{restrict:"A",link:function(r,s){s.on("$destroy",function(){r.$destroy()}),r.removeLoader=function(){var e=s;r.loaderType&&(e={loaderType:r.loaderType,elems:s}),l.switchOff(e)},r.firstStart=!0,r.getSrc=function(){var e=o.defaultImage,t=s.width(),a=s.height(),i=(r.firstStart&&(i=s,r.loaderType&&(i={loaderType:r.loaderType,elems:s}),l.switchOn(i)),Math.round(t/a)),a=(i=(i=4<i?4:i)<1?1:i,800<t?"b":480<t?"m":"s");return angular.isObject(r.imageSetElement)?angular.isDefined(r.imageSetElement.src)&&n.testSrc(r.imageSetElement.src)?n.isMarkupImage(r.imageSetElement.src):(t=n.testObj(r.imageSetElement,i+o.ratioMask+a)||n.testObj(r.imageSetElement,o.size[a]))?n.isMarkupImage(t):e:e},r.setBackground=function(){r.firstStart&&(r.firstStart=!1,t.hideContentArea(angular.element(s))),r.removeLoader(),s.css("background-image",'url("'+r.img.src+'")'),t.showContentArea(angular.element(s))},r.loadBackground=function(){r.img=new Image,r.img.src=r.getSrc(),angular.element(r.img).on("load",r.setBackground).on("error",r.removeLoader)},e(function(){r.childImgEl=s.children("img"),r.childImgEl.length&&r.childImgEl[0]?r.$watch(function(){return r.childImgEl[0].src},function(){e.cancel(r.loadBGTimer),r.loadBGTimer=e(function(){r.loadBackground()},1e3)}):(r.loadBackground(),r.enableWatch&&(r.parentNode=angular.element(s[0].parentNode),r.$watch(function(){return{width:s.width(),height:s.height()}},function(e,t){e.width===t.width&&e.height===t.height||r.loadBackground()},!0)))})},scope:{imageSetElement:"=",loadHeight:"@",enableWatch:"@",loaderType:"@"}}}]).directive("imgSpacer",[function(){return{restrict:"A",link:function(e,t,a){for(var i="imgSpacer"+(new Date).getTime()+(9998*Math.random()+1),r=(t.on("$destroy",function(){$(window).off("resize."+i),e.$destroy()}),e.attrParams=a.imgSpacer,e.attrParams=e.attrParams.split(":"),e.params={},e.attrParams.length);r--;){var s=e.attrParams[r].split("|");e.params[s[0]]=s[1]}e.images={"1x1":"data:image/gif;base64,R0lGODlhDwAPAIAAAP///wAAACH5BAEAAAAALAAAAAAPAA8AAAINhI+py+0Po5y02otnAQA7","2x1":"data:image/gif;base64,R0lGODlhHgAPAIAAAP///wAAACH5BAEAAAAALAAAAAAeAA8AAAIThI+py+0Po5y02ouz3rz7D4ZTAQA7","3x1":"data:image/gif;base64,R0lGODlhLQAPAIAAAP///wAAACH5BAEAAAAALAAAAAAtAA8AAAIYhI+py+0Po5y02ouz3rz7D4biSJbmiTYFADs=","4x1":"data:image/gif;base64,R0lGODlhPAAPAIAAAP///wAAACH5BAEAAAAALAAAAAA8AA8AAAIchI+py+0Po5y02ouz3rz7D4biSJbmiabqyrZrAQA7"},e.rewriteSet=function(){e.w=document.documentElement.clientWidth,e.set="a",e.w&&(e.set="a",463<e.w&&(e.set="b"),750<e.w&&(e.set="c"),970<e.w&&(e.set="d"),1170<e.w&&(e.set="e")),t[0].src=e.images[e.params[e.set]+"x1"],t[0].style.width="100%",t[0].style.height="auto"},e.rewriteSet(),$(window).on("resize."+i,function(){e.t&&clearTimeout(e.t),e.t=setTimeout(function(){e.rewriteSet()},Math.floor(400*Math.random())+100)})},scope:{imgSpacer:"@"}}}]).directive("imgRatio",["mosconfig","$timeout","imgSrvc","imageSet","toolsSrvc","loader",function(e,n,o,l,c,d){return{restrict:"A",link:function(r,a,t){for(var e="imgRatio"+(new Date).getTime()+(9998*Math.random()+1),i=(a.on("$destroy",function(){$(window).off("resize."+e),r.$destroy()}),r.images={"1x1":"data:image/gif;base64,R0lGODlhDwAPAIAAAP///wAAACH5BAEAAAAALAAAAAAPAA8AAAINhI+py+0Po5y02otnAQA7","2x1":"data:image/gif;base64,R0lGODlhHgAPAIAAAP///wAAACH5BAEAAAAALAAAAAAeAA8AAAIThI+py+0Po5y02ouz3rz7D4ZTAQA7","3x1":"data:image/gif;base64,R0lGODlhLQAPAIAAAP///wAAACH5BAEAAAAALAAAAAAtAA8AAAIYhI+py+0Po5y02ouz3rz7D4biSJbmiTYFADs=","4x1":"data:image/gif;base64,R0lGODlhPAAPAIAAAP///wAAACH5BAEAAAAALAAAAAA8AA8AAAIchI+py+0Po5y02ouz3rz7D4biSJbmiabqyrZrAQA7"},r.noAnimation="true"===t.noAnimation,r.attrParams=t.imgRatio,r.attrParams=r.attrParams.split(":"),r.params={},r.attrParams.length);i--;){var s=r.attrParams[i].split("|");r.params[s[0]]=s[1]}r.parentNode=angular.element(a[0].parentNode),r.removeLoader=function(){d.switchOff(r.parentNode[0])},r.firstStart=!0,r.getSrc=function(e){var t=r.images[e+"x1"],a=r.parentNode.width(),i=(!r.noAnimation&&r.firstStart&&d.switchOn(r.parentNode[0]),800<a?"b":480<a?"m":"s");return r.parentNode.height(a/e),angular.isObject(r.imgSource)?angular.isDefined(r.imgSource.src)&&o.testSrc(r.imgSource.src)?(a=o.isMarkupImage(r.imgSource.src),/^(\/)|(http(s):\/\/)/.test(a)?a:"/"+a):(a=o.testObj(r.imgSource,e+l.ratioMask+i)||o.testObj(r.imgSource,l.size[i]))?o.isMarkupImage(a):t:t},r.restoreStyle=function(e){r.needForRestore=!1,n.cancel(r.needForRestoreTimer),r.noAnimation||r.removeLoader(),!r.noAnimation&&r.firstStart&&(r.firstStart=!1,c.hideContentArea(r.parentNode)),a[0].src=e,a[0].style.height="auto",r.noAnimation||c.showContentArea(r.parentNode)},r.brokenImageSrc=function(e){t.setBrokenImageSrc&&r.setBrokenImageSrc(e)},r.rewriteSet=function(){r.needForRestore=!0,a[0].style.width="100%";var e=new Image,t=r.params[r.ratio];e.src=r.getSrc(t),r.noAnimation&&(a[0].src=e.src),angular.element(e).on("load",function(){r.needForRestore&&(r.brokenImageSrc(!1),r.restoreStyle(e.src,t))}),angular.element(e).on("error",function(){e.src=r.images[t+"x1"],r.needForRestore&&(r.brokenImageSrc(!0),r.restoreStyle(e.src,t))}),r.needForRestoreTimer=n(function(){r.needForRestore&&(r.brokenImageSrc(!1),r.restoreStyle(e.src,t))},1e4)},r.getRatio=function(){var e=document.documentElement.clientWidth;return e?1170<e?"e":970<e?"d":750<e?"c":463<e?"b":"a":"a"},r.ratio=r.getRatio(),r.rewriteSet(),r.$watch(function(){return r.parentNode.width()},function(e,t){e!==t&&(r.ratio=r.getRatio(),r.parentNode.css({height:e/r.params[r.ratio],overflow:"hidden"}),a[0].style.height="100%",r.t&&clearTimeout(r.t),r.t=setTimeout(function(){r.rewriteSet()},Math.floor(100*Math.random())+50))})},scope:{imgRatio:"@",imgSource:"=",noAnimation:"@",setBrokenImageSrc:"=?"}}}]),angular.module("mosapp.filters.prepareDate",[]).filter("prepareDate",function(){return function(e){var t,a,i=[];return-1===e.indexOf("-")?e:((i=e.split("-"))[0]=i[0].slice(0,i[0].length-1),i[1]=i[1].slice(1,i[1].length+1),i[0]===i[1]?i[0]:(t=i[0].split(" "),a=i[1].split(" "),1===t.length&&1===a.length?e:t[1]===a[1]?t[0]+"–"+a[0]+" "+a[1]:i[0]!==i[1]?e:void 0))}}),angular.module("mosapp.filters.prepareDateSince",[]).filter("prepareDateSince",["$filter",function(r){return function(e,t){var a=new Date,i=a.getTimezoneOffset()/60,i=(a=-3!=i?new Date(a.getTime()+3600*i*1e3+108e5):a).getFullYear();if(new Date(e).getFullYear()<i)return r("date")(e,t+" yyyy");i=Math.abs(e-a.getTime());if(1<=Math.floor(i/864e5))return r("date")(e,t);a=Math.floor(i/36e5);if(0<a&&a<24)return a+r("translate")("prepareDateSince.hours");a=Math.floor(i/6e4);return 0<a&&a<60?a+r("translate")("prepareDateSince.minutes"):0==a?r("translate")("prepareDateSince.momentAgo"):r("date")(e,t)}}]),angular.module("mosapp.quote.item.brick",[]).directive("mosQuoteItemBrick",["UrlSrvc",function(e){return{restrict:"A",replace:!0,link:function(e,t,a,i){},scope:{item:"="},templateUrl:e.tmplPath("quoteItemBrick/quoteItemBrick.tpl.html")}}]),angular.module("mosapp.biography.item.brick",[]).directive("mosBiographyItemBrick",["UrlSrvc",function(e){return{restrict:"A",link:function(e,t,a,i){},scope:{item:"="},templateUrl:e.tmplPath("biographyItemBrick/biographyItemBrick.tpl.html")}}]),angular.module("mosapp.photobank.item.brick",[]).directive("mosPhotobankItemBrick",["UrlSrvc","toolsSrvc",function(e,r){return{restrict:"A",replace:!0,link:function(t,e,a,i){t.$watch(function(){return r.colorScheme()},function(e){t.colorScheme=e})},scope:{item:"="},templateUrl:e.tmplPath("photobankItemBrick/photobankItemBrick.tpl.html")}}]),angular.module("mosapp.carousel.promo",["ngSanitize","slick"]).directive("mosCarouselPromo",["UrlSrvc","apiSrvc","$timeout","toolsSrvc",function(n,t,o,l){return{restrict:"A",link:function(r,e,s){e.on("$destroy",function(){r.$destroy()}),r.onInitCarousel=function(e,t){r.slick=t},r.$watch(function(){return l.colorScheme()},function(e){r.colorScheme=e}),r.contentArea=e.find(".b-promo__carousel-list"),l.hideContentArea(r.contentArea),r.incomeItems?(r.error=!1,r.items=angular.copy(r.incomeItems),o(function(){l.showContentArea(r.contentArea)},10)):angular.isDefined(r.apisection)&&angular.isDefined(r.promoapi)?t.getData(r.apisection,r.promoapi).then(function(e){r.error=!1,r.items=e.items,s.onInitFunc&&r.onInitFunc({num:e.items.length}),o(function(){l.showContentArea(r.contentArea)},10)},function(e){r.error=e}):t.getData("press","mainPromoList").then(function(e){for(var t=0;t<e.items.length;t++){var a=e.items[t],i=a.sphere&&a.sphere.id?a.sphere.id:"";a.link=n.pagePath("press","/themes/"+i+"/"+a.id)}r.error=!1,r.items=e.items,s.onInitFunc&&r.onInitFunc({num:e.items.length}),o(function(){l.showContentArea(r.contentArea)},10)},function(e){r.error=e}),r.$on("$locationChangeSuccess",function(){o(function(){r.slick&&r.slick.refresh()},100)})},scope:{onInitFunc:"&",section:"@",apisection:"@",promoapi:"@",sectionStory:"@",incomeItems:"="},templateUrl:n.tmplPath("carouselPromo/carouselPromo.tpl.html")}}]),angular.module("mosapp.carousel.media",["slick"]).directive("mosCarouselMedia",["UrlSrvc","toolsSrvc",function(e,r){return{restrict:"A",link:function(a,e,t,i){a.onInitCarousel=function(e,t){a.slick=t},a.videoState=function(e){a.$apply(a.videoStatus=e)},a.$watch(function(){return r.colorScheme()},function(e){a.colorScheme=e})},scope:{items:"="},templateUrl:e.tmplPath("carouselMedia/carouselMedia.tpl.html")}}]),angular.module("mosapp.video.player",[]),"function"!=typeof window.phantomJsLastModified&&angular.module("mosapp.video.player").directive("mosVideoPlayer",["UrlSrvc","VPsrvc","$rootScope",function(n,o,e){return{restrict:"A",replace:!0,link:function(t,e,a,i){t.player=null,t.autoplay=!!t.autoplay,t.playlist=[];var r=a.src;function s(){o.playerLoad({}).then(function(e){t.createPlayer(),t.attachPlayerEvents()},function(e){})}r?(t.playlist.push([{mp4:r}]),s()):t.$watch("sources",function(e){e!==undefined&&(t.playlist=[],t.playlist.push(e),s())}),a.$observe("src",function(e){}),t.createPlayer=function(){$(e).flowplayer({playlist:t.playlist,swf:n.jsPath("flowplayer/flowplayer.swf")}),t.player=flowplayer(e[0]),t.autoplay&&t.player.play(0),t.isAutoStart&&$(".fp-ui").trigger("click")},t.attachPlayerEvents=function(){t.player.bind("resume",function(){a.evtPlay&&t.evtPlay({state:"play"})}),t.player.bind("pause",function(){a.evtPause&&t.evtPause({state:"pause"})}),t.player.bind("stop",function(){a.evtStop&&t.evtStop({state:"stop"})}),t.player.bind("fullscreen",function(){void 0!==window.$mos_layouts&&window.$mos_layouts.api.header.set("displayHeader",!1)}),t.player.bind("fullscreen-exit",function(){void 0!==window.$mos_layouts&&window.$mos_layouts.api.header.set("displayHeader",!0)})}},scope:{isAutoStart:"@",sources:"=",evtPlay:"&",evtPause:"&",evtStop:"&",autoplay:"=?"},templateUrl:n.tmplPath("videoPlayer/videoPlayer.tpl.html")}}]),angular.module("mosapp.video.player").directive("mosVideoJs",["UrlSrvc","VPsrvc","$rootScope",function(e,n,t){return{restrict:"A",link:function(r,s,e,t){r.player=null,r.$watch("sources",function(e){e===undefined&&!s.find("source").length||r.initPlayer()}),r.$on("$destroy",function(){r.player&&r.player.dispose()}),r.initPlayer=function(){s.hasClass("vjs-big-play-centered")||s.addClass("vjs-big-play-centered");var t={fluid:!1,preload:"auto",techOrder:["flash","html5"],controls:!0,autoplay:!!r.isAutoStart};if(r.image&&(t.poster=r.image),r.sources)t.sources=r.sources;else{var e=s.find("source");if(e.length&&angular.forEach(e,function(e){var t=navigator.userAgent.toLowerCase(),a=-1!=t.indexOf("android");((-1!=t.indexOf("ipad")||-1!=t.indexOf("iphone")||-1!=t.indexOf("windows phone"))&&"m3u"==e.dataset.format||a&&"m3u8"==e.dataset.format)&&s[0].replaceChild(e,s[0].firstChild)}),"flv"===s[0].firstChild.dataset.format){var e=s,a=(navigator.userAgent.toLowerCase(),!1);if(void 0!==navigator.plugins&&"object"==typeof navigator.plugins["Shockwave Flash"])a=!0;else if(void 0!==window.ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(a=!0)}catch(e){}a?i():(a=$('<div style="height: 150px; background-color: rgba(0, 0, 0, 0.05); display: table; width: 100%; text-align: center;"><div style="display: table-cell; vertical-align: middle;">Чтобы воспроизвести видеопоток требуется <a href="http://www.adobe.com/go/getflashplayer"> установить Flash-плеер </a>.</div></div>'),e.replaceWith(a))}else i()}function i(){n.playerVideoJSLoad({}).then(function(e){r.player=videojs(s[0],t,function(){var e=this;this.ready(function(){e.poster(t.poster),e.el_&&$(e.el_).find(".vjs-poster").css("background-image",t.poster)})})},function(e){})}}},scope:{isAutoStart:"=?",sources:"=",image:"@"}}}]),angular.module("mosapp.video.mvsr.player",[]).directive("videoMvsrPlayer",["MvsrPlayerSrvc","UrlSrvc","$rootScope","$window",function(a,e,t,i){return{restrict:"A",templateUrl:e.tmplPath("videoMvsrPlayer/videoMvsrPlayer.tpl.html"),link:function(t,e){t.$watch("guid",function(e){e!==undefined&&t.initPlayer()}),t.guid=t.videoMvsrPlayer,t.$on("$destroy",function(){}),e.on("$destroy",function(){t.$destroy()}),t.initPlayer=function(){a.load({}).then(function(){i.publicPlayer&&i.publicPlayer.create({element:"player-container-"+t.guid,guid:t.guid})},function(){})}},scope:{videoMvsrPlayer:"@"}}}]).service("MvsrPlayerSrvc",["$q","$rootScope","$window","mosconfig",function(e,a,t,i){function r(){var e=window.jQuery&&window.jQuery.fn.jquery;if(e)return{major:(e=e.split("."))[0],minor:e[1],mod:e[2]}}this.load=function(){return e(function(t){var e;a.videoMvsrPlayer?"ready"!==a.videoMvsrPlayer.status?(e=document.getElementById("public-player-script"),$(e).on("load",function(){var e=r();e&&"1"===e.major&&jQuery.noConflict(),t()})):t():(a.videoMvsrPlayer={},a.videoMvsrPlayer.status="load",(e=document.createElement("script")).id="public-player-script",e.async="true",document.getElementsByTagName("head")[0].appendChild(e),e.src=i.mvsrPlayer,$(e).on("load",function(){a.videoMvsrPlayer.status="ready";var e=r();e&&"1"===e.major&&jQuery.noConflict(),t()}))})}}]),angular.module("mosapp.audio.player",[]).directive("mosAudioPlayer",["UrlSrvc","APsrvc","$rootScope",function(w,t,e){return{restrict:"A",scope:{audioFormat:"@",audioHref:"@",audioVolum:"@",autoPlay:"=",audioTitle:"="},templateUrl:w.tmplPath("audioPlayer_v4/audioPlayer.tpl.html"),link:function(v,y,_,e){v.initPlayer=function(){t.playerLoad({skin:"v4"}).then(function(e){v.createPlayer()},function(e){})},v.initPlayer(),v.createPlayer=function(){v.audioPlay=_.audioPlay,v.audioFormat=_.audioFormat,v.audioHref=_.src||_.audioHref,v.audioVolum=_.audioVolum;var e,t=$(y),a=$('<div class="audioplayer"></div>').prependTo(t),i=v.audioTitle||"",r={},s="",n=t.attr("id")?t.attr("id"):"a"+(new Date).getTime();t.find(".media a").each(function(e){$(this);s+=0<e?","+v.audioFormat:v.audioFormat,r[v.audioFormat]=v.audioHref}),t.data("width")&&t.data("width"),t.data("autoplay")&&t.data("autoplay"),t.data("mute")&&t.data("mute");v.audioVolum?(e=v.audioVolum,null!=localStorage.getItem("volume")&&(e=localStorage.getItem("volume"))):e=.6;$('<div id="container_'+n+'" class="nota_audio"><div class="nota_title-container"><div class="nota_title">'+i+'</div></div><div class="nota_type-single"><div id="notaplayer_'+n+'" class="nota_jplayer"></div><div class="nota_gui"><div class="nota_interface"><div class="nota_progress-container"><div class="nota_progress jp-progress-slider"><div class="nota_seek-bar"><div class="nota_play-bar"><div class="nota_time-container"><span class="nota_current-time"></span></div></div></div></div><div class="nota_time-tooltip"><span>00:00</span><i></i></div><div class="nota_duration"></div></div><div class="nota_controls-holder"><div class="nota_controls"><a href="javascript:;" class="nota_play" tabindex="1"><span class="icon-play_grey">воспр.</span></a><a href="javascript:;" class="nota_pause" tabindex="1"><span class="icon-pause_grey">пауза</span></a><a href="javascript:;" class="nota_stop" tabindex="1"><span  class="icon-pause_grey">стоп</span></a><div class="nota_rewind-controls"><a href="javascript:;" class="nota_rewind" tabindex="1"><span class="icon-rewind_grey">назад</span></a><a href="javascript:;" class="nota_fastforward" tabindex="1"><span  class="icon-fastforward_grey">стоп</span></a></div><div class="nota_volume-controls"><a href="javascript:;" class="nota_mute" tabindex="1" title="выкл."><span class="icon-mute_grey">выкл.</span></a><a href="javascript:;" class="nota_unmute" tabindex="1" title="вкл."><span class="icon-unmute_grey">вкл.</span></a><a href="javascript:;" class="nota_volume-max" tabindex="1" title="max volume"><span class="icon-mute_grey">вжарить</span></a><div class="nota_volume-bar"><div class="nota_volume-bar-value"></div></div></div></div></div></div></div><div class="errorlayer"><div class="errorstatus"></div></div><div class="waitinglayer"><div class="waitingstatus">Подождите, загрузка...</div></div><div class="nota_no-solution"><span>Нужен плагин</span>Для воспроизведения аудио вам нужно обновить браузер или <a href="http://get.adobe.com/flashplayer/" target="_blank">Flash plugin</a>.</div></div></div>').appendTo(a);var o,l=0,c=0,d=0,m=0,p=0,u=0,g=a.find(".errorlayer"),h=g.find(".errorstatus"),f=a.find(".waitinglayer");"apready"!=a.data("apready")&&($("#notaplayer_"+n).jPlayer({ready:function(e){var t=$(this);t.jPlayer("setMedia",r),a.data("apready","apready"),v.autoPlay&&t.jPlayer("play",0)},loadedmetadata:function(e){},timeupdate:function(e){},error:function(e){var t=$(this);e.jPlayer.status.currentTime!=undefined&&0<e.jPlayer.status.currentTime&&(l=e.jPlayer.status.currentTime,c=e.jPlayer.status.currentPercentRelative,d=e.jPlayer.status.currentPercentAbsolute,m=e.jPlayer.status.currentTime,p=e.jPlayer.status.duration,u=e.jPlayer.status.remaining),"play"==o&&(window.setTimeout(function(){e.jPlayer.status.currentPercentRelative=c,e.jPlayer.status.currentPercentAbsolute=d,e.jPlayer.status.currentTime=m,e.jPlayer.status.duration=p,e.jPlayer.status.remaining=u,g.css("display",""),t.jPlayer("play",l)},1e4),g.css("display","block"),h.html("Соединение с сервером прервано.<br>Восстановление соединения..."))},play:function(e){o="play";$(this)},pause:function(){o="pause"},stop:function(){o="stop"},waiting:function(){f.css("display","block")},canplay:function(){f.css("display","")},seeking:function(e){l=e.jPlayer.status.currentTime},swfPath:w.jsPath("jplayer/"),errorAlerts:!1,cssSelectorAncestor:"#container_"+n,cssSelector:{play:".nota_play",pause:".nota_pause",stop:".nota_stop",seekBar:".nota_seek-bar",playBar:".nota_play-bar",mute:".nota_mute",unmute:".nota_unmute",volumeBar:".nota_volume-bar",volumeBarValue:".nota_volume-bar-value",volumeMax:".nota_volume-max",currentTime:".nota_current-time",duration:".nota_duration",fullScreen:".nota_full-screen",restoreScreen:".nota_restore-screen",repeat:".nota_repeat",repeatOff:".nota_repeat-off",gui:".nota_gui",noSolution:".nota_no-solution"},volumechange:function(e){e=e.jPlayer.options.volume;localStorage.setItem("volume",e)},volume:e,supplied:s,wmode:"window",smoothPlayBar:!1,keyEnabled:!1}),a.find(".nota_rewind").on("click",function(){var e=a.find("#notaplayer_"+n),t=a.find("#notaplayer_"+n).data("jPlayer");t&&((t=t.status.currentPercentAbsolute-5)<=0?e.jPlayer("pause",0):e.jPlayer("playHead",t))}),a.find(".nota_fastforward").on("click",function(){var e=a.find("#notaplayer_"+n),t=a.find("#notaplayer_"+n).data("jPlayer");t&&(100<=(t=t.status.currentPercentAbsolute+5)?e.jPlayer("pause",0):e.jPlayer("playHead",t))}))}}}}]),angular.module("mosapp.press.themes",["ngAnimate"]).directive("mosPressThemes",["UrlSrvc","catSrvc","apiSrvc","$state","$stateParams","toolsSrvc","$filter","testDate","metaConfig","imageSrcFilter","tmplSrvc","headmetaSrvc","opengraphSrvc",function(n,e,o,l,c,d,t,a,m,p,u,g,h){return{restrict:"A",scope:{section:"@",sectionCategory:"@",sectionRange:"@",sectionStory:"@",apisection:"@",sectapi:"@",rangeFilter:"@",promoapi:"@",catapi:"@"},link:function(i,r){r.on("$destroy",function(){i.$destroy()}),a(),n.setCanonical(n.getLangLink(n.pagePath("mayorNews","")));var e={sort:"-date",fields:"id,title,image,sphere,date_timestamp"};function a(){var e={description:m.themes.description,keywords:m.themes.keywords};i.currentSphere&&angular.isNumber(i.currentSphere.id)?(e={description:m.theme.description.replace("%theme%",i.currentSphere.title),keywords:(m.theme.section+" "+i.currentSphere.title+", мэр москвы, сайт москвы").toLowerCase()},g.withoutSiteName().setTitle(i.currentSphere.title,m.theme.section)):g.setTitle(m.themes.sectionTitle,m.themes.section),g.setPageMeta({meta:e},"meta"),h.invalidateWithGlobalMeta().passUrl()}function s(e){var t="";return c.sphere_id&&(t=c.sphere_id+"/"),1===e?n.pagePath("mayorNews",t):1<e?n.pagePath("mayorNews",t+"page-"+e):""}i.params=angular.extend({},e),c.sphere_id&&(i.params.sphere_id=c.sphere_id),c.page&&(c.page*=1,1===c.page&&l.go("home.themes"),i.params.page=c.page),i.currentSphereAll=!0,i.firstPage=!c.page,i.linksLoaded=!1,i.getNextPageUrl=function(){return n.getNextPageUrl(i.params.page,s)},i.settings={sphere:{},categories:[]},i.catparams={expand:"image","per-page":50,filter:{in_news:1}},i.error=!1,i.getCategories=function(){if(angular.isUndefined(i.catapi)||angular.isUndefined(i.apisection))return!1;i.catListArea=r.find(".b-press-nav"),d.hideContentArea(i.catListArea),o.getData(i.apisection,i.catapi,i.catparams,!0,i.catListArea[0]).then(function(e){angular.isArray(e.items)&&e.items.length&&(i.itemsSphere=e.items,i.setCurrentSphere()),d.showContentArea(i.catListArea)},function(e){i.error=e})},i.getNewCategory=function(e){i.params&&(e?i.params.sphere_id=e:(delete i.params.sphere_id,delete i.params.page)),i.params.fromDate||i.params.untilDate&&angular.isDefined(i.sectionRange)&&""===i.params.sphere_id?l.go(i.sectionRange,i.params):angular.isDefined(i.params.sphere_id)?l.go(i.sectionCategory,i.params):l.go(i.section,i.params),i.setCurrentSphere()},i.setCurrentSphere=function(){i.currentSphere={id:""};var e="all"===(e=c.sphere_id||"")?"":e;i.sphere_id=e;for(var t=0;t<i.itemsSphere.length;t++)i.itemsSphere[t].id.toString()===e&&(i.currentSphere=i.itemsSphere[t]);a(),""!=i.currentSphere.id?i.currentSphereAll=!1:i.currentSphereAll=!0},i.$on("$stateChangeSuccess",function(){i.params=angular.extend({},e),c.sphere_id&&(i.params.sphere_id=c.sphere_id),i.getPressThemesList(!0),i.getCategories()}),i.morebutton=!1,i.scrollTop=d.scrollTop(.4),i.getPressThemesList=function(a){if(i.error=!1,i.notfound=!1,a&&(i.contentArea=r.find(".b-mos-press-category-items"),d.hideContentArea(i.contentArea)),angular.isUndefined(i.sectapi)||angular.isUndefined(i.apisection))return i.morebutton=!1;var e,t=function(t){i._params={},Object.keys(t).forEach(function(e){i._params[e]=t[e]}),!angular.isUndefined(t.page)&&null!==t.page||delete i._params.page;""===t.sphere_id&&delete i._params.sphere_id;return i._params["per-page"]=12,i._params}(i.params);i.setPromo=!1,t.sphere_id?(e=parseInt(t.sphere_id.trim()),isNaN(e)||(t.filter=t.filter||{},t.filter["spheres.id"]=[e],delete t.sphere_id)):(t.page&&1!=t.page||(t["per-page"]=1+t["per-page"],i.setPromo=!0),Array.isArray(i.promoItems)&&i.promoItems[0].id&&(t.filter=t.filter||{},t.filter["!=id"]=i.promoItems[0].id)),o.getData(i.apisection,i.sectapi,t,!0,angular.element(document).find(".b-press-bricks__morebutton")).then(function(e){if(e._meta&&(e._meta.pageCount>e._meta.currentPage?i.morebutton=!0:i.morebutton=!1),a&&(i.items=[]),i.items[0]&&i.items[0].image&&(i.image=p(e.items[0].image),-1!==i.image.indexOf("data:image",0)&&(i.image="")),angular.isArray(e.items)&&e.items.length){(l.is("home.themes")||l.is("home.themes.sphere"))&&angular.isObject(e.items[0])&&u.transferToPhantom(e.items[0].date_timestamp);for(var t=0;t<e.items.length;t++)0===t&&i.setPromo?i.promoItems=[e.items[t]]:i.items.push(e.items[t])}i.items.length<1&&(i.notfound=!0),a&&d.showContentArea(i.contentArea),i.linksLoaded||(n.setPrevNextLinks(i.params.page,i.morebutton,s),i.linksLoaded=!0)},function(e){i.error=e,i.morebutton=!1,i.notfound=!0})},i.getMoreBricks=function(){i.params.page?i.params.page++:i.params.page=2,i.getPressThemesList()},i.getCategories(),i.getPressThemesList(!0)},templateUrl:n.tmplPath("pressThemes/pressThemes.tpl.html")}}]).service("catSrvc",[function(){this.getCurrent=function(e,t){var a={id:e};!a.id&&t[0]&&""!=a.id&&(a.id=t[0].id);for(var i=0;i<t.length;i++)if(t[i].id===a.id){a.title=t[i].title;break}return a}}]),angular.module("mosapp.press.categories",[]).directive("mosPressCategories",["UrlSrvc","LangSrvc",function(e,r){return{restrict:"A",replace:!0,link:function(a,e,i,t){a.$watch("categories",function(e){for(var t in a.lang=r.getCurrentLang(),"en"==a.lang?a.allTitle="All":a.title="Все",a.categories)a.categories[t].preTitle="en"==a.lang?"News: ":"Новости: ";if(angular.isArray(e)&&!a.hideEmptyValue&&e[0]&&""!==e[0].id){e={id:"",title:i.placeholder||a.allTitle};a.categories.unshift(e);for(t=0;t<a.categories.length;t++){if(a.categories[t].id===a.category.id){a.category.title||(a.category=a.categories[0]);break}t!==a.categories.length-1||a.categories[t].active||(a.category=a.categories[0])}}}),a.$watch("category",function(e,t){!e||!e.hasOwnProperty("id")||a.categories&&!a.categories.length||t&&e.id===t.id||(""===e.id&&(a.category=a.categories[0]),a.changeCategory(e.id))}),a.changeCategory=function(e){a.catid=e,i.onCategoryChange&&a.catid!==a.category.id&&a.onCategoryChange({catid:e})}},scope:{categories:"=",category:"=",onCategoryChange:"&",hideEmptyValue:"=",h1:"="},templateUrl:e.tmplPath("pressCategories/pressCategories.tpl.html")}}]),angular.module("mgcrea.ngStrap.dropdown").run(["$templateCache",function(e){e.put("dropdown/dropdown.press.categories.tpl.html",'<div tabindex="-1" class="dropdown-menu customScrollbar" role="menu"><div role="presentation" ng-repeat="item in content" data-ng-class="{active: category.id==item.id}"><a role="menuitem" tabindex="-1" href="" ng-click="$hide();changeCategory(item.id);" ng-bind="item.title"></a></div></div>')}]),angular.module("mosapp.press.category",[]).directive("mosPressCategory",["UrlSrvc",function(e){return{restrict:"A",link:function(){},scope:{items:"=",section:"@",sectionCategory:"@",sectionStory:"@",settings:"=",getMoreBricks:"&",getNextPageUrl:"=",morebutton:"=",notfound:"="},templateUrl:e.tmplPath("pressCategory/pressCategory.tpl.html")}}]),angular.module("mosapp.press.story",["mosapp.filters.imageSrc","mosapp.carousel.four.items","mosapp.embeddedcontent"]).directive("mosPressStory",["UrlSrvc","$stateParams","apiSrvc","toolsSrvc","$filter","$sce","$compile","metaConfig","$timeout","imageSrcFilter","tmplSrvc","$state","headmetaSrvc","embeddedContentSrvc","districtsSrvc","$translate",function(l,t,i,c,e,a,d,m,p,u,g,h,f,v,y,_){return{restrict:"A",link:function(s,n){s.params={id:t.id},s.doNotShareIds=[11055];var e,o={lightbox:{selector:"p:not(.inline-carousel) > img:not(.inline-carousel)",init:function(e){e.each(function(e,t){t=$(t);t.attr({"mos-lightbox":"","data-container":".mos-lightbox"}),!t.attr("data-jsalt")&&t.attr("alt")&&""!==t.attr("alt")&&$('<span class="photo_descr"><span>'+t.attr("alt")+"</span></span>").insertAfter(t),t.wrap('<span class="mos-lightbox"><span class="mos-lightbox__wrapper"></span></span>')})}},blockquote:{selector:".inline_blockquote",init:v.replaceBlockquote.bind(null,s)}};s.$watch(function(){return c.colorScheme()},function(e){s.colorScheme=e,c.togglerBlackAndWhite(".img_left_position",e,n)}),s.$on("$stateChangeSuccess",function(){c.scrollTop(.4)}),s.setHeaderImageMeta=function(){s.story.image&&s.story.image.title?s.headerImageMeta=c.getMetaForImage(s.story.image.title):s.headerImageMeta=c.getMetaForImage(s.story.title)},s.getStoryMedia=function(){if(angular.isUndefined(s.mediaapi)||angular.isUndefined(s.apisection))return!(s.nomedia=!0);i.getData(s.apisection,s.mediaapi,s.params,!0,n[0].querySelectorAll(".b-press-preamble")[0]).then(function(e){angular.isArray(e.items)&&e.items.length?s.mediaitems=e.items:s.nomedia=!0},function(){})},s.getSimilarItems=function(){if(angular.isUndefined(s.similarapi)||angular.isUndefined(s.apisection))return!1;var e={};s.tags&&s.tags.length&&(e["index[]"]=["article","news"],e.text=c.prepareTags(s.tags),e.kind=s.kindSearch,e.skip_stat=1,e.text&&i.getData(s.rootSearch,s.rootSearchApi,e,!0,n[0].querySelectorAll(".b-press-article__similar")[0]).then(function(e){if(!(e.items&&e.items.article&&angular.isArray(e.items.article.search)))return s.similar=!1;for(var t=[],a=0;a<e.items.article.search.length;a++)e.items.article.search[a].id!==s.story.id&&t.push(e.items.article.search[a].id);if(t.length<1)return s.similar=!1;i.getData(s.apisection,s.similarapi,{ids:t.toString()},!0,n[0].querySelectorAll(".b-press-article__similar")[0]).then(function(e){angular.isArray(e.items)&&e.items.length?s.similar=e.items:s.similar=!1},function(){s.similar=!1})},function(){return s.similar=!1}))},e=angular.extend({expand:"districts"},s.params),angular.isDefined(s.apisection)&&angular.isDefined(s.sectapi)?(s.getStory=i.getData(s.apisection,s.sectapi,e,!0,n),s.getStory.then(function(i){if(s.story=i,s.story.share_image="",c.scrollTop(.4),(h.is("home.telegrams.story")||h.is("home.transcripts.story")||h.is("home.interviews.story"))&&angular.isObject(i)&&g.transferToPhantom(i.date_timestamp),s.story&&s.story.id&&s.story.title){s.mosError=!1,s.doNotShare=!1,-1<s.doNotShareIds.indexOf(s.story.id)&&(s.doNotShare=!0);for(var e=$(s.story.text),t=$(n).find(".b-article__text"),a=0;a<e.length;a++)"TABLE"==e[a].tagName&&angular.element(e[a]).attr("data-wrap-table-overflow","");if(t.append(e),s.story.attach||(s.story.attach=[]),v.replaceEmbedContent(t,s.story.attach,"story.attach","story.title"),r=t,angular.forEach(o,function(e){var t=r.find(e.selector);if(0<t.length)for(var a=0;a<t.length;a++)e.init(angular.element(t[a]))}),e=d(t.html())(s),t.empty(),t.append(e),s.tags=s.story.tags||!1,s.getStoryMedia(),s.getSimilarItems(),s.setHeaderImageMeta(),s.story.kind&&s.story.kind.id){switch(s.story.kind.id){case"interview":case"infographic":s.canonicalLink=l.getLangLink(l.pagePath(s.pagePath,s.story.id));break;case"transcript":s.canonicalLink=l.getLangLink(l.pagePath(s.pagePath,"transcripts/"+s.story.id));break;case"telegram":s.canonicalLink=l.getLangLink(l.pagePath(s.pagePath,"telegrams/"+s.story.id))}s.searchCategory=s.story.kind.id}s.canonicalLink&&l.setCanonical(s.canonicalLink),p(function(){s.image=u(i.image),-1!==s.image.indexOf("data:image",0)&&(s.image="");var e=s.section.split(".")[1],t=m[e].sectionTitle,a=(s.story.title=c.sanitize(s.story.title),{type:"article",title:s.story.title});a.description=m[e]?s.story.title+". "+m[e].description+". Мэр Москвы":s.story.title,s.story.date_timestamp&&(a.published_time=s.story.date_timestamp),s.story.image&&s.story.image.middle?(a.image=s.story.image.middle,s.story.share_image=s.story.image.middle.src):a.image={src:"https://"+window.location.hostname+"/open-graph/v1/frontend"+window.location.pathname},f.withoutSiteName().setPageMeta({story:a},"story").setKeywords("%title%, %category%, мэр, сайт москвы".replace("%category%",t).replace("%title%",s.story.title).toLowerCase()),s.$watch(function(){return c.colorScheme()},function(e){s.colorScheme=e,"contrast"===s.colorScheme?n.find("img").addClass("grayscale"):n.find("img").removeClass("grayscale")}),f.setTitle(a.title,m.story.section)},100),s.$watch(function(){return angular.element(document).find(".b-content__min-height").attr("style")},function(){angular.element(document).find(".b-content__min-height").removeAttr("style")}),_(["pressStory.districtsTitle","pressStory.areasTitle"]).then(function(e){s.districtsTitle=e["pressStory.districtsTitle"],s.areasTitle=e["pressStory.areasTitle"]}),y.handleDistricts(s.story.districts,s,{category:s.searchCategory,maxExtra:2})}else s.mosError=404;var r},function(e){"410"==e.code?h.go(s.section):s.mosError=e.code})):s.mosError=404,s.displayTags&&"string"==typeof s.displayTags?s.displayTagsFlag="false"!==s.displayTags:s.displayTags?s.displayTagsFlag=!!s.displayTags:s.displayTagsFlag=!0},scope:{section:"@",sectapi:"@",sectionCategory:"@",sectionStory:"@",apisection:"@",mediaapi:"@",similarapi:"@",rootSearch:"@",kindSearch:"@",rootSearchApi:"@",pagePath:"@",displayTags:"@"},templateUrl:l.tmplPath("pressStory/pressStory.tpl.html")}}]).directive("wrapTableOverflow",[function(){return{restrict:"A",link:function(e,t){var a=angular.element('<div class="b-article__text-wide-table"/>');setTimeout(function(){t.wrap(a)},100)}}}]),angular.module("mosapp.press.story.similar",["ngSanitize","mosapp.carousel.four.items"]).directive("mosPressStorySimilar",["UrlSrvc","$stateParams","apiSrvc","toolsSrvc","$sce",function(e,t,a,i,r){return{restrict:"A",link:function(e,t,a,i){},scope:{stories:"=",section:"@",sectionCategory:"@",sectionStory:"@",moreLinkText:"@"},templateUrl:e.tmplPath("pressStorySimilar/pressStorySimilar.tpl.html")}}]),angular.module("mosapp.press.review",["ngSanitize","mosapp.carousel.four.items"]).directive("mosPressReview",["UrlSrvc","$stateParams","apiSrvc","toolsSrvc","$sce",function(e,r,s,n,o){return{restrict:"A",link:function(a,e,t,i){a.params={id:r.story},a.$on("$stateChangeSuccess",function(){n.scrollTop(.4)}),a.getSimilarItems=function(){var e={};if(a.tags&&a.tags.length){e["tag[]"]=[];for(var t=0;t<a.tags.length;t++)e["tag[]"].push(a.tags[t].id)}return e},angular.isDefined(a.apisection)&&angular.isDefined(a.sectapi)?(a.getStory=s.getData(a.apisection,a.sectapi,a.params),a.getStory.then(function(e){angular.isArray(e.items)&&e.items.length&&(a.story=e.items[0],a.story.text=o.trustAsHtml(a.story.text),a.tags=a.story.tags||[],a.tagsParams=a.getSimilarItems(),n.scrollTop(.4),s.getData("press","pressReviewsStory",{tags:a.tagsParams,id:r.story}).then(function(e){angular.isArray(e.items)&&e.items.length&&(a.reviews=e.items[0].reviews)},function(e){a.error=e}))},function(e){a.error=e})):console.log("Не указан ключ для обращения к api")},scope:{sectapi:"@",apisection:"@",similarapi:"@"},templateUrl:e.tmplPath("pressReview/pressReview.tpl.html")}}]),angular.module("mosapp.press.brickwork",[]).directive("mosPressBrickwork",["UrlSrvc","toolsSrvc",function(e,a){return{restrict:"A",replace:!1,link:function(t){t.$watch(function(){return a.colorScheme()},function(e){t.colorScheme=e})},scope:{items:"=",section:"@",sectionCategory:"@",sectionStory:"@"},templateUrl:e.tmplPath("pressBrickwork/pressBrickwork.tpl.html")}}]),angular.module("mosapp.press.item.brick",[]).directive("mosPressItemBrick",["UrlSrvc","$timeout","toolsSrvc",function(e,r,s){return{restrict:"A",link:function(t,e,a,i){t.count=function(e){return e.length},t.$watch(function(){return s.colorScheme()},function(e){t.colorScheme=e}),t.itemOnClick=function(e){return t.$emit("sendStatOnBrickClick",e),!0},r(function(){$(e).find(".loader").remove()},Math.floor(3e3*Math.random())+1e3)},scope:{item:"=",section:"@",sectionCategory:"@",sectionStory:"@"},templateUrl:e.tmplPath("pressItemBrick/pressItemBrick.tpl.html")}}]);var debounce=function(a,i){var r=null;return function(){r&&clearTimeout(r);var e=arguments,t=this;r=window.setTimeout(function(){clearTimeout(r),r=null,a.apply(t,e)},i)}},hasFullScreenElement=function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)},requestFullScreen=document.documentElement.requestFullscreen||document.documentElement.webkitRequestFullScreen||document.documentElement.mozRequestFullScreen||document.documentElement.msRequestFullscreen,exitFullScreen=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;function TmplService(){this.transferToPhantom=function(e){e&&(angular.isString(e)&&(e=+e),"function"!=typeof window.phantomJsLastModified||isNaN(e)||window.phantomJsLastModified(moment.unix(e).utcOffset(3).toDate().toUTCString()))}}angular.module("mosapp.presentation.viewer",[]).directive("presentationViewer",["UrlSrvc","$window",function(e,t){return{restrict:"A",scope:{title:"@",href:"@",frames:"="},link:function(a,e,t){a.currentPage||(a.currentPage=1),a.numPages=a.frames.length;function i(e){var t=a.currentPage;if("ArrowLeft"===e.code||"ArrowLeft"===e.key)--t;else{if("ArrowRight"!==e.code&&"ArrowRight"!==e.key)return;t+=1}a.setCurrentPage(t)}function r(){setTimeout(function(){a.toggleFullscreen(),a.toggleFullscreen()},401)}var s=e.find(".presentationViewer__viewport"),n=(a.setCurrentPage=function(e){e<1||e>a.numPages||(a.currentPage=e)},a.loadDocument=function(e){return PDFJS.getDocument(e).promise.then(function(e){a.document=e})},a.renderPage=function(){a.document||a.loadDocument(a.href).then(function(){a.renderPage()})},a.toggleFullscreen=function(){if(hasFullScreenElement()||s.parent().hasClass("presentationViewer_fullscreen"))try{exitFullScreen.call(document)}catch(e){n()}else{try{requestFullScreen.call(s.parent().addClass("presentationViewer_fullscreen")[0])}catch(e){s.parent().addClass("presentationViewer_fullscreen").appendTo(document.body),$(window).on("orientationchange resize",r),$("html").css({position:"fixed",width:"100%",height:"100%",overflow:"hidden"})}angular.element(document).on("keydown",i)}},function(){hasFullScreenElement()||(s.parent().prependTo(e).removeClass("presentationViewer_fullscreen"),angular.element(document).off("keydown",i),$(window).off("orientationchange resize",r),$("html").attr("style",""))});angular.element(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",n)},templateUrl:e.tmplPath("presentationViewer/presentationViewer.tpl.html")}}]),angular.module("mosapp.filter.calendar",[]).directive("filterCalendar",["UrlSrvc","toolsSrvc","daterangepickerlibsrvc","$timeout",function(e,o,l,c){return{restrict:"A",link:function(i,r,s,e){var t=angular.element(document).find(".filter-news .b-filter__calendar .calendar-inner .icon");function a(){var e,t;i.datepicker&&(e=i.fromDate?moment(o.ruStrToDate(i.fromDate)).format("DD MMMM YYYY").toString():undefined,t=i.untilDate?moment(o.ruStrToDate(i.untilDate)).format("DD MMMM YYYY").toString():undefined,e&&t?i.datepicker.data("dateRangePicker").setDateRange(e,t):i.datepicker.data("dateRangePicker").clear())}i.placeholder=s.placeholder||"Выберите диапазон дат",i.$watch(function(){return o.colorScheme()},function(e){e="contrast"===e?"2px;":"12px;";Function("/*@cc_on return document.documentMode===10@*/")()&&t.attr("style","background-position: right -35px top "+e),document.body.style.msTextCombineHorizontal!==undefined&&t.attr("style","background-position: right -35px top "+e)}),i.watchEnable&&(i.$watch("fromDate",function(){a()}),i.$watch("untilDate",function(e){a()}));var n=!(i.datepicker=null);l.load({}).then(function(e){i.clearDatepicker=function(){i.datepicker&&c(function(){i.silentSet=!0,i.applyNewRange(null,null),i.datepicker.data("dateRangePicker").clear(),c(function(){i.silentSet=!1},100)},50)},i.$on("$stateChangeStart",function(){var e;i.datepicker&&(e=$(i.datepicker[0]).data("dateRangePicker")).length&&e.destroy()}),i.$on("$stateChangeSuccess",function(){var e;i.datepicker&&i.datepicker.data("dateRangePicker")&&c(function(){i.silentSet=!0;var e=i.fromDate?moment(o.ruStrToDate(i.fromDate)).format("DD MMMM YYYY").toString():undefined,t=i.untilDate?moment(o.ruStrToDate(i.untilDate)).format("DD MMMM YYYY").toString():undefined;if(e&&t)try{i.datepicker.data("dateRangePicker").setDateRange(e,t)}catch(e){}else try{i.datepicker.data("dateRangePicker").clear()}catch(e){}c(function(){i.silentSet=!1},100)},50),i.datepicker&&i.datepicker.data("dateRangePicker")&&(e=i.datepicker.data("dateRangePicker"),n?r.hasClass("js-daterange-input")&&(e.open(),n=!1):(e.close(),n=!0))}),c(function(){var t,e=r.find("input.js-daterange-input"),a=(i.datepicker=e.dateRangePicker({format:"D MMMM YYYY",separator:" — ",language:"ru",startOfWeek:"monday",startDate:!!i.dateDiffs&&moment(i.dateDiffs.split("-")[0],"YYYY.MM.DD HH:mm:ss").format("D MMMM YYYY"),endDate:!!i.dateDiffs&&moment(i.dateDiffs.split("-")[1],"YYYY.MM.DD HH:mm:ss").format("D MMMM YYYY"),container:e.parent(),setValue:function(e){$(this).is(":disabled")||e==$(this).val()||$(this).val(e)},showShortcuts:!1,autoClose:!0}),i.datepicker.unbind("datepicker-closed").bind("datepicker-closed",function(){var e=document.querySelector('meta[name="viewport"]');e&&(e.content="width=device-width"),t&&t()}),i.datepicker.unbind("datepicker-open").bind("datepicker-open",function(){var e=document.querySelector('meta[name="viewport"]');e&&(e.content="width=device-width, initial-scale=1, user-scalable=no"),t=i.$watchCollection(function(){for(var e=$(".month-wrapper table"),t=[],a=0;a<e.length;a++){var i=$(e[a]).find("tr:last-child td:first-child>div")[0];t.push(i)}return t},function(e){for(var t=0;t<e.length;t++){var a=angular.element(e[t]);a.hasClass("nextMonth")&&a.parent().parent().remove()}})}),!1);i.datepicker.unbind("datepicker-change").bind("datepicker-change",function(e,t){s.applyNewRange&&(a&&c.cancel(a),a=c(function(){i.silentSet||i.applyNewRange({fromDate:t.date1,untilDate:t.date2}),a=!1},50))}),c(function(){i.silentSet=!0;var e=i.fromDate?moment(o.ruStrToDate(i.fromDate)).format("DD MMMM YYYY").toString():undefined,t=i.untilDate?moment(o.ruStrToDate(i.untilDate)).format("DD MMMM YYYY").toString():undefined;e&&t?i.datepicker.data("dateRangePicker").setDateRange(e,t):i.datepicker.data("dateRangePicker").clear(),c(function(){i.silentSet=!1},100)},50)},200);var t=device&&device.tablet()?"touchstart.closedatepicker":"click.closedatepicker";$("body").on(t,function(e){var t;i.datepicker&&i.datepicker.data("dateRangePicker")&&(t=i.datepicker.data("dateRangePicker"),n?$(e.target).hasClass("js-daterange-input")&&(t.open(),n=!1):$(e.target).closest(".dates").hasClass("dates")||(t.close(),n=!0))})},function(e){})},templateUrl:e.tmplPath("filterCalendar/filterCalendar.tpl.html"),scope:{fromDate:"@",untilDate:"@",applyNewRange:"&",clearDatepicker:"&",icon:"=",uniqId:"=",watchEnable:"@",dateDiffs:"@"}}}]).service("testDate",[function(){this.retDate=function(e){var t,a,i,r,s=null;return angular.isString(e)&&(i=e.split(".")).length&&(t=+i[2],a=+i[1]-1,i=+i[0],s=new Date(t,a,i),r=Date.parse(s),(s=!(isNaN(r)||r<0)&&s)&&s.getUTCDate()===i&&s.getUTCMonth()===a&&s.getUTCFullYear()===t&&(s=!0)),s?e:null}}]).service("daterangepickerlibsrvc",["UrlSrvc","$q","$rootScope","$window",function(i,t,r,e){this.load=function(e){return t(function(e,t){var a;r.daterangepickerlib?"ready"!==r.daterangepickerlib.status?(a=document.getElementById("daterangepickerlibapiscript"),$(a).on("load",function(){e()})):e():(r.daterangepickerlib={},r.daterangepickerlib.status="load",(a=document.createElement("script")).id="daterangepickerlibapiscript",a.async="true",document.getElementsByTagName("head")[0].appendChild(a),a.src=i.jsPath("jquery.daterangepicker.min.js"),$(a).on("load",function(){r.daterangepickerlib.status="ready",e()}))})}}]),angular.module("filter.two.dates",[]).directive("filterTwoDates",["UrlSrvc",function(e){return{restrict:"A",link:function(e,t,a,i){e.applyFilter=function(){e.$emit("applyDatesFilter",{fromDate:e.fromDate,untilDate:e.untilDate})}},scope:{fromDate:"=",untilDate:"="},templateUrl:e.tmplPath("filterTwoDates/filterTwoDates.tpl.html")}}]),angular.module("nav.pagination",[]).directive("navPagination",["UrlSrvc",function(e){return{restrict:"A",link:function(t,e,a,i){t.limitToShow=parseInt(a.limitToShow)||5,t.applyPageNum=function(e){a.onPageChange&&t.pageCurrent!==e&&(t.pageCurrent=e,t.onPageChange({num:t.pageCurrent}),TweenLite.to(window,.5,{scrollTo:{y:0},ease:Power2.easeOut,onComplete:function(){}}))}},scope:{pageCurrent:"=",pagesTotal:"=",pageNums:"=",limitToShow:"=",onPageChange:"&"},templateUrl:e.tmplPath("navPagination/navPagination.tpl.html")}}]),angular.module("mosapp.press.presentations",["ngAnimate","mosapp.presentation.viewer"]).directive("mosPressPresentations",["UrlSrvc","apiSrvc","toolsSrvc","$state","$stateParams","$filter","testDate","$sce","metaConfig","headmetaSrvc",function(s,n,o,l,c,d,m,p,u,g){return{restrict:"A",link:function(r,t,e,a){function i(i){r.notfound=!1,r.error=!1,r.morebutton=!1;var e=t[0].querySelectorAll(".b-lookmore_loader")[0];n.getData("newsfeed","pressPresentations",r.params,!0,e).then(function(e){if(e.result?e.result.pages>e.result.page?r.morebutton=!0:r.morebutton=!1:e._meta&&(e._meta.pageCount>e._meta.currentPage?r.morebutton=!0:r.morebutton=!1),i&&(r.items=[]),angular.isArray(e.items)&&e.items.length)for(var t=0;t<e.items.length;t++){var a=e.items[t];a.code=p.trustAsHtml(a.code),r.items.push(a)}r.items.length<1&&(r.notfound=!0),r.$watch(function(){return o.colorScheme()},function(e){r.colorScheme=e})},function(e){r.error=e,r.morebutton=!1,r.notfound=!0})}t.on("$destroy",function(){r.$destroy()}),r.canonicalLink=s.getLangLink(s.pagePath("mayorMain","presentations")),r.canonicalLink&&s.setCanonical(r.canonicalLink),g.setPageMeta(u,"presentations").setTitle(u.presentations.sectionTitle,u.presentations.section),r.count=function(e){return e.length},r.defaultParams={fields:"id,title,label,date,date_timestamp,code,frames,href,is_powered,type","per-page":12},r.params=angular.extend({},r.defaultParams),c.fromDate&&(r.fromDate=m.retDate(c.fromDate)),c.untilDate&&(r.untilDate=m.retDate(c.untilDate)),r.fromDate&&r.untilDate?r.params=angular.extend({},r.defaultParams,{fromDate:r.fromDate||null,untilDate:r.untilDate||null}):(c.fromDate||c.untilDate)&&l.go("home.presentations",r.params),r.error=!1,r.morebutton=!1,r.scrollTop=o.scrollTop(.4),r.$watch("params",function(){angular.isDefined(r.params)&&i(!0)}),r.applyFilterCalendar=function(e,t){r.params=angular.extend({},r.defaultParams,{fromDate:d("date")(e,"dd.MM.yyyy"),untilDate:d("date")(t,"dd.MM.yyyy")}),e==r.fromDate&&(r.params.fromDate=undefined,t=e=r.params.untilDate=undefined),c.fromDate=r.params.fromDate,angular.isDefined(r.params.fromDate)||angular.isDefined(r.params.untilDate)?l.go("home.presentations.range",r.params):l.go("home.presentations",r.params)},r.getMoreBricks=function(){r.params.page?r.params.page++:r.params.page=2,i()},r.params.fromDate!==d("date")(r.fromDate,"dd.MM.yyyy")&&(r.fromDate=o.ruStrToDate(r.params.fromDate)),r.params.untilDate!==d("date")(r.untilDate,"dd.MM.yyyy")&&(r.untilDate=o.ruStrToDate(r.params.untilDate))},scope:{},templateUrl:s.tmplPath("pressPresentations/pressPresentations.tpl.html")}}]),angular.module("mosapp.press.infographic",["ngAnimate"]).directive("mosPressInfographic",["$state","$stateParams","$filter","toolsSrvc","testDate","UrlSrvc","LangSrvc","newsFilter","metaConfig",function(e,s,t,n,a,i,r,o,l){return{restrict:"A",scope:{rootState:"@"},controller:["$scope",function(a){var e={to:new Date};function t(){var e="infographic";n.setMeta(a,l,e),n.setTitle(l[e].sectionTitle,l[e].section)}function i(){o.setState(s),a.setCalendarDate(),a.setCurrentSphere(),a.setCurrentType(),a.$broadcast("state:loaded")}function r(){a.currentSphere={id:""};for(var e="all"===(e=o.getParam("sphere_id")||"")?"":e,t=0;t<a.itemsSphere.length;t++)a.itemsSphere[t].id!==e&&a.itemsSphere[t].id.toString()!==e||(a.currentSphere=a.itemsSphere[t])}o.init(a.rootState,["range","type","sphere_id"],e),a.activateButtonForNextLoading=!0,a.params={},a.currentSphere={id:""},a.currentType={id:""},a.itemsSphere=[],a.getMoreNewsFunc=null,a.isThereMorePages=!1,a.itemsType=[{id:"gallery",title:"Фото"},{id:"video",title:"Видео"}],a.setNewSphere=o.setNewSphere,a.setNewType=o.setNewType,a.setFilterCalendar=o.setFilterCalendar,a.setCurrentSphere=r,a.setCurrentType=function(){a.currentType={id:""};var e=o.getParam("type")||"";e="all"===e?"":e;for(var t=0;t<a.itemsType.length;t++)a.itemsType[t].id!==e&&a.itemsType[t].id.toString()!==e||(a.currentType=a.itemsType[t])},a.setCalendarDate=function(){var e=o.getDateForCalendar();a.params={from:e.from,to:e.to}},a.setAndGetParams=o.setAndGetParams,a.typesMap={gallery:"gallery",video:"video"},a.newsFeedItems=[],a.$on("controls:inited",function(){i(),a.$on("$stateChangeSuccess",function(){i(),t()}),t()}),a.$watch("itemsSphere",r)}],templateUrl:i.tmplPath("pressInfographic/pressInfographic.tpl.html")}}]),angular.module("mosapp.press.infographic.item",["mosapp.carousel.withminiatures"]).directive("mosPressInfographicItem",["UrlSrvc","apiSrvc","$state","$stateParams","$compile","toolsSrvc","embeddedContentSrvc","districtsSrvc","$translate",function(s,n,o,l,c,d,m,p,u){return{restrict:"A",scope:{rootState:"@",apiRoot:"@",apiPath:"@",pagePath:"@",displayTags:"@"},link:function(t,a){t.displayTags&&"string"==typeof t.displayTags?t.displayTagsFlag="false"!==t.displayTags:t.displayTags?t.displayTagsFlag=!!t.displayTags:t.displayTagsFlag=!0;var i,e=parseInt(l.id)||null,r=(t.banners=s.getBanners("infographic"),t.sharingTypeId="infographic",t.sectionAllHref=o.href(t.rootState),t.$watch(function(){return angular.element(document).width()},function(e){t.sharingDirection=+e<=986?"horizontal":"vertical"}),{lightbox:{selector:"img",init:function(e){e.each(function(e,t){t=$(t);t.attr({"mos-lightbox":"","data-container":".mos-lightbox"}),t.attr("alt")&&""!==t.attr("alt")&&$('<span class="photo_descr"><span>'+t.attr("alt")+"</span></span>").insertAfter(t),t.wrap('<span class="mos-lightbox"><span class="mos-lightbox__wrapper"></span></span>')})}},blockquote:{selector:".inline_blockquote",init:m.replaceBlockquote.bind(null,t)}});e={id:e,expand:"districts"},n.getData(t.apiRoot,t.apiPath,e,!0).then(function(e){e&&e.id&&e.title?(t.infographic=e,t.infographic.images&&t.infographic.images.length&&(t.imageForSharing=t.infographic&&t.infographic.image?t.infographic.image.middle||t.infographic.image.show:null,t.infographic.text&&(e=$(t.infographic.text),(i=a.find(".infographic-content__text")).append(e),angular.forEach(r,function(e){var t=i.find(e.selector);if(0<t.length)for(var a=0;a<t.length;a++)e.init(angular.element(t[a]))}),m.replaceEmbedContent(i,t.infographic.attach,"infographic.attach","infographic.title"),e=c(i.html())(t),i.empty(),i.append(e),setTimeout(function(){angular.element(document).find(".infographic-content__text img").parent().addClass("img-wrapper")},200)),t.canonicalLink=s.getLangLink(s.pagePath("mayorInfographic",t.infographic.id)),s.setCanonical(t.canonicalLink),t.$watch(function(){return d.colorScheme()},function(e){t.colorScheme=e,setTimeout(function(){"contrast"==e?(angular.element(document).find(".infographic-content__text img").addClass("grayscale"),angular.element(document).find(".b-video-player").addClass("grayscale")):(angular.element(document).find(".infographic-content__text img").remove("grayscale"),angular.element(document).find(".b-video-player").removeClass("grayscale"))},200)}),u(["infogrphicItem.districtsTitle","infogrphicItem.areasTitle"]).then(function(e){t.districtsTitle=e["infogrphicItem.districtsTitle"],t.areasTitle=e["infogrphicItem.areasTitle"]}),p.handleDistricts(t.infographic.districts,t,{category:"infographic",maxExtra:2}))):t.mosError=404},function(e){"410"==e.code?o.go("home.infographic"):t.mosError=e.code})},templateUrl:s.tmplPath("pressInfographicItem/pressInfographicItem.tpl.html")}}]),angular.module("mosapp.filter.news",[]).directive("filterNews",["apiSrvc","toolsSrvc","$timeout","UrlSrvc","LangSrvc","apiCache",function(e,t,r,a,s,n){return{restrict:"A",scope:{areaTitle:"@",apiRootSpheres:"@",apiPathSpheres:"@",apiRootAreas:"@",apiPathAreas:"@",setNewSphere:"=",setFilterCalendar:"=",setNewArea:"=",setCurrentSphere:"=",setCurrentArea:"=",setCalendarDate:"=",currentSphere:"=",currentArea:"=",itemsSphere:"=",itemsArea:"=",params:"="},templateUrl:a.tmplPath("filterNews/filterNews.tpl.html"),link:function(i,e){i.areaTitle=i.areaTitle||"Департамент",i.lang=s.getCurrentLang(),i.colorScheme=t.colorScheme(),i.controlsApiConf={},i.controlsApiConf[i.apiPathSpheres]={apiRoot:i.apiRootSpheres,itemsKey:"itemsSphere",parentFunc:"setCurrentSphere",elem:".filter-news__filter_sphere",params:{expand:"image",filter:{in_article:1},"per-page":50}},i.controlsApiConf[i.apiPathAreas]={apiRoot:i.apiRootAreas,itemsKey:"itemsArea",parentFunc:"setCurrentArea",elem:".filter-news__filter_area"},i.inited=!1,i.setCalendarDate(),Object.keys(i.controlsApiConf).forEach(function(t,a){i.controlsApiConf[t].apiRoot?n.getData(i.controlsApiConf[t].apiRoot,t,i.controlsApiConf[t].params,!0,e.find(i.controlsApiConf[t].elem)).then(function(e){i[i.controlsApiConf[t].itemsKey]=e.items,Object.keys(i.controlsApiConf).length-1===a&&(r(function(){i.$emit("controls:inited")},0),i.inited=!0)}):i.itemsArea.length&&Object.keys(i.controlsApiConf).length-1===a&&(r(function(){i.$emit("controls:inited")},0),i.inited=!0)}),i.getNewSphere=function(e){i.setNewSphere(e)},i.getNewArea=function(e){i.setNewArea(e)},i.applyFilterCalendar=function(e,t){i.setFilterCalendar(e,t)}}}}]),angular.module("mosapp.news.feed",["slick","mosapp.filters.prepareDateSince","mos.newsfeed.normalization.category"]).directive("newsFeed",["UrlSrvc","apiSrvc","$timeout","toolsSrvc","$window","$document","$stateParams","LangSrvc","loader","normalizationCategory","tmplSrvc","$filter",function(M,C,I,$,e,D,E,L,O,N,j,R){return{restrict:"A",scope:{apiRoot:"@",apiPath:"@",startLoadEvent:"@",page:"@",pagePath:"@",itemPath:"@",additionalFeedItems:"=?",getMoreNews:"=?",activateButtonForNextLoading:"=?",currentPage:"=?",isThereMorePages:"=?",showDistricts:"@",itemsArea:"=?",limit:"@",dependentOn:"@",setClass:"@?",filterBrickOff:"@",allInMainFeed:"=?",excludeIds:"@?",waitDependency:"=?",itemLinkTarget:"@",typesArray:"="},templateUrl:M.tmplPath("newsFeed/newsFeed.tpl.html"),link:function(n,i,e){n.getLangLink=M.getLangLink,n.lang=L.getCurrentLang();var s,t,a,r=768,o={big_accent:500,accent:320,with_photo:140,other:140},l=40,c=0,d={},m=[],p=0,u={items:[],itemsWithoutImage:[]},g=E,h=(E.page?(E.page*=1,n.currentPage=E.page):n.currentPage=1,n.typesArray||{});function f(e){n.parsedDistrictsData={};for(var t=0;t<e.length;t++){var a=e[t];n.parsedDistrictsData[a.id]=a.title}}function v(e){for(var t=0;t<e.length;t++){var a=e[t];a.districtTitle=n.parsedDistrictsData[a.territory_district_id]}}function y(e){return(e=angular.isObject(e)?e:{}).fields="id,title,date_timestamp,image,kind,territory_district_id,sphere,entity_id,entity_suffix",e["per-page"]=10,e}function _(e){e&&e.withoutAllItems||m.splice(0),n.feeds.splice(0),n.feeds.push(A()),n.additionalFeedItems.splice(0),c=p=0}function w(){var e={},t=("newsAllArea"===n.apiPath&&(e.has_district=1,e.status=["public","public_oiv"]),[]);return(t=n.excludeIds?function(){for(var e=["073"],t=n.excludeIds.split(","),a=[],i=t.length;i--;){var r,s=t[i];isNaN(s)||(r=(s+="").slice(-3),-1<e.indexOf(r)&&a.push(parseInt(s)))}return a}():t).length&&(e["!=id"]=t),e}function b(){n.notFound=!1,n.allInMainFeed=!1,_();var e=E.page||1;if((d=n.setAndGetParams(e)).id)return!1;d=y(d);e=w(),d.filter=angular.isObject(d.filter)?angular.extend(d.filter,e):e,Object.keys(d.filter).length||delete d.filter,O.switchOn(i),e=angular.copy(d);C.getData(n.apiRoot,n.apiPath,e,!1,i).then(function(t){{var e,a;angular.isArray(t.items)&&t.items.length?(n.error=!1,n.moreButton=!0,e=n.$parent&&n.$parent.normalizator?n.$parent.normalizator(t.items):N(t.items),n.showDistricts&&n.parsedDistrictsData&&v(e),a=angular.isArray(m)&&0===m.length,m=angular.isArray(m)?m.concat(e):[],window.innerWidth<r?(_({withoutAllItems:!0}),x(e),I(function(){P()},0)):T(e),t._meta&&(t._meta.currentPage==t._meta.pageCount?n.isThereMorePages=!1:(n.isThereMorePages=!0,d.page=t._meta.currentPage,n.currentPage=t._meta.currentPage)),I(function(){var e;_WINDOW.on("resize",function(){I.cancel(e),e=I(P,100)}),!D.find(".news-televisor .news-televisor__list").length&&a&&angular.isObject(t.items[0])&&j.transferToPhantom(t.items[0].date_timestamp)},150)):(n.notFound=!0,n.isThereMorePages=!1,n.currentPage=null)}n.$emit("newsfeed:fetched",{isThereMorePages:n.isThereMorePages,currentPage:n.currentPage})},function(e){n.error=e,n.isThereMorePages=!1,n.notFound=!0})}function k(e,t){return t?R("date")(e,"yyyy-MM-dd")+" 00:00:00":R("date")(e,"yyyy-MM-dd")+" 23:59:59"}function S(e){e.sort(function(e,t){e=new Date(1e3*(e.date_timestamp||e.date_from_timestamp)),t=new Date(1e3*(t.date_timestamp||t.date_from_timestamp));return e<t?1:t<e?-1:0})}function P(){var e=i.find(".news-feed__list");0<p&&(e=e.eq(p)),window.innerWidth<r?(n.separated||(n.allInMainFeed=!1,x(m),n.separated=!0),I(function(){"init"!==e.data("slickstate")&&(e.on("init",function(){e.data("slickstate","init")}),e.slick({infinite:!0,slidesToShow:1,slidesToScroll:1,speed:1e3,prevArrow:'<span class="slick-arrow-prev s-prev"><span class="ico"><span></span></span></span>',nextArrow:'<span class="slick-arrow-next s-next"><span class="ico"><span></span></span></span>'}))},0),n.additionalFeedItems.splice(0)):(angular.forEach(e,function(e){e=angular.element(e);"init"===e.data("slickstate")&&(e.slick("unslick"),e.data("slickstate","destroy"))}),(n.separated||angular.isUndefined(n.separated))&&(n.allInMainFeed=!1,p=0,n.feeds.splice(0),n.feeds.push(A()),n.feeds[p].itemsWithoutImage.splice(0),T(m,!0),n.separated=!1))}function T(e,t){t&&_({withoutAllItems:!0});t=window.innerWidth;l=t<992?20:40;for(var a=0;a<e.length;a++){i=e[a].typeOfMaterial;var i=o[i]||o.other,r=c+i+l;if(!(r<=s||s<r&&r-s<s-c||!s&&n.feeds[p].items.length<n.limit)){n.additionalFeedItems=n.additionalFeedItems.concat(e.slice(a));break}n.feeds[p].items.push(e[a]),c+=i+l,n.dependentOn&&a===e.length-1&&!n.additionalFeedItems.length&&(n.allInMainFeed=!0)}}function x(e){for(var t,a=[],i=[],r=0;r<e.length;r++)((t=e[r]).image?a:i).push(t);n.feeds[p].items=a,n.feeds[p].itemsWithoutImage=i}function A(){var e=angular.copy(u);function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e.id=t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t(),e}n.limit=parseInt(n.limit)||7,n.feeds=[],n.feeds.push(A()),n.colorScheme=$.colorScheme(),n.datenow=moment(Date.now()).format("DD.MM.YYYY"),n.getMoreNews=function(e){n.allInMainFeed=!1,e=e||i.find(".news-feed__get-more");d=y(d=n.setAndGetParams(n.currentPage+1));var t=w();d.filter=angular.isObject(d.filter)?angular.extend(d.filter,t):t,Object.keys(d.filter).length||delete d.filter;O.switchOn(e);var a=m.length;C.getData(n.apiRoot,n.apiPath,d,!1,e).then(function(e){var t;angular.isArray(e.items)&&(n.activateButtonForNextLoading=!0,t=n.$parent&&n.$parent.normalizator?n.$parent.normalizator(e.items):N(e.items),n.showDistricts&&n.parsedDistrictsData&&v(t),m=m.concat(t),window.innerWidth<r?(p++,n.feeds.push(A()),t=m.slice(a),E.theme_id&&S(t),x(t),E.theme_id&&S(m),I(function(){P()},0)):(S(m),T(m,!0)),e._meta.currentPage==e._meta.pageCount?n.isThereMorePages=!1:(n.isThereMorePages=!0,d.page=e._meta.currentPage,n.currentPage=e._meta.currentPage))},function(e){n.error=e,n.moreButton=!1})},e.excludeIds||(n.excludeIds=!1),n.dependentOn&&n.$watch(function(){return(t=t||D.find(n.dependentOn)).height()},function(e){e&&window.innerWidth>=r&&(s=e,m.length&&T(m,!0))}),n.showDistricts&&(n.isHasInnerFeedData=function(e){return angular.isArray(e)&&e[0]&&e[0].items&&e[0].items.length&&angular.isObject(e[0].items[0])}),n.itemsArea&&n.itemsArea.length?f(n.itemsArea):a=n.$watch("itemsArea",function(e){e&&e.length&&(a(),f(e),n.feeds.forEach(function(e){e.items&&v(e.items)}),v(n.additionalFeedItems),v(m))},!0),n.init=function(){n.startLoadEvent?n.$on(n.startLoadEvent,b):b()},n.setAndGetParams=function(e){var t,a=angular.extend({},g);for(t in a.page=e||1,a)if("from"===t&&""!==g[t])a.filter=a.filter||{},a.filter[">=date"]=k($.ruStrToDate(a[t]),!0),delete a.from;else if("to"===t&&""!==g[t])a.filter=a.filter||{},a.filter["<=date"]=k($.ruStrToDate(a[t]),!1),delete a.to;else if("district_id"===t&&""!==g[t]&&"all"!==g[t])a.filter=a.filter||{},a.filter["districts.id"]=a[t],delete a.district_id;else if("type"===t&&"all"!==a.type)a.type=h[a.type]?h[a.type].toString():null;else if("sphere_id"===t&&"all"!==a.sphere_id)try{a.filter=a.filter||{},a.filter["spheres.id"]=JSON.parse("["+a.sphere_id+"]"),delete a.sphere_id}catch(e){}else if("theme_id"===t&&"all"!==a.theme_id)try{a.filter=a.filter||{"!=status":"public_oiv","themes.id":E.theme_id},a.expand="kind,url",delete a.theme_id}catch(e){}else a[t]=""!==a[t]?a[t]:"all","all"!==a[t]&&""!==a[t]||delete a[t];return a},e.waitDependency?n.$watch("waitDependency",function(e){e&&!0===e.ready&&n.init()}):n.init()}}}]),angular.module("mosapp.news.feed.additional",["slick","mosapp.filters.prepareDateSince"]).directive("newsFeedAdditional",["UrlSrvc","apiSrvc","$timeout","toolsSrvc","LangSrvc",function(r,e,t,s,n){return{restrict:"A",scope:{apiRoot:"@",apiPath:"@",pagePath:"@",itemPath:"@",items:"=",getMoreNews:"=?",isThereMorePages:"=",activateButtonForNextLoading:"=",currentPage:"=",c:"=",showDistricts:"@",minimize:"@",filterBrickOff:"@",allInMainFeed:"=",itemLinkTarget:"@?",getNextPageUrl:"="},templateUrl:r.tmplPath("newsFeedAdditional/newsFeedAdditional.tpl.html"),link:function(e,t,a,i){e.getLangLink=r.getLangLink,e.colorScheme=s.colorScheme(),e.lang=n.getCurrentLang(),e.getMore=function(){e.activateButtonForNextLoading&&(e.activateButtonForNextLoading=!1,e.getMoreNews(t.find(".news-feed-additional__get-more")[0]))}}}}]),angular.module("mosapp.news.media.additional",[]).directive("newsMediaAdditional",["UrlSrvc","apiSrvc","$sce","toolsSrvc",function(e,r,s,n){return{restrict:"A",scope:{apiRoot:"@",apiPath:"@"},templateUrl:e.tmplPath("newsMediaAdditional/newsMediaAdditional.tpl.html"),link:function(t,e,a,i){t.trustAsHtml=function(e){return s.trustAsHtml(e)},t.hideme=!1,t.colorScheme=n.colorScheme(),r.getData(t.apiRoot,t.apiPath,{},!0,e).then(function(e){angular.isArray(e.items)?t.item=e.items[1]:t.hideme=!0},function(e){t.error=e,t.hideme=!0})}}}]),angular.module("mos.newsfeed.normalization.category",[]).service("normalizationCategory",["UrlSrvc","$filter",function(n,o){var l="news",c="mayorInfographic";return function(e){if(!e||!Array.isArray(e)||0===e.length)return e;for(var t,a,i=e.length,r=0;r<i;r++)if(e[r].kind&&e[r].kind.id)switch(e[r].kind.id){case"article":e[r].link=n.getLangLink(n.pagePath(l,"item/"+e[r].id)),e[r].sphere&&e[r].sphere.id&&(e[r].sphere.link=n.getLangLink(n.pagePath(l,e[r].sphere.id)));break;case"proxy":e[r].link=e[r].url,delete e[r].url,e[r].sphere&&delete e[r].sphere;break;case"news":e[r].sphere&&e[r].sphere.id?(e[r].link=n.getLangLink(n.pagePath("press",e[r].sphere.id+"/"+e[r].id)),e[r].sphere.link=n.getLangLink(n.pagePath("press",e[r].sphere.id))):e[r]=!1;break;case"conference":e[r].link=n.getLangLink(n.pagePath("conferences","item/"+e[r].id)),e[r].sphere&&(e[r].sphere.link=!1);break;case"interview":e[r].link=n.getLangLink(n.pagePath("interviews",e[r].id)),e[r].sphere&&(e[r].sphere.link=!1);break;case"infographic":e[r].link=n.getLangLink(n.pagePath(c,e[r].id)),e[r].sphere&&e[r].sphere.id&&(e[r].sphere.link=n.getLangLink(n.pagePath(c,"cat/"+e[r].sphere.id)));break;case"event":e[r].link=n.getLangLink(n.pagePath("afisha","event/"+e[r].id)),e[r].sphere&&e[r].sphere.id&&(a=new Date,t=o("date")(a,"dd.MM.yyyy"),a=o("date")(a.setMonth(a.getMonth()+1),"dd.MM.yyyy"),e[r].sphere.link=n.getLangLink(n.pagePath("afisha","from/"+t+"/to/"+a+"/"+e[r].sphere.id)))}else e[r].link=n.getLangLink(n.pagePath(l,"item/"+e[r].id));for(var i=e.length,s=[],r=0;r<i;r++)e[r]&&s.push(e[r]);return s}}]),angular.module("mosapp.press.media",["ngAnimate"]).directive("mosPressMedia",["UrlSrvc","apiSrvc","toolsSrvc","$state","$stateParams","$filter","testDate","metaConfig","$timeout","imageSrcFilter","tmplSrvc","headmetaSrvc",function(n,o,a,l,c,d,m,e,p,t,i,r){return{restrict:"A",scope:{sectionApi:"@",section:"@",apiRoot:"@",sectionMainApi:"@",pagePath:"@"},link:function(i,r){var e={"per-page":12};function t(a){i.notfound=!1,i.error=!1,i.morebutton=!1,i.params.fields="id,title,date_timestamp,image,type,count",i.setPromo=!1;var e=angular.copy(i.params);e.untilDate||(e.page&&1!=e.page||(e["per-page"]=1+e["per-page"],i.setPromo=!0),i.promoItem&&i.promoItem.id&&(e.filter={"!=id":i.promoItem.id})),o.getData(i.apiRoot,i.sectionApi,e,!0,r[0].querySelectorAll(".b-more__loader")[0]).then(function(e){if(e._meta&&(e._meta.pageCount>e._meta.currentPage?i.morebutton=!0:i.morebutton=!1),a&&(i.items=[]),angular.isArray(e.items)&&e.items.length){i.setBlockData=!0;for(var t=0;t<e.items.length;t++)0===t&&i.setPromo?i.promoItem=e.items[t]:i.items.push(e.items[t])}else i.setBlockData=!1;i.items.length<1&&(i.notfound=!0),p(function(){$(r).find(".loader").remove()},Math.floor(3e3*Math.random())+1e3),i.linksLoaded||(n.setPrevNextLinks(i.params.page,i.morebutton,s),i.linksLoaded=!0)},function(e){i.error=e,i.morebutton=!1,i.notfound=!0})}function s(e){var t="";return(c.fromDate||c.untilDate)&&(t="from/"+c.fromDate+"/until/"+c.untilDate+"/"),1===e?n.pagePath(i.pagePath,t):1<e?n.pagePath(i.pagePath,t+"page-"+e):""}i.params={},angular.extend(i.params,e),c.fromDate&&(i.fromDate=m.retDate(c.fromDate)),c.untilDate&&(i.untilDate=m.retDate(c.untilDate)),i.fromDate&&i.untilDate?i.params=angular.extend(i.params,{fromDate:i.fromDate||null,untilDate:i.untilDate||null}):(c.fromDate||c.untilDate)&&l.go(i.section,i.params),c.page&&(c.page*=1,1===c.page&&l.go(i.section),i.params.page=c.page),i.firstPage=!c.page,i.linksLoaded=!1,i.morebutton=!1,i.scrollTop=a.scrollTop(.4),i.error=!1,i.params.fromDate!==d("date")(i.fromDate,"dd.MM.yyyy")&&(i.fromDate=a.ruStrToDate(i.params.fromDate)),i.params.untilDate!==d("date")(i.untilDate,"dd.MM.yyyy")&&(i.untilDate=a.ruStrToDate(i.params.untilDate)),r.on("$destroy",function(){i.$destroy()}),i.applyFilterCalendar=function(e,t){i.params=angular.extend({},i.params,{fromDate:d("date")(e,"dd.MM.yyyy"),untilDate:d("date")(t,"dd.MM.yyyy")}),e==i.fromDate&&(i.params.fromDate=undefined,t=e=i.params.untilDate=undefined),c.fromDate=i.params.fromDate,i.$emit("sendStatFilterChange",i.params),angular.isDefined(i.params.fromDate)||angular.isDefined(i.params.untilDate)?l.go(i.section+".range",i.params):l.go(i.section,i.params)},i.$watch("params",function(){angular.isDefined(i.params)&&t(!0)}),i.$on("$stateChangeSuccess",function(){i.fromDate=m.retDate(c.fromDate),i.untilDate=m.retDate(c.untilDate),i.fromDate&&i.untilDate?i.params=angular.extend({},i.params,{fromDate:i.fromDate||null,untilDate:i.untilDate||null}):i.params=angular.extend({},e)}),i.count=function(e){return e.length},i.getNextPageUrl=function(){return n.getNextPageUrl(i.params.page,s)},i.$watch(function(){return a.colorScheme()},function(e){i.colorScheme=e}),i.getMoreBricks=function(){i.params.page?i.params.page++:i.params.page=2,i.$emit("sendStatGetMoreBricksClick"),t()}},templateUrl:n.tmplPath("pressMedia/pressMedia.tpl.html")}}]),angular.module("mosapp.press.photo",["mosapp.press.photo.popup"]).directive("mosPressPhoto",["UrlSrvc","apiSrvc","toolsSrvc","$stateParams","mosconfig","metaConfig",function(e,a,i,r,t,s){return{restrict:"A",link:function(t,e){t.galleryVisible=!0,t.params={id:r.photoID},t.error=!1,t.hideme=!1,t.params.id&&(t.getPhoto=a.getData("press","pressPhoto",t.params,!0,e),t.getPhoto.then(function(e){angular.isArray(e.items)&&e.items.length?(t.setBlockData=!0,t.gallery=e.items[0],i.setTitle(t.gallery.title,s.themes.section),t.photos=t.gallery.images,t.photos.forEach(function(e){e.actual=!0}),t.cachePhotos=angular.copy(t.photos),t.photosLength=t.gallery.images.length,t.getSimilarItems(),i.scrollTop(.4)):t.setBlockData=!1},function(e){t.error=e})),t.photoClicked=function(e){t.galleryVisible=!1,t.actualMenu=t.photos[e].items},t.getSimilarItems=function(){return!1},t.$on("$stateChangeSuccess",function(){i.scrollTop(.4)}),t.items=[]},templateUrl:e.tmplPath("pressPhoto/pressPhoto.tpl.html")}}]),angular.module("mosapp.press.video",[]).directive("mosPressVideo",["UrlSrvc","$stateParams","apiSrvc","toolsSrvc","metaConfig","mosconfig","$state","tmplSrvc","headmetaSrvc","districtsSrvc","$translate",function(i,t,r,s,n,e,o,l,c,d,m){return{restrict:"A",scope:{videoId:"=",rootApi:"@",sectionApi:"@",sectionState:"@",pageType:"@",pagePath:"@"},link:function(a,e){e.on("$destroy",function(){a.$destroy()}),a.checkedIEAndGetVersion=function(){var e,t=-1;return"Microsoft Internet Explorer"==navigator.appName?(e=navigator.userAgent,null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1))):"Netscape"==navigator.appName&&(e=navigator.userAgent,null!=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1))),t},a.params={id:t.videoID,expand:"districts"},a.$watch(function(){return s.colorScheme()},function(e){a.colorScheme=e}),a.videoId&&(a.params.id=a.videoId),a.item={},a.params.id&&(a.getVideo=r.getData(a.rootApi,a.sectionApi,a.params,!0,e),a.getVideo.then(function(e){var t;angular.isObject(e)&&e.id&&angular.isObject(e.video)?a.item=e:e&&angular.isArray(e.items)&&e.items.length&&(a.item=e.items[0]),a.item&&a.item.id&&angular.isObject(a.item.video)?(a.video=a.item.video,!a.pageType||"mayor"!==a.pageType&&"media"!==a.pageType?c.setTitle(a.item.title):(a.canonicalLink=i.getLangLink(i.pagePath(a.pagePath,"/video/"+a.item.id)),a.canonicalLink&&i.setCanonical(a.canonicalLink),c.setTitle(a.item.title,n.video.sectionTitle,n.video.section)),e=a.item.title+n.video.description,t=a.item.title.toLowerCase()+n.video.keywords,c.withoutSiteName().setPageMeta({video:{type:"article",title:a.item.title,description:e,image:a.item.image?a.item.image.middle:null,published_time:a.item.date_timestamp}},"video").setKeywords(t),a.video&&!a.video.guid&&(a.videoSrc=a.video.src&&a.video.src[0]&&a.video.src[0].mp4||"",a.source=a.video.src[0],a.downloadTarget=-1!==a.checkedIEAndGetVersion()?"_blank":"_self"),a.item.date_timestamp&&l.transferToPhantom(a.item.date_timestamp),m(["pressVideo.districtsTitle","pressVideo.areasTitle"]).then(function(e){a.districtsTitle=e["pressVideo.districtsTitle"],a.areasTitle=e["pressVideo.areasTitle"]}),e="","mayor"===a.pageType?e="video":"media"===a.pageType&&(e="mainvideo"),d.handleDistricts(a.item.districts,a,{category:e,maxExtra:2}),s.scrollTop(.4)):a.mosError=404},function(e){"410"==e.code&&a.sectionState?o.go(a.sectionState):(a.mosError=e.code,a.error=e)})),a.getSimilarItems=function(){return!1},a.$on("$stateChangeSuccess",function(){s.scrollTop(.4)}),a.videoState=function(e){a.$apply(a.videoStatus=e)}},templateUrl:i.tmplPath("pressVideo/pressVideo.tpl.html")}}]),angular.module("mosapp.photo.gallery",["slick"]).directive("mosPhotoGallery",["UrlSrvc",function(e){return{restrict:"A",link:function(a,e,t,i){a.onInitCarousel=function(e,t){a.slick=t;t=$(".b-thumb-gallery");t.children(".slick-prev").length||t.find(".slick-track").addClass("no-transform"),$(".slick-slide").removeClass("slick-center"),$('.slick-slide[data-slick-index="0"]').addClass("slick-center")},a.count=function(e){return e.length}},scope:{items:"="},templateUrl:e.tmplPath("photoGallery/photoGallery.tpl.html")}}]),angular.module("mosapp.press.plain.list",[]).directive("mosPressPlainList",["UrlSrvc","apiSrvc","toolsSrvc","$state","$rootScope","$stateParams","$filter","testDate","metaConfig","tmplSrvc","headmetaSrvc",function(o,l,c,d,m,p,u,g,h,f,v){return{restrict:"A",scope:{section:"@",sectrange:"@",sectapi:"@",apisection:"@"},link:function(i,e){var t=m.$on("$locationChangeSuccess",function(){r()});function r(e){e=(e=e||d.current.url).replace(/\//,""),h.hasOwnProperty(e)&&angular.isObject(h[e])&&v.setTitle(h[e].sectionTitle,h[e].section).setPageMeta(h,e).setKeywords("%category%, мэр, сайт москвы".replace("%category%",h[e].sectionTitle).toLowerCase())}function a(a){i.notfound=!1,i.error=!1,i.morebutton=!1,angular.isUndefined(i.sectapi)||(i.params.fields="id,title,date_timestamp",l.getData(i.apisection,i.sectapi,i.params,!0,e[0].querySelectorAll(".b-loader")[0]).then(function(e){if(e.result?e.result.pages>e.result.page?i.morebutton=!0:i.morebutton=!1:e._meta&&(e._meta.pageCount>e._meta.currentPage?i.morebutton=!0:i.morebutton=!1),a&&(i.items=[],i.fixLayout()),i.title=e.title||"",angular.isArray(e.items)&&e.items.length){(d.is("home.telegrams")||d.is("home.transcripts")||d.is("home.interviews"))&&i.items&&0===i.items.length&&angular.isObject(e.items[0])&&f.transferToPhantom(e.items[0].date_timestamp);for(var t=0;t<e.items.length;t++)i.items.push(e.items[t]);i.fixLayout(),i.promoItem=e.items[0],i.error=!1,r(d.current.url)}i.items.length<1&&(i.notfound=!0,i.fixLayout()),i.linksLoaded||(o.setPrevNextLinks(i.params.page,i.morebutton,n),i.linksLoaded=!0)},function(e){i.error=e,i.morebutton=!1,i.notfound=!0,i.fixLayout()}))}function s(){return d.includes("home.telegrams")?"telegrams":d.includes("home.interviews")?"interviews":d.includes("home.transcripts")?"transcripts":d.includes("home.reviews")?"reviews":d.includes("home.releases")?"messages":void 0}function n(e){var t=s(),a=p.fromDate||p.untilDate?"from/"+p.fromDate+"/until/"+p.untilDate+"/":"";return 1===e?o.pagePath(t,a):1<e?o.pagePath(t,a+"page-"+e):""}e.on("$destroy",function(){t()}),i.params={},p.fromDate?i.fromDate=g.retDate(p.fromDate):delete i.fromDate,p.untilDate?i.untilDate=g.retDate(p.untilDate):delete i.untilDate,i.fromDate&&i.untilDate?i.params={fromDate:i.fromDate||null,untilDate:i.untilDate||null}:(p.fromDate||p.untilDate&&angular.isDefined(i.section))&&d.go(i.section,i.params),p.page&&(p.page*=1,1===p.page&&d.go("home."+s()),i.params.page=p.page),i.linksLoaded=!1,i.getNextPageUrl=function(){return o.getNextPageUrl(i.params.page,n)},i.fixLayout=function(){setTimeout(function(){i.items&&i.items.length&&3<i.items.length||angular.element(document).find(".b-content__min-height").removeAttr("style")},300)},i.scrollTop=c.scrollTop(.4),i.morebutton=!1,o.setCanonical(o.getLangLink(o.pagePath(s(),""))),i.$watch("params",function(){angular.isDefined(i.params)&&a(!0)}),i.applyFilterCalendar=function(e,t){i.params={fromDate:u("date")(e,"dd.MM.yyyy"),untilDate:u("date")(t,"dd.MM.yyyy")},"string"==typeof e&&"string"==typeof t&&e.length<15&&t.length<15?(i.params={},d.go(i.section,i.params)):(p.fromDate=i.params.fromDate,angular.isDefined(i.params.fromDate)||angular.isDefined(i.params.untilDate)?angular.isDefined(i.sectrange)&&d.go(i.sectrange,i.params):d.go(i.section,i.params))},i.getMoreBricks=function(){i.params.page?i.params.page++:i.params.page=2,a()},i.params.fromDate!==u("date")(i.fromDate,"dd.MM.yyyy")&&(i.fromDate=c.ruStrToDate(i.params.fromDate)),i.params.untilDate!==u("date")(i.untilDate,"dd.MM.yyyy")&&(i.untilDate=c.ruStrToDate(i.params.untilDate))},templateUrl:o.tmplPath("pressPlainList/pressPlainList.tpl.html")}}]),angular.module("mosapp.banner",[]).directive("mosBanner",["UrlSrvc","apiSrvc","mosconfig","$sce",function(e,t,r,s){return{restrict:"A",scope:{},link:function(t,e,a,i){try{t.flagon=r.insertionHeader.current,"on"===t.flagon&&(t.path=s.trustAsResourceUrl(r.insertionHeader.path))}catch(e){t.flagon="off"}},templateUrl:e.tmplPath("banner/banner.tpl.html")}}]),angular.module("mosapp.press.photo.popup",[]).directive("mosPressPhotoPopup",["UrlSrvc","apiSrvc","toolsSrvc","$stateParams",function(e,t,a,i){return{restrict:"A",scope:{actualMenu:"=",galleryVisible:"=",photosLength:"="},link:function(t,e,a){t.itHasMenu=!1,t.photoVisible=!1,t.menuVisible=!0,t.$watch("actualMenu",function(e){t.itHasMenu=e!=undefined}),t.menuItemClicked=function(e){t.menuVisible=!1,t.photoVisible=!0,t.actualPhoto=t.actualMenu[e].image},t.closeAll=function(){t.actualMenu=undefined,t.photoVisible=!1,t.galleryVisible=!0},t.closePhoto=function(){t.menuVisible=!0,t.photoVisible=!1,t.galleryVisible=!1}},templateUrl:e.tmplPath("pressPhotoPopup/pressPhotoPopup.tpl.html")}}]),angular.module("mosapp.sharing",["mosapp.sharing.popup"]).directive("mosSharing",["UrlSrvc","$compile","$modal","$stateParams","apiSrvc","$timeout","mosconfig","LangSrvc",function(o,e,l,t,a,c,u,d){return{restrict:"A",priority:0,link:function(i,e,t){e.on("$destroy",function(){i.$destroy()}),i.$watch(function(){return angular.element(document).width()},function(e){i.direction=t.dynDirect?i.dynDirect:t.direction,i.dynClass="b-sharing-links_type_"+i.direction+" b-sharing-links_behaviour_plain"}),t.socials||(i.lang=d.getCurrentLang(),"ru"===i.lang?i.socials="vkontakte,odnoklassniki":i.socials="vkontakte");var a=["plain","modal"],m="icon-share",p={vkontakte:"vk",facebook:"facebook",twitter:"twitter",odnoklassniki:"odnoklassniki"},r=null;function s(e){return(e=e?String(e).replace(/\&\w{4,5};/gm," "):"")?String(e).replace(/<[^>]+>/gm,""):""}function n(){c(function(){var e="";u.domain&&(e=(e=(0===u.domain.indexOf("http")?"":location.protocol+"//")+u.domain).replace(new RegExp("/$"),""));var o=0===(o=i.image&&""!==i.image&&i.image.indexOf("data:image",0)<0?i.image:(u.imagesPath||"")+"icon200x200.png").indexOf("http")?o:e+"/"+o.replace(new RegExp("^/"),""),l=e+"/"+location.pathname.replace(new RegExp("^/"),""),c=s(i.title||i.text||document.title),d=s(i.description||i.preview||i.title||i.text||document.title),e=("article"!==t.itemType&&0!==window.location.pathname.indexOf("/city/about/symbols/")&&0!==window.location.pathname.indexOf("/city/about/honors/")||(o="https://"+window.location.hostname+"/open-graph/v1/frontend"+window.location.pathname,$('meta[property="og:image:width"]').attr("content","1200"),$('meta[property="og:image:height"]').attr("content","630")),i.letAloneOg||($('meta[property="og:url"]').attr("content",l),$('meta[property="og:title"]').attr("content",c),$('meta[property="og:description"]').attr("content",d),$('meta[property="og:image"]').attr("content",o),$('meta[property="og:image:url"]').attr("content",o)),"undefined"===i.showCounter||i.showCounter);i.socials&&i.id&&document.getElementById(i.id)&&(r?r.updateContent({url:l,title:c,description:d,image:o}):r=new Ya.share2(i.id,{content:{url:l,title:c,description:d,image:o},theme:{services:i.socials,counter:e,lang:"ru",bare:!1},hooks:{onready:function(){var r=$("#"+i.id),e=r.find(".ya-share2__icon"),a=i.getSocials(),s=(e.each(function(e,t){$(t).addClass(m).addClass(m+"-"+p[a[e]])}),new Date),n=setInterval(function(){var e=new Date;if(e-s<1e4&&r.find(".ya-share2__item_service_odnoklassniki").find(".ya-share2__link").attr("href","https://connect.ok.ru/dk?st.cmd=WidgetSharePreview&&st.imageUrl="+encodeURIComponent(o)+"&st.description="+encodeURIComponent(d)+"&st.shareUrl="+encodeURIComponent(l)+"&st.title="+encodeURIComponent(c)+"&utm_source=share2"),e-s<6e4)for(var t=r.find(".ya-share2__counter"),a=t.length-1;0<=a;a--){var i=$(t[a]);isNaN(parseInt(i.text()))?isNaN(i.data("count"))?i.removeClass("show-counter"):i.text($(t[a]).data("count")):i.hasClass("show-counter")||(i.css({opacity:0}).addClass("show-counter"),TweenLite.to(i,.75,{opacity:1,ease:Power1.easeOut}))}else clearInterval(n)},1e3)},onshare:function(e){for(var t=$("#"+i.id).find(".ya-share2__counter"),a=t.length-1;0<=a;a--)isNaN($(t[a]).text())||$(t[a]).css({opacity:1}).addClass("show-counter")}}})),i.calculatePos=function(){var e=angular.element(document).height(),t=angular.element(document).find(".b-popup-sharing__body").height();angular.element(document).find(".b-sharing").offset().top;return currentTop=(e-t)/2},i.isModal()&&i.$watch(function(){return angular.element(document).width()},function(e){i.widthShareItem&&(767<e?(angular.element(document).find(".ya-share2__item").attr("style","width: "+i.widthShareItem+"%"),i.calculatePos()):angular.element(document).find(".ya-share2__item").removeAttr("style"))})},10)}i.getSocials=function(){return i.socials.split(",")},i.isModal=function(){return i.type===a[1]||a.indexOf(i.type)<0},i.openPopup=function(e){i.widthShareItem=Math.round(100/i.getSocials().length),i.popup=l({scope:i,template:o.tmplPath("sharingPopup/sharingPopup.tpl.html"),show:!1,prefixClass:"share-modal",backdropAnimation:"am-fade"}),i.popup.$promise.then(function(){i.popup.show(),n()})},i.isModal()&&angular.element(window).on("click",function(e){angular.element(document).find(e.target).hasClass("am-fade")&&i.closePopup()}),i.closePopup=function(){r=null,i.popup.hide()},i.$watch("text",function(e){e&&!i.isModal()&&n()}),i.$watch("image",function(e){e&&!i.isModal()&&n()}),n()},scope:{id:"@",type:"@",socials:"@",direction:"@",dynDirect:"=",image:"@",text:"@",showCounter:"=",title:"@",preview:"@",description:"@",letAloneOg:"="},templateUrl:o.tmplPath("sharing/sharing.tpl.html")}}]),angular.module("mosapp.sharing.popup",[]).directive("mosSharingPopup",["UrlSrvc","$compile","$modal","$stateParams","apiSrvc","$timeout",function(e,t,a,i,r,s){return{restrict:"A",link:function(e,t,a){},scope:{},templateUrl:e.tmplPath("sharingPopup/sharingPopup.tpl.html")}}]),angular.module("mosapp.photoBank",[]).directive("photoBank",["UrlSrvc","apiSrvc","toolsSrvc","$stateParams","loader",function(r,s,n,o,e){return{scope:{stateRoot:"@",stateMode:"@",personPhoto:"@",firstPerson:"@",apiRoot:"@",galleryApi:"@",imagesApi:"@",paramsId:"@",personApi:"@",personDetailsApiRoot:"@",personDetailsApi:"@",isAuthority:"@"},link:function(a,e,t){function i(){var e;a.person.section&&res.person.section.id&&(e=r.pagePath("department",""+a.person.section.id),a.person.sectionUrl=e+"view/",t.firstPerson?a.person.personUrl=r.pagePath("mayor",""):(a.person.personUrl=e+"person/"+a.person.id+"/",a.postfix=". "+a.person.post))}a.isAuthority="true"==a.isAuthority,t.firstPerson?(a.personId=r.apiPath("photoBank").firstPersonId,a.firstPerson=!0):(a.personId=o[a.paramsId],a.firstPerson=!1),a.getPersonDetails=function(){a.personId;return s.getData(a.personDetailsApiRoot,a.personDetailsApi,{id:a.personId},!0,e[0].querySelectorAll(".photobank-loader")[0]).then(function(e){var t;e&&e.id&&(t={title:e.surname+" "+e.name+" "+e.patronymic,post:n.joinProperty(e.posts,"name",", ")},o.structureId?(e=o.structureId,s.getData("structure","institution",{id:e}).then(function(e){e&&e.id&&(e.title=e.name,t.section=e.title,a.person=t,i())})):(a.person=t,i()))},function(e){})},a.getPersonData=function(){return s.getData(a.apiRoot,a.personApi,{id:a.personId},!0,e[0].querySelectorAll(".photobank-loader")[0]).then(function(e){angular.isArray(e.items)&&e.items[0]&&e.items[0].title&&(a.galleryId=e.items[0].id)},function(e){a.errCode=404})},a.personId=+a.personId,a.personId?a.getPersonDetails().then(a.getPersonData):a.errCode=404},templateUrl:r.tmplPath("photoBank/photoBank.tpl.html")}}]),angular.module("masonry",[]).directive("masonry",["UrlSrvc","masonrysrvc","$rootScope","$timeout",function(e,c,d,m){return{restrict:"A",link:function(t,e,a,i){e.on("$destroy",function(){t.$destroy()});var r,s=e[0],n={itemSelector:a.itemSelector||".tiles__item"},o=(c.load({}).then(function(e){r=t.masonry=new Masonry(s,n),t.showItem=t.photoItems,r.on("layoutComplete",function(e){t.$emit("masonryLayoutComplete",{totalItems:e.length})})},function(e){}),0),l=(t.update=function(){"ready"===d.masonry.status&&(o&&m.cancel(o),o=m(function(){o=0,r.reloadItems(),r.layout(),e.children(n.itemSelector).css("visibility","visible")},120))},t.removeBrick=function(){"ready"===d.masonry.status&&m(function(){r.reloadItems(),r.layout()},500)},t.appendBricks=function(e){"ready"===d.masonry.status&&r.appended(e)},t.$on("masonry.layout",function(){r.layout()}),t.update(),0);$(window).on("resize",function(){l&&m.cancel(l),l=m(function(){l=0,r.reloadItems(),r.layout(),e.children(n.itemSelector).css("visibility","visible")},375)})}}}]).directive("masonryTile",["masonrysrvc",function(n){return{restrict:"A",link:function(t,a){a.css("visibility","hidden");var i=t,r=i.update,e=i.removeBrick,s=i.appendBricks;r&&n.load({}).then(function(e){imagesLoaded(a.get(0),r),a.ready(r),i.item.current&&t.$emit("masonrySayYes")},function(e){}),s&&n.load({}).then(function(e){imagesLoaded(a.get(0),s(a))},function(e){}),t.$on("$destroy",function(){e&&e()})}}}]).service("masonrysrvc",["UrlSrvc","$q","$rootScope","$window",function(i,t,r,e){this.load=function(e){return t(function(e,t){var a;r.masonry?"ready"!==r.masonry.status?(a=document.getElementById("masonryapiscript"),$(a).on("load",function(){e()})):e():(r.masonry={},r.masonry.status="load",(a=document.createElement("script")).id="masonryapiscript",a.async="true",document.getElementsByTagName("head")[0].appendChild(a),a.src=i.jsPath("masonry.pkgd.min.js"),$(a).on("load",function(){r.masonry.status="ready",e()}))})}}]),angular.module("mosapp.media.photo",["ngAnimate"]).directive("mosMediaPhoto",["UrlSrvc","apiSrvc","$state","$stateParams","$filter","metaConfig","galleryInfo","$timeout","galleryItems","tmplSrvc","headmetaSrvc","loader","districtsSrvc","$translate",function(t,r,a,n,o,l,c,d,m,p,u,g,h,f){return{restrict:"A",scope:{inline:"@",galleryInfoId:"=",mode:"@",galleryId:"@",apiRoot:"@",galleryApi:"@",imagesApi:"@",similarApi:"@",stateRoot:"@",stateMode:"@",person:"=",firstPerson:"=",errCode:"=",sectionState:"@",postfix:"@",pageType:"@",isAuthority:"@"},link:function(s,i,e){if(s.firstInit=!0,s.galleryCache={},!s.inline&&s.errCode)return s.mosError=s.errCode;if(i.on("$destroy",function(){s.$destroy()}),s.galleryVisible=!0,!s.inline){if(s.params={id:s.galleryId||n.photoID,page:n.page?Number(n.page):1,item:n.item?Number(n.item):0,mode:"carousel"!=n.mode?"tiles":"carousel",stateRoot:s.stateRoot,stateMode:s.stateMode},!s.params.stateRoot||!s.params.stateMode)return console.error("Add states to the ui-router!"),s.mosError=404;if(s.params.pages=[],!s.params.id)return console.error("ID doesn`t exist!"),s.mosError=404;if(!s.apiRoot||!s.galleryApi||!s.imagesApi)return console.error("API key`s doesn`t exist!"),s.mosError=404}s.inline&&s.galleryId&&!e.galleryInfoId&&(s.params={id:s.galleryId,page:1,item:0,mode:"carousel"!=s.mode?"tiles":"carousel"}),s.error=!1,s.hideme=!1,s.currentTileItem=s.params&&s.params.item||0,s.picsTotal=0,s.currentItem={},s.currentImageSrc="",s.inline||a.go(s.params.stateMode,{photoID:s.params.id,mode:s.params.mode,page:s.params.page,item:s.params.item},{notify:!1}),s.changeMode=function(e){s.currentTileItem=s.params.item,s.params.mode=e,s.inline||a.go(s.params.stateMode,{mode:e,page:s.params.page,item:s.params.item},{notify:!1}),s.currentImage=s.currentSlide},s.$watch("params.mode",function(e,t){"tiles"===e&&"carousel"===t?(s.fromCarousel=!0,t=Math.floor(s.params.item+1/s.perPage),s.params.pages[t]&&(s.params.page=s.params.pages[t])):s.fromCarousel=!1,"tiles"===e&&(s.firstInit=!1),"carousel"===e&&(s.inline&&(s.firstInit=!1),s.firstInit?s.firstInit=!1:d(function(){var e,t=angular.element(i).find(".carousel__header");t.length&&(t=t.offset().top-t.height(),e=s.inline?40:0,TweenLite.to(window,1,{scrollTo:{y:t-e,autoKill:!1},ease:Power1.easeInOut,onComplete:function(){}})),s.firstInit=!1},100))}),s.getMoreItems=function(e){if(!s.lockMore){if(s.lockMore=!0,!s.params.pages.length)return s.lockMore=!0;var t=s.params.pages[s.params.pages.length-1]+1,a=(t>s.pageCount&&(t=1),s.params.page=t,i),a="tiles"==s.params.mode?a.find(".tiles__container"):a.find(".carousel:not(.container-fluid)");g.switchOn(a),r.getData(s.apiRoot,s.imagesApi,{id:s.params.id,page:t},!0).then(function(e){s.lockMore=!1,s.params.pages.push(t),s.setData(e,1)},function(){s.lockMore=!1}).finally(function(){var e=a.children(".loader");e.length&&e.remove()})}},s.setCurrentImage=function(e,t){var a;e&&(s.currentItem=angular.copy(e),s.currentImageSrc=o("imgDownload")(e.image),a=(s.person||s.media||s.gallery).title,!s.isAuthority||"tiles"!==s.params.mode&&"carousel"!==s.params.mode?s.setCurrentMeta({title:a,pic:e}):s.setCurrentMetaAuthorityPhoto({title:a,pic:e,order:t+1}))},s.setCurrentMetaAuthorityPhoto=function(e){var t,a,i,r;s.inline||(s.image=o("imgDownload")(e.pic.image),-1!==s.image.indexOf("data:image",0)&&(s.image=""),e&&e.pic&&e.pic.image&&((r=e.pic.image.middle).fullTitle="Фотография "+r.title,(t=(r=document.querySelector("head")).querySelector("title"))||(t=document.createElement("title"),r.appendChild(t)),r="tiles"===s.params.mode?(a="Фотобанк — "+e.title,i="фотографии "+e.title.toLowerCase()+", фотобанк","Фотографии: "+e.title):(a=e.pic.image.title+". Фотография №"+e.order+": "+e.title,i="фотография "+e.title.toLowerCase()+", фотография "+e.order+", фотография "+e.title.toLowerCase()+" "+e.order+", "+e.pic.image.title,"Фотография №"+e.order+": "+e.title+". "+e.pic.image.title),t.innerHTML=r,u.withoutSiteName().setPageMeta({mediaPhoto:{type:"article",title:r,description:a,image:e.pic.image.middle,published_time:s.gallery.date_timestamp}},"mediaPhoto").setKeywords(i)))},s.setCurrentMeta=function(e){var t,a,i;s.inline||(s.image=o("imgDownload")(e.pic.image),-1!==s.image.indexOf("data:image",0)&&(s.image=""),e&&(e.pic&&e.pic.image&&((t=e.pic.image.middle).title&&0!==t.title.indexOf("Фотография ")&&(t.title="Фотография "+t.title),a=e.title+l.photo.description,i=e.title.toLowerCase()+l.photo.keywords,u.withoutSiteName().setPageMeta({mediaPhoto:{type:"article",title:e.title||t.title,description:a,image:e.pic.image.middle,published_time:s.gallery.date_timestamp}},"mediaPhoto").setKeywords(i)),!s.pageType||"mayor"!==s.pageType&&"media"!==s.pageType?u.setTitle(e.title):u.setTitle(e.title,l.photo.sectionTitle,l.photo.section)))},s.showSlide=function(e,t){s.action=t,s.currentTileItem=e},s.setData=function(e,t){if(!e)return!1;e&&e._meta&&e._meta.currentPage&&e._meta.pageCount?(s.pageCount=e._meta.pageCount,s.perPage=e._meta.perPage,s.picsTotal=e._meta.totalCount,s.inline||"tiles"===s.params.mode&&a.go(s.params.stateMode,{mode:s.params.mode,page:s.params.page,item:s.params.item},{notify:!1}),e._meta.currentPage<s.pageCount&&angular.isArray(s.params.pages)&&s.params.pages.length<s.pageCount||angular.isArray(s.params.pages)&&s.params.pages.length<s.pageCount?s.lockMore=!1:s.lockMore=!0):s.lockMore=!0,0===t?(s.mosError=!1,s.gallery=e&&!e.id&&angular.isArray(e.items)&&e.items.length?angular.copy(e.items[0]):angular.copy(e),s.setMediaTitle()):e.items&&angular.isArray(e.items)&&e.items.length?angular.forEach(e.items,function(e){e={image:e,showImage:!1};s.photoItems.push(e)}):s.lockMore=!0},s.setMediaTitle=function(){s.person||(s.media={title:s.gallery.title,date_timestamp:s.gallery.date_timestamp})},s.initGallery=function(){var e={id:s.params.id,page:s.params.page};s.getPhoto=r.getData(s.apiRoot,s.imagesApi,e,!0,i[0].querySelectorAll(".media-photo-loader")[0]),s.getPhoto.then(function(e){s.lockMore=!0,s.mosError=!1,angular.isArray(s.params.pages)||(s.params.pages=[]),s.params.pages.push(s.params.page),s.setData(e,1)},function(e){s.error=e,s.photoItems.length<1&&(s.mosError=e.code)})},s.getInfo=function(){var e={id:s.params.id,expand:"districts"};r.getData(s.apiRoot,s.galleryApi,e,!0,i[0].querySelectorAll(".media-photo-loader")[0]).then(function(e){var t;angular.isArray(e.items)&&e.items[0]&&e.items[0].id?t=e.items[0]:angular.isObject(e)&&e.id&&(t=e),t?(s.lockMore=!0,s.setData(t,0),s.initGallery(),!s.inline&&t.date_timestamp&&p.transferToPhantom(t.date_timestamp),f(["mediaPhoto.districtsTitle","mediaPhoto.areasTitle"]).then(function(e){s.districtsTitle=e["mediaPhoto.districtsTitle"],s.areasTitle=e["mediaPhoto.areasTitle"]}),e="","mayor"===s.pageType?e="photo":"media"===s.pageType&&(e="mainphoto"),h.handleDistricts(s.gallery.districts,s,{category:e,maxExtra:2})):s.inline&&s.galleryId?(s.gallery=null,$(document).trigger("dataMosSpecialPhotobankNotFound")):s.mosError=404},function(e){"410"==e.code&&s.sectionState?a.go(s.sectionState):(s.inline&&s.galleryId?(s.gallery=null,$(document).trigger("dataMosSpecialPhotobankNotFound")):s.mosError=e.code,s.lockMore=!0)})},s.inline&&e.galleryInfoId?(s.mode="tiles",s.params={},s.params.pages=[],s.params.page=1,s.params.item=0,s.params.mode="tiles",s.lockMore=!0,s.photoItems=[],s.$watch("galleryInfoId",function(t){angular.isDefined(t)&&angular.isNumber(+t)&&"on"===s.inline&&(s.lockMore=!1,s.photoItems=[],s.params.pages=[],s.params.id=s.galleryInfoId,r.getData(s.apiRoot,s.imagesApi,{id:s.params.id,page:s.params.page},!0,i[0].querySelectorAll(".media-photo-loader")[0]).then(function(e){angular.isArray(e.items)&&e.items.length?m.setInfo(t,!0):m.setInfo(t,!1),s.params.pages.push(e._meta.currentPage),s.setData(c.getInfo(t),0),s.setData(e,1)},function(e){m.setInfo(t,!1)}))})):s.photoItems=[],(!s.inline||s.inline&&s.galleryId&&!e.galleryInfoId)&&s.getInfo(),s.pageType&&"mayor"===s.pageType&&(s.canonicalLink=t.getLangLink(t.pagePath("mayorMain","media/photo/"+s.params.id+"/"+s.params.mode+"/"+s.params.page+"/"+s.params.item)),s.canonicalLink&&t.setCanonical(s.canonicalLink)),s.getSimilarItems=function(e){return!1}},templateUrl:t.tmplPath("mediaPhoto/mediaPhoto.tpl.html")}}]).factory("galleryInfo",function(){var a={};return{setInfo:function(e,t){a[e]=t},getInfo:function(e){return a[e]}}}).factory("galleryItems",function(){var a={};return{setInfo:function(e,t){(a={})[e]=t},getInfo:function(e){return a}}}),angular.module("mosapp.media.photo.carousel",["ngAnimate","ngTouch"]).directive("mosMediaPhotoCarousel",["UrlSrvc","toolsSrvc","$state","$filter","$timeout","$window",function(e,i,h,t,f,r){return{restrict:"A",scope:{inline:"=",getMoreItems:"=",gallery:"=",picsTotal:"=",lockMore:"=",photoItems:"=",perPage:"=",currentItem:"=",currentTileItem:"=",action:"=",currentImageSrc:"=",params:"=",setCurrentImage:"&",postfix:"@",pageType:"@",isAuthority:"@"},link:function(l,t){l.$watch(function(){return i.colorScheme()},function(e){l.colorScheme=e}),l.setSharingPreview=function(){!l.pageType||"mayor"!==l.pageType&&"media"!==l.pageType?l.sharingPreview="Фотография "+l.currentItem.image.title:l.sharingPreview=l.gallery.title},l.$watch("currentItem",l.setSharingPreview),l.slidesCount=l.slidesCount||5,t.on("$destroy",function(){l.$destroy(),$(window).off("resize.mosMediaPhotoCarousel")}),l.currentSlide=l.currentTileItem||0,l.isMobile=device&&(device.mobile()||device.tablet()),l.speed=.6,l.easing="Power1.easeOut";var c,d,e,o=t.find(".carousel-vertical__list"),m=0,p=0,u=l.slidesCount,a=(l.initFullCarousel=function(){var e,t;l.fullItems&&(e=(c=o.find(".slick-track")).find(".carousel-vertical__item"),t=o.width(),c.width(l.fullItems.length*t),e.width(t),e.css({display:"block"}),d=t,0<m&&c.css({left:-d*m}))},null);function g(e){var t,a=Math.floor(u/2),i=m,a=m-a,r=(0<a?0<(t=Math.min(Math.abs(a),l.picsTotal-(p+u)))&&(p+=t,m-=t):a<0&&0<(t=Math.min(p,Math.abs(a)))&&(p-=t,m+=t),p+u-1);if(r>l.picsTotal-1&&(r=l.picsTotal-1,0<p&&r-p<u-1&&(a=Math.min(p,u-1-(r-p)),p-=a,m+=a)),!e||0<t){for(var s=p,n=0;s<=r;s++,n++){var o=angular.copy(l.photoItems[s]);0<t&&e&&n===i||(o?(o.index=n,o.currentSlide=l.currentSlide,l.fullItems[n]=o):l.fullItems[n]={})}0<t&&c&&f(function(){c.css({left:-d*m}),e&&(l.fullItems[i]=l.photoItems[p+i])},0)}}$(window).on("resize.mosMediaPhotoCarousel",function(){a&&f.cancel(a),a=f(l.initFullCarousel,10)}),l.vertGoTo=function(a,i){var r,s,n,e;!l.photoItems[a]||!i&&a===l.currentSlide?l.lock=!1:(r=angular.element(t).find(".carousel-vertical__nav_list"),c=o.find(".slick-track"),s=r.find(".carousel-vertical__nav-item").height(),n=a-2,l.photoItems.length<6||n<=0?n=0:l.photoItems.length-n<=5&&(n=l.photoItems.length-5),e=a-l.currentSlide,0!=e&&(m+=e),f(function(){var e=-n*s,e=(TweenLite.to(r,(l.isMobile||i?0:l.speed/3)||.25,{marginTop:e,ease:l.easing,onComplete:function(){}}),TweenLite.to(c,(l.isMobile?l.speed/1.5:l.speed/3)||.75,{left:-d*m,ease:l.easing,onComplete:function(){g(!0),l.$apply(),l.lock=!1}}),l.params.page),t=(!l.lockMore&&l.photoItems.length-l.currentSlide<e*(l.perPage-3)&&(l.getMoreItems(),l.unwatchPhotoItems=l.$watch("photoItems",function(e,t){if(e&&t&&e.length>t.length){var a=p+u-1;a>l.picsTotal-1&&(a=l.picsTotal-1,0<p&&a-p<u-1&&(e=Math.min(p,u-1-(a-p)),p-=e));for(var i=p,r=0;i<=a;i++,r++){var s=l.fullItems[r];s&&s.image||(l.fullItems[r]=l.photoItems[i])}l.unwatchPhotoItems()}},!0)),l.photoItems[l.currentSlide].current=!1,l.photoItems[a].current=!0,l.currentItem=l.photoItems[a],l.currentSlide=a,l.currentTileItem=a,l.params.item=a,Math.floor(a/l.perPage));l.params.pages[t]&&(e=l.params.pages[t]),l.params.page=e,l.inline||h.go(l.params.stateMode,{mode:l.params.mode,page:l.params.page,item:l.params.item},{notify:!1}).then(function(){f(function(){l.setCurrentImage({pic:l.photoItems[a],order:a})},100)})},50))},l.getPrevSlide=function(){var e=0===l.currentSlide?0:l.currentSlide-1;l.goToSlide(e,!1)},l.getNextSlide=function(){var e=(e=l.currentSlide+1)<l.photoItems.length?e:l.photoItems.length;l.goToSlide(e,!1)},l.goToSlide=function(e,t){(t||!l.lock&&e!==l.currentSlide)&&(l.lock=!0,l.vertGoTo(e,t))},l.clearCurrent=function(){l.photoItems.forEach(function(e,t){t=t===l.currentSlide;angular.extend(e,{current:t,showImage:t})})},l.photoItems&&l.photoItems.length&&(l.clearCurrent(),l.params.item=l.currentSlide,l.currentSlide>l.photoItems.length-1&&(e=Math.ceil(l.currentSlide/l.perPage),0<(e=l.currentSlide-l.perPage*(e-1))&&e<l.photoItems.length?l.currentSlide=e:l.currentSlide=0),l.setCurrentImage({pic:l.photoItems[l.currentSlide],order:l.currentSlide}),l.fullItems=l.fullItems||[],l.picsTotal<u&&(u=l.picsTotal),p=l.currentSlide,l.fullItems=[],g(),f(function(){l.initFullCarousel(),l.goToSlide(l.currentSlide,!0)})),l.printThis=function(){return r.print()}},templateUrl:e.tmplPath("mediaPhotoCarousel/mediaPhotoCarousel.tpl.html")}}]).directive("mediaPhotoCarouselThumb",["UrlSrvc","toolsSrvc",function(e,a){return{restrict:"A",scope:{item:"=",currentSlide:"=",ind:"=",picsTotal:"=",gallery:"=",postfix:"@"},link:function(t,e){t.$watch(function(){return a.colorScheme()},function(e){t.colorScheme=e}),e.on("$destroy",function(){t.$destroy()}),t.postfix?t.metaImage=a.getMetaForImage(t.gallery.title+t.postfix):t.metaImage=a.getMetaForImage(t.gallery.title),t.$watch("currentSlide",function(e){t.item.showImage=Math.abs(t.ind-e)<6})},templateUrl:e.tmplPath("mediaPhotoCarousel/mediaPhotoCarouselThumb.tpl.html")}}]).directive("mediaPhotoCarouselFull",["UrlSrvc","toolsSrvc","$filter","loader",function(e,l,i,c){return{restrict:"A",scope:{item:"=",currentSlide:"=",ind:"@",getPrevSlide:"&",getNextSlide:"&",picsTotal:"=",gallery:"=",postfix:"@"},link:function(r,s){function n(e,t){var a=new Image;return $(a).on("load error",function(){c.switchOff(s),r.loading=!1,r.displayInfo=!0,window.location.pathname.match("^/en/")||(r.showPhotoTitle=!0)}),a.src=i("imgShow")(e),o(),a.alt=t.alt,a.title=t.title,a}function o(){r.loading||(c.switchOn(s),r.loading=!0,r.displayInfo=!1,r.showPhotoTitle=!1)}s.on("$destroy",function(){r.$destroy()}),r.postfix?r.metaImage=l.getMetaForImage(r.gallery.title+r.postfix):r.metaImage=l.getMetaForImage(r.gallery.title),r.item&&r.item.image||o(),r.$watch("item",function(e){var t,a,i;e&&e.image?(r.item.showImage=!0,t=s.find("img"),a=l.getMetaForImage(r.gallery.title+(r.postfix||"")),o(),t&&t.length?(i=n(e.image,a),t.replaceWith(i)):(i=n(e.image,a),s.find(".carousel-vertical__image-wrap").prepend(i))):o()})},templateUrl:e.tmplPath("mediaPhotoCarousel/mediaPhotoCarouselFull.tpl.html")}}]),angular.module("mosapp.media.photo.tiles",[]).directive("mosMediaPhotoTiles",["UrlSrvc","$timeout","toolsSrvc",function(e,r,s){return{restrict:"A",scope:{photoItems:"=",gallery:"=",lockMore:"=",params:"=",showSlide:"=",perPage:"=",getMoreItems:"=",currentTileItem:"=",fromCarousel:"=",setCurrentImage:"&",postfix:"@"},link:function(a,t,e){var i;!0!=(-1!=(i=navigator.userAgent.toLowerCase()).indexOf("safari")&&-1===i.indexOf("chrome"))&&a.$watch(function(){return s.colorScheme()},function(e){a.colorScheme=e}),t.on("$destroy",function(){a.$destroy()}),a.postfix?a.metaImage=s.getMetaForImage(a.gallery.title+a.postfix):a.metaImage=s.getMetaForImage(a.gallery.title),a.scrollToEl=function(e){e&&a.tryScroll&&((e=t.find(e)).length&&(a.scrollTw&&a.scrollTw.kill(),a.destination=angular.element(e[0]).offset().top-120,a.scrollTw=TweenLite.to(window,1,{scrollTo:{y:a.destination,autoKill:!1},ease:Power1.easeInOut,onComplete:function(){a.tryScroll=!1}})))},a.goToTop=function(){TweenLite.to(window,1,{scrollTo:{y:document.getElementsByClassName("carousel__header")[0].offsetTop-45,autoKill:!1},ease:Power2.easeInOut,onComplete:function(){a.tryScroll=!1}})},a.$watch("destination",function(e,t){e&&t&&e!==t&&a.scrollToEl(".tiles_anchor")}),a.gotoCurrent=function(){r(function(){a.destination=0,a.scrollToEl(".tiles_anchor")})},a.$watch("fromCarousel",function(e){e&&r(function(){a.tryScroll=!0,a.currentPos=0})}),a.$on("masonrySayYes",function(){}),a.$on("masonryLayoutComplete",function(e,t){t&&t.totalItems&&t.totalItems===a.photoItems.length&&a.gotoCurrent()}),a.clearCurrent=function(){for(var e=a.photoItems.length;e--;)if(a.photoItems[e].current){delete a.photoItems[e].current;break}},a.$watch("photoItems.length",function(e){e&&!a.fromCarousel&&a.setCurrentImage({pic:a.photoItems[0],order:0})}),a.open=function(e){a.clearCurrent(),a.params.mode="carousel",e.item.current=!0,a.showSlide(e.index,"tiles")}},templateUrl:e.tmplPath("mediaPhotoTiles/mediaPhotoTiles.tpl.html")}}]),angular.module("mosapp.search.form",[]).directive("mosSearchForm",["UrlSrvc","apiSrvc","$filter","$location","pathSrvc","$timeout","LangSrvc","$sce",function(l,e,t,c,d,m,p,u){return{restrict:"A",link:{pre:function(a,i,e,t){a.cacheQuery=[],a.path=d.parsePath(c.url());try{decodeURIComponent(a.path.query.value),a.query="error"!==a.path.query.result?decodeURIComponent(a.path.query.value):""}catch(e){a.query="error"!==a.path.query.result?a.path.query.value:""}a.expanded=!1,a.searchPlaceholder=e.searchPlaceholder,a.searchClass=e.searchClass,a.trustAsHtml=function(e){return u.trustAsHtml(e)};var r=$(i),s=r.find("form"),n=r.find(".b-search-input"),o=(r.find('input[type="button"]'),!0);r.hasClass("expanded")&&(a.expanded=!0),a.query?n.val(a.query):n.val(""),a.searchUrl=e.searchUrl,a.searchFiltr=e.searchFiltr||"common",a.searchAutoComplete=e.searchAutoComplete||"on",a.searchAutoComplete="ru"!==p.getCurrentLang()?"off":a.searchAutoComplete,a.onFocus=function(){a.query="",o=!1},a.onBlur=function(){a.searchCollapsed&&!o&&(o=!0,m(function(){i.addClass("collapsed"),s.removeClass("inpvalue"),a.query="",n.val(""),n.trigger("blur"),angular.element(document).find(".mos-header").removeAttr("style")},100))},"on"===a.searchAutoComplete?a.autocomplete=!0:a.autocomplete=!1,a.formSubmit=function(){var t,e=r.find(".b-search-input");if(a.autocomplete?t=n:e.each(function(e){$(this).hasClass("s-autocompl-input")||(t=$(this))}),""===t.val())return a.searchCollapsed&&(i.toggleClass("collapsed"),i.hasClass("collapsed")?t.trigger("blur"):m(function(){t.trigger("focus")},250)),!1;a.lock=!0,a.query=t.val();e=l.getLangLink(l.pagePath("search",""));e=(e=e.replace(new RegExp("/$","g"),""))+"?category="+a.searchFiltr+"&page=1&q="+a.query,-1===a.cacheQuery.indexOf(a.query)&&(a.cacheQuery.push(a.query),window.location.href=e)},a.autocomplete&&(a.prfurl=l.apiPath("search").searchPrfurl,-1<a.prfurl.indexOf("[lang]")&&(a.prfurl=a.prfurl.replace("[lang]",p.getCurrentLang())),a.remurl=l.apiPath("search").searchRemurl,-1<a.remurl.indexOf("[lang]")&&(a.remurl=a.remurl.replace("[lang]",p.getCurrentLang())))},post:function(t,e,a,i){var s,r=$(e),n=r.find("form"),r=r.find(".s-autocompl-input");if(t.autocomplete){var o=r.data("prfurl"),l=r.data("remurl");if(-1<l.indexOf("[lang]")&&(l=l.replace("[lang]",p.getCurrentLang())),-1<o.indexOf("[lang]")&&(o=o.replace("[lang]",p.getCurrentLang())),!l)return console.log("Отсутствует атрибут data-remurl у поля ввода запроса!"),!1;o=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:t.prfurl,remote:{url:t.remurl,wildcard:"%QUERY"}});o.initialize(),r.typeahead({classNames:{menu:"tt-dropdown-menu"},minLength:3,highlight:!0},{name:"search-autocomplete",display:"value",source:o,templates:{header:'<span class="tt-head"><div class="tt-head"><p>Часто ищут:</p></div></span>',suggestion:function(e){return'<div class="tt-suggestion"><p style="white-space: normal;">'+e.value+"</p></div>"}}}),r.on("typeahead:opened",function(){n.addClass("open")}),r.on("typeahead:closed",function(){n.removeClass("open")})}n.find("input.tt-input").each(function(){var e=$(this);e.on("keypress",function(e){if(t.query=$(this).val(),13===e.which)return t.formSubmit(),!0}),e.on("click",function(e){$(this).select()})}),r.on("change",function(e){$(this).val()?n.addClass("inpvalue"):n.removeClass("inpvalue"),t.query=$(this).val()}),a.searchClass&&n.find(".tt-hint").addClass(a.searchClass+"__input"),"search-panel"===e.attr("id")&&(s=e).each(function(){var e=$("body"),a=s.find(".tt-input"),i=$("#search-panel-opener"),r=e.hasClass("s-scroll-observer")||e.hasClass("mainpage");s.hasClass("panel-expanded")&&(s.addClass("expanded"),i.addClass("expanded"));function t(){if(r&&"userOpen"!==s.data("status")&&"slide"!==s.data("onAction")&&0<a.length&&""===a.val()){s.data("onAction","slide");var e=$("#header").next(".b-fix-wrapper"),t=$("div[data-article-emergency]");if(0<$(document).scrollTop())s.data("height")||s.data("height",s.height()),r&&(TweenLite.to(e,.7,{"padding-top":0,ease:Power2.easeOut,onComplete:function(){}}),TweenLite.to(t,.7,{"padding-top":0,ease:Power2.easeOut,onComplete:function(){}})),i.removeClass("expanded"),TweenLite.to(s,.7,{opacity:0,height:0,ease:Power1.easeOut,onComplete:function(){s.css({opacity:"",height:"",overflow:""}).removeClass("expanded"),s.data("onAction","off")}});else{s.data("height")||(s.css("opacity",0).addClass("preexpanded"),s.data("height",s.height()),s.removeClass("preexpanded").css("opacity","")),i.addClass("expanded");try{$("#mainnav").collapse("hide")}catch(e){}}}}r&&($(document).scroll(t),t())})}},scope:{searchPlaceholder:"@",searchUrl:"@",searchFiltr:"@",searchClass:"@",searchAutoComplete:"@",searchCollapsed:"=?",btnText:"@"},templateUrl:l.tmplPath("searchForm_v2/search.form_v2.tpl.html")}}]).service("pathSrvc",[function(){this.parsePath=function(e){var t={category:{value:"",result:"error"},page:{value:0,result:"error"},query:{value:"",result:"error"},filter:{value:""},errors:0},a="";try{a=decodeURI(e)}catch(e){a="f/common/p/1/q/",t.errors=100500}return angular.isString(a)&&(""===(a=a.split("/"))[0]&&a.splice(0,1),"f"===a[0]&&""!==a[1]?t.category={value:a[1],result:"ok"}:(t.category={value:a[1],result:"error"},t.errors++),"p"!==a[2]||isNaN(a[3])?(t.page={value:a[3],result:"error"},t.errors++):t.page={value:parseInt(a[3]),result:"ok"},"q"===a[4]?(a[5]=a[5].replace(new RegExp("%2F","g"),"/"),t.query={value:a[5],result:"ok"}):(t.query={value:a[6],result:"error"},t.errors++),a[6]&&(t.filter.value=a[6].replace(new RegExp("%7C","g"),"|"))),t}}]),angular.module("mosapp.tags",[]).directive("mosTags",["UrlSrvc","apiSrvc",function(i){return{restrict:"A",scope:{tags:"=",section:"@"},link:function(t,e,a){t.$watch("tags",function(){t.getSearchLink=function(e){return e=encodeURIComponent(e),a.section&&""!==a.section?t.filtr=t.section:t.filtr="common",i.getLangLink(i.pagePath("search","")).replace(new RegExp("/$","g"),"")+"?category="+t.filtr+"&page=1&skip_stat=2&q="+e}})},templateUrl:i.tmplPath("tags/tags.tpl.html")}}]),angular.module("mosapp.spheres",[]).directive("mosSpheres",["UrlSrvc",function(e){return{restrict:"A",scope:{params:"=",createLink:"=",target:"@?"},link:function(a,e){e.on("$destroy",function(){a.$destroy()}),a.$watch("params",function(t){a.getSphereLink=function(e){return a.createLink?t.url.replace("%sphereid%",e.id):null}})},templateUrl:e.tmplPath("spheres/spheres.tpl.html")}}]),angular.module("mosapp.mosError",["mosapp.filters.imageSrc","ngSanitize"]).filter("to_trusted",["$sce",function(t){return function(e){return t.trustAsHtml(e)}}]).directive("mosError",["UrlSrvc","apiSrvc","toolsSrvc","$state","$stateParams","$timeout","libsLoader","LangSrvc","headmetaSrvc","$translate",function(e,a,i,t,r,s,n,o,l,c){return{scope:{mosError:"="},link:function(t){n.get({js:"error/index.js",css:"error/index.css",id:"error-app.js",api:"Error"});["msapplication-tap-highlight","fb:pages","og:url","og:title","og:type","og:description","og:image","og:site_name","twitter:card"].forEach(function(e){l.removeMetaTag(e)}),c("mosError.errorMessage_"+t.mosError).then(function(e){i.setTitleClean(e)}),t.$watch("mosError",function(e){e!=undefined&&a.getData("mosError","page",{code:t.mosError},!0).then(function(e){t.pageInfo=e,s(function(){"function"==typeof window.phantomJsError&&window.phantomJsError(t.mosError)})})}),t.lang=o.getCurrentLang(),t.appId="en"===t.lang?"app-en":"app",t.isClientError="4"===t.mosError.toString()[0],t.showSearch=!("en"!==t.lang&&"ru"!==t.lang||!t.isClientError),"404"==t.mosError&&i.statCounter({metrika:{TARGET_NAME:"error_404"}})},templateUrl:e.tmplPath("mosError/mosError.tpl.html")}}]),angular.module("mosapp.photoBankTabs",[]).directive("photoBankTabs",["UrlSrvc","apiSrvc","$stateParams","mosconfig","toolsSrvc","galleryInfo","galleryItems","LangSrvc",function(e,s,t,a,i,n,o,l){return{scope:{mayorKey:"@",apiRoot:"@",galleryApi:"@",imagesApi:"@",postfixImg:"@"},link:function(r,e,t){r.blockVisible=!0,r.actives=0,r.confKeys=r.mayorKey.split("."),r.data=a[r.confKeys[0]][r.confKeys[1]][r.confKeys[2]],r.tabs=[],r.lang=l.getCurrentLang(),r.changeTab=function(t){r.galleryInfoId=t,r.tabs.forEach(function(e){delete e.active,e.id==t&&(e.active=!0)})},r.$watch(function(){return o.getInfo()},function(t){var a;0==t[Object.keys(t)[0]]&&(a=[],r.tabs.forEach(function(e){e.id!=Object.keys(t)[0]&&a.push(e)}),r.tabs=[],r.tabs=a,r.tabs[0]&&(r.tabs[0].active=!0,r.galleryInfoId=r.tabs[0].id))},!0),r.data.forEach(function(e,t){var a,i;a=e,i=t,s.getData(r.apiRoot,r.galleryApi,{id:a.id}).then(function(e){angular.isArray(e.items)&&e.items.length&&a.id==e.items[0].id&&(n.setInfo(a.id,e),r.tabs.push(a),a.active&&(r.galleryInfoId=a.id,r.actives++)),i==r.data.length-1&&0===r.actives&&r.tabs[0]&&(r.tabs[0].active=!0,r.actives++,r.galleryInfoId=r.tabs[0].id,r.blockVisible=!0),i===r.data.length-1&&0===r.actives&&(r.blockVisible=!1)},function(e){a.active&&(r.galleryInfoId=r.tabs[0]&&r.tabs[0].id,r.actives++,r.tabs[0]&&(r.tabs[0].active=!0))})})},templateUrl:e.tmplPath("photoBankTabs/photoBankTabs.tpl.html")}}]),angular.module("mosapp.carousel.withminiatures",["ngSanitize","slick","angular-click-outside"]).directive("mosCarouselWithMiniatures",["UrlSrvc","$timeout","$window","$interval","toolsSrvc","$modal","$popover",function(N,j,e,R,t,U,z){return{restrict:"A",scope:{items:"=",responsive:"=?",container:"@",css:"=",cssBreakpoints:"="},templateUrl:N.tmplPath("carouselWithMiniatures/carouselWithMiniatures.tpl.html"),link:function(n,e){var a,i,r,s,o=6,l=e.find(".b-carousel-with-miniatures__carousels"),t=e.closest(n.container),c=(e.on("$destroy",function(){n.$destroy(),$(document).off("keyup.mos-carousel")}),n.showInfo=!1,n.maxZoom=2,n.mainSlider=e.find(".b-carousel-with-miniatures__carousel_main"),n.mainSlider.hide(),n.navSlider=e.find(".b-carousel-with-miniatures__carousel_nav-items"),e.find(".b-carousel-with-miniatures__dots"));function d(){n.slidesToShow===n.items.length||n.navSlick.currentSlide+1===n.items.length?n.hideNavNext=!0:n.hideNavNext=!1,n.slidesToShow===n.items.length||0===n.navSlick.currentSlide?n.hideNavPrev=!0:n.hideNavPrev=!1}function m(){n.navSlider.on("init",function(e,t){j(function(){n.navSlick=t,$(window).off("resize.slick.slick-"+n.navSlick.instanceUid),n.navSlick.currentSlide=n.mainSlick.currentSlide,n.slidesToShow=p(),n.slidesToShow!==n.items.length&&n.navSlick.setPosition(),d(),p()},10)}),n.navSlider.slick({slidesToShow:n.slidesToShow,slidesToScroll:1,infinite:!1,speed:700,cssEase:"ease",arrows:!1,asNavFor:n.mainSlider,slide:".b-carousel-with-miniatures .nav-item",focusOnSelect:!0,waitForAnimate:!0,responsive:!1})}function p(){for(var e=n.items.length>o?o:n.items.length,t=0,a=0,i=0;i<e;i++){var r=t+104;r+24<n.mainSlider[0].clientWidth&&(t=r,a+=1)}if(n.navSlider.css("max-width",t),n.slidesToShow=a,!n.navSlick)return a;var s=n.navSlick.currentSlide;n.navSlick.slickSetOption("slidesToShow",a,!0),n.navSlider.slick("setSlideClasses",s),n.navSlick.currentSlide=s,d()}j(function(){n.mainSlider.on("init",function(e,t){n.mainSlick=t,n.imgTitle=n.items[0]?n.items[0].originalTitle:"",n.imgCopyright=n.items[0]?n.items[0].copyright:"",m(),n.mainSlick.$list.on("touchstart mousedown",function(e){a=e.clientX,i=e.clientY}),n.mainSlick.$list.on("touchend mouseup mouseleave",function(e){var t=Math.abs(a-e.clientX),e=Math.abs(i-e.clientY);t<10&&e<10&&n.openImage()})}),n.mainSlider.show(0,function(){n.mainSlider.slick({slidesToShow:1,slidesToScroll:1,infinite:!0,speed:700,cssEase:"ease",arrows:!1,slide:".b-carousel-with-miniatures .main-item",waitForAnimate:!0,appendDots:c,dots:!0})}),n.mainSlider.on("beforeChange",function(e,t,a,i){n.imgTitle=n.items[i]?n.items[i].originalTitle:"",n.imgCopyright=n.items[i]?n.items[i].copyright:"",n.showInfo=!1,n.popover&&(n.popover.destroy(),n.popover=null),n.navSlider.slick("setSlideClasses",i),n.navSlick&&n.slidesToShow<n.items.length&&(n.navSlick.slickGoTo(i,!1),d())}),n.mainSlider.on("afterChange",function(e,t,a){n.navSlider.slick("setSlideClasses",a)});var e=Math.floor(101*Math.random())+200;R(function(){n.paneWidth=t.width()},e),n.$watch("paneWidth",function(e,t){n.mainSlick&&n.navSlick&&e&&(!e||e!==t||l.width()!==n.paneWidth)&&n.mainSlick.setPosition()}),n.$watch(function(){return window.innerWidth},function(e){j.cancel(n.t),n.t=j(function(){767<e?(n.navSlick?p:m)():n.navSlick&&(n.navSlider.slick("unslick"),n.navSlick=null),n.popover&&(n.popover.destroy(),n.popover=null),n.showInfo=!1},100)})},0),n.nextSlide=function(){n.mainSlider.slick("next")},n.prevSlide=function(){n.mainSlider.slick("prev")},n.nextPreview=function(){n.mainSlider.slick("next")},n.prevPreview=function(){n.mainSlider.slick("prev")},n.showPopover=function(){n.popover||(r=e.find(".b-carousel-with-miniatures__popover"),n.popover=z(r,{scope:n,animation:!1,title:"",content:n.imgTitle?n.imgTitle+(n.imgCopyright?" | "+n.imgCopyright:""):n.imgCopyright,placement:"top-right",prefixClass:"mos-carousel",type:"popover",prefixEvent:"mosCarouselPopover",trigger:"manual",container:r,target:r,autoClose:!0,viewport:{selector:".b-carousel-with-miniatures__popover",padding:0}})),n.popover.$isShown?n.popover.hide():j(n.popover.show),n.showInfo=!n.showInfo},n.$on("mosCarouselPopover.show",function(e,t){var t=t.$element,a=parseInt(t.css("left")),i={opacity:1,right:0};!isNaN(a)&&0<a&&r.width()>t.width()&&44<t.height()&&(i.left=a-1),t.css(i)}),n.$on("mosCarouselPopover.hide",function(){n.showInfo=!1}),n.hidePopover=function(){n.popover&&n.popover.hide()};var u,g,h,f,v,y,_,w,b,k,S,P,T,x,A=document.body,M=document.documentElement;function C(){b.height()<=_.height()?_.addClass("mos-carousel-w-m-popup_center"):_.removeClass("mos-carousel-w-m-popup_center")}function I(e,t){w.width(y.clientWidth),e.css({width:""}),t.find("div").css({width:""}),b.css({"max-width":""}),t.css({width:b[0].clientWidth}),g.css("width",b[0].clientWidth),u.slick("slickSetOption","swipe",!0),D(),t.css({height:y.clientHeight-1}),n.zoomWidth=null}function D(){var e=window.innerWidth;1!==n.zoom?(v.css("display","none"),h.css("display","none")):(v.css("display",""),h.css("display","")),e=(767<e?v:h).outerHeight(),1!==n.zoom?E():_.css({bottom:e+10})}function E(){_.css({bottom:""})}function L(){var e=parseInt(b.css("padding-top"));_.find(".carousel-main__item").each(function(){$(this).css("height",y.clientHeight-(isNaN(e)?0:e))})}function O(e){return[e.pageY,e.pageX,!1]}n.$on("mosCarouselWM.show",function(e,t){s=window.pageYOffset||A.scrollTop,A.style.position="fixed",A.style.top=-s+"px",A.style.width="100%",document.activeElement.blur(),y=document.querySelector(".mos-carousel-w-m-popup"),_=$(y),w=$(y.querySelector(".mos-carousel-w-m-popup__carousels-wrap")),b=$(y.querySelector(".mos-carousel-w-m-popup__carousels")),w.width(y.clientWidth),n.zoom=1,k=n.mainSlider.slick("slickCurrentSlide");var a=y.querySelector(".mos-carousel-w-m-popup__carousel_main"),a=(u=$(a),y.querySelector(".mos-carousel-w-m-popup__carousel_nav-items")),i=(v=$(y.querySelector(".mos-carousel-w-m-popup__carousel_nav")),f=$(a),h=_.find(".mos-carousel-w-m-popup__carousel_dots"),_.find(".carousel-main__item").each(function(){var e=$(this),t=e.find("img");e.addClass(1<t[0].width/t[0].height?"carousel-main__item_wide":"carousel-main__item_tall"),e.css("height",e.height())}),u.on("init",function(e,t){_.removeClass("mos-carousel-w-m-popup_height"),u.css("visibility",""),(g=u.find(".slick-list")).css("width",b[0].clientWidth),t.setPosition()}),u.slick({accessibility:!1,slidesToShow:1,slidesToScroll:1,initialSlide:k,infinite:!0,slide:".mos-carousel-w-m-popup__carousel_main .carousel-main__item",asNavFor:f,cssEase:"ease",speed:700,arrows:!1,focusOnSelect:!0,adaptiveHeight:!0,waitForAnimate:!0,touchMove:!1,swipe:!0,appendDots:h,dots:!0,responsive:[{breakpoint:768,settings:{touchMove:!0}}]}),u.on("beforeChange",function(e,t,a,i){a!==i&&(1<n.zoom&&I((i=u.find('[data-slick-index="'+a+'"]')).find("img"),i),n.zoom=1)}),u.on("afterChange",function(e,t,a){k!==a&&(k=a,C(),_.mCustomScrollbar("update"),D(),L())}),n.items.length>o?o:n.items.length);f.css("max-width",72*i+"px"),f.on("init",function(){v.css("visibility","")}),j(function(){f.slick({accessibility:!1,slidesToShow:1<i?i-1:i,slidesToScroll:1,initialSlide:k,infinite:!0,cssEase:"ease",speed:700,arrows:!1,focusOnSelect:!0,variableWidth:!0,asNavFor:u,waitForAnimate:!0}),j(function(){D(),C(),L()})},50),_.mCustomScrollbar({axis:"yx",scrollInertia:500,advanced:{updateOnContentResize:!1,autoExpandHorizontalScroll:!0},documentTouchScroll:!0,keyboard:{enable:!1}}),C(),S=_.data("mCS"),P=_.find(".mCSB_container"),_.find(".mCSB_scrollTools_vertical"),_.find(".mCSB_scrollTools_horizontal"),$(window).on("resize.mos-carousel",function(){var e=1!==n.zoom?n.zoomWidth*n.zoom:0;e<y.clientWidth?w.width(y.clientWidth):w.width(e),g.css("width",b[0].clientWidth),D(),L(),u.slick("setPosition"),C(),_.mCustomScrollbar("update")}),$(document).on("keyup.mos-carousel",function(e){e=e.keyCode;27===e?t.hide():37===e?u.slick("prev"):39===e&&u.slick("next")})}),n.$on("mosCarouselWM.hide",function(){n.isOpenedPopup=!1;var e=u.slick("slickCurrentSlide");n.mainSlick.currentSlide!==e&&n.mainSlick.slideHandler(e,!0,!0),A.style.position="",A.style.width="",A.style.top="",M.scrollTop=s,A.scrollTop=s,$(window).off("resize.mos-carousel"),$(document).off("keyup.mos-carousel")}),n.openImage=function(){n.isOpenedPopup||(n.popup=U({scope:n,template:N.tmplPath("carouselWithMiniatures/carouselWithMiniaturesPopup.tpl.html"),prefixClass:"mos-carousel-w-m-popup",prefixEvent:"mosCarouselWM",backdropAnimation:"am-fade",placement:"center",backdrop:"static"}),n.isOpenedPopup=!0)},n.nextPopupSlide=function(){u.slick("next")},n.prevPopupSlide=function(){u.slick("prev")},n.zoomIn=function(){var e=Math.round(10*(n.zoom+.2))/10;2<e&&(e=2);{var t,a,i;n.zoom!==e&&(n.zoom=e,t=u.find('[data-slick-index="'+k+'"]'),a=t.find("img"),n.zoomWidth||(n.zoomWidth=a.width()),(i=n.zoomWidth*e)>b.width()&&(b.css({"max-width":"none"}),t.css({width:i>y.clientWidth?i:y.clientWidth})),t.css({height:"auto"}),t.find("div").css({width:i}),i>w[0].clientWidth&&w.width(i),a.css({width:"100%"}),1<e&&u.slick("slickSetOption","swipe",!1),u.slick("setHeight"),g.css("width",b[0].clientWidth),D(),C(),_.mCustomScrollbar("update"))}},n.zoomOut=function(){var e=Math.round(10*(n.zoom-.2))/10;e<1&&(e=1);{var t,a,i;n.zoom!==e&&(n.zoom=e,t=u.find('[data-slick-index="'+k+'"]'),a=t.find("img"),n.zoomWidth||(n.zoomWidth=a.width()),1!==e?((e=n.zoomWidth*e)<y.clientWidth?w.width(y.clientWidth):w.width(e),i=b.width(),e<i?t.css({width:i}):t.css({width:e>y.clientWidth?e:y.clientWidth}),t.find("div").css({width:e}),D()):I(a,t),u.slick("setHeight"),g.css("width",b[0].clientWidth),C(),_.mCustomScrollbar("update"))}},n.onPinchZoom=function(e,t){e.preventDefault(),1<t?n.zoomIn():n.zoomOut()},n.onMouseSwipeStart=function(e){if(1===n.zoom)return!0;_.mCustomScrollbar("stop"),(new Date).getTime();var e=O(e),t=P.offset();x=e[0]-t.top,T=e[1]-t.left},n.onMouseSwipe=function(e){if(1===n.zoom)return!0;e.stopImmediatePropagation(),(new Date).getTime();var e=O(e),t=_.offset(),a=e[0]-t.top,e=e[1]-t.left;P[0].idleTimer=250,S.overflowed[0]&&0<x-a&&_.mCustomScrollbar("scrollTo",[x-a,null],{scrollEasing:"mcsLinearOut",dur:0,dir:"y",drag:!0,overwrite:"all"}),S.overflowed[1]&&0<T-e&&_.mCustomScrollbar("scrollTo",[null,T-e],{scrollEasing:"mcsLinearOut",dur:0,dir:"x",drag:!0,overwrite:"none",timeout:0})}}}}]).directive("zoomableImage",["UrlSrvc",function(e){return{restrict:"A",scope:{imageSrc:"=",onMouseSwipeStart:"=",onMouseSwipe:"=",onPinchZoom:"="},templateUrl:e.tmplPath("carouselWithMiniatures/zoomableImage.tpl.html"),link:function(a,e,t){var i,r,s,n,o="",l=0,c=1,d=1,m=1,p=parseInt(t.maxScale,10),u=((isNaN(p)||p<=1)&&(p=3),0),g=0,h=0,f=0,v=0,y=0,_=0,w=0,b=0,k=0,S=e.find("img");function P(e){-1<e.type.indexOf("mouse")?(e=e.originalEvent||e,_=e.clientX,w=e.clientY,h=u,f=g,n=!(k=b=0),a.onMouseSwipeStart&&a.onMouseSwipeStart(e)):(e=(e.originalEvent||e).touches,_=e[0].clientX,w=e[0].clientY,h=u,f=g,k=b=0)}function T(e){var t;-1<e.type.indexOf("mouse")?n&&(e=e.originalEvent||e,b=e.clientX-_,k=e.clientY-w,u=h+b,g=f+k,a.onMouseSwipe&&a.onMouseSwipe(e)):(t=(e.originalEvent||e).touches,""===o&&(1===t.length&&1<c?o="swipe":2===t.length&&(o="pinch",m=c,l=A(t),v=t[0].clientX-parseInt((t[0].clientX-t[1].clientX)/2,10)-S[0].offsetLeft-h,y=t[0].clientY-parseInt((t[0].clientY-t[1].clientY)/2,10)-S[0].offsetTop-f)),"swipe"===o?(b=t[0].clientX-_,k=t[0].clientY-w,u=h+b,g=f+k):"pinch"===o&&2===t.length&&(s=A(t),c=(d=s/l)*m,u=v*(1-d)+h+b,g=y*(1-d)+f+k,t=e,a.onPinchZoom&&a.onPinchZoom(t,c)))}function x(e){-1<e.type.indexOf("mouse")?(e=e.originalEvent||e,n=!1):(e=(e.originalEvent||e).touches,""===o||0<e.length||(c<1?(c=1,g=u=0):p<c?(u=v*(1-(d=(c=p)/m))+h+b,g=y*(1-d)+f+k):(0<u?u=0:u<i*(1-c)&&(u=i*(1-c)),0<g?g=0:g<r*(1-c)&&(g=r*(1-c))),o=""))}function A(e){e=2===e.length?Math.sqrt(Math.pow(e[0].clientX-e[1].clientX,2)+Math.pow(e[0].clientY-e[1].clientY,2)):0;return parseInt(e,10)}S[0].onload=function(){i=S[0].clientWidth,r=S[0].clientHeight,S.css({"-webkit-transform-origin":"0 0","transform-origin":"0 0"}),S.on("touchstart mousedown",P),S.on("touchmove mousemove",T),S.on("touchend mouseup mouseleave",x)}}}}]),angular.module("mosapp.mosLightbox",[]).directive("mosLightbox",["$modal","UrlSrvc","$timeout","loader",function(se,ne,oe,le){return{restrict:"A",scope:{fullImageLink:"@",description:"@",prefixClass:"@",scrollOn:"@",container:"@"},template:"",link:function(i,n,e){var r,s,a,o,l,c,d,m=document.body,t=document.documentElement,p=angular.element(document),u=angular.element(window),g=i.container&&n.parents(i.container),h=parseInt(n.attr("width")),f=parseInt(n.attr("height")),v=!h&&(f||0);function y(e,t,a,i,r,s){!t&&e!=a||t&&t!=a?(n.attr("height",Math.ceil(a/s)),!t&&f&&g&&g.width()>a&&i<r&&(e=Math.ceil(g.width()/s),n.attr("height",r<e?r:e))):t===a&&r&&n.attr("height",r)}function U(){var e=angular.element(n);i.popupImage={src:i.fullImageLink||e.attr("src"),description:i.description||(e.attr("data-jsalt")?"":e.attr("alt"))},i.popup=se({scope:i,template:ne.tmplPath("mosLightbox/mosLightbox.tpl.html"),show:!1,prefixClass:"mos-lightbox",prefixEvent:"mos-lightbox",backdropAnimation:"am-fade",placement:"center",backdrop:"static"}),i.popup.$promise.then(function(){i.popup.show();var e,t=angular.element(i.popup.$element),a=t.find(".mos-lightbox-popup-modal__cont");le.switchOn(a),i.popupImage&&i.popupImage.src&&(e=new Image,s=$(e),r=$(i.popup.$element),e.onload=function(){le.switchOff(a),t.find(".mos-lightbox-popup-modal__wrapper").prepend(e),oe(function(){r.addClass("positioned"),u.on("resize.popup",B)},10)},s.on("mousedown",Y),s.on("mousemove",H),s.on("mouseup mouseleave",Q),s.on("touchstart pointerdown",te),s.on("touchmove pointermove",ae),s.on("touchend pointerup",ie),e.src=i.popupImage.src)})}f||n.attr("height",""),i.maxZoom=2,i.$on("$destroy",function(){p.off("keyup.mos-lightbox"),u.off("resize.lightboxImage")}),n.on("load",function(){var a=this.naturalWidth,e=this.naturalHeight,i=h&&f?h/f:a/e,e=n.width(),t=n.height();h&&(y(a,h,e,t,v,i),u.on("resize.lightboxImage",function(){var e=n.width(),t=n.height();y(a,h,e,t,v,i)}))}),i.$on("mos-lightbox.show",function(e,t){i.zoom=1,o=null,a=window.pageYOffset||m.scrollTop,m.style.position="fixed",m.style.top=-a+"px",m.style.width="100%",p.on("keyup.mos-lightbox",function(e){27===e.keyCode&&t.hide()}),(l=r.find(".mos-lightbox-popup-modal__cont-wrapper")).width(r.width()),c=r.find(".mos-lightbox-popup-modal__cont"),d=r.find(".mos-lightbox-popup-modal__wrapper"),l.css({height:r.height()}),r.mCustomScrollbar({axis:"yx",scrollbarPosition:"inside",theme:"minimal-dark",advanced:{updateOnImageLoad:!0,autoExpandHorizontalScroll:!0}}),P(),w=r.data("mCS"),b=r.find(".mCSB_container"),r.find(".mCSB_scrollTools_vertical"),r.find(".mCSB_scrollTools_horizontal"),touchMoveY=[],touchMoveX=[]}),i.$on("mos-lightbox.hide",function(){m.style.position="",m.style.width="",m.style.top="",t.scrollTop=a,m.scrollTop=a,u.off("resize.popup"),p.off("keyup.mos-lightbox")}),i.hidePop=function(){i.popup&&(i.popup.hide(),i.popup=null)};var _,w,b,k,S,z,F,q=angular.element(n);function B(){var e=1!==i.zoom?o*i.zoom:0;e<r[0].clientWidth?l.width(r[0].clientWidth):l.width(e),r.mCustomScrollbar("update")}function P(){c.outerHeight()<=r.height()?r.addClass("mos-lightbox-popup-modal_center"):r.removeClass("mos-lightbox-popup-modal_center")}function G(e){var t,e=V(i.zoom,e=e||.2);i.zoom!==(e=2<e?2:e)&&(t=(o=o||s.width())*e,c.width(t),t>l.width()&&l.css({"max-width":"none"}),s.height()>=d.height()&&l.css({height:"auto"}),t>l[0].clientWidth&&l.width(t),s.css({width:"100%"}),i.zoom=e,P(),r.mCustomScrollbar("update"))}function W(e){var t,e=V(i.zoom,-(e=e||.2));i.zoom!==(e=e<1?1:e)&&(1!==e?((t=o*e)<r[0].clientWidth?l.width(r[0].clientWidth):l.width(t),c.width(t)):(l.css({"max-width":"",width:r[0].clientWidth,height:r[0].clientHeight}),c.css({width:""}),s.css("width","")),i.zoom=e,P(),r.mCustomScrollbar("update"))}function V(e,t){return e=e||1,Math.round(10*(e+t))/10}function Y(e){e=e.originalEvent||e,_=!0,(new Date).getTime();var e=J(e),t=b.offset();S=e[0]-t.top,k=e[1]-t.left}function H(e){var t,a;_&&((e=e.originalEvent||e).preventDefault(),e.stopImmediatePropagation(),(new Date).getTime(),e=J(e),t=r.offset(),a=e[0]-t.top,e=e[1]-t.left,touchMoveY.push(a),touchMoveX.push(e),b[0].idleTimer=250,w.overflowed[0]&&0<S-a&&r.mCustomScrollbar("scrollTo",[S-a,null],{scrollEasing:"mcsLinearOut",dur:0,dir:"y",drag:!0,overwrite:"all"}),w.overflowed[1]&&0<k-e&&r.mCustomScrollbar("scrollTo",[null,k-e],{scrollEasing:"mcsLinearOut",dur:0,dir:"x",drag:!0,overwrite:"none",timeout:0}))}function Q(){_=!1}function J(e){return[e.pageY,e.pageX,!1]}q.on("click",function(e){e.stopPropagation(),U()}),q.parent(".mos-lightbox__wrapper").on("click",function(e){e.preventDefault(),U()}),i.zoomIn=G,i.zoomOut=W;var T="",Z=0,X=0,x=1,A=1,M=1,C=parseInt(e.maxScale,10),I=((isNaN(C)||C<=1)&&(C=3),0),D=0,E=0,L=0,O=0,N=0,K=0,ee=0,j=0,R=0;function te(e){var t=(e.originalEvent||e).touches;t?(K=t[0].clientX,ee=t[0].clientY,E=I,L=D,R=j=0):e.stopPropagation()}function ae(e){var t=(e.originalEvent||e).touches;t?(""===T&&(1===t.length&&1<x?T="swipe":2===t.length&&(T="pinch",M=x,X=re(t),O=t[0].clientX-parseInt((t[0].clientX-t[1].clientX)/2,10)-s[0].offsetLeft-E,N=t[0].clientY-parseInt((t[0].clientY-t[1].clientY)/2,10)-s[0].offsetTop-L)),"swipe"===T?(j=t[0].clientX-K,R=t[0].clientY-ee,I=E+j,D=L+R):"pinch"===T&&2===t.length&&(Z=re(t),I=O*(1-(A=Z/X))+E+j,D=N*(1-A)+L+R,(1<(x=A*M)?G:W)(.1))):e.stopPropagation()}function ie(e){var t=(e.originalEvent||e).touches;e.stopImmediatePropagation(),""===T||!t||0<t.length||(x<1?(x=1,D=I=0):C<x?(I=O*(1-(A=(x=C)/M))+E+j,D=N*(1-A)+L+R):(0<I?I=0:I<z*(1-x)&&(I=z*(1-x)),0<D?D=0:D<F*(1-x)&&(D=F*(1-x))),T="")}function re(e){e=2===e.length?Math.sqrt(Math.pow(e[0].clientX-e[1].clientX,2)+Math.pow(e[0].clientY-e[1].clientY,2)):0;return parseInt(e,10)}}}}]),angular.module("mosapp.embeddedcontent",["mosapp.2gis.map","mosapp.carousel.withminiatures","mosapp.filters.prepareDateSince"]).directive("embedLifehack",[function(){return{restrict:"A",replace:!0,scope:{item:"="},template:['<div class="embed-lifehack">','<div class="embed-lifehack__title">{{item.data.title}}</div>','<a class="embed-lifehack__link" data-translate="embedLifehack.btn" data-ng-href="{{item.url}}"></a>',"</div>"].join(""),link:function(){}}}]).directive("embedMedia",["$filter","UrlSrvc",function(e,t){return{restrict:"A",replace:!0,scope:{item:"=",type:"@"},template:['<div class="embed-media" data-ng-class="{\'embed-media_no-image\': !item.data.image}">','<a class="embed-media__image" data-ng-if="item.data.image" target="{{item.target}}" data-ng-href="{{item.url}}" data-image-set-element="item.data.image"></a>','<span class="embed-media__icon icon-media-{{icon}}"></span>','<a class="embed-media__title" target="{{item.target}}" data-ng-href="{{item.url}}">','<div data-ng-if="item.data.date_timestamp" class="embed-media__date">{{item.data.date_timestamp*1000 | prepareDateSince : \'d MMM\' }}</div>',"{{item.data.title}}</a>","</div>"].join(""),link:function(e){switch(e.item.url&&(t.isExternalUrl(e.item.url)?e.item.target="_blank":e.item.target="_top"),e.type){case"media_photo":e.icon="camera";break;case"media_video":e.icon="play";break;case"main_media_photo":e.icon="camera";break;case"main_media_video":e.icon="play";break;default:e.icon=e.type}}}}]).directive("embedMap",[function(){return{restrict:"A",scope:{item:"="},template:['<div class="" data-mos2-gis-map="" data-controls="zoom">','<div data-mos2-gis-map-marker="" data-lat-lng="{x: item.data.lng, y:  item.data.lat}" ','data-focus="true" data-focus-zoom="16" ',"data-icon-url=\"{{'map_marker.svg' | imagesPath}}\" ",'data-width="20" data-height="28"\tdata-icon-offset-x="10" ','data-icon-offset-y="0" data-label="item.data.title">',"</div>","</div>"].join(""),link:function(){}}}]).directive("embedAudio",["$sce",function(t){return{restrict:"A",scope:{item:"="},template:'<audio class="embed-audio" data-mos-audio-player="" src="{{source}}" data-audio-title="item.data.title" data-audio-href="{{item.data.source}}" data-audio-format="mp3"></div>',link:function(e){e.source=t.trustAsResourceUrl(e.item.data.source)}}}]).directive("embedVideo",["$sce",function(t){return{restrict:"A",scope:{item:"="},template:"<video data-mos-video-player=\"\" src=\"{{source}}\" data-ng-style=\"{'background-image': background, 'background-size': 'cover'}\"></video>",link:function(e){e.background='url("'+e.item.data.poster+'")',e.source=t.trustAsResourceUrl(e.item.data.source),e.sources=[{mp4:e.source}]}}}]).directive("embedGallery",["toolsSrvc",function(s){return{restrict:"A",scope:{item:"=",additionals:"=",container:"@"},template:'<div data-mos-carousel-with-miniatures="" data-items="images" data-container="{{container}}"></div>',link:function(e){e.container=e.container||".article-content__text-wrap",e.images=[];for(var t=0;t<e.item.data.length;t++){var a,i,r=e.item.data[t];angular.isObject(r)&&angular.isObject(r.original)&&(a={},""===(i=r.title||"")&&(a=s.getMetaForImage(e.additionals)),e.images.push({src:r.original.src,alt:i||a.alt,title:i||a.title,originalTitle:i,copyright:r.copyright}))}}}}]).directive("embedEhdMap",["$timeout","mosconfig",function(t,a){return{restrict:"A",scope:{},compile:function(e){e.addClass("data-mos-map"),t(function(){var e;a.mapsLoaderPath&&(document.querySelector('script[src*="'+a.mapsLoaderPath+'"]')?window.$mosMaps&&window.$mosMaps.registerMaps():((e=document.createElement("script")).async=!0,e.src=a.mapsLoaderPath,$("body").append(e)))},0)}}}]),angular.module("mosapp.embeddedcontent").service("embeddedContentSrvc",["$compile","toolsSrvc",function(r,s){this.replaceEmbedContent=function(e,t,a,i){a=a||"attach";for(var r=e.find("[data-entity]"),s={lifehack:0,media_photo:0,media_video:0,main_media_photo:0,main_media_video:0,presentation:0,map:0,audio:0,video:0,gallery:0},n=0;n<r.length;n++){var o,l=angular.element(r[n]),c=l.data("entity"),d=-1;if(s[c]++,t&&t.length)for(var m=0;m<t.length;m++)t[m].marker===c+"_"+s[c]&&(d=m);d<0&&["ehd-map"].indexOf(c)<0||("gallery"===c?l.replaceWith('<div class="embed-gallery" data-type="'+c+'" data-embed-gallery="" data-container=".article__text-event" data-item="'+a+"["+d+']"></div>'):"ehd-map"===c?(o=$("<div data-embed-"+c+'=""></div>'),angular.forEach(l[0].dataset,function(e,t){o[0].dataset[t]=e}),l.replaceWith(o)):"media_photo"===c||"media_video"===c||"main_media_photo"===c||"main_media_video"===c||"presentation"===c||"infographic"===c?l.replaceWith('<div class="embed-media" data-type="'+c+'" data-embed-media="" data-item="'+a+"["+d+']"></div>'):l.replaceWith('<div class="embed-'+c+'" data-embed-'+c+'="" data-item="'+a+"["+d+']" data-additionals="'+i+'"></div>'))}},this.replaceBlockquote=function(e,t){var a=t.attr("data-quote");{var i;a&&(e.inlineQuotes||(e.inlineQuotes=[],e.metaAlt=[],e.metaTitle=[]),e.inlineQuotes.push({quote:a,personImage:t.attr("data-person-image"),personName:t.attr("data-person-name"),personPosition:t.attr("data-person-position")}),a=e.inlineQuotes.length-1,i=e.inlineQuotes[a],e.metaAlt[a]=s.getMetaForImage(i.personName+". "+i.personPosition).alt,e.metaTitle[a]=i.personName,i=r(['<div class="inline-blockquote">','<div class="inline-blockquote__line"></div>','<div class="inline-blockquote__content">','<div class="inline-blockquote__quote" data-ng-show="inlineQuotes['+a+'].quote">{{inlineQuotes['+a+"].quote}}</div>",'<div class="inline-blockquote__author">','<div class="author">','<img class="author__image" alt="{{metaAlt['+a+']}}" title="{{metaTitle['+a+']}}" data-ng-src="{{inlineQuotes['+a+'].personImage}}"/>','<div class="author-info">','<div class="author-info__name">{{inlineQuotes['+a+"].personName}}</div>",'<div class="author-info__post">{{inlineQuotes['+a+"].personPosition}}</div>","</div>","</div>","</div>","</div>","</div>"].join(""))(e),t.replaceWith(i))}}}]),angular.module("mosapp.2gis.map",[]).directive("mos2GisMap",["UrlSrvc","mosconfig","$q","apiSrvc","$timeout","$interval","$filter","LangSrvc","GIS2srvc","mos2GisMapSrvc",function(e,t,a,i,l,r,s,c,d,m){return{restrict:"A",scope:{center:"=?",height:"=?",zoom:"=?",onClick:"&",controls:"@?",onMapReady:"&",eventsMap:"=?",scrollZoom:"@?"},transclude:!0,controller:["$scope",function(e){e.mapDeffered=a.defer(),this.getMap=function(){return e.mapDeffered.promise},this.getMapId=function(){return e.mapId}}],link:function(t,e,a,i){var r=t.mapDeffered,s=(t.center=t.center||{y:55.751206,x:37.61778},t.zoom=a.zoom?parseInt(t.zoom):12,t.zoom=isNaN(t.zoom)?12:t.zoom,"false"!==t.scrollZoom),n={};function o(){r.promise.then(function(e){l(function(){e.invalidateSize()},100)})}t.eventsMap?(n.zoom=!1,n.fullScreen=!1):(n.zoom=!0,n.fullScreen=!0),t.map=null,t.mapId="map"+(new Date).getTime(),t.mapElement=$('<div id = "'+t.mapId+'"/>').width("auto"),t.height&&t.mapElement.height(t.height),e.attr("data-map-id",t.mapId),$(e).append(t.mapElement),l(function(){t.loader=$('<div class="loader"><div class="loader-image"><div class="cssload-progress cssload-float cssload-shadow"><div class="cssload-progress-item"></div></div></div></div>').appendTo(t.mapElement)},10),t.zoomIn=function(){gcapi.SetZoomLevelPlus()},t.zoomOut=function(){gcapi.SetZoomLevelMinus()},t.$on("$destroy",function(){angular.element(window).off("resize",o)}),d.loadLibrary().then(function(){function e(){t.loader.remove(),t.mapLoadedAndReady=!0,r.resolve(t.map);var e=c.getCurrentLang();"ru"!==e&&t.map.setLang(e)}return DG.then(function(){return DG.config=Object.assign(DG.config,{tileServer:"//tile{s}.maps.2gis.com/tiles?x={x}&y={y}&z={z}&v=1&ts=online_sd&layerType=nc",retinaTileServer:"//tile{s}.maps.2gis.com/tiles?x={x}&y={y}&z={z}&v=1&ts=online_hd&layerType=nc",poiMetaServer:"//tile{s}.maps.2gis.com/poi?x={x}&y={y}&z={z}&v=1&ts=online_sd&layerType=nc",retinaPoiMetaServer:"//tile{s}.maps.2gis.com/poi?x={x}&y={y}&z={z}&v=1&ts=online_hd&layerType=nc"}),DG.plugin("//2gis.github.io/mapsapi/vendors/Leaflet.markerCluster/leaflet.markercluster-src.js")}).then(function(){if(t.map)return r.promise;t.map=DG.map(t.mapId,{scrollWheelZoom:s,center:[t.center.y,t.center.x],zoom:t.zoom,minZoom:9,zoomControl:n.zoom,fullscreenControl:n.fullScreen}),e(),d.add(t.mapId,t.map),m.setMap(t.mapId,t.map),m.setMapEl(t.mapId,t.mapElement),t.eventsMap&&DG.control.zoom({position:"bottomright"}).addTo(t.map),t.onMapReady&&"function"==typeof t.onMapReady&&t.onMapReady()}),window.onMapApiLoad=e,r.promise}).then(function(e){return a.onClick&&e.on("click",function(e){t.onClick({event:e})}),e}).then(function(){t.height||(angular.element(window).on("resize",o),o())}).then(function(){t.map.setView([t.center.y,t.center.x],t.zoom)})},templateUrl:e.tmplPath("mos2GisMap/mos2GisMap.tpl.html")}}]).service("mos2GisMapSrvc",[function(){var i={};return{setMap:function(e,t){i[e]={id:e,map:t,pointsLength:0,latlngs:[]}},getMap:function(e){if(e&&i[e]&&i[e].map)return i[e].map},setMapEl:function(e,t){i[e].el=t},getMapEl:function(e){if(e&&i[e]&&i[e].el)return i[e].el},setPointsLength:function(e,t){i[e].pointsLength=t,i[e].latlngs=[]},addLatLng:function(e,t){i[e].latlngs.push(t)},fitMap:function(e,t){t=t||{},i[e].pointsLength==i[e].latlngs.length&&0<i[e].pointsLength&&0<i[e].latlngs.length&&(i[e].map.invalidateSize(!0),i[e].map.fitBounds(DG.latLngBounds(i[e].latlngs,{}),t))},senterPoint:function(e,t){var a=i[e].map.getZoom();i[e].map.setView([t.lon,t.lat],13<a?a:13)}}}]),angular.module("mosapp.2gis.map").directive("mos2GisMapMarker",["UrlSrvc","mosconfig","$q","apiSrvc","$timeout","GIS2srvc","mosconfig",function(e,t,a,m,p,u,g){return{restrict:"A",scope:{address:"=?",latLng:"=?",label:"=?",labelClass:"=?",labelPosition:"=?",focus:"=?",focusZoom:"@?",iconUrl:"@",width:"@?",height:"@?",iconClass:"@?",onClick:"&?"},link:function(a,e,t){var i,r;function s(){var e=DG.icon({iconUrl:a.iconUrl,iconSize:[a.width,a.height],iconClass:a.iconClass||""}),e=(a.marker=DG.marker([a.latLng.y,a.latLng.x],{icon:e}).addTo(a.map),{}),t=(a.labelPosition&&(e.position=DG.point(a.labelPosition.x,a.labelPosition.y)),a.labelClass&&(e.className=a.labelClass),a.label&&a.marker.bindLabel(a.label,e),a.marker.on("dblclick",c),a.marker.on("click",l),[]);a.map.eachLayer(function(e){e._latlng&&t.push(e._latlng)}),t.length&&a.map.fitBounds(DG.latLngBounds(t,{}))}function n(e){var t;if(!e.result||!e.result.length)return console.log("2GisMapMarker: cannot detect address ",address);e=e.result[0].selection;2===(t=e?e.replace("POINT(","").replace(")","").split(" "):t).length&&(a.latLng={x:t[0],y:t[1]},s())}function o(){a.focusZoom=parseInt(t.focusZoom),a.focusZoom=isNaN(a.focusZoom)?13:a.focusZoom,a.latLng&&a.focus&&(a.map.setView([a.latLng.y,a.latLng.x],a.focusZoom),a.onClick&&a.onClick())}function l(){a.onClick&&a.onClick()}function c(){a.map.setView([a.latLng.y,a.latLng.x],11)}function d(){a.marker&&a.marker.remove()}i=$(e).closest("[data-mos2-gis-map]"),p(function e(){var t;r=i.attr("data-map-id"),a.map=u.get(r),a.map?(a.$watch("iconUrl",function(e,t){e!==t&&(a.iconUrl=e,a.marker.remove(),s())}),a.$watch("focus",o),a.$on("$destroy",d),a.latLng&&s(a.latLng),a.address&&(t={q:function(e){if(!e)return"";e=e.split(",");6===e[0].length&&angular.isNumber(+e[0])&&e.shift();return e.join(" ")}(t=a.address),key:"rukrlf1286",version:"1.3"},m.getDataByUrl(g["2GisApi"].search_url,t,!0).then(n))):p(e,100)},100)}}}]),angular.module("mos.embed.social",[]).directive("embedSocial",["UrlSrvc","$sce","embedSocialSrvc",function(e,t,l){return{restrict:"EA",scope:{code:"@"},link:function(e,t,a,i){t.on("$destroy",function(){e.$destroy(),"function"==typeof l.offIframeWatcher&&l.offIframeWatcher()});var r,s=[{name:"facebook-video",regexp:/facebook\.com\/plugins\/video\.php/},{name:"facebook-post",regexp:/facebook\.com\/plugins\/post\.php/},{name:"instagram",regexp:/instagram\.com/},{name:"vk",regexp:/vk\.com/}],n=decodeURIComponent(escape(window.atob(e.code)));$(t).find(".embed-social").append(n);for(var o=0;o<s.length;o++)s[o].regexp.test(n)&&(r=s[o].name);switch(r){case"facebook-video":e.displayBlock=!0,e.responsiveFrame=!0;break;case"facebook-post":e.displayBlock=!0;break;case"instagram":e.displayBlock=!0,window.instgrm&&window.instgrm.Embeds&&window.instgrm.Embeds.process();break;case"vk":e.displayBlock=!0}},templateUrl:e.tmplPath("00_mosNewsfeed/mosEmbedSocial/mosEmbedSocial.tpl.html")}}]).service("embedSocialSrvc",function(){this.offIframeWatcher=null}),angular.module("mosapp.copyright",[]).directive("mosCopyright",["UrlSrvc",function(e){return{restrict:"A",link:function(e,t,a,i){},scope:{title:"=",copyright:"="},templateUrl:e.tmplPath("mosCopyright/mosCopyright.tpl.html")}}]),angular.module("mosapp.hiddenList",["mgcrea.ngStrap","mosapp","ngAnimate"]).directive("mosHiddenList",["$tooltip","$sce","$window","UrlSrvc",function(l,e,c,d){return{restrict:"A",priority:0,link:function(t,e,a){var i,r,s=angular.element(c),n=(e.on("$destroy",function(){t.$destroy(),s.off("resize.hiddenList")}),o(),r=i,l(e,{scope:t,show:!1,target:"body",template:d.tmplPath("00_common/hiddenList/hiddenListPopup.tpl.html"),trigger:"manual",prefixEvent:"hiddenListPopup"}));function o(){i=Modernizr&&Modernizr.mq("(max-width: 767px)")}e.on("click",function(e){e.preventDefault(),t.onClick({evt:{widthLT768:i}}),i&&n.show()}),s.on("resize.hiddenList",function(){o(),r!==i&&function(){e.addClass("news-article-place_more-hidden"),i||n.hide();t.onReset()}();r=i}),t.$on("hiddenListPopup.show",function(e,t){t.$element.find(".hidden-list-popup__body").mCustomScrollbar()})},scope:{max:"=",list:"=",onClick:"&",onReset:"&",popupTitle:"@",noUrls:"@"}}}]),angular.module("mosapp").service("APsrvc",["UrlSrvc","$q","$rootScope","$window",function(s,e,n,o){var l={default:"audioPlayer",v4:"audioPlayer_v4"};this.playerLoad=function(r){return e(function(e,t){var a,i=r.skin&&l[r.skin]||l.default;n.audioPlayer?"ready"!==n.audioPlayer.status?(a=document.getElementById("jplayerapiscript"),$(a).on("load",function(){e()})):e():(n.audioPlayer={},n.audioPlayer.status="load",(a=document.createElement("script")).id="jplayerapiscript",a.async="true",document.getElementsByTagName("head")[0].appendChild(a),a.src=s.jsPath("jplayer/jquery.jplayer.min.js"),$(a).on("load",function(){n.audioPlayer.api=o.jPlayer,n.audioPlayer.status="ready",e()}),r.nocss||((a=document.createElement("link")).rel="stylesheet",a.href=s.jsPath("jplayer/skin/"+i+".css"),a.type="text/css",document.getElementsByTagName("head")[0].appendChild(a)))})}}]),angular.module("mosapp").value("apiQueue",[]).value("lastReq",!1).service("apiSrvc",["UrlSrvc","$http","$q","transformRequestAsFormPost","apiQueue","$timeout","loader","lastReq","LangSrvc",function(m,o,t,l,p,c,u,d,r){function g(){d&&(d=!1,c(function(){"function"==typeof window.callPhantom&&window.callPhantom({queue:"isempty"})},100))}o.defaults.headers.common["x-caller-id"]="markup-app",this.sendRequestFromQueue=function e(){var a,i,r,t,s,n=Math.floor(50*Math.random()+25);0<p.length&&(a={},angular.forEach(p[0],function(e,t){a[t]=p[0][t]}),"POST"===a.method?(t=(r=a).header,s=r.notTransform,t={url:r.url,method:"POST",data:r.params,headers:t},s||(t.transformRequest=l),o(t).success(function(e,t){var a;r.showError&&e.error&&(a={title:"Ошибка получения данных из API.",content:e.description,placement:"top",type:"warning",show:!0},e.errorMessage=a),u.switchOff(r.loaderEl),g(),r.resolve(e)}).error(function(e,t){u.switchOff(r.loaderEl),g(),r.reject({content:e,code:t})})):o({url:(i=a).url,method:"GET",params:i.params}).success(function(e,t){var a;i.showError&&e.error&&(a={title:"Ошибка получения данных из API.",content:e.description,placement:"top",type:"warning",show:!0},e.errorMessage=a),i.loaderEl&&!i.loaderEl.dontSwitchOff&&u.switchOff(i.loaderEl),g(),i.resolve(e,t)}).error(function(e,t){u.switchOff(i.loaderEl),g(),i.reject({content:e,code:t})}),p.shift(),0===p.length&&(d=!0)),c(e,n)};new Date;function h(e,t,a,i){return console.error("Object '"+e+"' not found! Check config, please."),u.switchOff(i),("function"==typeof a?a:t)({error:"Object '"+e+"' not found! Check config, please."}),!1}function f(a,e){var i=[];angular.forEach(e,function(e,t){-1<a.indexOf("%"+t+"%")&&(a=a.replace("%"+t+"%",e),i.indexOf(t)<0&&i.push(t))});for(var t=0;t<i.length;t++)delete e[i[t]];return a=-1<a.indexOf("[lang]")?a.replace("[lang]",r.getCurrentLang()):a}this.sendRequestFromQueue(),this.getData=function(r,s,n,o,l){return t(function(e,t){u.switchOn(l);var a=angular.copy(n),i=m.apiPath(r);if(!angular.isObject(i))return h(r,e,t,l);if(!(i=i[s]))return h(r+"."+s,e,t,l);angular.isObject(a);i=f(i,a);p.push({method:"GET",url:i,resolve:e,reject:t,params:a,showError:o,loaderEl:l})})},this.getDataByUrl=function(i,r,s,n){return t(function(e,t){u.switchOn(n);var a=angular.copy(r);if(!i)return h(i,e,t,n);angular.isObject(a);e={method:"GET",url:i=f(i,a),resolve:e,reject:t,params:a,showError:s,loaderEl:n};p.push(e)})},this.getDataCancelable=function(r,s,n,o,l){var c,e=t(function(e,t){u.switchOn(l);var a=angular.copy(n),i=m.apiPath(r);return angular.isObject(i)?(i=i[s])?(angular.isObject(a),i=f(i,a),c={method:"GET",url:i,resolve:e,reject:t,params:a,showError:o,loaderEl:l},void p.push(c)):h(r+"."+s,e,t,l):h(r,e,t,l)});return e.cancel=function(){c.resolve({state:"cancelled"})},e},this.postData=function(r,s,n,o,l,c,d){return t(function(e,t){u.switchOn(l);var a=angular.copy(n),i=m.apiPath(r);if(!angular.isObject(i))return h(r,e,t,l);if(!(i=i[s]))return h(r+"."+s,e,t,l);i=f(i,a);p.push({method:"POST",url:i,resolve:e,reject:t,params:a,showError:o,loaderEl:l,header:c,notTransform:d})})}}]).factory("transformRequestAsFormPost",function(){return function(e,t){t()["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8";var a,i=e;if(!angular.isObject(i))return null===i?"":i.toString();var r,s=[];for(r in i)i.hasOwnProperty(r)&&(a=i[r],s.push(encodeURIComponent(r)+"="+encodeURIComponent(null===a?"":a)));return s.join("&").replace(/%20/g,"+")}}).service("loader",["toolsSrvc",function(a){var i=50,r=.7;function s(e,t){"plainDots"===t.loaderType?(e.addClass("rel"),t.animate&&e.css({height:i+"px",overflow:"hidden"}),e.prepend('<div class="dots-loader-backdrop"></div><div class="dots-loader"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>')):(t="contrast"==a.colorScheme()?"grayscale":"",e.addClass("rel"),e.prepend('<div class="loader"><div class=" '+t+' loader-image"><div class="cssload-progress cssload-float cssload-shadow"><div class="cssload-progress-item"></div></div></div></div>'))}function n(e,t){var a;"plainDots"===t.loaderType?t.animate?(a=e,TweenLite.set(a,{height:""}),TweenLite.from(a,r,{height:i+"px",ease:Power2.easeIn,onComplete:function(){TweenLite.set(a,{height:"",overflow:""}),a.removeClass("rel"),a.find(".dots-loader-backdrop,.dots-loader").remove()}})):(e.removeClass("rel"),e.find(".dots-loader-backdrop,.dots-loader").remove()):(e.removeClass("rel"),e.find(".loader").remove())}function t(e){return e instanceof angular.element||("object"==typeof HTMLElement||"function"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof o&&null!==e&&1===o.nodeType&&"string"==typeof e.nodeName)}this.switchOn=function(a){var e;a&&(t(a)?(e=angular.element(a)).length&&s(e,a):a.hasOwnProperty("elems")&&(a.elems.hasOwnProperty("length")?a.elems.length&&angular.forEach(a.elems,function(e,t){s(angular.element(e),a),a.elems.length===t&&"function"==typeof a.onSwitchOn&&a.onSwitchOn()}):(s(e=angular.element(a.elems),a),"function"==typeof a.onSwitchOn&&a.onSwitchOn())))},this.switchOff=function(a){var e;a&&(t(a)?(e=angular.element(a)).length&&n(e,a):a.hasOwnProperty("elems")&&(a.elems.hasOwnProperty("length")?a.elems.length&&angular.forEach(a.elems,function(e,t){n(angular.element(e),a),a.elems.length===t&&"function"==typeof a.onSwitchOn&&a.onSwitchOn()}):(n(e=angular.element(a.elems),a),"function"==typeof a.onSwitchOff&&a.onSwitchOff()),"function"==typeof a.onSwitchOff&&a.onSwitchOff()))}}]).service("apiCache",["$q","apiSrvc",function(n,o){var l={};this.getData=function(e,t,a,i,r){var s=e+t+JSON.stringify(a);if(l[s])return n.when(l[s]);return o.getData(e,t,a,i,r).then(function(e){return l[s]=e})}}]),angular.module("mosapp.customisation",[]).service("CustomisationSrvc",[function(){var r={};return{add:function(e,t,a,i){return!r[e]&&(r[e]={name:e,fromWhere:t,options:a,callback:i},r.name)},get:function(e){return r[e]},delete:function(e){return delete r[e]},rewrite:function(e,t,a,i){return r[e]={name:e,fromWhere:t,options:a,callback:i},r[e]}}}]),angular.module("mosapp").service("districtsSrvc",["apiSrvc","$q","UrlSrvc","LangSrvc",function(e,t,a,s){var n=this,i={};function o(e){(e=e||{}).category=e.category||"";var t=(t=a.getLangLink(a.pagePath("search",""))).replace(new RegExp("/$","g"),"");return t=(t+="?category="+e.category)+("&hostApplied=false&page=1&skip_stat=2&q="+(e.query||"")),e.districts&&(t+="&districts="+e.districts),e.areas&&(t+="&areas="+e.areas),t}this.getDistricts=function(){return i.districtsMap?t.when(i.districtsMap):e.getData("newsfeed","directories",{expand:"areas"},!1).then(function(e){var a;return e.items&&e.items.length&&(a={},e.items.forEach(function(e){var t={};e.areas.forEach(function(e){t[e.id]=e}),e.areas=t,a[e.id]=e}),i.districtsMap=a),i.districtsMap},function(){return null})},this.extractDistrictsAndAreasFromMap=function(a,e,i){var r=[],s=[];return angular.forEach(e,function(e){var t=angular.copy(a[e.id]);t&&(t.url=o({districts:t.id,category:i.category,query:i.query}),r.push(t),e.area_ids&&e.area_ids.length&&angular.forEach(e.area_ids,function(e){e=t.areas[e];e&&(e.url=o({districts:t.id,areas:e.id,category:i.category,query:i.query}),s.push(e))}))}),{districts:r,areas:s}},this.handleDistricts=function(t,a,i){i=i||{};var r="ru"===s.getCurrentLang()?"title":"title_en";t&&t.length&&n.getDistricts().then(function(e){e&&(a.districts=[],a.areas=[],a.maxExtra=i.maxExtra||2,e=n.extractDistrictsAndAreasFromMap(e,t,{category:i.category}),a.districts=e.districts.map(function(e){return e.title=e[r],e}),a.areas=e.areas.map(function(e){return e.title=e[r],e}),a.districts.length>a.maxExtra?a.districtsMax=a.maxExtra:a.districtsMax=a.districts.length,a.areas.length>a.maxExtra?a.areasMax=a.maxExtra:a.areasMax=a.areas.length,a.moreClicked=function(e,t){t.widthLT768||(a[e+"Max"]=a[e].length)},a.moreReset=function(e){a[e+"Max"]=a.maxExtra})})}}]),angular.module("mosapp").service("GIS2srvc",["UrlSrvc","$q","$rootScope","$window","mosconfig","$timeout",function(e,a,t,i,r,s){var n={},o="no";this.add=function(e,t){n[e]=t},this.get=function(e){return n[e]},this.loadLibrary=function(){var e,t=a.defer();return"no"!==o?s(function e(){"yes"===o?t.resolve():"loading"===o&&s(e,100)},100):(o="loading",(e=document.createElement("script")).id="GisApi",e.async="true",document.getElementsByTagName("head")[0].appendChild(e),e.src=r["2GisApi"].url,$(e).on("load",function(){window.DG===undefined?(o="no",t.reject("API not found")):(o="yes",t.resolve())})),t.promise}}]),angular.module("mosapp").service("headmetaSrvc",["mosconfig","$timeout","LangSrvc","UrlSrvc","toolsSrvc",function(o,e,l,c,d){var m=this;this.expandWithSiteName=!0,this.reSetMetaTag=function(e,t,a){var i=document.querySelector("head"),r=i.querySelector("meta["+e+'="'+t+'"]');a?(r||(r=document.createElement("meta"),i.appendChild(r)),r.setAttribute(e,t),r.setAttribute("content",a)):r&&r.parentNode.removeChild(r)},this.removeMetaTag=function(e){var t=document.querySelector("head"),a=t.querySelector('meta[property="'+e+'"]');(a=a||t.querySelector('meta[name="'+e+'"]'))&&a.parentNode.removeChild(a)},this.setTitle=function(){for(var e=document.querySelector("head"),t=e.querySelector("title"),a=l.getCurrentLang(),i=o.titleParams||{},r=i.separator||" / ",i=i.siteName[a]||"Сайт Москвы",s=[],n=0;n<arguments.length;n++)s.push(d.htmlToPlaintext(arguments[n]));a=Array.prototype.slice.call(s,0);return a.push(i),t||(t=document.createElement("title"),e.appendChild(t)),t.innerHTML=a.join(r),this},this.setDescription=function(e){if(!e||""==e)return this;e=this.expandWithSiteName?this.expandDataWithSiteName(e):e;return m.reSetMetaTag("name","description",e),this},this.expandDataWithSiteName=function(e){var t=l.getCurrentLang(),t=(o.altParams||{})[t]||"Официальный сайт Мэра Москвы",a=" ";return e+(a="."!==e[e.length-1]?". ":a)+t},this.setKeywords=function(e){e&&""!=e&&m.reSetMetaTag("name","keywords",e)},this.addAmpHtml=function(e){var t=document.querySelector("head"),a=t.querySelector('link[rel="amphtml"]');a&&a.parentNode.removeChild(a),(e.match(/^\/mayor\/telegrams\/[\d]+\/$/)||e.match(/^\/mayor\/interviews\/[\d]+\/$/)||e.match(/^\/mayor\/transcripts\/[\d]+\/$/)||e.match(/^\/mayor\/media\/photo\/[\d]+\//)||e.match(/^\/mayor\/media\/video\/[\d]+\/$/))&&(a=document.createElement("link"),t.appendChild(a),a.setAttribute("rel","amphtml"),a.setAttribute("href","/amp"+e))},this.setPageMeta=function(e,t){if(!e[t])return this;var a,i=c.getMainDomain()||"",r=l.getCurrentLang(),s=(o.altParams||{})[r]||"Официальный сайт Мэра Москвы",n=angular.isObject(e[t].image)&&e[t].image.src?angular.copy(e[t].image):{src:(o.imagesPath||"")+"favicon/icon200x200.png",width:200,height:200,title:s};return n.src=0===n.src.indexOf("http")?n.src:i+"/"+n.src.replace(new RegExp("^/"),""),m.removeMetaTag("og:image"),m.removeMetaTag("og:image:width"),m.removeMetaTag("og:image:height"),m.removeMetaTag("og:image:alt"),"/mayor/themes/"!==window.location.pathname&&"/mayor/biography/"!==window.location.pathname&&0!==window.location.pathname.indexOf("/mayor/transcripts/")&&0!==window.location.pathname.indexOf("/mayor/telegrams/")&&0!==window.location.pathname.indexOf("/mayor/interviews/")&&0!==window.location.pathname.indexOf("/mayor/media/")&&!window.location.pathname.match("^/mayor/themes/[\\d]+/$")||(n.src="https://"+window.location.hostname+"/open-graph/v1/frontend"+window.location.pathname,n.width="1200",n.height="630"),m.reSetMetaTag("property","og:image",n.src),m.reSetMetaTag("property","og:image:url",n.src),m.reSetMetaTag("property","og:image:width",n.width),m.reSetMetaTag("property","og:image:height",n.height),m.reSetMetaTag("property","og:image:alt",n.fullTitle||n.title),m.addAmpHtml(location.pathname),m.reSetMetaTag("property","og:url",i+"/"+location.pathname.replace(new RegExp("^/"),"")),m.reSetMetaTag("property","og:site_name",s),t&&e[t]&&(a=d.htmlToPlaintext(e[t].description),setTimeout(function(){m.reSetMetaTag("property","og:title",d.htmlToPlaintext(e[t].title)),m.reSetMetaTag("property","og:description",a)}),m.setDescription(a),m.setKeywords(e[t].keywords),"article"===e[t].type?(m.reSetMetaTag("property","og:type",e[t].type),m.reSetMetaTag("property","article:publisher",o.linksPath.social[r].facebook),m.reSetMetaTag("property","article:author",o.linksPath.social[r].facebook),isNaN(+e[t].published_time)?m.removeMetaTag("article:published_time"):m.reSetMetaTag("property","article:published_time",moment.unix(+e[t].published_time).utcOffset(3).format()),m.reSetMetaTag("name","twitter:site_name",o.domain.replace("www.","")),m.reSetMetaTag("name","twitter:creator",o.linksPath.social[r].twitter_creator)):(m.removeMetaTag("article:publisher"),m.removeMetaTag("article:author"),m.removeMetaTag("article:published_time"),m.removeMetaTag("twitter:site_name"),m.removeMetaTag("twitter:creator"),m.reSetMetaTag("property","og:type",e[t].type||"website"))),this},this.extractMeta=function(){return{title:document.title,description:d.htmlToPlaintext(this.getContentFor("description")),keywords:this.getContentFor("keywords")}},this.getContentFor=function(e){e=document.querySelector('meta[name="'+e+'"]');return null!==e?e.getAttribute("content"):""},this.withoutSiteName=function(){return this.expandWithSiteName=!1,this},this.withSiteName=function(){return this.expandWithSiteName=!0,this}}]),angular.module("mosapp").service("libsLoader",["UrlSrvc","$q","$window",function(s,t,n){var a={};this.get=function(i){var r,e;return void 0===a[i.id]&&(r={},i.js&&(r.js=t(function(e,t){var a;r.status="load",i.js&&((a=document.createElement("script")).id=i.id,a.async="true"),document.getElementsByTagName("head")[0].appendChild(a),a.src=s.jsPath(i.js),$(a).on("load",function(){i.api&&(r.api=n[i.api]),r.status="ready",e(r)})})),a[i.id]=r,i.css&&((e=document.createElement("link")).rel="stylesheet",e.href=s.jsPath(i.css),e.type="text/css",document.getElementsByTagName("head")[0].appendChild(e))),a[i.id]}}]),angular.module("mosapp").config(["mosconfig","$translateProvider","$translatePartialLoaderProvider","LangSrvcProvider",function(e,t,a,i){t.usePostCompiling(!0),t.useSanitizeValueStrategy("escape"),t.useLoader("$translatePartialLoader",{urlTemplate:e.i18nPath+"{part}/{lang}.json?1677769505234"}),t.preferredLanguage(i.setCurrentLang())}]),angular.module("mosapp").service("opengraphSrvc",["mosconfig","$timeout","LangSrvc","UrlSrvc","toolsSrvc","headmetaSrvc","$location",function(e,t,a,i,r,s,n){this.invalidateWithGlobalMeta=function(){var e=s.extractMeta();return t(function(){s.reSetMetaTag("property","og:title",e.title),s.reSetMetaTag("property","og:description",e.description)}),this},this.passUrl=function(){return s.reSetMetaTag("property","og:url",n.absUrl().replace(new RegExp("all/$"),"")),this}}]),angular.module("mosapp").service("tColumn",["UrlSrvc","$q","$rootScope","$window",function(i,t,r,s){this.columnizerLoad=function(e){return t(function(e,t){var a;r.textColumnizer?"ready"!==r.textColumnizer.status?(a=document.getElementById("columnizerapiscript"),$(a).on("load",function(){e()})):e():(r.textColumnizer={},r.textColumnizer.status="load",(a=document.createElement("script")).id="columnizerapiscript",a.async="true",document.getElementsByTagName("head")[0].appendChild(a),a.src=i.jsPath("columnizer/jquery.columnizer.js"),$(a).on("load",function(){r.textColumnizer.api=s.columnizer,r.textColumnizer.status="ready",e()}))})}}]),angular.module("mosapp").service("tmplSrvc",TmplService),angular.module("mosapp").service("toolsSrvc",["mosconfig","$timeout","LangSrvc","UrlSrvc","$filter",function(mosconfig,$timeout,LangSrvc,UrlSrvc,$filter){var errorInfo,self=this;this.ruStrToDate=function(e){var t,a=!1;return(a=angular.isString(e)&&2<(t=e.split(".")).length?new Date(t[2],t[1]-1,t[0]):a)||e},this.getMaxDate=function(e){return Math.max.apply(null,e)},this.sanitize=function(e){return e.replace(/\u200B/g,"")},this.getSiteLogo=function(){return mosconfig.siteLogo||null},this.fillOutPages=function(e,t){for(var a=[],i=1;i<t+1;i++)a.push({num:i});return a},this.scrollTop=function(e){TweenLite.to(window,e||.75,{scrollTo:{y:0},ease:Power2.easeOut,onComplete:function(){}})},this.colorScheme=function(){return"true"===localStorage.getItem("contrast")?"contrast":"default"},this.htmlToPlaintext=function(e){return(e=e?String(e).replace(/\&\w{4,5};/gm," "):"")?String(e).replace(/<[^>]+>/gm,""):""},this.getMetaForImage=function(e){var t=LangSrvc.getCurrentLang();return{alt:e+". "+mosconfig.altParams[t],title:e}},this.removeMetaTag=function(e){var t=document.querySelector("head"),a=t.querySelector('meta[property="'+e+'"]');(a=a||t.querySelector('meta[name="'+e+'"]'))&&a.parentNode.removeChild(a)},this.setMeta=function(e,t,a){var i=UrlSrvc.getMainDomain(),e=e.image&&""!==e.image&&e.image.indexOf("data:image",0)<0?e.image:(mosconfig.imagesPath||"")+"favicon/icon200x200.png",r=(e=0===e.indexOf("http")?e:i+"/"+e.replace(new RegExp("^/"),""),LangSrvc.getCurrentLang()),r=(mosconfig.altParams||{})[r]||"Официальный сайт Мэра Москвы";0===window.location.pathname.indexOf("/news/maintheme/")||"/city/projects/"===window.location.pathname||"/city/about/plan/"===window.location.pathname||"/authority/documents/"===window.location.pathname||0===window.location.pathname.indexOf("/authority/documents/doc/")||0===window.location.pathname.indexOf("/authority/projects/active/")||0===window.location.pathname.indexOf("/authority/projects/archive/")||0===window.location.pathname.indexOf("/authority/projects/doc/")||"/authority/discussion/"===window.location.pathname||0===window.location.pathname.indexOf("/authority/discussion/doc/")||0===window.location.pathname.indexOf("/city/about/symbols/")||0===window.location.pathname.indexOf("/city/about/honors/")?(e="https://"+window.location.hostname+"/open-graph/v1/frontend"+window.location.pathname,$('meta[property="og:image:width"]').attr("content",1200),$('meta[property="og:image:height"]').attr("content",630)):(self.removeMetaTag("og:image:width"),self.removeMetaTag("og:image:height")),$('meta[property="og:url"]').attr("content",i+"/"+location.pathname.replace(new RegExp("^/"),"")),$('meta[property="og:type"]').attr("content","website"),$('meta[property="og:site_name"]').attr("content",r),a&&t[a]&&(i=this.htmlToPlaintext(t[a].description),$('meta[property="og:title"]').attr("content",this.htmlToPlaintext(t[a].title)),$('meta[property="og:description"]').attr("content",i),self.setDescription(i)),$('meta[property="og:image"]').attr("content",e),$('meta[property="og:image:url"]').attr("content",e),self.removeMetaTag("article:publisher"),self.removeMetaTag("article:author"),self.removeMetaTag("article:published_time"),self.removeMetaTag("og:image:alt")},this.setTitle=function(){for(var e=LangSrvc.getCurrentLang(),t=mosconfig.titleParams||{},a=t.separator||" / ",t=t.siteName[e]||"Сайт Москвы",i=[],r=0;r<arguments.length;r++)i.push(this.htmlToPlaintext(arguments[r]));e=Array.prototype.slice.call(i,0);e.push(t),$("title").text(e.join(a))},this.setTitleClean=function(){for(var e=(mosconfig.titleParams||{}).separator||" / ",t=[],a=0;a<arguments.length;a++)t.push(this.htmlToPlaintext(arguments[a]));var i=Array.prototype.slice.call(t,0);$("title").text(i.join(e))},this.setDescription=function(e){var t,a=LangSrvc.getCurrentLang();e&&""!=e&&(a=(mosconfig.altParams||{})[a]||"Официальный сайт Мэра Москвы",t=" ","."!==e[e.length-1]&&(t=". "),self._setMeta("description",e+t+a))},this.setRawDescription=function(e){self._setMeta("description",e)},this.setRawTitle=function(e){$("title").text(e)},this.setKeywords=function(e){e&&""!=e&&self._setMeta("keywords",e)},this.setVerification=function(){self._setMeta("baidu-site-verification","Jauog7E16g")},this._setMeta=function(e,t){var a;e&&0!=e.length&&(0<(a=$("meta[name="+e+"]")).length?a.attr("content",t):((a=document.createElement("meta")).name=e,a.content=t,document.getElementsByTagName("head")[0].appendChild(a)))},this.togglerBlackAndWhite=function(e,t,a){a instanceof $||"string"!=typeof a?a instanceof $&&void 0!==a||(a=$(document.body)):a=$(a),"contrast"===t?(a.find(e).addClass("grayscale"),a.find(".grayscale-img").addClass("grayscale"),a.find(".grayscale").gray()):(a.find(".grayscale").toggleClass("grayscale-off"),a.find(e).removeClass("grayscale"),a.find(".grayscale-img").removeClass("grayscale"))},this.prepareTags=function(e){var t=[];return angular.isString(e)?e:angular.isArray(e)?(e.forEach(function(e){t.push(e.title)}),t.join(", ")):void 0},this.setErrorInfo=function(e){errorInfo=e},this.getErrorInfo=function(){return errorInfo},this.statCounter=function statCounter(params){var maxAttempts=20;function trySendMetrika(COUNTER_ID,TARGET_NAME,GOAL_PARAMS,cnt){var js="yaCounter"+COUNTER_ID+".reachGoal('"+TARGET_NAME+"');",params;try{GOAL_PARAMS?(params="yaCounter"+COUNTER_ID+".params("+(angular.isObject(GOAL_PARAMS)?JSON.stringify(GOAL_PARAMS):GOAL_PARAMS)+");",eval(params)):eval(js)}catch(e){cnt++,cnt<maxAttempts&&$timeout(function(){trySendMetrika(COUNTER_ID,TARGET_NAME,GOAL_PARAMS,cnt)},500)}}if(angular.isObject(params)&&angular.isObject(params.metrika)&&params.metrika.TARGET_NAME){var COUNTER_ID,TARGET_NAME=angular.isObject(params.metrika)&&params.metrika.TARGET_NAME?params.metrika.TARGET_NAME:null,GOAL_PARAMS=angular.isObject(params.params)?params.params:null;try{COUNTER_ID=mosconfig.stat.metrika.id}catch(e){}COUNTER_ID&&TARGET_NAME&&trySendMetrika(COUNTER_ID,TARGET_NAME,GOAL_PARAMS,0)}},this.localeNum=function(e,t){if("number"!=typeof(e=+e))return"";if((!t||t.length<1)&&(t=new Array("")),0<(e=e.toString()).indexOf(".")||0<e.indexOf(","))return t[1];var a=e.length,i=new Number(a<2?0:e.substr(a-2,1)),e=new Number(e.substr(a-1,1));return 1!=i?1<e&&e<5?t[1]:4<e&&e<=9||0==e?t[2]:1==e?t[0]:void 0:t[2]},this.hideContentArea=function(e){e.css("opacity",0)},this.showContentArea=function(e){e&&e.length&&TweenLite.to(e,.5,{opacity:1,ease:Power1.easeIn,onComplete:function(){e.css("opacity","")}})},this.transformDateToMos=function(e){var t=e.getTimezoneOffset()/60;return e=-3!=t?new Date(e.getTime()+3600*t*1e3+108e5):e},this.handleAlternateTags=function(i,e,t){for(var a=document.querySelectorAll('link[rel="alternate"]'),r=function(e){var t,a=[];for(t in e)a.push({lang:t,href:e[t].href,fromState:e[t].fromState});return a}(i.current.alternateLinks),s=0;s<a.length;s++){var n=a[s].attributes.href.nodeValue,o=a[s].attributes.hreflang.nodeValue;(r=r||[]).push({lang:o,href:n,fromState:!1})}r&&r.length&&r.forEach(function(a){(function(e,t){"zn"===e&&(e="cn");return UrlSrvc.getMainDomain()+("ru"===e?"":"/"+e)+("ru"===LangSrvc.getCurrentLang()?t:t.slice(3))})(a.lang,i.href(e)).replace(/^https/,"http")!==a.href.replace(/^https/,"http")?(t.forEach(function(e){var t=i.href(e),t=new RegExp(("ru"===LangSrvc.getCurrentLang()?t:t.slice(3))+"$","i"),e=i.get(e);t.test(a.href)&&(e.alternateLinks||(e.alternateLinks={}),e.alternateLinks[a.lang]||(e.alternateLinks[a.lang]={}),e.alternateLinks[a.lang].href=a.href,e.alternateLinks[a.lang].fromState=!0)}),document.querySelector('link[rel="alternate"][hreflang="'+a.lang+'"][href="'+a.href+'"]').remove()):a.fromState&&angular.element("head").append('<link rel="alternate" hreflang="'+a.lang+'" href="'+a.href+'">')})},this.joinProperty=function(e,t,a){var i="";return t&&e?e.map(function(e){return e[t]}).join(a):i},this.statsMosCounter=function(e){if(angular.isObject(e)){e={eventType:e.type,eventSrc:"mos.ru",eventDst:"stats",eventTime:parseInt((new Date).getTime()/1e3,10),mosId:getCookie("mos_id"),eventObject:e.params},e=JSON.stringify(e);try{fetch("https://stats.mos.ru/eds.gif?o="+e,{credentials:"include"})}catch(e){}}},this.dateRange=function(e,t){var a="d MMMM",i="d MMMM yyyy",r=(e=!!e&&new Date(e),t=!!t&&new Date(t),new Date),s=r.getTimezoneOffset()/60;if(-3!=s&&(r=new Date(r.getTime()+3600*s*1e3+108e5)),!e&&!t)return"";if(!e||!t)return n=(s=e||t).getFullYear()===r.getFullYear(),$filter("date")(s,n?a:i);var n,s=(n=e.getFullYear()===r.getFullYear())?a:i;return e.getFullYear()===t.getFullYear()?e.getMonth()===t.getMonth()?e.getDate()===t.getDate()?$filter("date")(e,s):e.getDate()+" – "+$filter("date")(t,s):$filter("date")(e,a)+" – "+$filter("date")(t,s):$filter("date")(e,i)+" – "+$filter("date")(t,i)},this.formatHoursMinutes=function(e){var e=self.transformDateToMos(new Date(1e3*e)),t=((t=e.getHours())<10?"0":"")+t,e=e.getMinutes();return t+":"+((e<10?"0":"")+e)}}]),angular.module("mosapp").service("UrlSrvc",["mosconfig","LangSrvc","$rootScope",function(s,a,e){function i(e){var t,a;if(!(e.length<=1))return t=e.split("/"),t=t[t.length-1].split("?"),a="/"!=e[e.length-1],a&&1===t.length?e+"/":a&&1!=t.length&&""!=t[0]?e.replace("?","/?"):e}function r(e){var e=i(e),t=a.getCurrentLang();return"ru"==t?e:"/"+t+e}function n(e,t){t=t((e=e||1)+1);return t?r(t):""}function o(e,t){t=t((e=e||1)-1);return t?r(t):""}function l(e,t,a){var i,r;e&&t&&(r=!1,(i=a?document.getElementById(a):i)||(i=document.createElement("link"),r=!0),i.id=a,i.rel=e,i.href=function(){var e="";s.domain&&(e=(e=(0===s.domain.indexOf("http")?"":location.protocol+"//")+s.domain).replace(new RegExp("/$"),""));return e}()+t,r&&document.getElementsByTagName("head")[0].appendChild(i))}function c(e){e=document.getElementById(e);e&&"LINK"===e.tagName&&document.getElementsByTagName("head")[0].removeChild(e)}e.$on("$stateChangeSuccess",function(){try{setTimeout(window.$mos_layouts.api.setActive,0)}catch(e){}}),this.getMainDomain=function(){var e="";return e=s.domain?(e=(0===s.domain.indexOf("http")?"":location.protocol+"//")+s.domain).replace(new RegExp("/$"),""):e},this.getLangLink=r,this.getLangLinkPrefix=function(){var e=a.getCurrentLang();return"ru"==e?"":"/"+e},this.getLangPath=function(e,t){return this.getLangLink(this.pagePath(e,t))},this.tmplPath=function(e){return e},this.apiPath=function(e,t){return s.restAPI[e]},this.jsPath=function(e){return((s.jsPath||"")+e).replace(new RegExp("//","g"),"/")},this.cssPath=function(e){return((s.cssPath||"")+e).replace(new RegExp("//","g"),"/")},this.pagePath=function(e,t){return i((s.pagePath[e]||"")+t).replace(new RegExp("//","g"),"/")},this.linksPath=function(e){return s.linksPath[e]},this.specialType=function(e){return s.specialType[e]||""},this.currentEmergency=function(e){if(e||s.emergency)return s.emergency[e]||""},this.currentEmergencyPath=function(e){if(e||s.emergency||s.emergency.path)return s.emergency.path[e]||""},this.getBanners=function(e,t){if(e&&s.banners&&s.banners[e])return t=t||a.getCurrentLang(),{domain:s.banners.domain,urlPath:s.banners.urlPath,items:s.banners[e][t]}},this.isExternalUrl=function(e){return!/(^((http(s)?:\/\/)?(www.)?|\/\/)?mos.ru)|^\/{1}([^\/]+|$)/gi.test(e)},this.addParamsToUrl=function(e,t){if(!t)return e;var a=(r=e.split("#"))[1]?"#"+r[1]:"",i=[],r=r[0].split("?");return angular.forEach(t,function(e,t){i.push(t+"="+e)}),1===r.length?e=r[0]+"?"+i.join("&"):2===r.length&&(e=r[0]+"?"+r[1]+"&"+i.join("&")),e+a},this.setCanonical=function(e){var t,a="";s.domain&&(a=(a=(0===s.domain.indexOf("http")?"":location.protocol+"//")+s.domain).replace(new RegExp("/$"),"")),e&&((t=document.createElement("link")).id="canonicalLink",t.rel="canonical",t.href=a+e,document.getElementsByTagName("head")[0].appendChild(t))},this.setPrevNextLinks=function(e,t,a,i){var r=n(e,a),e=o(e,a);t&&r?l("next",r,"link-rel-next"):c("link-rel-next"),e?l("prev",e,"link-rel-prev"):c("link-rel-prev")},this.getNextPageUrl=n,this.getPrevPageUrl=o,this.appendLink=l}]),angular.module("mosapp").filter("imagesPath",["mosconfig",function(t){return function(e){return((t.imagesPath||"")+e).replace(new RegExp("//","g"),"/")}}]),angular.module("mosapp").run(["$state","$stateParams","$window",function(e,t,a){function i(){if(angular.isObject(e))try{e.transitionTo(e.current,t,{reload:!0,inherit:!1,notify:!0})}catch(e){return window.location=window.location.href,!1}else window.location=window.location.href}a.addEventListener?a.addEventListener("contrastTrigger",i):a.attachEvent("oncontrastTrigger",function(){i.call(a)})}]),angular.module("mosapp").provider("LangSrvc",function(){var e=!1;this.setCurrentLang=function(){return e=e||((e=document.documentElement.lang)||"ru")},this.$get=function(){return{getCurrentLang:function(){return e}}}}).service("linksInterceptor",[function(){var a,n=0,o=new Object(null),l=(o[++n]={regExp:[/\/pgu\./],attr:"href",callback:function(e,t){"object"==typeof _paq&&"function"==typeof _paq.push&&(e.preventDefault(),e=$(t).attr("href"),_paq.push(["trackLink",e,"link"]),(t=window.open(e,"_blank"))&&t.focus())},id:n},o[++n]={regExp:[/\/pgu\//],attr:"href",callback:function(e,t){"object"==typeof window._paq&&"function"==typeof window._paq.push&&(t=$(t).attr("href"),_paq.push(["trackLink",t,"link"]))},id:n},{openInNewTab:function(e,t){e.preventDefault();e=$(t).attr("href"),t=window.open(e,"_blank");t&&t.focus()}});function c(e){return"function"==typeof e.exec}return function e(){var t=$("div.b-content");a&&$timeout.cancel(a),t.length?t.on("click","a",function(r){var s=$(this);Object.keys(o).forEach(function(e){var t=o[e],a=s.attr(t.attr);if(a&&""!==a)for(var i=0;i<t.regExp.length;i++)if(null!==t.regExp[i].exec(a)){t.callback(r,s,t.cbParams);break}})}):a=$timeout(e,100)}(),{add:function(e,t,a,i){var r,s=new Object(null);if(Array.isArray(e)?(r=[],e.forEach(function(e){c(e)&&r.push(e)}),s.regExp=r):c(e)&&(s.regExp=[e]),s.attr="string"==typeof a?a:"href","function"==typeof t)s.callback=t;else if("string"==typeof t){if("function"!=typeof l[t])return!1;s.callback=l[t]}return s.cbParams="object"==typeof i?i:new Object(null),s.id=++n,o[n]=s},remove:function(e){return!!o[e]&&(delete o[e],!0)},check:function(e){return!!o[e]}}}]),angular.module("mosapp").service("VPsrvc",["UrlSrvc","$q","$rootScope","$window","$timeout",function(n,e,o,l,c){this.playerLoad=function(i){return e(function(e,t){var a;o.videoPlayer?"ready"!==o.videoPlayer.status?(a=document.getElementById("flowplayerapiscript"),$(a).on("load",function(){e()})):e():(o.videoPlayer={},o.videoPlayer.status="load",(a=document.createElement("script")).id="flowplayerapiscript",a.async="true",document.getElementsByTagName("head")[0].appendChild(a),a.src=n.jsPath("flowplayer/flowplayer.min.js"),$(a).on("load",function(){o.videoPlayer.api=l.flowplayer,o.videoPlayer.status="ready",o.videoPlayer.api.conf={splash:!0,key:"$219658761613389, $156847843995181, $217505261009336, $438958512312610"},e()}),i.nocss||((a=document.createElement("link")).rel="stylesheet",a.href=n.jsPath("flowplayer/skin/playful.css"),a.type="text/css",document.getElementsByTagName("head")[0].appendChild(a)))})},this.playerVideoJSLoad=function(s){return e(function(t,e){var a,i,r;o.videoPlayerJS?"load"===o.videoPlayerJS.status?c(function e(){"ready"===o.videoPlayerJS.status?t():c(e,100)},100):t():(o.videoPlayerJS={},o.videoPlayerJS.status="load",(r=document.createElement("script")).id="videojs_script",r.async="true",(i=document.getElementsByTagName("head")[0]).appendChild(r),r.src=n.jsPath("videojs/video.js"),$(r).on("load",function(){(a=document.createElement("script")).id="videojs_hls_script",a.async="true",a.src=n.jsPath("videojs/videojs-contrib-hls.js"),i.appendChild(a),$(a).on("load",function(){window.videojs.options.flash.swf=n.jsPath("videojs/video-js.swf"),o.videoPlayerJS.api=l.videojs,o.videoPlayerJS.status="ready",t()})}),s.nocss||((r=document.createElement("link")).rel="stylesheet",r.href=n.jsPath("videojs/video-js.min.css"),r.type="text/css",i.appendChild(r)))})}}]),angular.module("mayor.templates",[]).run(["$templateCache",function(e){e.put("mosBanner/mosBanner.tpl.html",'<div class="extconts-service-container"></div>'),e.put("socialWidget/informerWeatherTraffic.tpl.html",'<ul class="weather-traffic-informer"><li data-ng-repeat="informer in informers" data-ng-if="!informer.hideme" data-ng-class="informer.api"><span class="title">{{informer.title}}</span><img class="ico" data-ng-if="informer.data.image &amp;&amp; informer.api !== \'infoTraffic\'" data-ng-class="{\'grayscale-modern\': colorScheme == \'contrast\'}" data-ng-src="{{informer.data.image | imageSrc}}" data-ng-style="{width:((colorScheme==\'contrast\')?(informer.data.image.width*2) : informer.data.image.width) + \'px\',height:((colorScheme==\'contrast\')?(informer.data.image.height*2) : informer.data.image.height) + \'px\'}" alt=""/><div class="ico icon-traffic-lights" data-ng-if="informer.api == \'infoTraffic\'" data-ng-class="{\'grayscale-modern\': colorScheme == \'contrast\', \'{{informer.class}}\': informer.class}"></div><span class="data">{{ informer.data.value }} {{ informer.units }}</span></li></ul>'),e.put("socialWidget/socialWidget.tpl.html",'<div class="subhead"><div class="row" data-ng-style="border"><ul class="mayor-social col-sm-7" data-ng-if="lang === \'ru\'"><li class="mayor-social__logo"><img ng-src="{{\'mayour-logo.jpg\' | imagesPath}}" alt=""/></li><li class="title"><strong>{{\'social_widget.mayor_in_social_first\' | translate}}</strong><span> {{\'social_widget.mayor_in_social_last\' | translate}}</span></li><li><a class="icon icon-share-vk" data-ng-href="{{social.vkMayor}}" target="_blank" href="" title="vk"></a></li></ul><div class="weater-trafic-informer-wrapper hidden-xs col-sm-5" informer-weather-traffic="" data-ng-class="{\'pull-left\': lang !== \'ru\'}"></div></div></div>'),e.put("carouselFourItems/carouselFourItems.tpl.html",'<div class="b-navtitle container-fluid"><div class="b-navtitle__top-panel navbar navbar-static"><div class="b-navtitle__title"><a data-ng-if="moreLink &amp;&amp; !section &amp;&amp; !moreLinkTarget" data-ng-click="titleClick($event)" data-ng-href="{{moreLink}}"><span class="img" data-ng-if="titleImage"><img data-ng-src="{{titleImage.src | imagesPath}}" width="{{titleImage.width}}" height="{{titleImage.height}}"/></span><span data-ng-bind-html="title"></span></a><a data-ng-if="moreLink &amp;&amp; !section &amp;&amp; moreLinkTarget" data-ng-href="{{moreLink}}" data-ng-click="titleClick($event)" target="{{moreLinkTarget}}"><span class="img" data-ng-if="titleImage"><img data-ng-src="{{titleImage.src | imagesPath}}" width="{{titleImage.width}}" height="{{titleImage.height}}"/></span><span data-ng-bind-html="title"></span></a><span data-ng-if="!moreLink"><span class="img" data-ng-if="titleImage"><img data-ng-src="{{titleImage.src | imagesPath}}" width="{{titleImage.width}}" height="{{titleImage.height}}"/></span><span data-ng-bind-html="title"></span></span></div><ul class="nav b-navtitle__nav"><li><div class="b-navtitle__nav-prev" data-ng-if="showArrows"><a class="s-prev" href="" ng-click="gotoPrev()"><span class="ico"><span></span></span></a></div><div class="b-navtitle__nav-next" data-ng-if="showArrows"><a class="s-next" href="" ng-click="gotoNext()"><span class="ico"><span></span></span></a></div><div class="b-navtitle__nav-details" data-ng-if="moreLink || section"><a data-ng-if="moreLink &amp;&amp; !section &amp;&amp; !moreLinkTarget" data-ng-href="{{moreLink}}" data-ng-click="titleClick($event)" data-ng-bind-html="moreLinkText"></a><a data-ng-if="moreLink &amp;&amp; !section &amp;&amp; moreLinkTarget" data-ng-click="titleClick($event)" data-ng-href="{{moreLink}}" target="{{moreLinkTarget}}" data-ng-bind-html="moreLinkText"></a><a data-ng-if="!moreLink &amp;&amp; section" data-ng-click="titleClick($event)" data-ui-sref="{{section}}" data-ng-bind-html="moreLinkText"></a></div></li></ul></div></div><div class="b-slick-carousel" slick="" arrows="false" infinite="{{infinite}}" slides-to-show="{{slidesToShow}}" slides-to-scroll="{{slidesToScroll}}" responsive="responsive" init-onload="true" data="items" on-init="onInitCarousel(evt, slick)" accessibility="false" draggable="false" swipe="true" rows="{{rows}}" slides-per-row="{{slidesPerRow}}" touch-move="true" adaptive-height="{{adaptiveHeight}}" variableWidth="{{variableWidth}}" speed="{{speed}}" wait-for-animate="true" init-delay="{{initDelay}}"><div class="b-carousel__item" data-ng-repeat="item in items track by $index"><div data-compile-template="data-compile-template" template="{{template}}"></div></div></div>'),e.put("departmentPerson/departmentPerson.tpl.html",'<div data-mos-error="mosError" data-ng-if="mosError"></div><div class="b-content" data-ng-if="person &amp;&amp; !mosError"><div class="b-content__block"><div class="b-content__block-header_person"><a class="link-back" href="" data-ng-click="backButton()">Назад<i class="icon icon-arrow_left_03_black"></i></a></div><div class="departments"><div class="b-person b-departments__person b-departments__person_details b-departments__person_details" itemscope="itemscope" itemtype="http://schema.org/Person"><div class="row"><div class="b-person__photo"><figure class="b-person__photo-img"><img data-ng-class="{\'grayscale\': colorScheme == \'contrast\'}" alt="{{person.name}}.{{person.post}}.Официальный сайт Мэра Москвы" title="{{person.name}}" data-ng-if="person.image" data-ng-src="{{person.image | imageSrc}}" itemprop="image"/></figure></div><div class="b-person__data"><div class="b-person__name" itemprop="name">{{person.name}}</div><span class="b-person__post" itemprop="jobTitle">{{person.post}}</span><div data-ng-if="person.section"><a class="b-person__data-link" data-ng-if="person.department_link_activity" data-ui-sref="home.structure.view({structureId:person.section.id})"><span data-ng-bind-html="person.section.title"></span><i class="icon icon-arrow_right_02_blue"></i><i class="icon icon-arrow_right_01_black"></i></a><span class="b-person__data-link" data-ng-if="!person.department_link_activity"><span data-ng-bind-html="person.section.title"></span></span></div><ul class="b-person__contacts" data-ng-if="person.contacts.length || person.id_photo_mos"><li class="b-person__contacts-item clearfix" data-ng-repeat="contact in person.contacts" data-ng-if="contact.val"><i class="icon" data-ng-class="&quot;icon-&quot; + contact.type"></i><span class="b-person__data"><a class="b-person__contacts-data" data-ng-href="mailto:{{contact.val}}" itemprop="email" data-ng-if="contact.type==\'email\'">{{contact.val}}</a><div class="b-person__contacts-data" itemprop="telephone" data-ng-if="contact.type==\'phone\'">{{contact.val}}</div><a class="b-person__contacts-data" data-ng-href="{{contact.val}}" itemprop="sameAs" data-ng-if="contact.type==\'web\'">{{contact.val}}</a><p class="b-person__contacts-text">{{contact.title}}</p></span></li><li class="b-person__contacts-item clearfix" data-ng-if="person.id_photo_mos"><i class="icon icon-camera-black"></i><span class="b-person__data"><a class="b-person__contacts-data" data-ng-href="{{person.photo_mosru_url}}">Фотобанк</a></span></li></ul><a class="b-person__data-link" data-ng-if="person.salary_info" data-ng-href="{{person.salary_info.url}}">Сведения о доходах<i class="icon icon-arrow_right_02_blue"></i><i class="icon icon-arrow_right_01_black"></i></a><div class="b-person__data-footer"><a class="butt-red" data-ng-if="person.photobank" data-ng-href="{{person.photobank.url}}"><span class="butt-text">{{person.photobank.title}}</span></a></div></div></div></div><div class="b-accordion" data-ng-if="person.biography"><dl data-ng-repeat-start="biography in person.biography" ng-if="$first" data-ng-init="this.$show = true"><dt class="b-accordion__head" data-ng-click="this.$show = !this.$show"><div class="b-accordion__head-text">{{biography.title}}</div><i class="icon icon-arrow_down_01_black" data-ng-hide="this.$show"></i><i class="icon icon-arrow_up_01_black" data-ng-show="this.$show"></i></dt><dd class="b-accordion__panel"><div class="b-accordion__panel-text" data-ng-bind-html="biography.text" data-ng-class="{\'am-fade-and-slide-top\': this.$show, \'am-fade-and-slide-top\': !this.$show}" data-ng-show="this.$show">{{biography.title}}</div></dd></dl><dl data-ng-repeat-end="biography in person.biography" ng-if="!$first" data-ng-init="this.$show = false"><dt class="b-accordion__head" data-ng-click="this.$show = !this.$show"><div class="b-accordion__head-text">{{biography.title}}</div><i class="icon icon-arrow_down_01_black" data-ng-hide="this.$show"></i><i class="icon icon-arrow_up_01_black" data-ng-show="this.$show"></i></dt><dd class="b-accordion__panel"><div class="b-accordion__panel-text" data-ng-bind-html="biography.text" data-ng-class="{\'am-fade-and-slide-top\': this.$show, \'am-fade-and-slide-top\': !this.$show}" data-ng-show="this.$show">{{biography.title}}</div></dd></dl></div></div></div><div class="b-news-carousel color_lite_gray"><div class="b-carousel__cdt-person" data-ng-if="news.items.length" data-mos-carousel-four-items="" data-title-image="" data-title="Новости пресс-службы" data-section="home.activity" data-more-link-text="Все новости" data-items="news.items" data-slides-to-show="4" data-slides-to-scroll="3" data-template="&lt;div data-mos-press-item-brick=\'\' data-item=\'item\' data-section=\'home.activity\' data-section-category=\'home.activity.category\' data-section-story=\'home.activity.category.story\' class=\'b-press-bricks__item-content color_bw\'&gt;&lt;/div&gt;" data-responsive="[{breakpoint: 1200,settings: {slidesToShow:3,slidesToScroll:2}},{breakpoint: 767,settings: {slidesToShow:2,slidesToScroll:2}}]"></div></div></div>'),e.put("departmentPersonOne/departmentPersonOne.tpl.html",'<div class="b-content"><div class="b-content__person_one" data-ng-class="class"><div class="departments"><div class="b-person b-person_one"><div class="b-person_one_wrapper"><div class="b-person_one_wrapper_img" data-ng-class="{\'grayscale-modern\': colorScheme == \'contrast\'}" data-ng-if="person.preamble.image" data-ng-style="{\'background-image\': \'url(&quot;{{person.preamble.image | imageSrcBig}}&quot;)\'}"></div></div><div class="b-person__photo_one"><figure class="b-person__photo-img"><img data-ng-class="{\'grayscale\': colorScheme == \'contrast\'}" data-ng-if="person.image" data-ng-src="{{person.image | imageSrc}}" itemprop="image"/></figure></div><div class="b-person__data"><div class="b-person__name" itemprop="name" data-ng-bind-html="person.name"></div><span class="b-person__post" itemprop="jobTitle">{{person.post}}</span>\x3c!-- - div(data-ng-if="person.descr" data-ng-bind-html="person.descr")--\x3e<div class="b-person_butt clearfix" data-ng-if="lang != \'en\'"><a class="butt-ico" data-ng-href="/mayor/telegrams/" href=""><span class="butt-text"><i class="icon icon-telegram"></i>Телеграммы</span></a><a class="butt-ico" data-ng-href="/mayor/interviews/" href=""><span class="butt-text"><i class="icon icon-interview_black"></i>Интервью</span></a></div><div class="b-person_social-butt" data-ng-if="lang != \'en\'"><span>В социальных сетях</span><a class="icon-share-vk" data-ng-if="social.vkMayor" data-ng-href="{{social.vkMayor}}" target="_blank" href="" title="vk"></a></div></div></div></div></div><div class="b-biography-carousel color_lite_gray"><div class="b-carousel__cdt-person" data-ng-if="person.biography.length" data-mos-carousel-four-items="" data-infinite="false" data-title-image="" data-title="{{\'mosDepartmentPersonOne.biographyTitle\' | translate}}" data-section="" data-items="person.biography" data-slides-to-show="3" data-slides-to-scroll="2" data-template="&lt;div data-mos-biography-item-brick=\'\' data-item=\'item\' class=\'b-biography-bricks__item-content color_bw\'&gt;&lt;/div&gt;" data-responsive="[{breakpoint: 1200,settings: {slidesToShow:2,slidesToScroll:2}},{breakpoint: 767,settings: {slidesToShow:1,slidesToScroll:1}}]"></div></div><div class="clearfix" data-photo-bank-tabs="" data-mayor-key="mayor.photobank.{{lang}}" data-api-root="photoBank" data-postfix-img="{{\'mosDepartmentPersonOne.altImg\' | translate}}" data-gallery-api="photobankGallery" data-images-api="photobankImages"></div></div>'),e.put("quoteItemBrick/quoteItemBrick.tpl.html",'<div> <span>{{item.text}}</span><span class="qoute-resource">{{item.resource}}</span></div>'),e.put("biographyItemBrick/biographyItemBrick.tpl.html",'<div class="b-biography_item_year" data-ng-bind-html="item.year"></div><div class="b-biography_item_icon"></div><div class="b-biography_item_text" data-ng-bind-html="item.text"></div>'),e.put("photobankItemBrick/photobankItemBrick.tpl.html","<div class=\"photobank_item_image\" data-ng-style=\"{'background-image': 'url(&quot;{{item.image | imageSrc}}&quot;)'}\" data-ng-class=\"{'grayscale-modern': colorScheme == 'contrast'}\"></div>"),e.put("carouselPromo/carouselPromo.tpl.html",'<div class="b-promo__carousel-list" slick="" infinite="true" slides-to-show="1" slides-to-scroll="1" init-onload="true" data="items" prev-arrow="&lt;span class=\'slick-arrow-prev s-prev\'&gt;&lt;span class=\'ico\'&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;" next-arrow="&lt;span class=\'slick-arrow-next s-next\'&gt;&lt;span class=\'ico\'&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;" on-init="onInitCarousel(evt, slick)" accessibility="false" draggable="false" swipe="items.length &gt; 1" touch-move="items.length &gt; 1" speed="1300" dots="items.length &gt; 1" autoplay="items.length &gt; 1" autoplay-speed="15000"><div class="b-promo__carousel-item" data-ng-repeat="item in items"><div class="b-promo__carousel-image" data-ng-if="item.image" data-image-set-element="item.image" data-ng-class="{\'grayscale-modern\': colorScheme == \'contrast\'}"></div><div class="b-promo__carousel-mask"></div><div class="b-large-img__description" data-ng-if="item.image.title || item.image.copyright"><span class="b-large-img__description-s" data-ng-if="item.image.title">{{item.image.title}}</span><span class="b-large-img__description-f" data-ng-if="item.image.copyright" data-translate="mosCarouselPromo.title"></span><span class="b-large-img__description-s" data-ng-if="item.image.copyright">{{item.image.copyright}}</span></div><div class="b-promo__carousel-content"><div class="b-promo__carousel-date" data-ng-if="item.date_timestamp">{{item.date_timestamp*1000 | date : \'dd.MM.yyyy\'}}</div><div class="b-promo__carousel-title" data-ng-bind-html="item.title"></div><div class="b-promo__carousel-button"><a class="butt_red" data-ng-if="!sectionStory" data-ng-href="{{item.link}}">{{item.button || \'mosCarouselPromo.titleLink\' | translate}}</a><a class="butt_red" data-ng-if="sectionStory" data-ng-href="/mayor/themes/{{item.sphere &amp;&amp; item.sphere.id}}/{{item.id}}/" target="_self">{{item.button || \'mosCarouselPromo.titleLink\' | translate}}</a></div></div></div></div>'),e.put("carouselMedia/carouselMedia.tpl.html",'<div class="b-article__carousel-list" slick="" infinite="true" slides-to-show="1" slides-to-scroll="1" init-onload="true" data="items" on-init="onInitCarousel(evt, slick)" accessibility="false" draggable="false" swipe="true" touch-move="true" speed="1800" as-nav-for=".b-article__carousel-nav" dots="true" arrows="false" autoplay="false"><div class="b-article__carousel-item" data-ng-repeat="item in items" data-ng-class="{videoitem : item.type == \'video\'}"><div class="b-article__carousel-image" data-ng-if="item.image" data-ng-style="{\'background-image\': \'url(&quot;{{item.image | imageSetSrc:\'a|1|s\':\'b|2|m\':\'c|2|b\':\'d|2|b\':\'e|3|b\'}}&quot;)\'}" data-ng-class="{\'grayscale-modern\':colorScheme==\'contrast\'}"></div><div class="b-article__carousel-copyright" data-ng-if="!item.image.title">{{item.copyright}}</div><div class="b-article__carousel-mask"></div><div class="b-large-img__description" data-ng-if="item.image.title"><span class="b-large-img__description-f">Фотография</span><span class="b-large-img__description-s">{{item.image.copyright}}</span></div><div class="b-article__carousel-content" data-ng-if="item.type == \'video\'"><div data-mos-video-player="" data-sources="item.sources" data-evt-play="videoState(state)" data-evt-pause="videoState(state)" data-evt-stop="videoState(state)"></div></div></div></div><div class="am-fade-and-slide-bottom" data-ng-hide="videoStatus == \'play\'" data-ng-if="items.length&gt;1"><div class="b-article__carousel-nav" slick="" infinite="true" slides-to-show="5" slides-to-scroll="1" responsive="[{breakpoint: 1000,settings: {slidesToShow:3}}]" init-onload="true" data="items" on-init="onInitCarousel(evt, slick)" accessibility="false" draggable="false" swipe="false" touch-move="false" speed="1800" dots="false" autoplay="false" autoplay-speed="15000" as-nav-for=".b-article__carousel-list" prev-arrow="&lt;span class=\'slick-arrow-prev s-prev\'&gt;&lt;span class=\'ico\'&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;" next-arrow="&lt;span class=\'slick-arrow-next s-next\'&gt;&lt;span class=\'ico\'&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;" center-mode="false" center-padding="0" focus-on-select="true"><div class="b-article__carousel-nav-item" data-ng-repeat="item in items" data-ng-class="{videoitem : item.type == \'video\'}"><div class="b-article__carousel-image" data-ng-if="item.image" data-ng-style="{\'background-image\': \'url(&quot;{{item.image | imageSetSrc:\'a|1|s\':\'b|2|m\':\'c|2|b\':\'d|2|b\':\'e|3|b\'}}&quot;)\'}" data-ng-class="{\'grayscale-modern\':colorScheme==\'contrast\'}"></div><div class="b-article__carousel-content" data-ng-class="{\'play-video-button\' : item.type == \'video\'}"></div></div></div></div>'),e.put("videoPlayer/videoPlayer.tpl.html",'<div class="b-video-player"></div>'),e.put("videoMvsrPlayer/videoMvsrPlayer.tpl.html",'<div class="videoMvsrPlayer-container" id="player-container-{{::guid}}"></div>'),e.put("audioPlayer_v4/audioPlayer.tpl.html",'<div class="media"><a rel="" href=""></a></div>'),e.put("pressThemes/pressThemes.tpl.html",'<div class="press-themes"><div class="b-press-preamble" data-ng-if="currentSphereAll &amp;&amp; firstPage &amp;&amp; promoItems"><div class="b-press-main__carousel" data-mos-carousel-promo="" data-apisection="{{apisection}}" data-promoapi="{{promoapi}}" data-section-story="{{sectionStory}}" data-income-items="promoItems"></div></div><div class="b-fix-wrapper container-fluid"><div class="row b-press-nav"><div class="col-xs-12 col-sm-6 col-md-4 b-press-categories"><div class="dropdown" data-mos-press-categories="" data-on-category-change="getNewCategory(catid)" data-categories="itemsSphere" data-category="currentSphere" data-placeholder="Все сферы" data-h1="true"></div></div><div class="col-xs-12 col-sm-6 col-md-4 b-filter__calendar" data-ng-if="rangeFilter" data-filter-calendar="" data-from-date="{{params.fromDate}}" data-until-date="{{params.untilDate}}" data-apply-new-range="applyFilterCalendar(fromDate,untilDate)"></div></div><div class="b-mos-press-category-items" data-mos-press-category="" data-items="items" data-get-more-bricks="getMoreBricks()" data-settings="settings" data-section="{{section}}" data-section-category="{{sectionCategory}}" data-section-story="{{sectionStory}}" data-morebutton="morebutton" data-notfound="notfound" data-get-next-page-url="getNextPageUrl"></div></div></div>'),e.put("pressCategories/pressCategories.tpl.html",'<div class="b-press-dropdown"><h1 class="b-dropdown__opener" data-bs-dropdown="categories" data-animation="am-fade" data-template="dropdown/dropdown.press.categories.tpl.html" data-ng-if="h1">{{category.title}}<span class="ico icon-arrow_down_01_black"></span></h1><span class="b-dropdown__opener" data-bs-dropdown="categories" data-animation="am-fade" data-template="dropdown/dropdown.press.categories.tpl.html" data-ng-if="!h1">{{category.title}}<span class="ico icon-arrow_down_01_black"></span></span></div>'),e.put("pressCategory/pressCategory.tpl.html",'<div class="row b-press-category__not-found" data-ng-if="notfound"><div class="col-xs-12"><p>Публикаций не найдено</p></div></div><div data-mos-press-brickwork="" data-ng-if="items &amp;&amp; items.length &gt; 0" data-items="items" data-section="{{section}}" data-section-category="{{sectionCategory}}" data-section-story="{{sectionStory}}"></div><div class="b-more__loader"></div><div class="row b-press-nav" data-ng-if="items &amp;&amp; items.length &gt; 0 &amp;&amp; morebutton"><div class="col-xs-12 b-press-bricks__morebutton"><a data-ng-if="getNextPageUrl()" data-ng-href="{{ getNextPageUrl() }}" data-ng-click="getMoreBricks(); $event.preventDefault(); $event.stopPropagation();"><span class="ico icon-arrow_down_03_black"></span><span class="text">Посмотреть еще</span></a><a data-ng-if="!getNextPageUrl()" href="" data-ng-click="getMoreBricks(); $event.preventDefault(); $event.stopPropagation();"><span class="ico icon-arrow_down_03_black"></span><span class="text">Посмотреть еще</span></a></div></div>'),e.put("pressStory/pressStory.tpl.html",'<div data-mos-error="mosError" data-ng-if="mosError"></div><article class="press-story" data-ng-if="!mosError">{{display_image}}<div class="press-article__header" data-ng-if="nomedia &amp;&amp; story.display_image != 0 &amp;&amp; (story.image.src || story.image.big &amp;&amp; story.image.big.src)" itemprop="image" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><img data-img-ratio="a|1:b|2:c|2:d|3:e|3" data-img-source="story.image" alt="{{headerImageMeta.alt}}" title="{{headerImageMeta.title}}" data-ng-class="{\'grayscale-modern\':colorScheme==\'contrast\'}"/><meta data-ng-if="schema.image.url" itemprop="url" content="{{schema.image.url}}"/><meta data-ng-if="schema.image.width" itemprop="width" content="{{schema.image.width}}"/><meta data-ng-if="schema.image.height" itemprop="height" content="{{schema.image.height}}"/></div><div class="b-press-preamble" data-ng-hide="nomedia"><div class="b-press-article__carousel" data-mos-carousel-media="" data-items="mediaitems"></div></div><div class="b-fix-wrapper container-fluid b-press-article"><div class="row b-article"><div class="col-xs-12 col-md-9 col-lg-8 b-press-article__main"><div class="article-content__copyright" data-ng-if="story.image || story.image.title || story.image.copyright"><div data-mos-copyright="" data-ng-if="story.image" data-title="story.image.title" data-copyright="story.image.copyright"></div></div><h1 class="b-article__title" data-ng-bind-html="story.title"></h1><div class="b-article__preview" data-ng-bind-html="story.preview"></div><div class="b-article__date" data-ng-if="story.date_timestamp">{{story.date_timestamp*1000 | date : \'dd.MM.yyyy\'}}</div><div data-ng-if="story.video &amp;&amp; story.video.guid" data-video-mvsr-player="{{ ::story.video.guid }}"></div><video class="inlineVideoPlayer" data-mos-video-player="" data-ng-class="{\'grayscale\': colorScheme == \'contrast\'}" data-ng-if="story.video &amp;&amp; story.video.src.length &amp;&amp; !story.video.guid" data-ng-style="{\'background-image\': \'url(&quot;{{story.video.image | imageSetSrc:\'a|1|s\':\'b|2|m\':\'c|2|b\':\'d|2|b\':\'e|3|b\'}}&quot;)\'}" data-sources="story.video.src" src="{{story.video.src[0].mp4}}"></video><div class="audionota" id="audionota" data-ng-class="{\'grayscale\': colorScheme == \'contrast\'}" data-auto-play="false" data-audio-format="mp3" data-audio-href="{{story.audio.src[0].mp3 || story.audio.src[0].ogg}}" data-ng-if="story.audio" data-mos-audio-player=""></div><div class="b-article__text b-article__text_press clearfix" data-ng-class="{\'grayscale\': colorScheme == \'contrast\'}"></div><div class="b-article__text" data-ng-if="displayTagsFlag &amp;&amp; story.tags &amp;&amp; story.tags.length &gt; 0" data-section="newsfeed" data-mos-tags="" data-tags="story.tags"></div><div class="press-story__extras-wrap"><div class="press-story__extras" data-ng-if="districts.length"><span class="press-story__extras-title" data-translate="pressStory.districts"></span> <a class="press-story__extras-item" data-ng-repeat="district in districts | limitTo: districtsMax" data-ng-href="{{ district.url }}">{{ district.title }}<span data-ng-if="$index != districtsMax - 1">, </span></a><span class="press-story__extras-item" data-ng-if="districts.length &gt; districtsMax"> и </span><a class="press-story__extras-item" data-ng-show="districts.length &gt; districtsMax" href="#" data-mos-hidden-list="" data-list="districts" data-on-click="moreClicked(\'districts\', evt)" data-on-reset="moreReset(\'districts\')" data-popup-title="{{ districtsTitle }}">еще {{ districts.length - districtsMax }} <ng-pluralize count="districts.length - districtsMax" when="{\'one\': \'округ\',\'few\': \'округа\',\'many\': \'округов\',\'other\': \'округов\'}"></ng-pluralize></a></div><div class="press-story__extras" data-ng-if="areas.length"><span class="press-story__extras-title" data-translate="pressStory.areas"></span> <a class="press-story__extras-item" data-ng-repeat="area in areas | limitTo: areasMax" data-ng-href="{{ area.url }}">{{ area.title }}<span data-ng-if="$index != areasMax - 1">, </span></a><span class="press-story__extras-item" data-ng-if="areas.length &gt; areasMax"> и </span><a class="press-story__extras-item" data-ng-show="areas.length &gt; areasMax" href="#" data-mos-hidden-list="" data-list="areas" data-on-click="moreClicked(\'areas\', evt)" data-on-reset="moreReset(\'areas\')" data-popup-title="{{ areasTitle }}">еще {{ areas.length - areasMax }} <ng-pluralize count="areas.length - areasMax" when="{\'one\': \'район\',\'few\': \'района\',\'many\': \'районов\',\'other\': \'районов\'}"></ng-pluralize></a></div></div><div class="b-share_news" data-ng-if="story.id &amp;&amp; !doNotShare" data-id="press_{{story.id}}" data-mos-sharing="" data-type="plain" data-text="{{story.title}}" data-title="{{story.title}}" data-preview="{{story.preview}}" data-direction="horizontal" data-image="{{story.share_image}}" data-item-type="article" data-socials="vkontakte,odnoklassniki"></div></div><div class="col-xs-12 col-md-3 col-lg-4 b-press-article__sidebar"><div class="article-content__copyright" data-ng-if="story.image || story.image.title || story.image.copyright"><div data-mos-copyright="" data-ng-if="story.image" data-title="story.image.title" data-copyright="story.image.copyright"></div></div></div></div><div class="row b-press-article__similar" data-ng-if="similarapi  &amp;&amp; similar"><div mos-press-story-similar="" data-more-link-text="Все сюжеты" data-stories="similar" data-section="{{section}}" data-section-category="{{sectionCategory}}" data-section-story="{{sectionStory}}"></div></div></div></article>'),e.put("pressStorySimilar/pressStorySimilar.tpl.html",'<div class="color_lite_gray" data-mos-carousel-four-items="" data-title="Смотрите также" data-section="{{section}}" data-more-link-text="{{moreLinkText}}" data-items="stories" data-slides-to-show="4" data-slides-to-scroll="3" data-template="&lt;div class=\'b-press-bricks__item-content color_bw\' data-section=\'{{section}}\' data-section-category=\'{{sectionCategory}}\' data-section-story=\'{{sectionStory}}\' data-mos-press-item-brick=\'\' data-item=\'item\'&gt;&lt;/div&gt;" data-responsive="[{breakpoint: 1400,settings: {slidesToShow:3,slidesToScroll:2}},{breakpoint: 1000,settings: {slidesToShow:2,slidesToScroll:2}},{breakpoint: 767,settings: {slidesToShow:1,slidesToScroll:1}}]"></div>'),e.put("pressReview/pressReview.tpl.html",'<div class="b-fix-wrapper container-fluid b-press-article b-press-article-review"><div class="row b-article"><div class="col-xs-12 col-md-9 col-lg-8 b-press-article__main"><h1 class="b-article__title" data-ng-bind-html="story.title"></h1><div class="b-article__source" data-ng-if="story.source">Источник: &laquo;{{story.source}}&raquo;</div><div class="b-iconic-btn-list b-iconic-btn-list_phone" style="display: none;"><a class="b-iconic-btn" href="#"><i class="icon-save_blue"></i></a><a class="b-iconic-btn" href="#"><i class="icon-share_blue"></i></a></div><div class="b-article__preview" data-ng-if="story.preview" data-ng-bind-html="story.preview"></div><div><div class="b-article__date_alt" data-ng-if="story.date_timestamp">{{story.date_timestamp*1000 | date : \'dd.MM.yyyy\'}}</div><div class="b-article__author" data-ng-if="story.author">Автор: {{story.author}}</div></div><div class="b-article__text b-article__text_press" data-ng-bind-html="story.text"></div><div class="b-share_news" data-ng-if="story.id" data-id="press_{{story.id}}" data-mos-sharing="" data-type="plain" data-text="{{story.title}}" data-direction="horizontal" data-socials="vkontakte"></div></div><div class="col-xs-12 col-md-3 col-lg-4 b-press-article__sidebar b-press-article__sidebar_review"><div class="b-article__reviews" data-ng-if="reviews"><div class="b-article__reviews-header">Обзоры по теме</div><div class="b-article__reviews-item" data-ng-repeat="review in reviews"><div class="b-article__reviews-source" data-ng-if="review.res">{{review.res}}</div><a class="b-article__reviews-title" data-ui-sref="home.reviews.story({story:review.id})">{{review.title}}</a><a class="b-article__reviews-more" data-ui-sref="home.reviews.story({story:review.id})">Подробнее</a></div><div class="b-article__reviews-list"><a data-ui-sref="home.reviews">Список обзоров</a></div></div></div></div></div>'),e.put("pressBrickwork/pressBrickwork.tpl.html",'<div class="row b-press-bricks__list"><div class="col-xs-12 col-sm-6 col-md-4 b-press-bricks__item" data-ng-repeat="item in items" data-ng-class="{\'am-fade-and-slide-left\': !params.page, \'am-fade-and-slide-top\': params.page}"><div class="b-press-bricks__item-content color_bw" data-mos-press-item-brick="" data-item="item" data-section="{{section}}" data-section-category="{{sectionCategory}}" data-section-story="{{sectionStory}}"></div></div></div>'),e.put("pressItemBrick/pressItemBrick.tpl.html",'<div data-ng-init="themes = item.type != \'gallery\' &amp;&amp; item.type != \'video\' &amp;&amp; item.type != \'slideshare\' &amp;&amp; item.type != \'pdf\'">\x3c!--#TODO check if category is none--\x3e<div class="rel"><div class="loader" data-ng-if="item.image"><div class="loader-image"><div class="cssload-progress cssload-float cssload-shadow"><div class="cssload-progress-item"></div></div></div></div><div class="b-press-bricks__item-image" data-ng-if="themes &amp;&amp; item.image" data-image-set-element="item.image" data-enable-watch="false" data-ng-class="{\'grayscale-modern\': colorScheme == \'contrast\'}"><a class="b-full-container-link" data-ng-if="themes" data-ng-href="/mayor/themes/{{item.sphere.id}}/{{item.id}}/" target="_self"></a></div><div class="b-press-bricks__item-image" data-ng-if="!themes &amp;&amp; item.image" data-ng-style="{\'background-image\': \'url(&quot;{{item.image | imageSetSrc:\'a|2|s\':\'b|3|m\':\'c|2|m\':\'d|1|s\':\'e|2|m\'}}&quot;)\'}" data-ng-class="{\'grayscale\': colorScheme == \'contrast\'}"><a class="b-full-container-link" data-ng-if="item.type == \'gallery\'" data-ui-sref="{{section}}.photo({photoID:item.id})" data-ng-click="itemOnClick(item)"></a><a class="b-full-container-link" data-ng-if="item.type == \'video\'" data-ui-sref="{{section}}.video({videoID:item.id})" data-ng-click="itemOnClick(item)"></a><span class="b-press-bricks__item-image__icon" data-ng-class="{\'icon-camera\': item.type == \'gallery\', \'icon-play\': item.type == \'video\'}">{{item.count ? item.count + \' фото\' : ((item.duration && item.duration!=\'00:00:00\')?item.duration:\'\')}}</span></div><div class="b-press-bricks__item-pdf" data-ng-if="item.type == \'pdf\'" data-presentation-viewer="data-presentation-viewer" data-title="{{item.title}}" data-href="{{item.href}}" data-frames="item.frames"></div><div class="b-press-bricks__item-slideshare" data-ng-if="item.type == \'slideshare\' &amp;&amp; item.code" data-ng-bind-html="item.code" data-ng-class="{\'grayscale-modern\': colorScheme == \'contrast\'}"></div></div><div class="b-press-bricks__item-caption" data-ng-class="{\'b-press-bricks__item-media\':(item.type == \'gallery\' || item.type == \'video\')}"><span class="b-press-bricks__item-date" data-ng-if="item.date_timestamp">{{item.date_timestamp*1000 | date : \'d MMMM yyyy\'}}</span><a class="b-press-bricks__item-title" data-ng-if="item.type != \'slideshare\' &amp;&amp; item.type != \'gallery\' &amp;&amp; item.type != \'video\' &amp;&amp; item.type != \'pdf\'" data-ng-bind-html="item.title" data-ng-href="/mayor/themes/{{item.sphere.id}}/{{item.id}}/" target="_self"></a><a class="b-press-bricks__item-title" data-ng-if="item.type == \'gallery\'" data-ng-bind-html="item.title" data-ui-sref="{{section}}.photo({photoID:item.id})" data-ng-click="itemOnClick(item)"></a><a class="b-press-bricks__item-title" data-ng-if="item.type == \'video\'" data-ng-bind-html="item.title" data-ui-sref="{{section}}.video({videoID:item.id})" data-ng-click="itemOnClick(item)"></a></div><a class="b-press-bricks__item-all" data-ng-if="item.all" href="{{item.all}}">Все новости<div class="icon icon-arrow_right_01_black"></div></a></div>'),e.put("presentationViewer/presentationViewer.tpl.html",'<div class="presentationViewer"><div class="presentationViewer__viewport" style="background-image: url(&quot;{{frames[currentPage-1].src}}&quot;)"></div><div class="presentationViewer__menu"><div class="presentationViewer__arrows"><div class="presentationViewer__arrow presentationViewer__arrow_prev" data-ng-class="currentPage == 1 ? \'presentationViewer__arrow_inactive\' : \'\'" data-ng-click="setCurrentPage(currentPage - 1)"></div><div class="presentationViewer__pager">{{currentPage}} из {{numPages}}</div><div class="presentationViewer__arrow presentationViewer__arrow_next" data-ng-class="currentPage == numPages ? \'presentationViewer__arrow_inactive\' : \'\'" data-ng-click="setCurrentPage(currentPage + 1)"></div></div><div class="presentationViewer__fullScreenToggle" data-ng-click="toggleFullscreen()" title="Полноэкранный режим"></div></div></div><div class="presentation__title" style="margin-bottom:5px"><strong><a href="{{href}}" title="{{title}}" target="_blank">{{title}}</a></strong></div>'),e.put("filterCalendar/filterCalendar.tpl.html",'<div class="calendar-inner" data-range-apply=""><div class="dates"><input class="js-daterange-input icon" type="text" data-ng-readonly="true" placeholder="{{placeholder}}" data-ng-class="icon || \'icon-calendar-gray\'" id="{{ uniqId || \'calendar1\' }}"/><span class="calendar-clear" data-ng-click="clearDatepicker()">Сбросить</span></div></div>'),e.put("filterTwoDates/filterTwoDates.tpl.html",'<div class="b-filter__two-dates"><div class="form-group"><label class="control-label"><span class="label-text">Вывести даты с</span><input class="form-control" data-bs-datepicker="" data-ng-model="fromDate" data-ng-value="fromDate" data-max-date="{{untilDate}}" placeholder="Выберите дату" data-date-format="dd.MM.yyyy" data-icon-left="arrow-prev icon-arrow_left_01_black" data-icon-right="arrow-next icon-arrow_right_01_black" data-start-week="1" type="text" data-autoclose="true"/></label><label class="control-label"><span class="label-text">по</span><input class="form-control" data-bs-datepicker="" data-ng-model="untilDate" data-min-date="{{fromDate}}" placeholder="Выберите дату" data-date-format="dd.MM.yyyy" data-icon-left="arrow-prev icon-arrow_left_01_black" data-icon-right="arrow-next icon-arrow_right_01_black" data-start-week="1" type="text" data-autoclose="true"/></label><a class="form-button butt_red" href="" data-ng-click="applyFilter()">Показать</a></div></div>'),e.put("navPagination/navPagination.tpl.html",'<div class="b-pagination__nav" data-ng-if="pageNums &amp;&amp; pagesTotal &gt; 1"><nav><ul class="pagination"><li data-ng-class="{hidden: pageCurrent==1}"><a class="page-prev" href="" data-ng-click="applyPageNum(pageCurrent-1)"><span class="ico icon-arrow_left_02_gray-dark"></span><span class="pagination__text">{{ \'navPagination.prev\' | translate }}</span></a></li><li data-ng-repeat="item in pageNums" data-ng-class="{current: item.num===pageCurrent}" data-ng-if="$first"><a href="" data-ng-click="applyPageNum(item.num)">{{item.num}}</a></li><li data-ng-class="{hidden: pageCurrent &lt; 4}"><span class="pagination__text">...</span></li><li data-ng-repeat="item in pageNums" data-ng-class="{current: item.num===pageCurrent}" data-ng-show="(pageCurrent - item.num) &lt; limitToShow &amp;&amp; item.num &lt; (pageCurrent + limitToShow) &amp;&amp; !$first &amp;&amp; !$last"><a href="" data-ng-click="applyPageNum(item.num)">{{item.num}}</a></li><li data-ng-class="{hidden: pageCurrent &gt; (pagesTotal-limitToShow-1)}"><span class="pagination__text">...</span></li><li data-ng-repeat="item in pageNums" data-ng-class="{current: item.num===pageCurrent}" data-ng-if="$last"><a href="" data-ng-click="applyPageNum(item.num)">{{item.num}}</a></li><li data-ng-class="{hidden: pageCurrent==pagesTotal}"><a class="page-next" href="" data-ng-click="applyPageNum(pageCurrent+1)"><span class="pagination__text">{{ \'navPagination.next\' | translate }}</span><span class="ico icon-arrow_right_02_black"></span></a></li></ul></nav></div>'),e.put("pressPresentations/pressPresentations.tpl.html",'<div><div class="b-fix-wrapper container-fluid"><div class="row b-press-nav"><div class="col-xs-12 col-sm-6 col-md-4 b-filter__calendar" data-filter-calendar="" data-from-date="{{params.fromDate}}" data-until-date="{{params.untilDate}}" data-apply-new-range="applyFilterCalendar(fromDate,untilDate)"></div></div><div class="b-press-media__bricks" data-ng-class="{\'grayscale\': colorScheme == \'contrast\'}" data-mos-press-category="" data-items="items" data-get-more-bricks="getMoreBricks()" data-morebutton="morebutton" data-notfound="notfound"></div><div class="b-lookmore_loader"></div></div></div>'),e.put("pressInfographic/pressInfographic.tpl.html",'<div class="infographic-page"><div class="infographic-page__directives"><div class="col-xs-12 col-sm-12 col-md-9 col-lg-9 infographic-page__filters"><div data-filter-news="" data-api-root-spheres="newsfeed" data-api-path-spheres="newsShperes" data-area-title="Тип инфографики" data-set-new-sphere="setNewSphere" data-set-new-area="setNewType" data-set-filter-calendar="setFilterCalendar" data-set-current-sphere="setCurrentSphere" data-set-current-area="setCurrentType" data-set-calendar-date="setCalendarDate" data-current-sphere="currentSphere" data-current-area="currentType" data-items-sphere="itemsSphere" data-items-area="itemsType" data-start-find-posts="startFindPosts" data-params="params"></div></div><div class="districts-page__news col-xs-12 col-sm-8 col-md-9 col-lg-9"><div data-news-feed="" data-show-districts="true" data-items-area="itemsType" data-api-root="newsfeed" data-api-path="pressInfographicList" data-start-load-event="state:loaded" data-set-and-get-params="setAndGetParams" data-types-array="typesMap" data-page="pressInfographic" data-page-path="mayorMain" data-item-path="/infographic/" data-sphere-path="/infographic/cat/" data-additional-feed-items="newsFeedItems" data-max-height="1850" data-is-there-more-pages="isThereMorePages" data-activate-button-for-next-loading="activateButtonForNextLoading" data-get-more-news="getMoreNewsFunc" data-item-link-target="_self"></div></div><div class="news-media-wrapper col-xs-12 col-sm-4 col-md-3 col-lg-3 pull-right"><div class="extconts" data-ng-if="extconts &amp;&amp; extconts.items.length"><div class="hidden-xs" data-ng-repeat="item in extconts.items" data-mos-extconts-service="" data-domain="extconts.domain" data-url-path="extconts.urlPath" data-item="item"></div></div></div><div class="col-xs-12 col-sm-8 col-md-9 col-lg-9"><div data-news-feed-additional="" data-items="newsFeedItems" data-show-districts="true" data-is-there-more-pages="isThereMorePages" data-activate-button-for-next-loading="activateButtonForNextLoading" data-get-more-news="getMoreNewsFunc" data-item-link-target="_self"></div></div></div></div>'),e.put("pressInfographicItem/pressInfographicItem.tpl.html",'<div data-mos-error="mosError" data-ng-if="mosError"></div><div class="infographic-item__header" data-ng-if="!mosError &amp;&amp; infographic.images &amp;&amp; infographic.images.length &amp;&amp; infographic.display_image != 0" data-ng-style="{\'background-image\': \'url(&quot;{{infographic.images[0] | imageSetSrc:\'a|1|s\':\'b|1|m\':\'c|2|b\':\'d|2|b\':\'e|3|b\'}}&quot;)\'}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" title="{{infographic.images[0].title}}"><div class="infographic-item__header-title"><div class="header-title" data-ng-if="infographic.images[0].copyright"><div class="header-title__caption">Фотография</div><div class="header-title__text">{{ infographic.images[0].copyright }}</div></div></div></div><div class="infographic-item__content container-fluid" data-ng-if="!mosError"><div class="row infographic-item__row"><div class="col-xs-12 col-sm-8 col-md-9 col-lg-9 infographic-item__col"><div class="infographic-content" data-ng-class="{\'infographic-content_without-image\':!(infographic.images &amp;&amp; infographic.images.length)}"><div class="infographic-content__header-wrap"><div class="infographic-content__header"><div class="infographic-content__header-text" data-ng-bind-html="infographic.title"></div><div class="infographic-content__header-info"><span class="header__date" data-ng-if="infographic.date_timestamp">{{infographic.date_timestamp*1000 | date : \'d MMM yyyy, HH:mm\'}}</span></div></div></div><div class="infographic-content__text-wrap"><div class="infographic-item__share-links" data-id="{{sharingTypeId}}" data-ng-if="infographic.id" data-mos-sharing="" data-type="plain" data-image="{{imageForSharing | imageSrc}}" data-text="{{infographic.title}}" data-preview="{{infographic.preview}}" data-direction="{{sharingDirection}}" data-socials="vkontakte,odnoklassniki"></div><h2 class="preview" data-ng-if="infographic.preview" data-ng-bind-html="infographic.preview"></h2><div data-ng-if="infographic.type === \'video\' &amp;&amp; infographic.video &amp;&amp; infographic.video.guid" data-video-mvsr-player="{{ ::infographic.video.guid }}"></div><video class="inlineVideoPlayer" data-mos-video-player="" data-ng-class="{\'grayscale\': colorScheme == \'contrast\'}" data-ng-if="infographic.type === \'video\' &amp;&amp; infographic.video &amp;&amp; infographic.video.src.length &amp;&amp; !infographic.video.guid" data-ng-style="{\'background-image\': \'url(&quot;{{infographic.video.image | imageSetSrc:\'a|1|s\':\'b|2|m\':\'c|2|b\':\'d|2|b\':\'e|3|b\'}}&quot;)\', \'background-color\': \'black\'}" data-sources="infographic.video.src" src="{{infographic.video.src[0].mp4}}"></video><div class="infographic-content__text clearfix"></div><div class="infographic-item__extras-wrap"><div data-mos-tags="" data-tags="infographic.tags" data-section="newsfeed" data-ng-if="displayTagsFlag !== false &amp;&amp; infographic.tags &amp;&amp; infographic.tags.length &gt; 0"></div><div class="infographic-item__extras" data-ng-if="districts.length"><span class="infographic-item__extras-title" data-translate="infographicItem.districts"></span> <a class="infographic-item__extras-item" data-ng-repeat="district in districts | limitTo: districtsMax" data-ng-href="{{ district.url }}">{{ district.title }}<span data-ng-if="$index != districtsMax - 1">, </span></a><span class="infographic-item__extras-item" data-ng-if="districts.length &gt; districtsMax"> и </span><a class="infographic-item__extras-item" data-ng-show="districts.length &gt; districtsMax" href="#" data-mos-hidden-list="" data-list="districts" data-on-click="moreClicked(\'districts\', evt)" data-on-reset="moreReset(\'districts\')" data-popup-title="{{ districtsTitle }}">еще {{ districts.length - districtsMax }} <ng-pluralize count="districts.length - districtsMax" when="{\'one\': \'округ\',\'few\': \'округа\',\'many\': \'округов\',\'other\': \'округов\'}"></ng-pluralize></a></div><div class="ainfographic-item__extras" data-ng-if="areas.length"><span class="infographic-item__extras-title" data-translate="infographicItem.areas"></span> <a class="infographic-item__extras-item" data-ng-repeat="area in areas | limitTo: areasMax" data-ng-href="{{ area.url }}">{{ area.title }}<span data-ng-if="$index != areasMax - 1">, </span></a><span class="infographic-item__extras-item" data-ng-if="areas.length &gt; areasMax"> и </span><a class="infographic-item__extras-item" data-ng-show="areas.length &gt; areasMax" href="#" data-mos-hidden-list="" data-list="areas" data-on-click="moreClicked(\'areas\', evt)" data-on-reset="moreReset(\'areas\')" data-popup-title="{{ areasTitle }}">еще {{ areas.length - areasMax }} <ng-pluralize count="areas.length - areasMax" when="{\'one\': \'район\',\'few\': \'района\',\'many\': \'районов\',\'other\': \'районов\'}"></ng-pluralize></a></div></div><div class="infographic-item__footer"><a class="b-infographic-item__back" data-ng-href="{{::sectionAllHref}}">Еще инфографика</a></div></div></div></div></div></div>'),e.put("filterNews/filterNews.tpl.html",'<div class="filter-news" data-ng-class="{\'contrast\':colorScheme==\'contrast\', \'hidden\': lang !== \'ru\'}"><div class="row"><div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 filter-news__dropdown-wrap"><div class="filter-news__filter filter-news__filter_sphere"><div class="dropdown" data-mos-press-categories="" data-on-category-change="getNewSphere(catid)" data-categories="itemsSphere" data-category="currentSphere" data-placeholder="{{\'filterNews.sphereTitle\' | translate}}"></div></div></div><div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 filter-news__dropdown-wrap"><div class="filter-news__filter filter-news__filter_area"><div class="dropdown" data-mos-press-categories="" data-on-category-change="getNewArea(catid)" data-categories="itemsArea" data-category="currentArea" data-placeholder="{{areaTitle}}"></div></div></div><div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 filter-news__range-wrap"><div class="filter-news__filter b-filter__calendar b-filter__calendar_right right_side filter-news__filter_range"><div data-filter-calendar="" data-from-date="{{params.from}}" data-until-date="{{params.to}}" data-apply-new-range="applyFilterCalendar(fromDate,untilDate)"></div></div></div></div></div>'),e.put("newsFeed/newsFeed.tpl.html",'<div class="news-feed" data-ng-hide="hideme" data-ng-class="{\'contrast\':colorScheme==\'contrast\', \'{{setClass}}\': setClass}"><div class="news-feed__feed" data-ng-repeat="feed in feeds track by feed.id"><div class="news-feed__list"><div class="news-feed__item" data-ng-repeat="item in feed.items track by $index" data-ng-class="{\'news-feed__item_big-accent\': item.typeOfMaterial === \'big_accent\', \'news-feed__item_accent\': item.typeOfMaterial === \'accent\',\'news-feed__item_with-photo\': item.typeOfMaterial === \'with_photo\', \'news-feed__item_default\': !item.typeOfMaterial}" data-on-finish-render=""><div class="news-feed__item-wrapper"><div class="news-feed__item-text-wrapper" data-ng-class="{\'news-feed__item-text-no-image\': !item.image}"><div class="news-feed__item-text"><div class="news-feed__item-district-title" data-ng-if="showDistricts &amp;&amp; item.districtTitle">{{::item.districtTitle}}</div><a class="news-feed__item-title" data-ng-href="{{ item.link}}" target="{{ itemLinkTarget }}">{{ ::item.title }}</a><div class="news-feed__credentials"><span class="news-feed__item-date" data-ng-if="(item.date_timestamp || item.date_from_timestamp) &amp;&amp; !(item.kind &amp;&amp; item.kind.id === \'event\') &amp;&amp; !(item.kind &amp;&amp; item.kind.id === \'conference\')">{{(item.date_timestamp || item.date_from_timestamp)*1000 | prepareDateSince : \'d MMM\'}}</span><div class="news-feed__item-views" data-ng-if="item.counter"><span class="news-feed__item-icon icon-eye_grey"></span><span class="news-feed__item-date">{{::item.counter}}</span></div></div></div></div><a class="news-feed__item-image-wrapper" data-ng-href="{{ ::item.link }}" target="{{ itemLinkTarget }}"><div class="news-feed__item-image" data-ng-if="item.typeOfMaterial === \'big_accent\' &amp;&amp; item.image" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" data-image-set-element="item.image"></div><div class="news-feed__item-image" data-ng-if="item.typeOfMaterial === \'accent\'" data-ng-class="{\'grayscale\':colorScheme==\'contrast\' &amp;&amp; item.image}" data-image-set-element="item.image"></div><div class="news-feed__item-image" data-ng-if="(item.typeOfMaterial === \'with_photo\' || !item.typeOfMaterial) &amp;&amp; item.image" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" data-image-set-element="item.image"></div></a></div></div></div><div class="news-feed__list-without-images" data-ng-if="feed.itemsWithoutImage.length"><div class="customScrollbar"><div class="news-feed__item-without-image" data-ng-repeat="item in feed.itemsWithoutImage"><a class="news-feed__link" data-ng-href="{{ ::item.link }}" target="{{ itemLinkTarget }}">{{ ::item.title}}<span class="news-feed__item-date" data-ng-if="item.date_timestamp || item.date_from_timestamp">{{ (item.date_timestamp || item.date_from_timestamp)*1000 | prepareDateSince : \'d MMM\' }}</span></a></div></div></div></div><div class="news-feed__get-more" data-ng-if="isThereMorePages" data-ng-click="getMoreNews()" data-translate="newsFeed.see"></div><div class="news-feed__not-found" data-ng-if="notFound" data-translate="newsFeed.notFound"></div></div>'),e.put("newsFeedAdditional/newsFeedAdditional.tpl.html",'<div class="news-feed-additional-additional" data-ng-hide="hideme" data-ng-class="{\'contrast\':colorScheme==\'contrast\'}"><div class="news-feed-additional__list" data-ng-if="!minimize"><div class="news-feed-additional__item" data-ng-repeat="item in items" data-ng-class="{\'news-feed-additional__item_default\': !item.typeOfMaterial, \'news-feed-additional__item_big-accent\': item.typeOfMaterial === \'big_accent\', \'news-feed-additional__item_accent\': item.typeOfMaterial === \'accent\',\'news-feed-additional__item_with-photo\': item.typeOfMaterial === \'with_photo\'}"><div class="news-feed-additional__item-wrapper row"><a class="news-feed-additional__item-image-wrapper" data-ng-href="{{ item.link }}" target="{{ itemLinkTarget }}"><div class="news-feed-additional__item-image" data-ng-if="item.typeOfMaterial === \'big_accent\' || item.typeOfMaterial === \'accent\' &amp;&amp; item.image" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" data-image-set-element="item.image"></div><div class="news-feed-additional__item-image" data-ng-if="item.typeOfMaterial === \'with_photo\' || !item.typeOfMaterial &amp;&amp; item.image" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" data-image-set-element="item.image"></div></a><div class="news-feed-additional__item-text-wrapper" data-ng-class="{\'news-feed__item-text-no-image\': !item.image}"><div class="news-feed-additional__item-text"><div class="news-feed-additional__item-district-title" data-ng-if="showDistricts &amp;&amp; item.districtTitle">{{item.districtTitle}}</div><a class="news-feed-additional__item-title" data-ng-href="{{ item.link }}" target="{{ itemLinkTarget }}">{{ item.title }}</a><div class="news-feed-additional__credentials"><span class="news-feed-additional__item-date" data-ng-if="item.date_timestamp || item.date_from_timestamp">{{ (item.date_timestamp || item.date_from_timestamp)*1000 | prepareDateSince : \'d MMM\' }}</span><div class="news-feed-additional__item-views" data-ng-if="item.counter"><span class="news-feed-additional__item-icon icon-eye_grey"></span><span class="news-feed-additional__item-date">{{item.counter}}</span></div></div></div></div></div></div></div><div class="news-feed-additional__list" data-ng-if="minimize"><div class="news-feed-additional__item news-feed-additional__item_default" data-ng-repeat="item in items"><div class="news-feed-additional__item-wrapper row"><a class="news-feed-additional__item-image-wrapper" data-ng-href="{{ item.link }}" target="{{ itemLinkTarget }}"><div class="news-feed-additional__item-image" data-ng-if="item.image" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" data-image-set-element="item.image"></div></a><div class="news-feed-additional__item-text-wrapper" data-ng-class="{\'news-feed__item-text-no-image\': !item.image}"><div class="news-feed-additional__item-text"><div class="news-feed-additional__item-district-title" data-ng-if="showDistricts &amp;&amp; item.districtTitle">{{item.districtTitle}}</div><a class="news-feed-additional__item-title" data-ng-href="{{ item.link }}" target="{{ itemLinkTarget }}">{{ item.title }}</a><div class="news-feed-additional__credentials"><span class="news-feed-additional__item-date" data-ng-if="item.date_timestamp || item.date_from_timestamp">{{ (item.date_timestamp || item.date_from_timestamp)*1000 | prepareDateSince : \'d MMM\' }}</span><div class="news-feed-additional__item-views" data-ng-if="item.counter"><span class="news-feed-additional__item-icon icon-eye_grey"></span><span class="news-feed-additional__item-date">{{item.counter}}</span></div></div></div></div></div></div></div><a class="news-feed-additional__get-more" data-ng-click="getMore(); $event.preventDefault(); $event.stopPropagation();" data-ng-href="{{ getNextPageUrl() }}" data-ng-if="isThereMorePages &amp;&amp; (items.length || allInMainFeed)" data-translate="newsFeedAdditional.see"></a></div>'),e.put("newsMediaAdditional/newsMediaAdditional.tpl.html",'<div class="news-media-additional" data-ng-hide="hideme" data-ng-class="{\'contrast\':colorScheme==\'contrast\'}"><div class="news-media-additional__item"><a class="news-media-additional__item-extconts" data-ng-if="item.link" data-ng-href="{{item.link}}"><div class="text" data-ng-bind-html="trustAsHtml(item.text)"></div><div class="img hidden-xs" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" data-ng-style="{\'background-image\': \'url(&quot;{{item.image | imagesPath}}&quot;)\'}"></div><div class="img visible-xs-block" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" data-ng-style="{\'background-image\': \'url(&quot;{{ item.imagehorizontal | imagesPath}}&quot;)\'}"></div></a></div></div>'),e.put("pressMedia/pressMedia.tpl.html",'<div><div class="b-press-promo" data-ng-if="promoItem &amp;&amp; !params.fromDate &amp;&amp; !params.untilDate"><a class="b-full-container-link" data-ng-if="promoItem.type == \'gallery\'" data-ui-sref="{{section}}.photo({photoID:promoItem.id})"></a><a class="b-full-container-link" data-ng-if="promoItem.type == \'video\'" data-ui-sref="{{section}}.video({videoID:promoItem.id})"></a><div class="loader"><div class="loader-image"><div class="cssload-progress cssload-float cssload-shadow"><div class="cssload-progress-item"></div></div></div></div><div class="b-promo__carousel-image" data-ng-if="promoItem.image"><img data-img-ratio="a|1:b|2:c|2:d|2:e|3" data-img-source="promoItem.image" data-no-animation="true" alt="{{promoItem.image.title}}" data-ng-if="promoItem.image" title="{{promoItem.image.title}}" data-ng-class="{\'grayscale\': colorScheme == \'contrast\'}"/></div><div class="b-press-preamble__caption-wrapper"><div class="b-press-preamble__caption"><div data-ng-class="{\'icon-camera\': promoItem.type == \'gallery\', \'icon-play\': promoItem.type == \'video\'}"></div><div class="b-press-preamble__caption__info"><span class="b-press-preamble__caption__info__date" data-ng-if="promoItem.date_timestamp">{{promoItem.date_timestamp*1000 | date : \'d.MM.yyyy\'}}</span><span class="b-press-preamble__caption__info__title" ng-bind-html="promoItem.title"></span><span class="b-press-preamble__caption__info__ext">{{promoItem.count ? promoItem.count + \' фото\' : ((promoItem.duration && promoItem.duration!=\'00:00:00\')?promoItem.duration:\'\')}}</span></div></div></div><div class="b-large-img__description" data-ng-if="promoItem.image.title"><span class="b-large-img__description-f">Фотография</span><span class="b-large-img__description-s">{{promoItem.image.title}}</span></div></div><div class="b-fix-wrapper container-fluid"><div class="row b-press-nav"><div class="col-xs-12 col-sm-6 col-md-4 b-filter__calendar" data-filter-calendar="" data-from-date="{{params.fromDate}}" data-until-date="{{params.untilDate}}" data-apply-new-range="applyFilterCalendar(fromDate,untilDate)"></div></div><div class="b-press-media__bricks" data-mos-press-category="" data-items="items" data-section="{{section}}" data-get-more-bricks="getMoreBricks()" data-get-next-page-url="getNextPageUrl" data-settings="settings" data-morebutton="morebutton" data-notfound="notfound"></div></div></div>'),e.put("pressPhoto/pressPhoto.tpl.html",'<h1 class="b-press-titlebar" data-ng-if="setBlockData"><div class="b-press-photo-count">{{photosLength}} фото</div><div class="b-press-photo-date" data-ng-bind-html="gallery.date"></div><span data-ng-bind-html="gallery.title"></span></h1><div class="b-press-photo-gallery" data-mos-photo-gallery="" data-items="photos"></div><div class="b-press-photo-list" data-ng-if="!!galleryVisible"><div class="b-press-photo-item" data-ng-click="photoClicked($index)" data-ng-repeat="item in photos" data-ng-style="{\'background-image\': \'url(&quot;{{item.image | imageSetSrc:\'a|1|s\':\'b|2|s\':\'c|2|m\':\'d|3|m\':\'e|3|m\'}}&quot;)\'}"></div></div><div data-mos-press-photo-popup="" data-gallery-visible="galleryVisible" data-actual-menu="actualMenu" data-photos-length="photosLength"></div><div class="b-fix-wrapper container-fluid b-press-article" data-ng-if="similar.length"><div class="row b-press-article__similar similar-media"><div class="color_lite_gray" data-mos-carousel-four-items="" data-title="Галереи и видео на эту тему" data-section="home.media" data-ng-hide="hideme" data-more-link-text="Все галереи и видео" data-items="similar" data-slides-to-show="4" data-slides-to-scroll="3" data-template="&lt;div class=\'b-press-bricks__item-content color_bw\' data-mos-press-item-brick=\'\' data-item=\'item\'&gt;&lt;/div&gt;" data-responsive="[{breakpoint: 1400,settings: {slidesToShow:3,slidesToScroll:2}},{breakpoint: 1000,settings: {slidesToShow:2,slidesToScroll:2}},{breakpoint: 767,settings: {slidesToShow:1,slidesToScroll:1}}]"></div></div></div>'),e.put("pressVideo/pressVideo.tpl.html",'<div data-mos-error="mosError" data-ng-if="mosError"></div><h1 class="b-press-titlebar b-press-titlebar_type_title" data-ng-if="!mosError" ng-bind-html="::item.title"></h1><div class="b-press-title" data-ng-if="item.date_timestamp">{{::item.date_timestamp*1000 | date : \'d MMMM yyyy\'}} года</div><div class="b-press-preamble b-press-video" data-ng-if="!mosError &amp;&amp; video &amp;&amp; video.guid" data-video-mvsr-player="{{ ::video.guid }}"></div><div class="b-press-preamble b-press-video" data-ng-if="!mosError &amp;&amp; video &amp;&amp; videoSrc &amp;&amp; !video.guid" data-ng-class="{\'b-press-video_aspect-ratio\': !video.image}"><div class="b-press-video__back"><img data-img-ratio="a|2:b|2:c|2:d|3:e|3" data-img-source="video.image" data-no-animation="true" alt="{{video.image.title}}" data-ng-if="video.image" title="{{video.image.title}}" data-ng-class="{\'grayscale\': colorScheme == \'contrast\'}"/></div><div class="b-media-controls"><div class="b-press-video__btn_type_share" data-id="media" data-mos-sharing="" data-type="modal" data-title="{{item.title}}" data-preview="{{item.title}}" data-image="{{video.image | imgDownload}}" data-socials="vkontakte,odnoklassniki"></div><a class="icon-save_white" data-ng-href="{{::source.mp4}}" target="{{downloadTarget}}" download="download"></a></div><video class="b-press-video__player" data-ng-if="videoSrc" data-mos-video-player="" data-sources="videoSrc" src="{{videoSrc}}" data-evt-play="videoState(state)" data-evt-pause="videoState(state)" data-evt-stop="videoState(state)" data-ng-class="{\'grayscale-modern\': colorScheme == \'contrast\'}"></video></div><div class="b-press-video__extras-wrap"><div class="b-article__text b-video_tags" data-mos-tags="" data-section="media" data-tags="item.tags" data-ng-if="item.tags &amp;&amp; item.tags.length &gt; 0"></div><div class="b-press-video__extras" data-ng-if="districts.length"><span class="b-press-video__extras-title" data-translate="pressVideo.districts"></span> <a class="b-press-video__extras-item" data-ng-repeat="district in districts | limitTo: districtsMax" data-ng-href="{{ district.url }}">{{ district.title }}<span data-ng-if="$index != districtsMax - 1">, </span></a><span class="b-press-video__extras-item" data-ng-if="districts.length &gt; districtsMax"> и </span><a class="b-press-video__extras-item" data-ng-show="districts.length &gt; districtsMax" href="#" data-mos-hidden-list="" data-list="districts" data-on-click="moreClicked(\'districts\', evt)" data-on-reset="moreReset(\'districts\')" data-popup-title="{{ districtsTitle }}">еще {{ districts.length - districtsMax }} <ng-pluralize count="districts.length - districtsMax" when="{\'one\': \'округ\',\'few\': \'округа\',\'many\': \'округов\',\'other\': \'округов\'}"></ng-pluralize></a></div><div class="b-press-video__extras" data-ng-if="areas.length"><span class="b-press-video__extras-title" data-translate="pressVideo.areas"></span> <a class="b-press-video__extras-item" data-ng-repeat="area in areas | limitTo: areasMax" data-ng-href="{{ area.url }}">{{ area.title }}<span data-ng-if="$index != areasMax - 1">, </span></a><span class="b-press-video__extras-item" data-ng-if="areas.length &gt; areasMax"> и </span><a class="b-press-video__extras-item" data-ng-show="areas.length &gt; areasMax" href="#" data-mos-hidden-list="" data-list="areas" data-on-click="moreClicked(\'areas\', evt)" data-on-reset="moreReset(\'areas\')" data-popup-title="{{ areasTitle }}">еще {{ areas.length - areasMax }} <ng-pluralize count="areas.length - areasMax" when="{\'one\': \'район\',\'few\': \'района\',\'many\': \'районов\',\'other\': \'районов\'}"></ng-pluralize></a></div></div>'),e.put("photoGallery/photoGallery.tpl.html",'<div class="b-main-gallery" slick="" init-onload="true" data="items" on-init="onInitCarousel(evt, slick)" accessibility="false" draggable="false" swipe="false" touch-move="false" speed="1000" arrows="false" wait-for-animate="true"><div class="b-main-gallery__item" data-ng-repeat="item in items"><div class="b-media-controls"><a class="icon-save_white" data-ng-href="{{item.image.src || item.image.big.src}}" download="download"></a><div class="b-large-img__description" data-ng-if="item.image.title"><span class="b-large-img__description-f">Фотография</span><span class="b-large-img__description-s">{{item.image.title}}</span></div></div><div class="b-promo__carousel-image" data-ng-if="item.image" data-ng-style="{\'background-image\': \'url(&quot;{{item.image | imageSetSrc:\'a|1|s\':\'b|1|m\':\'c|2|b\':\'d|2|b\':\'e|3|b\'}}&quot;)\'}"></div></div></div><div class="b-thumb-gallery" slick="" waitForAnimate="false" slides-to-show="9" slides-to-scroll="4" init-onload="true" data="items" on-init="onInitCarousel(evt, slick)" accessibility="false" draggable="false" swipe="false" touch-move="false" speed="600" center-padding="20px" as-nav-for=".b-main-gallery" center-mode="true" focus-on-select="true" prev-arrow="&lt;button type=\'button\' class=\'slick-prev icon-arrow_left_01_black\'&gt;&lt;/button&gt;" next-arrow="&lt;button type=\'button\' class=\'slick-next icon-arrow_right_01_black\'&gt;&lt;/button&gt;" data-responsive="[{breakpoint: 1400,settings: {slidesToShow:7,slidesToScroll:3}},{breakpoint: 1000,settings: {slidesToShow:5,slidesToScroll:2}},{breakpoint: 767,settings: {slidesToShow:3,slidesToScroll:1}}]"><div class="b-thumb-gallery__item" data-ng-repeat="item in items"><div data-ng-style="{\'background-image\': \'url(&quot;{{item.image | imageSetSrc:\'a|1|s\':\'b|1|m\':\'c|2|b\':\'d|2|b\':\'e|3|b\'}}&quot;)\'}"></div><span>{{$index+1 + \' / \' + count(items)}}</span></div></div>'),e.put("pressPlainList/pressPlainList.tpl.html",'<div class="b-fix-wrapper b-press-tape" data-ng-class="{\'picker-content\': notfound}"><div class="b-press-tape__title" data-ng-if="title">{{title}}</div><div class="row b-press-nav"><div class="col-xs-12 col-sm-6 col-md-4 b-filter__calendar" data-filter-calendar="" data-from-date="{{params.fromDate}}" data-until-date="{{params.untilDate}}" data-apply-new-range="applyFilterCalendar(fromDate,untilDate)"></div></div><div class="row b-press-tape__list"><div class="col-xs-12 b-press-tape__item" data-ng-if="notfound"><p>Публикаций не найдено</p></div><div class="col-xs-12 b-press-tape__item" data-ng-if="items &amp;&amp; items.length &gt; 0" data-ng-repeat="item in items" data-ng-class="{\'am-fade-and-slide-right\': !params.page, \'am-fade-and-slide-top\': params.page}"><a class="b-press-tape__item-link" ui-sref="{{section+\'.story\'}}({id:item.id})"><span class="b-press-tape__item-date" data-ng-if="item.date_timestamp">{{::item.date_timestamp*1000 | date : \'d MMM yyyy\'}}</span><span class="b-press-tape__item-title" data-ng-bind-html="::item.title"></span><span class="ico"></span></a></div></div><div class="b-loader"></div><div class="row b-press-nav" data-ng-if="items &amp;&amp; items.length &gt; 0 &amp;&amp; morebutton"><div class="col-xs-12 b-press-bricks__morebutton"><a class="b-more__loader" data-ng-href="{{ getNextPageUrl() }}" data-ng-click="getMoreBricks(); $event.preventDefault(); $event.stopPropagation();"><span class="ico icon-arrow_down_03_black"></span><span class="text">Посмотреть еще</span></a></div></div></div>'),e.put("banner/banner.tpl.html",'<div class="insertionHeader" ng-if="flagon === &quot;on&quot;"><iframe name="insertionHeader" scrolling="no" data-ng-src="{{path}}"></iframe></div>'),e.put("pressPhotoPopup/pressPhotoPopup.tpl.html",'<div class="b-press-photo-popup" data-ng-if="!!itHasMenu"><div class="b-press-photo-popup__title" data-ng-if="!photoVisible"><span data-ng-click="closeAll()">Вернуться к фото<div class="arrow"></div></span><div class="icon icon-cross_white" data-ng-click="closeAll()"></div></div><div class="row b-press-tape__list" data-ng-if="!!itHasMenu &amp;&amp; !!menuVisible"><div class="b-press-tape__item am-fade-and-slide-left" data-ng-click="menuItemClicked($index)" data-ng-repeat="item in actualMenu"><div class="b-press-tape__item-link"><div class="b-press-tape__item-title">{{actualPhoto.title}}</div><div class="ico"></div></div></div></div><div class="b-press-photo-popup__item" data-ng-if="!!photoVisible"><img class="b-press-photo-popup__img" ng-src="{{actualPhoto | imageSrcMiddle}}"/><div class="b-press-photo-popup__close" data-ng-click="closePhoto()"><div class="icon icon-cross_white"></div></div><div class="b-press-photo-popup__menu"><div class="col col-xs-3 b-press-photo-popup__menu__item"><div class="caption">{{$index+1 + \' / \' + photosLength}}</div></div><div class="col-xs-3 b-press-photo-popup__menu__item"><div class="icon icon-save_white"></div></div><div class="col-xs-3 b-press-photo-popup__menu__item"><div class="icon icon-share_white"></div></div><div class="col-xs-3 b-press-photo-popup__menu__item"><div class="icon icon_info"></div></div><div class="b-large-img__description" data-ng-if="actualPhoto.title"><span class="b-large-img__description-f">Фотография</span><span class="b-large-img__description-s">{{actualPhoto.title}}</span></div></div></div></div>'),e.put("sharing/sharing.tpl.html",'<div class="b-sharing"><div class="b-sharing__share-button" data-ng-if="isModal()"><button class="b-iconic-btn" data-ng-click="openPopup()"><i class="icon-share_blue"></i><span class="b-iconic-btn__text" data-translate="mosSharing.shareTitle"></span></button></div><div class="b-sharing-links" id="{{id}}" data-ng-class="dynClass" data-ng-if="!isModal()"></div></div>'),e.put("sharingPopup/sharingPopup.tpl.html",'<div class="b-popup-sharing"><div class="b-popup-sharing__body"><div class="b-popup-sharing__header"><h3 class="b-popup-sharing__title" data-translate="mosSharingPopup.shareTitle"></h3><button class="b-popup-sharing__close" data-ng-click="closePopup()"></button></div><div class="b-popup-sharing__content"><div class="b-popup-sharing__socials"><div class="b-sharing-links b-sharing-links_type_horizontal b-sharing-links_behaviour_form" id="{{id}}"></div></div></div><div class="b-popup-sharing__footer"></div></div></div>'),e.put("photoBank/photoBank.tpl.html",'<div class="photobank-loader"></div><div data-ng-if="galleryId" data-mos-media-photo="" data-gallery-info-id="1" data-state-root="{{stateRoot}}" data-state-mode="{{stateMode}}" data-gallery-id="{{galleryId}}" data-api-root="{{apiRoot}}" data-gallery-api="{{galleryApi}}" data-images-api="{{imagesApi}}" data-first-person="firstPerson" data-person="person" data-err-code="errCode" data-postfix="{{postfix}}" data-is-authority="{{isAuthority}}"></div>'),e.put("mediaPhoto/mediaPhoto.tpl.html",'<div data-mos-error="mosError" data-ng-if="mosError"></div><div class="media-photo-loader"></div><div class="media-photo" data-ng-if="gallery &amp;&amp; !mosError"><div class="carousel__header wrapper"><div class="carousel__title-wrapper" data-ng-if="media.title &amp;&amp; (!inline || inline &amp;&amp; galleryId)"><h1 class="carousel__title" ng-bind-html="::media.title"></h1><div class="carousel__info" data-ng-if="media.date_timestamp || picsTotal"><span class="carousel__date" data-ng-if="media.date_timestamp">{{media.date_timestamp*1000 | date : \'d MMMM yyyy\'}} года</span><span class="carousel__number" data-ng-if="picsTotal">{{picsTotal}} фото</span></div></div><div class="carousel__title-wrapper person-title" data-ng-if="person.title"><h1 class="carousel__title"><a data-ng-href="{{person.personUrl}}">{{person.title}}</a></h1><div class="carousel__info" data-ng-if="person.post || person.section.title || picsTotal"><span class="carousel__number" data-ng-if="picsTotal">{{picsTotal}} фото</span><a class="carousel__person-info" data-ng-if="person.section" data-ng-href="{{person.sectionUrl}}">{{person.section}}</a><span class="carousel__person-info" data-ng-if="person.post">{{person.post}}</span></div></div><div class="carousel__toggle toggle noprint"><a class="toggle__item toggle__item_type_list" data-ng-click="changeMode(\'tiles\')" data-ng-class="{\'toggle__item_state_active\': params.mode == \'tiles\'}"></a><a class="toggle__item toggle__item_type_grid" data-ng-click="changeMode(\'carousel\')" data-ng-class="{\'toggle__item_state_active\' : params.mode == \'carousel\'}"></a></div></div><div class="carousel" data-ng-if="params.mode == \'carousel\' &amp;&amp; photoItems.length"><a class="goto_tiles_mobile" href="" data-ng-click="changeMode(\'tiles\')"><span class="ico icon-close_white"></span></a><div class="carousel__printonly"><img class="carousel__printonly_image" data-ng-if="currentImageSrc" data-ng-src="{{currentImageSrc}}"/><p data-ng-if="currentItem.image.title">Фотография {{currentItem.image.title}}</p></div><div data-mos-media-photo-carousel="" data-inline="inline" data-params="params" data-pics-total="picsTotal" data-get-more-items="getMoreItems" data-photo-items="photoItems" data-lock-more="lockMore" data-per-page="perPage" data-action="action" data-postfix="{{postfix}}" data-current-item="currentItem" data-current-tile-item="currentTileItem" data-current-image-src="currentImageSrc" data-gallery="gallery" data-set-current-image="setCurrentImage(pic, order)" data-page-type="{{pageType}}" data-is-authority="{{isAuthority}}"></div></div><div class="tiles" data-ng-if="params.mode == \'tiles\' &amp;&amp; photoItems.length" data-mos-media-photo-tiles="" data-photo-items="photoItems" data-gallery="gallery" data-lock-more="lockMore" data-params="params" data-show-slide="showSlide" data-per-page="perPage" data-postfix="{{postfix}}" data-current-tile-item="currentTileItem" data-get-more-items="getMoreItems" data-from-carousel="fromCarousel" data-set-current-image="setCurrentImage(pic)"></div><div class="media-photo__extras-wrap"><div class="b-article__text b-video_tags" data-mos-tags="" data-section="media" data-tags="gallery.tags" data-ng-if="gallery.tags &amp;&amp; gallery.tags.length &gt; 0"></div><div class="media-photo__extras" data-ng-if="districts.length"><span class="media-photo__extras-title" data-translate="mediaPhoto.districts"></span> <a class="media-photo__extras-item" data-ng-repeat="district in districts | limitTo: districtsMax" data-ng-href="{{ district.url }}">{{ district.title }}<span data-ng-if="$index != districtsMax - 1">, </span></a><span class="media-photo__extras-item" data-ng-if="districts.length &gt; districtsMax"> и </span><a class="media-photo__extras-item" data-ng-show="districts.length &gt; districtsMax" href="#" data-mos-hidden-list="" data-list="districts" data-on-click="moreClicked(\'districts\', evt)" data-on-reset="moreReset(\'districts\')" data-popup-title="{{ districtsTitle }}">еще {{ districts.length - districtsMax }} <ng-pluralize count="districts.length - districtsMax" when="{\'one\': \'округ\',\'few\': \'округа\',\'many\': \'округов\',\'other\': \'округов\'}"></ng-pluralize></a></div><div class="media-photo__extras" data-ng-if="areas.length"><span class="media-photo__extras-title" data-translate="mediaPhoto.areas"></span> <a class="media-photo__extras-item" data-ng-repeat="area in areas | limitTo: areasMax" data-ng-href="{{ area.url }}">{{ area.title }}<span data-ng-if="$index != areasMax - 1">, </span></a><span class="media-photo__extras-item" data-ng-if="areas.length &gt; areasMax"> и </span><a class="media-photo__extras-item" data-ng-show="areas.length &gt; areasMax" href="#" data-mos-hidden-list="" data-list="areas" data-on-click="moreClicked(\'areas\', evt)" data-on-reset="moreReset(\'areas\')" data-popup-title="{{ areasTitle }}">еще {{ areas.length - areasMax }} <ng-pluralize count="areas.length - areasMax" when="{\'one\': \'район\',\'few\': \'района\',\'many\': \'районов\',\'other\': \'районов\'}"></ng-pluralize></a></div></div></div>'),e.put("mediaPhotoCarousel/mediaPhotoCarousel.tpl.html",'<div class="carousel-vertical noprint"><div class="carousel-vertical__social"><div class="b-iconic-btn-list"><div class="carousel-vertical__info"><span class="js-current-number">{{currentSlide + 1}}</span> / <span class="js-all-number">{{picsTotal}}</span></div><a class="b-iconic-btn carousel-vertical__btn carousel-vertical__btn_type_print" data-ng-click="printThis()"><i class="icon-print_blue"></i><span class="b-iconic-btn__text"></span></a><a class="b-iconic-btn carousel-vertical__btn carousel-vertical__btn_type_download" target="_blank" data-ng-if="currentItem.image" data-ng-href="{{currentItem.image | imgDownload}}" download="{{currentItem.image | imgFileName}}"><i class="icon-save_blue"></i><span class="b-iconic-btn__text"></span></a><div class="carousel-vertical__btn carousel-vertical__btn_type_share" data-id="media" data-mos-sharing="" data-type="modal" data-let-alone-og="1" data-title="{{currentItem.title}}" data-preview="{{sharingPreview}}" data-image="{{currentItem.image | imgDownload}}"></div><a class="carousel-vertical__btn carousel-vertical__btn_type_info" href="#"></a></div></div><div class="carousel-vertical__list slick-slider"><div class="carousel-vertical__list-prev" data-ng-if="currentSlide &gt; 0 &amp;&amp; fullItems &amp;&amp; fullItems.length &gt; 1" data-ng-click="getPrevSlide()"></div><div class="carousel-vertical__list-next" data-ng-if="(currentSlide !== picsTotal - 1) &amp;&amp; fullItems &amp;&amp; fullItems.length &gt; 1" data-ng-click="getNextSlide()"></div><div class="slick-list"><div class="slick-track"><div class="carousel-vertical__item slick-slide" data-ng-repeat="item in fullItems track by $index" data-ng-class="{videoitem : item.type == \'video\', \'current-slide\':item.current,\'grayscale\': colorScheme == \'contrast\'}" data-media-photo-carousel-full="" data-item="item" data-postfix="{{postfix}}" data-gallery="gallery" data-current-slide="currentSlide" data-get-next-slide="getNextSlide()" data-get-prev-slide="getPrevSlide()" data-pics-total="picsTotal"></div></div></div></div><div class="carousel-vertical__nav"><div class="carousel-vertical__nav-prev slick-arrow" data-ng-class="{disabled:currentSlide==0}" data-ng-click="getPrevSlide()"></div><div class="carousel-vertical__nav-next slick-arrow" data-ng-class="{disabled:currentSlide==picsTotal-1}" data-ng-click="getNextSlide()"></div><div class="carousel-vertical__nav_track"><div class="carousel-vertical__nav_list"><div class="carousel-vertical__nav-item" data-ng-repeat="item in photoItems track by $index" data-ng-class="{videoitem : item.type == \'video\', \'current\': item.current, \'grayscale\': colorScheme == \'contrast\'}" data-index="{{$index}}" data-ng-click="goToSlide($index)"><div class="table" data-media-photo-carousel-thumb="" data-item="item" data-ind="$index" data-postfix="{{postfix}}" data-gallery="gallery" data-current-slide="currentSlide" data-pics-total="picsTotal"></div></div></div></div></div></div>'),e.put("mediaPhotoCarousel/mediaPhotoCarouselFull.tpl.html",'<div class="carousel-vertical__mask" data-ng-if="item.showImage" data-ng-swipe-left="getNextSlide()" data-ng-swipe-right="getPrevSlide()"></div><div class="carousel-vertical__content-image nonDraggableImage" data-ng-swipe-left="getNextSlide()" data-ng-swipe-right="getPrevSlide()"><div class="carousel-vertical__image-wrap"><div class="b-large-img__description" data-ng-if="displayInfo &amp;&amp; item.image.title"><div data-ng-if="showPhotoTitle"><span class="b-large-img__description-f">Фотография</span></div><span class="b-large-img__description-s">{{item.image.title}}</span></div></div></div>'),e.put("mediaPhotoCarousel/mediaPhotoCarouselThumb.tpl.html",'<div class="table-cell" data-ng-if="item.showImage"><div class="carousel-vertical__blur-wrapper" data-ng-style="{\'background-image\': \'url(&quot;{{item.image | imgThumb}}&quot;)\'}"></div><div class="carousel-vertical__image"><img data-ng-src="{{item.image | imgThumb}}" alt="{{metaImage.alt}}" title="{{metaImage.title}}"/></div></div><div class="carousel-vertical__number" data-ng-if="item.current"><span class="js-current-number">{{currentSlide + 1}}</span> / <span class="js-all-number">{{picsTotal}}</span></div>'),e.put("mediaPhotoTiles/mediaPhotoTiles.tpl.html",'<div>{{currentSlide}}</div><div class="tiles__container" data-masonry=""><div class="tiles__item" data-ng-class="{\'grayscale\': colorScheme == \'contrast\'}" data-masonry-tile="" data-ng-repeat="item in showItem track by $index" data-ng-click="open({item:item, index:$index})"><div class="tiles_anchor" data-ng-if="item.current"></div><img data-ng-src="{{item.image | imgThumb}}" width="100%" height="100%" alt="{{metaImage.alt}}" title="{{metaImage.title}}"/></div></div><div class="tiles__container"><div class="tiles__btn tiles__btn_up" data-ng-click="goToTop()"><div class="icon icon-arrow_up_03_gray"></div></div><div class="tiles__btn tiles__btn_expand" data-ng-if="!lockMore" data-ng-click="getMoreItems()"><span class="icon icon-arrow_down_03_black"></span><span data-translate="mosMediaPhotoTiles.see"></span></div></div>'),e.put("searchForm_v2/search.form_v2.tpl.html",'<form class="b-search-form" data-ng-class="{\'s-autocompl-form\': autocomplete, \'b-search-panel__form\': searchClass==\'b-search-panel\', \'b-advisor-search__form\': searchClass==\'b-advisor-search\', \'b-press-search__form\': searchClass==\'b-press-search\'}" data-ng-submit="formSubmit()"><fieldset><span class="icon-lense_black icon-main_page"></span><div class="rel"><input class="b-search-input s-autocompl-input" type="text" name="query" data-ng-focus="onFocus()" data-ng-blur="onBlur()" data-ng-class="{\'b-search-panel__input\': searchClass==\'b-search-panel\', \'b-advisor-search__input\': searchClass==\'b-advisor-search\', \'b-press-search__input\': searchClass==\'b-press-search\'}" value="" autocomplete="off" placeholder="{{searchPlaceholder}}" data-ng-hide="!autocomplete" data-prfurl="{{prfurl}}" data-remurl="{{remurl}}"/><span class="twitter-typeahead" data-ng-hide="autocomplete"><input class="b-search-input" type="text" name="query" autocomplete="off" value="{{searchText}}" placeholder="{{searchPlaceholder}}" data-ng-class="{\'b-search-panel__input\': searchClass==\'b-search-panel\', \'b-advisor-search__input\': searchClass==\'b-advisor-search\', \'b-press-search__input\': searchClass==\'b-press-search\'}"/></span><input class="icon-lense_black" data-ng-if="!btnText" type="button" ng-click="formSubmit()" value="{{\'mosSearchForm.findTitle\' | translate}}" data-ng-disabled="lock" data-ng-class="{\'b-search-panel__button\': searchClass==\'b-search-panel\', \'b-advisor-search__button\': searchClass==\'b-advisor-search\', \'b-press-search__button\': searchClass==\'b-press-search\'}"/><button class="icon-lense_black" data-ng-if="btnText" data-ng-bind-html="trustAsHtml(btnText)" type="submit" ng-click="formSubmit()" data-ng-disabled="lock" data-ng-class="{\'b-search-panel__button\': searchClass==\'b-search-panel\', \'b-advisor-search__button\': searchClass==\'b-advisor-search\', \'b-press-search__button\': searchClass==\'b-press-search\'}">{{\'mosSearchForm.findTitle\' | translate}}</button></div></fieldset></form>'),e.put("tags/tags.tpl.html",'<div class="b-article__tags"><span data-translate="mosTags.tagTitle"> </span> <a data-ng-href="{{getSearchLink(item.title)}}" data-ng-repeat="item in tags">{{item.title}}<span data-ng-if="$index!=tags.length-1!=0 || $index!=tags.length-1">,</span></a></div>'),e.put("spheres/spheres.tpl.html",'<div class="b-article__spheres"><span data-translate="mosSpheres.spheresTitle"> </span> <a data-ng-href="{{getSphereLink(item)}}" data-ng-repeat="item in params.spheres" target="{{target}}">{{item.title}}<span data-ng-if="$index!=params.spheres.length-1!=0 || $index!=params.spheres.length-1">,</span></a></div>'),e.put("mosError/mosError.tpl.html",'<div class="mos-error error-page"><div class="header"><h1 class="errorMessage" data-ng-if="pageInfo.title" data-translate="mosError.errorMessage_{{pageInfo.title}}" ng-class="{ header_cn: lang === \'cn\'}"></h1><p class="errorText" data-ng-if="pageInfo.title" data-translate="mosError.errorText_{{pageInfo.title}}"></p><div ng-if="showSearch" id="{{ appId }}"></div></div><div class="live" ng-if="lang === \'ru\'" data-widget="widget-live"></div><script ng-if="lang === \'ru\' &amp;&amp; isClientError" type="text/javascript" src="/widget-collection/main.js"><\/script></div>'),e.put("photoBankTabs/photoBankTabs.tpl.html",'<div class="bank-tabs-wrap" data-ng-if="blockVisible"><div class="bank-tabs-wrap__header" data-ng-if="tabs.length" data-translate="photoBankTabs.galleryTitle"></div><div class="bank-tabs-wrap-tabs" data-ng-if="tabs.length &gt; 1"><div class="bank-tabs-wrap-tabs__item" data-ng-click="changeTab(tab.id)" data-ng-class="{\'bank-tabs-wrap-tabs__item_state_active\': tab.active}" data-ng-repeat="tab in tabs" data-translate="photoBankTabs.tabTitle{{$index}}"></div></div><div data-mos-media-photo="" data-inline="on" data-gallery-info-id="galleryInfoId" data-api-root="{{apiRoot}}" data-gallery-api="{{galleryApi}}" data-images-api="{{imagesApi}}" data-postfix="{{postfixImg}}"></div></div>'),e.put("carouselWithMiniatures/carouselWithMiniatures.tpl.html",'<div class="b-carousel-with-miniatures"><div class="b-carousel-with-miniatures__carousels"><div class="b-carousel-with-miniatures__carousel_main"><div class="controls controls_left" aria-label="Previous" role="button" data-ng-click="prevSlide()"><span class="b-carousel-with-miniatures__icon b-carousel-with-miniatures__icon_prev"></span></div><div class="controls controls_right" aria-label="Next" role="button" data-ng-click="nextSlide()"><span class="b-carousel-with-miniatures__icon b-carousel-with-miniatures__icon_next"></span></div><div class="b-carousel-with-miniatures__icon b-carousel-with-miniatures__icon_zoom-in" data-ng-click="openImage()"></div><div class="b-carousel-with-miniatures__info" data-ng-if="imgTitle || imgCopyright" data-click-outside="hidePopover()"><div class="b-carousel-with-miniatures__popover"></div><div class="b-carousel-with-miniatures__icon" data-ng-class="{\'b-carousel-with-miniatures__icon_info\': !showInfo, \'b-carousel-with-miniatures__icon_info-close\': showInfo}" data-ng-click="showPopover()"></div></div><div class="main-item" data-ng-repeat="item in items track by $index"><div class="main-item__img" alt="{{item.alt}}" title="{{item.title}}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" data-ng-style="{\'background-image\': \'url(&quot;{{item.src}}&quot;)\'}"></div><div class="main-item__description" data-ng-if="item.title || item.copyright"><span data-ng-if="item.title">{{item.title + (item.copyright ? \' | \' : \'\')}}</span><span>{{item.copyright}}</span></div></div></div><div class="b-carousel-with-miniatures__carousel_nav"><div class="b-carousel-with-miniatures__carousel_nav-items"><div class="b-carousel-with-miniatures__icon b-carousel-with-miniatures__icon_prev-thumb" data-ng-if="!hideNavPrev" data-ng-click="prevPreview()"></div><div class="b-carousel-with-miniatures__icon b-carousel-with-miniatures__icon_next-thumb" data-ng-if="!hideNavNext" data-ng-click="nextPreview()"></div><div class="nav-item" data-ng-repeat="item in items track by $index"><div class="nav-item__img" alt="{{item.alt}}" title="{{item.title}}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" data-ng-style="{\'background-image\': \'url(&quot;{{item.src}}&quot;)\'}"></div></div></div></div><div class="b-carousel-with-miniatures__dots"></div></div></div>'),e.put("carouselWithMiniatures/carouselWithMiniaturesPopup.tpl.html",'<div class="mos-carousel-w-m-popup mos-carousel-w-m-popup_height"><div class="b-carousel-with-miniatures__icon mos-carousel-w-m-popup__close" data-ng-click="$hide()"></div><div class="mos-carousel-w-m-popup__zoom-controls" data-ng-class="{\'mos-carousel-w-m-popup__zoom-controls_zoom\': zoom &gt; 1}"><div class="mos-carousel-w-m-popup__zoom-in b-carousel-with-miniatures__icon b-carousel-with-miniatures__icon_plus" data-ng-click="zoom &lt; maxZoom &amp;&amp; zoomIn()"></div><div class="mos-carousel-w-m-popup__zoom-out b-carousel-with-miniatures__icon b-carousel-with-miniatures__icon_minus" data-ng-click="zoomOut()"></div><div class="mos-carousel-w-m-popup__zoom b-carousel-with-miniatures__icon b-carousel-with-miniatures__icon_zoom-in" data-ng-click="zoomIn()"></div></div><div class="mos-carousel-w-m-popup__carousels-wrap"><div class="mos-carousel-w-m-popup__carousels"><div class="mos-carousel-w-m-popup__carousel_main" style="visibility: hidden"><div class="mos-carousel-w-m-popup__control mos-carousel-w-m-popup__control_left" aria-label="Previous" role="button" data-ng-click="prevPopupSlide()"><span class="b-carousel-with-miniatures__icon b-carousel-with-miniatures__icon_prev"></span></div><div class="mos-carousel-w-m-popup__control mos-carousel-w-m-popup__control_right" aria-label="Next" role="button" data-ng-click="nextPopupSlide()"><span class="b-carousel-with-miniatures__icon b-carousel-with-miniatures__icon_next"></span></div><div class="carousel-main__item" data-ng-repeat="item in items track by $index"><div data-zoomable-image="" data-image-src="item.src" data-on-pinch-zoom="onPinchZoom" data-on-mouse-swipe-start="onMouseSwipeStart" data-on-mouse-swipe="onMouseSwipe"></div></div></div><div class="mos-carousel-w-m-popup__carousel_nav" style="visibility: hidden"><div class="mos-carousel-w-m-popup__carousel_nav-items"><div class="carousel-nav__item" data-ng-repeat="item in items track by $index"><div class="carousel-nav__item-img" title="{{item.title}}" data-ng-class="{\'grayscale\':colorScheme==\'contrast\'}" data-ng-style="{\'background-image\': \'url(&quot;{{item.src}}&quot;)\'}"></div></div></div></div><div class="mos-carousel-w-m-popup__carousel_dots"></div></div></div></div>'),e.put("carouselWithMiniatures/zoomableImage.tpl.html",'<img data-ng-src="{{imageSrc}}"/>'),e.put("mosLightbox/mosLightbox.tpl.html",'<div class="mos-lightbox-popup-modal" data-ng-class="{\'{{prefixClass}}\': prefixClass }"><div class="mos-lightbox__icon mos-lightbox-popup-modal__close" data-ng-click="hidePop()"></div><div class="mos-lightbox__zoom-controls" data-ng-class="{\'mos-lightbox__zoom-controls_zoom\': zoom &gt; 1}"><div class="mos-lightbox__icon mos-lightbox__zoom-in" data-ng-click="zoomIn()"></div><div class="mos-lightbox__icon mos-lightbox__zoom-out" data-ng-click="zoomOut()"></div><div class="mos-lightbox__icon mos-lightbox__zoom" data-ng-click="zoomIn()"></div></div><div class="mos-lightbox-popup-modal__cont-wrapper"><div class="mos-lightbox-popup-modal__cont"><div class="mos-lightbox-popup-modal__wrapper"></div></div></div></div>'),e.put("mos2GisMap/mos2GisMap.tpl.html",'<div class="b-egip-map"><div class="b-egip-items" data-ng-transclude="data-ng-transclude"></div></div>'),e.put("00_mosNewsfeed/mosEmbedSocial/mosEmbedSocial.tpl.html",'<div class="embed-social-wrapper"><div class="embed-social" data-ng-class="{\'embed-social_displayb\': displayBlock, \'embed-social_resp-frame\': responsiveFrame}"></div></div>'),e.put("mosCopyright/mosCopyright.tpl.html",'<div class="mos-copyright" data-ng-if="title || copyright"><h4 class="mos-copyright__title" data-ng-if="title">{{title}}</h4><p class="mos-copyright__description" data-ng-if="copyright"><span data-translate="mosCopyright.photo"></span>: {{copyright}}</p></div>'),e.put("00_common/hiddenList/hiddenListPopup.tpl.html",'<div class="hidden-list-popup"><div class="hidden-list-popup__wrapper"><div class="hidden-list-popup__header"><div class="hidden-list-popup__title">{{ popupTitle }}</div><div class="hidden-list-popup__close" ng-click="$hide()"></div></div><div class="hidden-list-popup__body"><a class="hidden-list-popup__item" data-ng-if="!noUrls" data-ng-repeat="item in list" data-ng-href="{{ item.url }}">{{ item.title }}</a><span class="hidden-list-popup__item" data-ng-if="noUrls" data-ng-repeat="item in list">{{ item.title }}</span></div></div></div>')}])}(window,window.angular);